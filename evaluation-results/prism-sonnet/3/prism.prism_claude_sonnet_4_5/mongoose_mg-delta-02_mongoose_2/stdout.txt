[2;36m[01/10/26 06:50:27][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=486279;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=762531;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpne_6nu42[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/mongoose_mg-delta-02_mongoose[0m [2m               [0m
[2;36m                    [0m         [35m_2/[0m[95magent-output-1768027827.6050873[0m                                                   [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/mongoose_mg-delta-02_mongoose_2.toml                [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-mongoose[0m         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Building Cached for CLEAN environment[1m)[0m          ]8;id=371280;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=102838;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[01/10/26 06:50:35][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Building Cached for CLEAN environment[1m)[0m Took    ]8;id=137849;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=549177;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m8.17[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                 [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running tests for Cached for CLEAN environment[1m)[0m ]8;id=75858;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=717024;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running tests for Cached for CLEAN             ]8;id=586609;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=900846;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=601964;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=360020;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m8[0m[1m)[0m                                                           [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=23896;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=493867;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 06:50:36][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.91[0m seconds;              ]8;id=458770;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=25651;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 06:50:37][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=234818;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=88193;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=66712;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=412804;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=630201;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=550312;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=359682;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=166430;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 06:50:38][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m1.00[0m seconds;              ]8;id=11052;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=223530;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=453006;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=748380;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 06:50:39][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.91[0m seconds;              ]8;id=518340;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=51972;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 06:50:41][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=870209;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=140086;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m258835080[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x561ff01a2708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x561ff01a3aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x561ff01a3aa8[0m[39m,[0m[1;36m0x561ff01b7448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x561ff0128c02[0m[39m bp [0m[1;36m0x7ffc33939220[0m[39m sp [0m[1;36m0x7ffc33939218[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561ff0128c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561ff0110d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561ff01258b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561feff91350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561feff7c5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561feff8205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561feffad302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fec5899b082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561feff747ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561ff009d11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561ff012579d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561feff91350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561feff7c5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561feff8205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561feffad302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fec5899b082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpi8kbb5d5[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m258835080[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x561ff01a2708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x561ff01a3aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x561ff01a3aa8[0m[39m,[0m[1;36m0x561ff01b7448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x561ff0128c02[0m[39m bp [0m[1;36m0x7ffc33939220[0m[39m sp [0m[1;36m0x7ffc33939218[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561ff0128c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561ff0110d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561ff01258b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561feff91350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561feff7c5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561feff8205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561feffad302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fec5899b082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561feff747ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561ff009d11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561ff012579d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561feff91350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561feff7c5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561feff8205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561feffad302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fec5899b082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                   [2m                [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                [2m                [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                       [2m                [0m
[2;36m                    [0m           Heap left redzone:       fa                                                       [2m                [0m
[2;36m                    [0m           Freed heap region:       fd                                                       [2m                [0m
[2;36m                    [0m           Stack left redzone:      f1                                                       [2m                [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                       [2m                [0m
[2;36m                    [0m           Stack right redzone:     f3                                                       [2m                [0m
[2;36m                    [0m           Stack after return:      f5                                                       [2m                [0m
[2;36m                    [0m           Stack use after scope:   f8                                                       [2m                [0m
[2;36m                    [0m           Global redzone:          f9                                                       [2m                [0m
[2;36m                    [0m           Global init order:       f6                                                       [2m                [0m
[2;36m                    [0m           Poisoned by user:        f7                                                       [2m                [0m
[2;36m                    [0m           Container overflow:      fc                                                       [2m                [0m
[2;36m                    [0m           Array cookie:            ac                                                       [2m                [0m
[2;36m                    [0m           Intra object redzone:    bb                                                       [2m                [0m
[2;36m                    [0m           ASan internal:           fe                                                       [2m                [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                       [2m                [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                       [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                      [2m                [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                               [2m                [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64 [2m                [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                    [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpi8kbb5d5[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce     [2m                [0m
[2;36m                    [0m         fuzz -[33mruns[0m=[1;36m100[0m.                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/10/26 06:50:58][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=954229;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=579736;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 06:55:01][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=653163;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=228205;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 06:55:36][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=338536;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=961738;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=573133;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=585721;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 06:55:37][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.87[0m seconds;              ]8;id=640482;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=206747;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Started[33m...[0m                            ]8;id=452996;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=696366;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpky3uofyi[0m                                                 ]8;id=832600;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=411837;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/10/26 06:55:44][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Took [1;36m6.84[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=611323;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=341625;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Started[33m...[0m                      ]8;id=768980;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=860621;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 06:55:48][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Took [1;36m4.31[0m seconds;             ]8;id=212331;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=145230;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Started[33m...[0m                         ]8;id=346101;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=644158;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 06:55:51][0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=339227;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=772087;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py#102\[2m102[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m568223494[0m                                                                [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x556791b63708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x556791b64aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x556791b64aa8[0m[39m,[0m[1;36m0x556791b78448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x556791ae9c02[0m[39m bp [0m[1;36m0x7ffeb41021e0[0m[39m sp [0m[1;36m0x7ffeb41021d8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x556791ae9c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x556791ad1d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x556791ae68b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x556791952350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55679193d5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55679194305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55679196e302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f3eb4124082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x5567919357ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x556791a5e11f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x556791ae679d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x556791952350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55679193d5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55679194305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55679196e302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f3eb4124082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp44_tllbw[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=575822;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=313358;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py#103\[2m103[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m568223494[0m                                                                [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x556791b63708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x556791b64aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x556791b64aa8[0m[39m,[0m[1;36m0x556791b78448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x556791ae9c02[0m[39m bp [0m[1;36m0x7ffeb41021e0[0m[39m sp [0m[1;36m0x7ffeb41021d8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x556791ae9c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x556791ad1d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x556791ae68b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x556791952350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55679193d5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55679194305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55679196e302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f3eb4124082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x5567919357ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x556791a5e11f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x556791ae679d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x556791952350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55679193d5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55679194305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55679196e302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f3eb4124082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp44_tllbw[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [31m╭─[0m[31m──────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m───────────────────────[0m[31m─╮[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/evaluator/services/default/[0m[1m__init__.py[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m :97 in _evaluate_internal                                                        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 94 [0m[2m│   │   [0m[94mwith[0m logging_performance(context, header=[33m"[0m[33mRunning PoV[0m[33m"[0m):           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 95 [0m[2m│   │   │   [0m[94mtry[0m:                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 96 [0m[2m│   │   │   │   [0m[94mif[0m [96mlen[0m(detection.blobs) > [94m0[0m:                               [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 97 [2m│   │   │   │   │   [0menvironment.run_pov(context, detection)                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 98 [0m[2m│   │   │   │   [0m[94melse[0m:                                                      [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 99 [0m[2m│   │   │   │   │   [0mcontext[[33m"[0m[33mlogger[0m[33m"[0m].warning([33m"[0m[33mNo blob data found for the [0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m100 [0m                                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mcached.p[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1my[0m:56 in run_pov                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 53 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, detection: Detection            [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 54 [0m[2m│   [0m) -> [96mtuple[0m[[96mstr[0m, [96mstr[0m]:                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 55 [0m[2m│   │   [0m[94massert[0m [96mlen[0m(detection.blobs) > [94m0[0m, [33m"[0m[33mAt least one blob is required[0m[33m"[0m   [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 56 [2m│   │   [0m[94mreturn[0m [1;4;96mself[0m[1;4m.environment.run_pov(context, detection)[0m                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 57 [0m[2m│   [0m                                                                       [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 58 [0m[2m│   [0m[94mdef[0m[90m [0m[92mrun_tests[0m(                                                         [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 59 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, env: [96mdict[0m[[96mstr[0m, [96mstr[0m] = {}        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mdefault.[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1mpy[0m:210 in run_pov                                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m207 [0m[2m│   │   │   │   [0mcontext, blobinfo.blob, blobinfo.harness_name              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m208 [0m[2m│   │   │   [0m)                                                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m209 [0m[2m│   │   │   [0m[94mif[0m [95mnot[0m success:                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m210 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m ChallengePoVFoundError([0m                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m211 [0m[2m│   │   │   │   │   [0m[1;4mstdout=stdout.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m212 [0m[2m│   │   │   │   │   [0m[1;4mstderr=stderr.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m213 [0m[2m│   │   │   │   [0m[1;4m)[0m                                                          [31m│[0m [2m               [0m
[2;36m                    [0m         [31m╰──────────────────────────────────────────────────────────────────────────────────╯[0m [2m               [0m
[2;36m                    [0m         [1;91mChallengePoVFoundError: [0mPoV found:                                                   [2m               [0m
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m568223494[0m                                                                [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x556791b63708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x556791b64aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x556791b64aa8[0m[39m,[0m[1;36m0x556791b78448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x556791ae9c02[0m[39m bp [0m[1;36m0x7ffeb41021e0[0m[39m sp [0m[1;36m0x7ffeb41021d8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x556791ae9c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x556791ad1d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x556791ae68b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x556791952350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55679193d5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55679194305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55679196e302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f3eb4124082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x5567919357ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x556791a5e11f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x556791ae679d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x556791952350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55679193d5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55679194305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55679196e302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f3eb4124082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp44_tllbw[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Took [1;36m2.44[0m seconds;                ]8;id=213917;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=638046;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=257145;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=741;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 06:55:52][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.86[0m seconds;              ]8;id=502234;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=909464;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=533863;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=643120;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 06:55:53][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.97[0m seconds;              ]8;id=735625;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=876626;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=134564;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=294878;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         +++ b/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-888[0m,[1;36m10[0m +[1;36m888[0m,[1;36m13[0m @@                                                               [2m                [0m
[2;36m                    [0m              [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m              if [1m([0mpkt.raw.len [1m<[0m[39m [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m    [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m       [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle IPv4 [0m [2m                [0m
[2;36m                    [0m         [39moptions[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m-    else[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m                                 [0m[35m/[0m[35m/[0m[39m Handle IPv4 [0m [2m                [0m
[2;36m                    [0m         [39moptions[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+        size_t ip_hdr_len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hdr_len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m     [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + ip_hdr_len[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m568223494[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x556791b63708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x556791b64aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x556791b64aa8[0m[39m,[0m[1;36m0x556791b78448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x556791ae9c02[0m[39m bp [0m[1;36m0x7ffeb41021e0[0m[39m sp [0m[1;36m0x7ffeb41021d8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x556791ae9c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x556791ad1d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x556791ae68b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x556791952350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55679193d5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55679194305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55679196e302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f3eb4124082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x5567919357ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x556791a5e11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x556791ae679d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x556791952350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55679193d5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55679194305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55679196e302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f3eb4124082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp44_tllbw[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m258835080[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x561ff01a2708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x561ff01a3aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x561ff01a3aa8[0m[39m,[0m[1;36m0x561ff01b7448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x561ff0128c02[0m[39m bp [0m[1;36m0x7ffc33939220[0m[39m sp [0m[1;36m0x7ffc33939218[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561ff0128c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561ff0110d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561ff01258b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561feff91350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561feff7c5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561feff8205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561feffad302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fec5899b082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561feff747ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561ff009d11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561ff012579d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561feff91350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561feff7c5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561feff8205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561feffad302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fec5899b082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpi8kbb5d5[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA heap-buffer-overflow vulnerability has been detected in the Mongoose network [0m     [2m                [0m
[2;36m                    [0m         [39mlibrary during fuzzing. The issue occurs in the `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` function when [0m          [2m                [0m
[2;36m                    [0m         [39mprocessing ICMP packets, where a [0m[1;36m1[0m[39m-byte read operation attempts to access memory [0m   [2m                [0m
[2;36m                    [0m         [39mbeyond the bounds of a [0m[1;36m34[0m[39m-byte allocated buffer. AddressSanitizer has flagged this [0m [2m                [0m
[2;36m                    [0m         [39mas a READ operation at an address exactly at the boundary of the allocated region.[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fuzzing test has identified a heap-buffer-overflow error occurring in the [0m      [2m                [0m
[2;36m                    [0m         [39mnetwork packet processing code of the Mongoose library. Specifically:[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Vulnerability Type**: Heap-buffer-overflow - a [0m[1;36m1[0m[39m-byte READ operation beyond [0m      [2m                [0m
[2;36m                    [0m         [39mallocated memory boundaries.[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location of the Issue**:[0m                                                          [2m                [0m
[2;36m                    [0m         [39m- Primary location: `[0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m` in the `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` [0m    [2m                [0m
[2;36m                    [0m         [39mfunction[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- The overflow occurs when attempting to read from address `[0m[1;36m0x504000000172[0m[39m`[0m         [2m                [0m
[2;36m                    [0m         [39m- This address is located [0m[1;36m0[0m[39m bytes after a [0m[1;36m34[0m[39m-byte region allocated at [0m              [2m                [0m
[2;36m                    [0m         [39m`[0m[1;39m[[0m[1;36m0x504000000150[0m[39m, [0m[1;36m0x504000000172[0m[1;39m)[0m[39m`[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Call Stack Analysis**:[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The fuzzer entry point `LLVMFuzzerTestOneInput` in [0m                              [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m[39m` initiates the test[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. The input is processed by `mg_tcpip_rx` function in [0m                             [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m[39m`[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. The vulnerability is triggered in `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` function during ICMP packet [0m       [2m                [0m
[2;36m                    [0m         [39mprocessing[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Memory Allocation Details**:[0m                                                      [2m                [0m
[2;36m                    [0m         [39m- A [0m[1;36m34[0m[39m-byte buffer was allocated via `malloc` in the fuzzer test input handler [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`[0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m[39m`[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [39m- The overflow attempts to read exactly [0m[1;36m1[0m[39m byte beyond this allocated region[0m         [2m                [0m
[2;36m                    [0m         [39m- The shadow byte analysis shows the memory layout with the problematic access [0m     [2m                [0m
[2;36m                    [0m         [39mmarked as `[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39m` [0m[1;39m([0m[39mpartially addressable[0m[1;39m)[0m[39m at the boundary[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Severity**: The issue has a SCARINESS score of [0m[1;36m12[0m[39m, classified as a [0m               [2m                [0m
[2;36m                    [0m         [32m"1-byte-read-heap-buffer-overflow"[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Areas Requiring Investigation**:[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Primary Investigation Area**: `[0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m`[0m                [2m                [0m
[2;36m                    [0m         [39m   - The `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` function at line [0m[1;36m385[0m[39m needs examination to understand what read[0m [2m                [0m
[2;36m                    [0m         [39moperation is being performed[0m                                                        [2m                [0m
[2;36m                    [0m         [39m   - The `mg_tcpip_rx` function at line [0m[1;36m897[0m[39m that calls `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` should be [0m       [2m                [0m
[2;36m                    [0m         [39mreviewed for packet validation logic[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Packet Structure Handling**:[0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - The `pkt*` structure being passed to `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` may lack proper bounds [0m       [2m                [0m
[2;36m                    [0m         [39mchecking[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   - Investigation needed into how packet lengths are validated before processing[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Buffer Management**:[0m                                                           [2m                [0m
[2;36m                    [0m         [39m   - Review how the [0m[1;36m34[0m[39m-byte buffer is used in relation to ICMP packet parsing[0m       [2m                [0m
[2;36m                    [0m         [39m   - Examine if there are assumptions about minimum packet sizes that are violated[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Fuzzer Harness** [0m[1;39m([0m[39mfor context, not root cause[0m[1;39m)[0m[39m:[0m                                [2m                [0m
[2;36m                    [0m         [39m   - `[0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m` lines [0m[1;36m95[0m[39m and [0m[1;36m106[0m[39m show the test setup[0m               [2m                [0m
[2;36m                    [0m         [39m   - Understanding the harness can help reproduce the exact conditions that trigger[0m [2m                [0m
[2;36m                    [0m         [39mthe overflow[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe error suggests that the ICMP packet processing code may be reading packet data [0m [2m                [0m
[2;36m                    [0m         [39mwithout properly validating that sufficient bytes remain in the buffer, leading to [0m [2m                [0m
[2;36m                    [0m         [39man out-of-bounds read when processing malformed or truncated ICMP packets.[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m258835080[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x561ff01a2708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x561ff01a3aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x561ff01a3aa8[0m[39m,[0m[1;36m0x561ff01b7448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x561ff0128c02[0m[39m bp [0m[1;36m0x7ffc33939220[0m[39m sp [0m[1;36m0x7ffc33939218[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561ff0128c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561ff0110d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561ff01258b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561feff91350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561feff7c5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561feff8205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561feffad302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fec5899b082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561feff747ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561ff009d11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561ff012579d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561feff91350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561feff7c5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561feff8205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561feffad302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fec5899b082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpi8kbb5d5[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtest/fuzz.[0m[1;92mc:90[0m[39m-[0m[1;36m110[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    struct mg_mgr mgr;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    [0m[1;35mmg_mgr_init[0m[1;39m([0m[39m&mgr[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    [0m[1;35mmg_tcpip_init[0m[1;39m([0m[39m&mgr, &mif[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[35m/[0m[35m/[0m[39m Make a copy of the random data, in order to modify it[0m                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    void *pkt = [0m[1;35mmalloc[0m[1;39m([0m[39msize[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    struct eth *eth = [0m[1;39m([0m[39mstruct eth *[0m[1;39m)[0m[39m pkt;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39mpkt, data, size[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    if [0m[1;39m([0m[39msize > [0m[1;35msizeof[0m[1;39m([0m[39m*eth[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:      static size_t i;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:      uint16_t eth_types[0m[1;39m[[0m[1;39m][0m[39m = [0m[1;39m{[0m[1;36m0x800[0m[39m, [0m[1;36m0x800[0m[39m, [0m[1;36m0x806[0m[39m, [0m[1;36m0x86dd[0m[1;39m}[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39meth->dst, mif.mac, [0m[1;36m6[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Set valid destination MAC[0m               [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:      eth->type = [0m[1;35mmg_htons[0m[1;39m([0m[39meth_types[0m[1;39m[[0m[39mi++[0m[1;39m][0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:      if [0m[1;39m([0m[39mi >= [0m[1;35msizeof[0m[1;39m([0m[39meth_types[0m[1;39m)[0m[39m [0m[35m/[0m[39m [0m[1;35msizeof[0m[1;39m([0m[39meth_types[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[1;39m)[0m[39m i = [0m[1;36m0[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:    [0m[1;35mmg_tcpip_rx[0m[1;39m([0m[39m&mif, pkt, size[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    [0m[35m/[0m[35m/[0m[39m Test HTTP serving[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    const char *url = [0m[32m"http://localhost:12345"[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    struct mg_connection *c = [0m[1;35mmg_http_connect[0m[1;39m([0m[39m&mgr, url, fn, NULL[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:72[0m[39m-[0m[1;36m76[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:struct icmp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  uint8_t type;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint8_t code;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  uint16_t csum;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:129[0m[39m-[0m[1;36m141[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:struct pkt [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:  struct mg_str raw;  [0m[35m/[0m[35m/[0m[39m Raw packet data[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:  struct mg_str pay;  [0m[35m/[0m[35m/[0m[39m Payload data[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:  struct eth *eth;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:  struct llc *llc;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:  struct arp *arp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:  struct ip *ip;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:  struct ip6 *ip6;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:  struct icmp *icmp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:  struct tcp *tcp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:  struct udp *udp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:  struct dhcp *dhcp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:147[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:static void [0m[1;35msend_syn[0m[1;39m([0m[39mstruct mg_connection *c[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:838[0m[39m-[0m[1;36m852[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m838[0m[39m:static void [0m[1;35mrx_ip6[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m839[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"IP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m840[0m[39m:  if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m1[0m[39m || pkt->ip6->proto == [0m[1;36m58[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m841[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m842[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m843[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m844[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m845[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m846[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m847[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m848[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"  UDP %u %u -> %u"[0m[39m, len, [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->sport[0m[1;39m)[0m[39m,[0m                [2m                [0m
[2;36m                    [0m         [1;36m849[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->dport[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m850[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m851[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m852[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:854[0m[39m-[0m[1;36m901[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m854[0m[39m:void [0m[1;35mmg_tcpip_rx[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, void *buf, size_t len[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m855[0m[39m:  struct pkt pkt;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m856[0m[39m:  [0m[1;35mmemset[0m[1;39m([0m[39m&pkt, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mpkt[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m857[0m[39m:  pkt.raw.buf = [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m buf;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m858[0m[39m:  pkt.raw.len = len;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m859[0m[39m:  pkt.eth = [0m[1;39m([0m[39mstruct eth *[0m[1;39m)[0m[39m buf;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m860[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_hexdump[0m[1;39m([0m[39mbuf, len > [0m[1;36m16[0m[39m ? [0m[1;36m16[0m[39m: len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m861[0m[39m:  if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated - runt?[0m             [2m                [0m
[2;36m                    [0m         [1;36m862[0m[39m:  if [0m[1;39m([0m[39mifp->enable_mac_check &&[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m863[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, ifp->mac, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[39m &&[0m              [2m                [0m
[2;36m                    [0m         [1;36m864[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, broadcast, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m865[0m[39m:    return;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m866[0m[39m:  if [0m[1;39m([0m[39mifp->enable_crc32_check && len > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m867[0m[39m:    len -= [0m[1;36m4[0m[39m;  [0m[35m/[0m[35m/[0m[39m [0m[1;35mTODO[0m[1;39m([0m[39mscaprile[0m[1;39m)[0m[39m: check on bigendian[0m                            [2m                [0m
[2;36m                    [0m         [1;36m868[0m[39m:    uint32_t crc = [0m[1;35mmg_crc32[0m[1;39m([0m[1;36m0[0m[39m, [0m[1;39m([0m[39mconst char *[0m[1;39m)[0m[39m buf, len[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m869[0m[39m:    if [0m[1;39m([0m[1;35mmemcmp[0m[1;39m([0m[1;39m([0m[39mvoid *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m buf + len[0m[1;39m)[0m[39m, &crc, [0m[1;35msizeof[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m return;[0m       [2m                [0m
[2;36m                    [0m         [1;36m870[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m871[0m[39m:  if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x806[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m872[0m[39m:    pkt.arp = [0m[1;39m([0m[39mstruct arp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m873[0m[39m:    if [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.arp[0m[1;39m)[0m[39m > pkt.raw.len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m874[0m[39m:    [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mifp, MG_TCPIP_EV_ARP, &pkt.raw[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m875[0m[39m:    [0m[1;35mrx_arp[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m876[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x86dd[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m877[0m[39m:    pkt.ip6 = [0m[1;39m([0m[39mstruct ip6 *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m878[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip6[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m879[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip6->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m0x6[0m[1;39m)[0m[39m return;                         [0m[35m/[0m[35m/[0m[39m Not IP[0m   [2m                [0m
[2;36m                    [0m         [1;36m880[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m881[0m[39m:    [0m[1;35mrx_ip6[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m897[0m[39m:  [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m898[0m[39m:    [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"Unknown eth type %x"[0m[39m, [0m[1;35mmg_htons[0m[1;39m([0m[39mpkt.eth->type[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m899[0m[39m:    if [0m[1;39m([0m[39mmg_log_level >= MG_LL_VERBOSE[0m[1;39m)[0m[39m [0m[1;35mmg_hexdump[0m[1;39m([0m[39mbuf, len >= [0m[1;36m32[0m[39m ? [0m[1;36m32[0m[39m : len[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m900[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m901[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:891[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:806[0m[39m-[0m[1;36m823[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:824[0m[39m-[0m[1;36m835[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m800[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:806[0m[39m-[0m[1;36m809[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:824[0m[39m-[0m[1;36m827[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:891[0m[39m-[0m[1;36m894[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:72[0m[39m-[0m[1;36m76[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:struct icmp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  uint8_t type;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint8_t code;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  uint16_t csum;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Root Cause Analysis[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe heap-buffer-overflow vulnerability occurs in the `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` function when [0m     [2m                [0m
[2;36m                    [0m         [39mprocessing malformed IPv4 packets with incorrect Internet Header Length [0m[1;39m([0m[39mIHL[0m[1;39m)[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mvalues. The core issue is in the `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m` function at lines [0m[1;36m891[0m[39m-[0m[1;36m894[0m[39m of [0m      [2m                [0m
[2;36m                    [0m         [39m`src/net_builtin.c`.[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Vulnerability Sequence:**[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. A malicious [0m[1;36m34[0m[39m-byte packet arrives with IPv4 IHL field set to > [0m[1;36m5[0m[39m [0m[1;39m([0m[39mclaiming the [0m [2m                [0m
[2;36m                    [0m         [39mheader has options[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. The actual packet contains only: Ethernet header [0m[1;39m([0m[1;36m14[0m[39m bytes[0m[1;39m)[0m[39m + IP header [0m[1;39m([0m[1;36m20[0m[39m [0m     [2m                [0m
[2;36m                    [0m         [39mbytes[0m[1;39m)[0m[39m = [0m[1;36m34[0m[39m bytes total[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. At line [0m[1;36m891[0m[39m, code checks if IHL > [0m[1;36m5[0m[39m and proceeds to line [0m[1;36m892[0m                     [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. At line [0m[1;36m892[0m[39m, `[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m` is called with payload start calculated as: `[0m[1;39m([0m[39mchar [0m       [2m                [0m
[2;36m                    [0m         [39m*[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[39m`[0m                                               [2m                [0m
[2;36m                    [0m         [39m   - For [0m[33mIHL[0m[39m=[0m[1;36m6[0m[39m: byte [0m[1;36m14[0m[39m + [0m[1;36m24[0m[39m = [0m[1;36m38[0m[39m [0m[1;39m([0m[1;36m4[0m[39m bytes beyond the [0m[1;36m34[0m[39m-byte buffer![0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. In `[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m` function [0m[1;39m([0m[39mline [0m[1;36m151[0m[1;39m)[0m[39m, pointer arithmetic produces: `[0m[1;36m34[0m[39m - [0m[1;36m38[0m[39m = [0m[1;36m-4[0m[39m`[0m    [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. This negative value is cast to `size_t` [0m[1;39m([0m[39munsigned[0m[1;39m)[0m[39m, causing integer wraparound [0m  [2m                [0m
[2;36m                    [0m         [39mto [0m[1;36m0xFFFFFFFC[0m[39m [0m[1;39m([0m[39mhuge value[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. The corrupted `pkt->pay.len` bypasses validation checks in `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m803[0m [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m. When `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` accesses `pkt->icmp->type` at line [0m[1;36m384[0m[39m, it reads beyond the [0m    [2m                [0m
[2;36m                    [0m         [39mallocated buffer[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Core Problem:** The code calculates payload start based on IHL field without [0m     [2m                [0m
[2;36m                    [0m         [39mvalidating that the buffer actually contains the claimed IP header length, allowing[0m [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m` to perform invalid pointer arithmetic that results in integer underflow.[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Primary Fix: Validate IPv4 Header Length in `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m`[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** `src/net_builtin.c` lines [0m[1;36m891[0m[39m-[0m[1;36m894[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Current Code:**[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle IPv4 [0m      [2m                [0m
[2;36m                    [0m         [39moptions[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39melse[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Fix Implementation:**[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Extract the IP header length calculation into a variable for clarity[0m             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Add bounds checking to ensure the buffer contains the full IP header including [0m  [2m                [0m
[2;36m                    [0m         [39moptions[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Only call `[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m` if validation passes[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Use early return pattern to reject truncated packets[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Modified Code:**[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m                                 [0m[35m/[0m[35m/[0m[39m Handle IPv4 [0m      [2m                [0m
[2;36m                    [0m         [39moptions[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m    size_t ip_hdr_len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hdr_len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m          [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + ip_hdr_len[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;39m}[0m[39m else [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes:**[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m- Calculate `ip_hdr_len` as `[0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m` to get actual header size in [0m [2m                [0m
[2;36m                    [0m         [39mbytes[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m- Add validation: `if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hdr_len[0m[1;39m)[0m[39m return;`[0m        [2m                [0m
[2;36m                    [0m         [39m- This ensures the buffer contains at minimum: Ethernet header + complete IP header[0m [2m                [0m
[2;36m                    [0m         [39m- Prevents calling `[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m` with a pointer beyond the buffer end[0m                   [2m                [0m
[2;36m                    [0m         [39m- Add braces for clarity and maintainability[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This Fix is Optimal[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Addresses Root Cause:** Prevents the integer underflow in `[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m` by [0m        [2m                [0m
[2;36m                    [0m         [39mensuring the pointer passed is always within buffer bounds[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Consistent with Existing Logic:** Mirrors the validation pattern already [0m      [2m                [0m
[2;36m                    [0m         [39mpresent at lines [0m[1;36m884[0m[39m and [0m[1;36m889[0m[39m that check for minimum IP header size[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Minimal Code Changes:** Single validation check added at the precise location [0m [2m                [0m
[2;36m                    [0m         [39mwhere the vulnerability occurs[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Preserves Existing Functionality:**[0m                                            [2m                [0m
[2;36m                    [0m         [39m   - Maintains support for IPv4 options [0m[1;39m([0m[39mRFC [0m[1;36m791[0m[39m compliant[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [39m   - Does not affect normal packet processing paths[0m                                 [2m                [0m
[2;36m                    [0m         [39m   - Protocol handlers in `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m` continue to work correctly with valid [0m          [2m                [0m
[2;36m                    [0m         [39m`pkt->pay.len`[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Defense in Depth:** Once `pkt->pay.len` is correctly calculated, all [0m          [2m                [0m
[2;36m                    [0m         [39mdownstream validation checks in protocol handlers [0m[1;39m([0m[39mlines [0m[1;36m803[0m[39m, [0m[1;36m808[0m[39m, [0m[1;36m826[0m[1;39m)[0m[39m function as[0m [2m                [0m
[2;36m                    [0m         [39mintended[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **No Breaking Changes:**[0m                                                         [2m                [0m
[2;36m                    [0m         [39m   - Does not modify API signatures[0m                                                 [2m                [0m
[2;36m                    [0m         [39m   - Does not alter structure definitions[0m                                           [2m                [0m
[2;36m                    [0m         [39m   - Does not affect test code or fuzzing harness[0m                                   [2m                [0m
[2;36m                    [0m         [39m   - Simply rejects malformed packets earlier in the processing pipeline[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Impact on Downstream Code[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter this fix:[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m- `[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m` will always receive valid pointers, preventing integer underflow[0m        [2m                [0m
[2;36m                    [0m         [39m- `pkt->pay.len` will accurately represent remaining buffer size[0m                    [2m                [0m
[2;36m                    [0m         [39m- Validation checks in `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m` for ICMP [0m[1;39m([0m[1;36m803[0m[1;39m)[0m[39m, UDP [0m[1;39m([0m[1;36m808[0m[1;39m)[0m[39m, and TCP [0m[1;39m([0m[1;36m826[0m[1;39m)[0m[39m will [0m     [2m                [0m
[2;36m                    [0m         [39mcorrectly reject packets with insufficient data[0m                                     [2m                [0m
[2;36m                    [0m         [39m- `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m`, `[0m[1;35mrx_udp[0m[1;39m([0m[1;39m)[0m[39m`, and `[0m[1;35mrx_tcp[0m[1;39m([0m[1;39m)[0m[39m` will only process packets with valid [0m     [2m                [0m
[2;36m                    [0m         [39mprotocol headers[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Side Effects and Mitigation[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential Side Effect:** Legitimate packets with IPv4 options that are truncated [0m [2m                [0m
[2;36m                    [0m         [39mwill be dropped[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Mitigation:** This is correct behavior per RFC [0m[1;36m791[0m[39m - truncated packets should be [0m [2m                [0m
[2;36m                    [0m         [39msilently discarded. The fix ensures compliance with the specification.[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**No Impact On:**[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- IPv4 packets without options [0m[1;39m([0m[39mIHL = [0m[1;36m5[0m[1;39m)[0m[39m - unchanged code path at line [0m[1;36m894[0m          [2m                [0m
[2;36m                    [0m         [39m- IPv6 packets - handled separately in `[0m[1;35mrx_ip6[0m[1;39m([0m[1;39m)[0m[39m` function[0m                          [2m                [0m
[2;36m                    [0m         [39m- ARP packets - handled separately[0m                                                  [2m                [0m
[2;36m                    [0m         [39m- Normal packet processing with valid sizes[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Similar Patterns in Codebase[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis fix follows the existing validation pattern seen at:[0m                           [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m861[0m[39m: `if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[1;39m)[0m[39m return;`[0m                           [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m873[0m[39m: `if [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.arp[0m[1;39m)[0m[39m > pkt.raw.len[0m[1;39m)[0m[39m return;`[0m        [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m878[0m[39m: `if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip6[0m[1;39m)[0m[1;39m)[0m[39m return;`[0m        [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m884[0m[39m: `if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;`[0m         [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m889[0m[39m: `if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;`[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe proposed fix maintains consistency with this established pattern.[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Implementation Steps[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Locate `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m` function in `src/net_builtin.c`[0m                           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Find the IPv4 packet handling section starting at line [0m[1;36m882[0m                       [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Identify the IPv4 options handling at lines [0m[1;36m891[0m[39m-[0m[1;36m894[0m                              [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Replace the single-line conditional with the multi-line block including [0m         [2m                [0m
[2;36m                    [0m         [39mvalidation[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Ensure proper formatting and indentation matches surrounding code[0m                [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. The fix should be applied between line [0m[1;36m890[0m[39m [0m[1;39m([0m[39mIP version check[0m[1;39m)[0m[39m and the current [0m   [2m                [0m
[2;36m                    [0m         [39mline [0m[1;36m892[0m[39m [0m[1;39m([0m[39mmkpay call[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Testing Validation[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter applying this fix:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m- The [0m[1;36m34[0m[39m-byte attack packet with IHL > [0m[1;36m5[0m[39m will be rejected at the new validation [0m    [2m                [0m
[2;36m                    [0m         [39mcheck[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m- AddressSanitizer should no longer detect heap-buffer-overflow[0m                     [2m                [0m
[2;36m                    [0m         [39m- Fuzzing should not trigger the vulnerability[0m                                      [2m                [0m
[2;36m                    [0m         [39m- Normal ICMP echo requests/replies with valid headers will continue to work[0m        [2m                [0m
[2;36m                    [0m         [39m- Packets with legitimate IPv4 options will be processed correctly if they contain [0m [2m                [0m
[2;36m                    [0m         [39msufficient data[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/10/26 06:56:16][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=106213;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=178761;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 06:59:38][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=918154;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=723447;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 07:00:37][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=559168;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=678553;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=196357;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=881034;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 07:00:38][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.99[0m seconds;              ]8;id=320314;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=155401;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Started[33m...[0m                            ]8;id=595104;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=791364;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp5dp7ph9n[0m                                                 ]8;id=598747;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=510479;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/10/26 07:00:45][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Took [1;36m6.85[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=639441;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=646256;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Started[33m...[0m                      ]8;id=531130;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=544878;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 07:00:49][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Took [1;36m4.34[0m seconds;             ]8;id=941903;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=583458;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Started[33m...[0m                         ]8;id=851457;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=391120;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 07:00:52][0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=59421;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=967089;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py#102\[2m102[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m869259888[0m                                                                [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55679e6c7708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x55679e6c8aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55679e6c8aa8[0m[39m,[0m[1;36m0x55679e6dc448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x55679e64dc02[0m[39m bp [0m[1;36m0x7ffc8ca0bbc0[0m[39m sp [0m[1;36m0x7ffc8ca0bbb8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55679e64dc01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55679e635d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55679e64a8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55679e4b6350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55679e4a15c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55679e4a705f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55679e4d2302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f2cdb2bd082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55679e4997ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55679e5c211f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55679e64a79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55679e4b6350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55679e4a15c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55679e4a705f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55679e4d2302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f2cdb2bd082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp2yrbdd7r[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=304906;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=914505;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py#103\[2m103[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m869259888[0m                                                                [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55679e6c7708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x55679e6c8aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55679e6c8aa8[0m[39m,[0m[1;36m0x55679e6dc448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x55679e64dc02[0m[39m bp [0m[1;36m0x7ffc8ca0bbc0[0m[39m sp [0m[1;36m0x7ffc8ca0bbb8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55679e64dc01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55679e635d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55679e64a8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55679e4b6350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55679e4a15c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55679e4a705f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55679e4d2302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f2cdb2bd082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55679e4997ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55679e5c211f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55679e64a79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55679e4b6350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55679e4a15c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55679e4a705f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55679e4d2302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f2cdb2bd082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp2yrbdd7r[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [31m╭─[0m[31m──────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m───────────────────────[0m[31m─╮[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/evaluator/services/default/[0m[1m__init__.py[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m :97 in _evaluate_internal                                                        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 94 [0m[2m│   │   [0m[94mwith[0m logging_performance(context, header=[33m"[0m[33mRunning PoV[0m[33m"[0m):           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 95 [0m[2m│   │   │   [0m[94mtry[0m:                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 96 [0m[2m│   │   │   │   [0m[94mif[0m [96mlen[0m(detection.blobs) > [94m0[0m:                               [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 97 [2m│   │   │   │   │   [0menvironment.run_pov(context, detection)                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 98 [0m[2m│   │   │   │   [0m[94melse[0m:                                                      [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 99 [0m[2m│   │   │   │   │   [0mcontext[[33m"[0m[33mlogger[0m[33m"[0m].warning([33m"[0m[33mNo blob data found for the [0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m100 [0m                                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mcached.p[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1my[0m:56 in run_pov                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 53 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, detection: Detection            [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 54 [0m[2m│   [0m) -> [96mtuple[0m[[96mstr[0m, [96mstr[0m]:                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 55 [0m[2m│   │   [0m[94massert[0m [96mlen[0m(detection.blobs) > [94m0[0m, [33m"[0m[33mAt least one blob is required[0m[33m"[0m   [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 56 [2m│   │   [0m[94mreturn[0m [1;4;96mself[0m[1;4m.environment.run_pov(context, detection)[0m                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 57 [0m[2m│   [0m                                                                       [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 58 [0m[2m│   [0m[94mdef[0m[90m [0m[92mrun_tests[0m(                                                         [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 59 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, env: [96mdict[0m[[96mstr[0m, [96mstr[0m] = {}        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mdefault.[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1mpy[0m:210 in run_pov                                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m207 [0m[2m│   │   │   │   [0mcontext, blobinfo.blob, blobinfo.harness_name              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m208 [0m[2m│   │   │   [0m)                                                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m209 [0m[2m│   │   │   [0m[94mif[0m [95mnot[0m success:                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m210 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m ChallengePoVFoundError([0m                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m211 [0m[2m│   │   │   │   │   [0m[1;4mstdout=stdout.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m212 [0m[2m│   │   │   │   │   [0m[1;4mstderr=stderr.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m213 [0m[2m│   │   │   │   [0m[1;4m)[0m                                                          [31m│[0m [2m               [0m
[2;36m                    [0m         [31m╰──────────────────────────────────────────────────────────────────────────────────╯[0m [2m               [0m
[2;36m                    [0m         [1;91mChallengePoVFoundError: [0mPoV found:                                                   [2m               [0m
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m869259888[0m                                                                [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55679e6c7708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x55679e6c8aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55679e6c8aa8[0m[39m,[0m[1;36m0x55679e6dc448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x55679e64dc02[0m[39m bp [0m[1;36m0x7ffc8ca0bbc0[0m[39m sp [0m[1;36m0x7ffc8ca0bbb8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55679e64dc01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55679e635d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55679e64a8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55679e4b6350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55679e4a15c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55679e4a705f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55679e4d2302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f2cdb2bd082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55679e4997ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55679e5c211f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55679e64a79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55679e4b6350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55679e4a15c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55679e4a705f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55679e4d2302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f2cdb2bd082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp2yrbdd7r[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Took [1;36m2.30[0m seconds;                ]8;id=253008;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=540139;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=819607;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=468265;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 07:00:53][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.85[0m seconds;              ]8;id=956417;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=9775;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=460959;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=274215;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 07:00:54][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.92[0m seconds;              ]8;id=69785;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=445643;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=804461;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=310406;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         +++ b/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-792[0m,[1;36m21[0m +[1;36m792[0m,[1;36m21[0m @@                                                               [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          static void [1;35mrx_ip[0m[1m([0mstruct mg_tcpip_if *ifp, struct pkt *pkt[1m)[0m [1m{[0m                      [2m                [0m
[2;36m                    [0m         +  size_t ip_hlen = [1m([0mpkt->ip->ver & [1;36m0xF[0m[1m)[0m * [1;36m4[0m;                                       [2m                [0m
[2;36m                    [0m         +  if [1m([0mip_hlen [1m<[0m[39m [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m IHL must be at least [0m[1;36m5[0m[39m [0m[1;39m([0m[1;36m20[0m[39m bytes[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m   uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + [0m        [2m                [0m
[2;36m                    [0m         [39mip_hlen[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + [0m         [2m                [0m
[2;36m                    [0m         [39mip_hlen[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m     struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m-    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [39m+    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m-    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [39m-    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m+    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m-    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m        [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m            [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-822[0m[39m,[0m[1;36m11[0m[39m +[0m[1;36m822[0m[39m,[0m[1;36m10[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m-    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m+    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m-    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m-    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [39m+    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip_hlen + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m        [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m            [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-888[0m[39m,[0m[1;36m10[0m[39m +[0m[1;36m887[0m[39m,[0m[1;36m14[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m    [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m       [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle IPv4 [0m [2m                [0m
[2;36m                    [0m         [39moptions[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m-    else[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m                                 [0m[35m/[0m[35m/[0m[39m Handle IPv4 [0m [2m                [0m
[2;36m                    [0m         [39moptions[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+        size_t ip_hdr_len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[39mip_hdr_len > [0m[1;36m60[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Maximum IP header length is [0m[1;36m60[0m[39m bytes[0m      [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hdr_len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m     [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + ip_hdr_len[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m869259888[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55679e6c7708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55679e6c8aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55679e6c8aa8[0m[39m,[0m[1;36m0x55679e6dc448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55679e64dc02[0m[39m bp [0m[1;36m0x7ffc8ca0bbc0[0m[39m sp [0m[1;36m0x7ffc8ca0bbb8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55679e64dc01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55679e635d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55679e64a8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55679e4b6350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55679e4a15c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55679e4a705f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55679e4d2302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f2cdb2bd082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55679e4997ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55679e5c211f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55679e64a79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55679e4b6350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55679e4a15c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55679e4a705f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55679e4d2302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f2cdb2bd082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp2yrbdd7r[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m258835080[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x561ff01a2708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x561ff01a3aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x561ff01a3aa8[0m[39m,[0m[1;36m0x561ff01b7448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x561ff0128c02[0m[39m bp [0m[1;36m0x7ffc33939220[0m[39m sp [0m[1;36m0x7ffc33939218[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561ff0128c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561ff0110d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561ff01258b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561feff91350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561feff7c5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561feff8205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561feffad302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fec5899b082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561feff747ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561ff009d11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561ff012579d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561feff91350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561feff7c5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561feff8205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561feffad302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fec5899b082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpi8kbb5d5[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m         [39mThe initial issue reports a heap-buffer-overflow vulnerability in the mongoose [0m     [2m                [0m
[2;36m                    [0m         [39mnetwork library, specifically in the `rx_icmp` function at line [0m[1;36m385[0m[39m of [0m             [2m                [0m
[2;36m                    [0m         [39m`src/net_builtin.c`. The error occurs when processing network packets, with [0m        [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer detecting a [0m[1;36m1[0m[39m-byte read beyond the bounds of a [0m[1;36m34[0m[39m-byte [0m            [2m                [0m
[2;36m                    [0m         [39mheap-allocated buffer. A patch was attempted that added validation for IPv4 header [0m [2m                [0m
[2;36m                    [0m         [39mlengths before processing packet payloads. However, after applying the patch, the [0m  [2m                [0m
[2;36m                    [0m         [39msame heap-buffer-overflow error persists at the identical location, indicating that[0m [2m                [0m
[2;36m                    [0m         [39mthe patch did not successfully resolve the underlying issue.[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Initial Issue Analysis[0m                                                          [2m                [0m
[2;36m                    [0m         [39mThe fuzzing test reveals a heap-buffer-overflow error with the following [0m           [2m                [0m
[2;36m                    [0m         [39mcharacteristics:[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m- **Error Type**: READ of size [0m[1;36m1[0m[39m at address [0m[1;36m0x504000000172[0m                          [2m                [0m
[2;36m                    [0m         [39m- **Location**: `rx_icmp` function in `[0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m`[0m      [2m                [0m
[2;36m                    [0m         [39m- **Call Stack**: The error originates from `LLVMFuzzerTestOneInput` → [0m             [2m                [0m
[2;36m                    [0m         [39m`mg_tcpip_rx` → `rx_icmp`[0m                                                           [2m                [0m
[2;36m                    [0m         [39m- **Buffer Details**: The overflow occurs [0m[1;36m0[0m[39m bytes after a [0m[1;36m34[0m[39m-byte region allocated [0m [2m                [0m
[2;36m                    [0m         [39mat addresses [0m[1;39m[[0m[1;36m0x504000000150[0m[39m, [0m[1;36m0x504000000172[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [39m- **Scariness Score**: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe stack trace indicates that the fuzzer allocates a buffer in `fuzz.[0m[1;92mc:95:17[0m[39m`, [0m    [2m                [0m
[2;36m                    [0m         [39mwhich is then processed through the network stack, eventually reaching the [0m         [2m                [0m
[2;36m                    [0m         [39m`rx_icmp` function where the out-of-bounds read occurs.[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Patch Attempt Description[0m                                                       [2m                [0m
[2;36m                    [0m         [39mThe patch attempted to address the issue by modifying the packet processing logic [0m  [2m                [0m
[2;36m                    [0m         [39min `src/net_builtin.c` around lines [0m[1;36m888[0m[39m-[0m[1;36m897[0m[39m. The changes include:[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Added IPv4 header length validation**: When the IP version field indicates [0m    [2m                [0m
[2;36m                    [0m         [39mIPv4 options [0m[1;39m([0m[39mwhen `[0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[39m`[0m[1;39m)[0m[39m, the patch:[0m                           [2m                [0m
[2;36m                    [0m         [39m   - Calculates the IP header length: `size_t ip_hdr_len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m [2m                [0m
[2;36m                    [0m         [1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[1;39m)[0m[39m`[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   - Adds a bounds check: `if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hdr_len[0m[1;39m)[0m[39m [0m        [2m                [0m
[2;36m                    [0m         [39mreturn;`[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   - Updates the payload pointer: `[0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + ip_hdr_len[0m[1;39m)[0m[39m`[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Code restructuring**: The if-else block was reformatted with explicit braces [0m  [2m                [0m
[2;36m                    [0m         [39mfor better clarity.[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe patch logic appears to validate that the raw packet length is sufficient to [0m    [2m                [0m
[2;36m                    [0m         [39mcontain both the Ethernet header and the complete IP header [0m[1;39m([0m[39mincluding options[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mbefore attempting to access the payload.[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Post-Patch Results[0m                                                              [2m                [0m
[2;36m                    [0m         [39mAfter applying the patch, the fuzzing test produces identical results:[0m              [2m                [0m
[2;36m                    [0m         [39m- **Same error location**: `rx_icmp` function at line [0m[1;36m385[0m                           [2m                [0m
[2;36m                    [0m         [39m- **Same buffer address**: [0m[1;36m0x504000000172[0m[39m [0m[1;39m([0m[1;36m0[0m[39m bytes after the same [0m[1;36m34[0m[39m-byte region[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m- **Same call stack**: The execution path remains unchanged[0m                         [2m                [0m
[2;36m                    [0m         [39m- **Same DEDUP_TOKEN**: Indicates the fuzzer recognizes this as the same issue[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis demonstrates that while the patch added validation for the packet length at [0m   [2m                [0m
[2;36m                    [0m         [39mthe IP header processing stage, it does not prevent the buffer overflow that occurs[0m [2m                [0m
[2;36m                    [0m         [39mlater in the `rx_icmp` function.[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas Requiring Further Investigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **The `rx_icmp` function [0m[1;39m([0m[39mline [0m[1;36m385[0m[1;39m)[0m[39m**: This is where the actual overflow occurs.[0m [2m                [0m
[2;36m                    [0m         [39mThe code at this location needs to be examined to understand what specific read [0m    [2m                [0m
[2;36m                    [0m         [39moperation is causing the [0m[1;36m1[0m[39m-byte overflow.[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **The `mkpay` function**: This function is called to set up the payload pointer.[0m [2m                [0m
[2;36m                    [0m         [39mInvestigation is needed to understand how it calculates and sets payload [0m           [2m                [0m
[2;36m                    [0m         [39mboundaries.[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **ICMP packet structure validation**: The `rx_icmp` function likely processes [0m   [2m                [0m
[2;36m                    [0m         [39mICMP headers and payloads. There may be insufficient validation of ICMP packet [0m     [2m                [0m
[2;36m                    [0m         [39mlengths before accessing ICMP-specific fields.[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Packet length tracking**: The relationship between `pkt.raw.len`, the actual [0m  [2m                [0m
[2;36m                    [0m         [39mallocated buffer size, and the various header/payload size calculations needs to be[0m [2m                [0m
[2;36m                    [0m         [39mexamined throughout the packet processing pipeline.[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **The fuzzer test case**: The specific input at `[0m[35m/[0m[95mtestcase[0m[39m` that triggers this [0m  [2m                [0m
[2;36m                    [0m         [39moverflow should be analyzed to understand what malformed packet structure causes [0m   [2m                [0m
[2;36m                    [0m         [39mthe issue [0m[1;39m([0m[1;36m34[0m[39m-byte buffer suggests a minimal/truncated packet[0m[1;39m)[0m[39m.[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Earlier validation points**: The function `mg_tcpip_rx` [0m[1;39m([0m[39mline [0m[1;36m897[0m[1;39m)[0m[39m calls [0m      [2m                [0m
[2;36m                    [0m         [39m`rx_icmp`, and understanding what validations occur [0m[1;39m([0m[39mor should occur[0m[1;39m)[0m[39m before [0m       [2m                [0m
[2;36m                    [0m         [39mreaching `rx_icmp` would provide context for where additional checks are needed.[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m258835080[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x561ff01a2708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x561ff01a3aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x561ff01a3aa8[0m[39m,[0m[1;36m0x561ff01b7448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x561ff0128c02[0m[39m bp [0m[1;36m0x7ffc33939220[0m[39m sp [0m[1;36m0x7ffc33939218[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561ff0128c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561ff0110d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561ff01258b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561feff91350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561feff7c5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561feff8205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561feffad302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fec5899b082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561feff747ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561ff009d11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561ff012579d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561feff91350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561feff7c5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561feff8205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561feffad302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fec5899b082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpi8kbb5d5[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m568223494[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x556791b63708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x556791b64aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x556791b64aa8[0m[39m,[0m[1;36m0x556791b78448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x556791ae9c02[0m[39m bp [0m[1;36m0x7ffeb41021e0[0m[39m sp [0m[1;36m0x7ffeb41021d8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x556791ae9c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x556791ad1d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x556791ae68b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x556791952350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55679193d5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55679194305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55679196e302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f3eb4124082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x5567919357ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x556791a5e11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x556791ae679d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x556791952350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55679193d5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55679194305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55679196e302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f3eb4124082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp44_tllbw[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:41[0m[39m-[0m[1;36m45[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:struct eth [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:  uint8_t dst[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Destination MAC address[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:  uint8_t src[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Source MAC address[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:  uint16_t type;   [0m[35m/[0m[35m/[0m[39m Ethernet type[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:72[0m[39m-[0m[1;36m76[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:struct icmp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  uint8_t type;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint8_t code;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  uint16_t csum;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:129[0m[39m-[0m[1;36m141[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:struct pkt [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:  struct mg_str raw;  [0m[35m/[0m[35m/[0m[39m Raw packet data[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:  struct mg_str pay;  [0m[35m/[0m[35m/[0m[39m Payload data[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:  struct eth *eth;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:  struct llc *llc;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:  struct arp *arp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:  struct ip *ip;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:  struct ip6 *ip6;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:  struct icmp *icmp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:  struct tcp *tcp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:  struct udp *udp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:  struct dhcp *dhcp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:806[0m[39m-[0m[1;36m835[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:824[0m[39m-[0m[1;36m835[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:90[0m[39m-[0m[1;36m115[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:struct tcp [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:  uint16_t sport;  [0m[35m/[0m[35m/[0m[39m Source port[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:  uint16_t dport;  [0m[35m/[0m[35m/[0m[39m Destination port[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:  uint32_t seq;    [0m[35m/[0m[35m/[0m[39m Sequence number[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:  uint32_t ack;    [0m[35m/[0m[35m/[0m[39m Acknowledgement number[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:  uint8_t off;     [0m[35m/[0m[35m/[0m[39m Data offset[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:  uint8_t flags;   [0m[35m/[0m[35m/[0m[39m TCP flags[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:#define TH_FIN [0m[1;36m0x01[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:#define TH_SYN [0m[1;36m0x02[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:#define TH_RST [0m[1;36m0x04[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:#define TH_PUSH [0m[1;36m0x08[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:#define TH_ACK [0m[1;36m0x10[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:#define TH_URG [0m[1;36m0x20[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:#define TH_ECE [0m[1;36m0x40[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:#define TH_CWR [0m[1;36m0x80[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:  uint16_t win;   [0m[35m/[0m[35m/[0m[39m Window[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:  uint16_t urp;   [0m[35m/[0m[35m/[0m[39m Urgent pointer[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:struct udp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:  uint16_t sport;  [0m[35m/[0m[35m/[0m[39m Source port[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:  uint16_t dport;  [0m[35m/[0m[35m/[0m[39m Destination port[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:  uint16_t len;    [0m[35m/[0m[35m/[0m[39m UDP length[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:  uint16_t csum;   [0m[35m/[0m[35m/[0m[39m UDP checksum[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:53[0m[39m-[0m[1;36m54[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m800[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter examining the evaluation report and code snippets, I can now identify the [0m    [2m                [0m
[2;36m                    [0m         [39mroot cause of the persistent heap-buffer-overflow:[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Root Cause[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe previous patch attempted to fix IPv4 options handling in `mg_tcpip_rx` [0m[1;39m([0m[39mlines [0m  [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m-[0m[1;36m897[0m[1;39m)[0m[39m, which correctly calculates the payload position accounting for IP header [0m [2m                [0m
[2;36m                    [0m         [39moptions. However, **the actual bug occurs in the `rx_ip` function** [0m[1;39m([0m[39mlines [0m         [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m-[0m[1;36m836[0m[1;39m)[0m[39m, which systematically uses `pkt->ip + [0m[1;36m1[0m[39m` pointer arithmetic throughout. [0m   [2m                [0m
[2;36m                    [0m         [39mThis arithmetic assumes a fixed [0m[1;36m20[0m[39m-byte IP header [0m[1;39m([0m[39m`[0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m`[0m[1;39m)[0m[39m, completely[0m [2m                [0m
[2;36m                    [0m         [39mignoring IPv4 options that can extend the header up to [0m[1;36m60[0m[39m bytes.[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe critical flow:[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. `mg_tcpip_rx` correctly sets `pkt.pay` accounting for IP options [0m[1;39m([0m[39mlines [0m[1;36m891[0m[39m-[0m[1;36m894[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m✓[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. `rx_ip` is called with the correctly configured packet [0m[1;39m([0m[39mline [0m[1;36m896[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Inside `rx_ip`**, line [0m[1;36m802[0m[39m sets: `pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;` [0m [2m                [0m
[2;36m                    [0m         [39m✗[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m   - This assumes ICMP header is [0m[1;36m20[0m[39m bytes after the IP header start[0m                 [2m                [0m
[2;36m                    [0m         [39m   - With IPv4 options, ICMP is actually at `[0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + [0m                     [2m                [0m
[2;36m                    [0m         [39mactual_ip_header_length`[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Line [0m[1;36m804[0m[39m calls: `[0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;` ✗[0m                                   [2m                [0m
[2;36m                    [0m         [39m   - This **overwrites** the correct payload setup from `mg_tcpip_rx`[0m               [2m                [0m
[2;36m                    [0m         [39m   - Sets `pkt->pay.buf` to point beyond the actual buffer boundary[0m                 [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. `rx_icmp` is called [0m[1;39m([0m[39mline [0m[1;36m805[0m[1;39m)[0m[39m, and at line [0m[1;36m392[0m[39m it accesses `pkt->pay.buf`, [0m     [2m                [0m
[2;36m                    [0m         [39mcausing the heap-buffer-overflow[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why the Previous Patch Failed[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe patch added validation in `mg_tcpip_rx` but didn't fix the systematic bug in [0m   [2m                [0m
[2;36m                    [0m         [39m`rx_ip`. All protocol handlers in `rx_ip` [0m[1;39m([0m[39mICMP, UDP, TCP[0m[1;39m)[0m[39m suffer from the same [0m    [2m                [0m
[2;36m                    [0m         [39missue - they all use `pkt->ip + [0m[1;36m1[0m[39m` and then call `mkpay`, negating the previous [0m    [2m                [0m
[2;36m                    [0m         [39mcorrect setup.[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Comprehensive Fix Strategy[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Primary Fix Location: `rx_ip` function [0m[1;39m([0m[39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m836[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix must modify the `rx_ip` function to consistently use the actual IP header [0m  [2m                [0m
[2;36m                    [0m         [39mlength throughout all protocol processing paths.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Implementation Steps[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m1[0m[39m: Calculate Actual IP Header Length[0m                                      [2m                [0m
[2;36m                    [0m         [39mAt the beginning of `rx_ip` [0m[1;39m([0m[39mimmediately after line [0m[1;36m794[0m[1;39m)[0m[39m, add:[0m                      [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39msize_t ip_hlen = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mip_hlen < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m IHL must be at least [0m[1;36m5[0m[39m [0m[1;39m([0m[1;36m20[0m[39m bytes[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis extracts the Internet Header Length [0m[1;39m([0m[39mIHL[0m[1;39m)[0m[39m field from the version byte and [0m     [2m                [0m
[2;36m                    [0m         [39mconverts it to bytes. The validation ensures malformed packets with IHL < [0m[1;36m5[0m[39m are [0m    [2m                [0m
[2;36m                    [0m         [39mrejected.[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m2[0m[39m: Fix Fragmented Packet Handlers [0m[1;39m([0m[39mlines [0m[1;36m797[0m[39m-[0m[1;36m798[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [39mReplace:[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mWith:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m3[0m[39m: Fix ICMP Handler [0m[1;39m([0m[39mline [0m[1;36m802[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [39mReplace:[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mpkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mWith:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mpkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m4[0m[39m: Remove Redundant mkpay Call for ICMP [0m[1;39m([0m[39mline [0m[1;36m804[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [39m**Delete line [0m[1;36m804[0m[39m entirely**: `[0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;`[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis line overwrites the correct payload setup from `mg_tcpip_rx`. Since the [0m       [2m                [0m
[2;36m                    [0m         [39mpayload is already correctly positioned, this redundant call must be removed.[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m5[0m[39m: Fix UDP Handler [0m[1;39m([0m[39mline [0m[1;36m807[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [39mReplace:[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mpkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mWith:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mpkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m6[0m[39m: Remove Redundant mkpay Call for UDP [0m[1;39m([0m[39mline [0m[1;36m809[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [39m**Delete line [0m[1;36m809[0m[39m entirely**: `[0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;`[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mSame reasoning as ICMP - the payload is already correct.[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m7[0m[39m: Fix TCP Handler [0m[1;39m([0m[39mline [0m[1;36m825[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [39mReplace:[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mpkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mWith:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mpkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m8[0m[39m: Remove Redundant mkpay Call for TCP [0m[1;39m([0m[39mline [0m[1;36m827[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [39m**Delete line [0m[1;36m827[0m[39m entirely**: `[0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;`[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m9[0m[39m: Fix TCP Payload Offset Calculation [0m[1;39m([0m[39mline [0m[1;36m829[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [39mReplace:[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39muint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mWith:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39muint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip_hlen + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis ensures TCP payload length calculation accounts for IP options.[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Secondary Fix: Enhance Validation in `mg_tcpip_rx` [0m[1;39m([0m[39mlines [0m[1;36m891[0m[39m-[0m[1;36m894[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe previous patch added a length check for IPv4 options, but it should be enhanced[0m [2m                [0m
[2;36m                    [0m         [39mto validate the IHL value:[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mReplace lines [0m[1;36m891[0m[39m-[0m[1;36m894[0m[39m with:[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m                                 [0m[35m/[0m[35m/[0m[39m Handle IPv4 [0m      [2m                [0m
[2;36m                    [0m         [39moptions[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m    size_t ip_hdr_len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mip_hdr_len > [0m[1;36m60[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Maximum IP header length is [0m[1;36m60[0m[39m bytes[0m           [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hdr_len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m          [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + ip_hdr_len[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;39m}[0m[39m else [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe additional check `if [0m[1;39m([0m[39mip_hdr_len > [0m[1;36m60[0m[1;39m)[0m[39m return;` prevents malformed packets with[0m [2m                [0m
[2;36m                    [0m         [39mimpossibly large IHL values from being processed.[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Justification[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This Is Optimal[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Fixes the Root Cause**: Addresses the systematic bug where all protocol [0m       [2m                [0m
[2;36m                    [0m         [39mhandlers incorrectly assume [0m[1;36m20[0m[39m-byte IP headers[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Preserves Existing Logic**: The previous patch's validation in `mg_tcpip_rx` [0m  [2m                [0m
[2;36m                    [0m         [39mis maintained and enhanced[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Follows Existing Patterns**: The codebase already handles variable-length TCP [0m [2m                [0m
[2;36m                    [0m         [39mheaders using `[0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U`; this fix applies the same pattern to IP [0m [2m                [0m
[2;36m                    [0m         [39mheaders[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Minimal Changes**: Only modifies the necessary calculations without [0m           [2m                [0m
[2;36m                    [0m         [39mrestructuring the packet processing flow[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Preserves Existing Logic[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Protocol dispatch logic remains unchanged [0m[1;39m([0m[39mproto == [0m[1;36m1[0m[39m/[0m[1;36m6[0m[39m/[0m[1;36m17[0m[39m checks[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [39m- Fragmentation handling flow is preserved[0m                                          [2m                [0m
[2;36m                    [0m         [39m- The validation checks [0m[1;39m([0m[39mlines [0m[1;36m803[0m[39m, [0m[1;36m808[0m[39m, [0m[1;36m826[0m[1;39m)[0m[39m remain functional[0m                     [2m                [0m
[2;36m                    [0m         [39m- Connection matching via `getpeer` continues to work correctly[0m                     [2m                [0m
[2;36m                    [0m         [39m- All downstream protocol handlers [0m[1;39m([0m[39m`rx_icmp`, `rx_tcp`, `rx_udp`[0m[1;39m)[0m[39m receive [0m         [2m                [0m
[2;36m                    [0m         [39mcorrectly positioned packet structures[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Addresses the Evaluation Report[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Heap-buffer-overflow at line [0m[1;36m385[0m[39m**: Fixed by ensuring `pkt->pay.buf` points [0m   [2m                [0m
[2;36m                    [0m         [39mwithin bounds[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **[0m[1;36m34[0m[39m-byte buffer overflow**: With correct IP header length handling, the payload[0m [2m                [0m
[2;36m                    [0m         [39mcalculation won't extend beyond allocated memory[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Persistent issue after previous patch**: Resolved by fixing the actual bug [0m    [2m                [0m
[2;36m                    [0m         [39mlocation in `rx_ip` instead of just adding validation in `mg_tcpip_rx`[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Potential Side Effects and Mitigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Removed `mkpay` calls**: These were redundant and harmful. The payload is [0m     [2m                [0m
[2;36m                    [0m         [39malready correctly set by `mg_tcpip_rx`, so removing them has no negative impact.[0m    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Changed pointer arithmetic**: Using `[0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen` instead of [0m    [2m                [0m
[2;36m                    [0m         [39m`pkt->ip + [0m[1;36m1[0m[39m` is correct for variable-length headers and won't affect packets [0m      [2m                [0m
[2;36m                    [0m         [39mwithout IP options [0m[1;39m([0m[39mwhere `ip_hlen == [0m[1;36m20[0m[39m == [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m`[0m[1;39m)[0m[39m.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **TCP offset calculation**: Changing `[0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m` to `ip_hlen` in line [0m[1;36m829[0m [2m                [0m
[2;36m                    [0m         [39mis correct and essential for accurate TCP payload length when IP options are [0m       [2m                [0m
[2;36m                    [0m         [39mpresent.[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Similar Solutions in Codebase[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe TCP handler already demonstrates awareness of variable-length headers:[0m          [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m829[0m[39m: `[0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[39m` calculates variable TCP header length[0m     [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m830[0m[39m: Adjusts payload length based on this calculation[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis fix applies the same principle to IP headers, ensuring consistent handling of [0m [2m                [0m
[2;36m                    [0m         [39mprotocol options throughout the packet processing pipeline.[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/10/26 07:01:21][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=551607;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=538625;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m3[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 07:04:47][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=116424;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=98287;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m3[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 07:05:59][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=571735;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=560388;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m3[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=278572;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=806985;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 07:06:00][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.88[0m seconds;              ]8;id=913157;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=486128;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Started[33m...[0m                            ]8;id=432658;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=479466;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpr_mo__kl[0m                                                 ]8;id=289957;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=819328;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/10/26 07:06:07][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Took [1;36m6.97[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=609071;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=254233;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Started[33m...[0m                      ]8;id=160709;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=399001;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 07:06:11][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Took [1;36m4.29[0m seconds;             ]8;id=802556;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=737391;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Started[33m...[0m                         ]8;id=569740;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=234770;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 07:06:14][0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=360662;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=630768;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py#102\[2m102[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1191115489[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x564bb4406708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x564bb4407aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x564bb4407aa8[0m[39m,[0m[1;36m0x564bb441b448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x564bb438cc02[0m[39m bp [0m[1;36m0x7ffc5fe52700[0m[39m sp [0m[1;36m0x7ffc5fe526f8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x564bb438cc01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x564bb4374d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x564bb43898b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x564bb41f5350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x564bb41e05c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x564bb41e605f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x564bb4211302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f9df3e47082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x564bb41d87ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x564bb430111f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x564bb438979d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x564bb41f5350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x564bb41e05c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x564bb41e605f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x564bb4211302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f9df3e47082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpqxaz0aup[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=865119;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=344247;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py#103\[2m103[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1191115489[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x564bb4406708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x564bb4407aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x564bb4407aa8[0m[39m,[0m[1;36m0x564bb441b448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x564bb438cc02[0m[39m bp [0m[1;36m0x7ffc5fe52700[0m[39m sp [0m[1;36m0x7ffc5fe526f8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x564bb438cc01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x564bb4374d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x564bb43898b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x564bb41f5350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x564bb41e05c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x564bb41e605f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x564bb4211302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f9df3e47082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x564bb41d87ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x564bb430111f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x564bb438979d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x564bb41f5350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x564bb41e05c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x564bb41e605f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x564bb4211302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f9df3e47082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpqxaz0aup[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [31m╭─[0m[31m──────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m───────────────────────[0m[31m─╮[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/evaluator/services/default/[0m[1m__init__.py[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m :97 in _evaluate_internal                                                        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 94 [0m[2m│   │   [0m[94mwith[0m logging_performance(context, header=[33m"[0m[33mRunning PoV[0m[33m"[0m):           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 95 [0m[2m│   │   │   [0m[94mtry[0m:                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 96 [0m[2m│   │   │   │   [0m[94mif[0m [96mlen[0m(detection.blobs) > [94m0[0m:                               [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 97 [2m│   │   │   │   │   [0menvironment.run_pov(context, detection)                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 98 [0m[2m│   │   │   │   [0m[94melse[0m:                                                      [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 99 [0m[2m│   │   │   │   │   [0mcontext[[33m"[0m[33mlogger[0m[33m"[0m].warning([33m"[0m[33mNo blob data found for the [0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m100 [0m                                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mcached.p[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1my[0m:56 in run_pov                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 53 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, detection: Detection            [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 54 [0m[2m│   [0m) -> [96mtuple[0m[[96mstr[0m, [96mstr[0m]:                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 55 [0m[2m│   │   [0m[94massert[0m [96mlen[0m(detection.blobs) > [94m0[0m, [33m"[0m[33mAt least one blob is required[0m[33m"[0m   [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 56 [2m│   │   [0m[94mreturn[0m [1;4;96mself[0m[1;4m.environment.run_pov(context, detection)[0m                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 57 [0m[2m│   [0m                                                                       [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 58 [0m[2m│   [0m[94mdef[0m[90m [0m[92mrun_tests[0m(                                                         [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 59 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, env: [96mdict[0m[[96mstr[0m, [96mstr[0m] = {}        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mdefault.[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1mpy[0m:210 in run_pov                                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m207 [0m[2m│   │   │   │   [0mcontext, blobinfo.blob, blobinfo.harness_name              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m208 [0m[2m│   │   │   [0m)                                                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m209 [0m[2m│   │   │   [0m[94mif[0m [95mnot[0m success:                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m210 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m ChallengePoVFoundError([0m                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m211 [0m[2m│   │   │   │   │   [0m[1;4mstdout=stdout.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m212 [0m[2m│   │   │   │   │   [0m[1;4mstderr=stderr.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m213 [0m[2m│   │   │   │   [0m[1;4m)[0m                                                          [31m│[0m [2m               [0m
[2;36m                    [0m         [31m╰──────────────────────────────────────────────────────────────────────────────────╯[0m [2m               [0m
[2;36m                    [0m         [1;91mChallengePoVFoundError: [0mPoV found:                                                   [2m               [0m
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1191115489[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x564bb4406708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x564bb4407aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x564bb4407aa8[0m[39m,[0m[1;36m0x564bb441b448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x564bb438cc02[0m[39m bp [0m[1;36m0x7ffc5fe52700[0m[39m sp [0m[1;36m0x7ffc5fe526f8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x564bb438cc01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x564bb4374d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x564bb43898b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x564bb41f5350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x564bb41e05c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x564bb41e605f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x564bb4211302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f9df3e47082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x564bb41d87ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x564bb430111f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x564bb438979d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x564bb41f5350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x564bb41e05c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x564bb41e605f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x564bb4211302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f9df3e47082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpqxaz0aup[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Took [1;36m2.37[0m seconds;                ]8;id=297734;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=351377;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=487084;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=133360;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 07:06:15][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.93[0m seconds;              ]8;id=231535;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=172538;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=563818;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=866736;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 07:06:16][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m1.00[0m seconds;              ]8;id=873376;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=175716;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=912804;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=885745;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         +++ b/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-792[0m,[1;36m19[0m +[1;36m792[0m,[1;36m20[0m @@                                                               [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          static void [1;35mrx_ip[0m[1m([0mstruct mg_tcpip_if *ifp, struct pkt *pkt[1m)[0m [1m{[0m                      [2m                [0m
[2;36m                    [0m         +  size_t ip_hlen = [1m([0mpkt->ip->ver & [1;36m0xF[0m[1m)[0m * [1;36m4[0m;                                       [2m                [0m
[2;36m                    [0m            uint16_t frag = [1;35mmg_ntohs[0m[1m([0mpkt->ip->frag[1m)[0m;                                         [2m                [0m
[2;36m                    [0m            if [1m([0mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[1m)[0m [1m{[0m                     [2m                [0m
[2;36m                    [0m         -    if [1m([0mpkt->ip->proto == [1;36m17[0m[1m)[0m pkt->udp = [1m([0mstruct udp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;             [2m                [0m
[2;36m                    [0m         -    if [1m([0mpkt->ip->proto == [1;36m6[0m[1m)[0m pkt->tcp = [1m([0mstruct tcp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;              [2m                [0m
[2;36m                    [0m         +    if [1m([0mpkt->ip->proto == [1;36m17[0m[1m)[0m pkt->udp = [1m([0mstruct udp *[1m)[0m [1m([0m[1m([0mchar *[1m)[0mpkt->ip +         [2m                [0m
[2;36m                    [0m         ip_hlen[1m)[0m;                                                                           [2m                [0m
[2;36m                    [0m         +    if [1m([0mpkt->ip->proto == [1;36m6[0m[1m)[0m pkt->tcp = [1m([0mstruct tcp *[1m)[0m [1m([0m[1m([0mchar *[1m)[0mpkt->ip +          [2m                [0m
[2;36m                    [0m         ip_hlen[1m)[0m;                                                                           [2m                [0m
[2;36m                    [0m              struct mg_connection *c = [1;35mgetpeer[0m[1m([0mifp->mgr, pkt, false[1m)[0m;                       [2m                [0m
[2;36m                    [0m              if [1m([0mc[1m)[0m [1;35mmg_error[0m[1m([0mc, [32m"Received fragmented packet"[0m[1m)[0m;                              [2m                [0m
[2;36m                    [0m            [1m}[0m else if [1m([0mpkt->ip->proto == [1;36m1[0m[1m)[0m [1m{[0m                                                [2m                [0m
[2;36m                    [0m         -    pkt->icmp = [1m([0mstruct icmp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;                                     [2m                [0m
[2;36m                    [0m         +    pkt->icmp = [1m([0mstruct icmp *[1m)[0m [1m([0m[1m([0mchar *[1m)[0mpkt->ip + ip_hlen[1m)[0m;                       [2m                [0m
[2;36m                    [0m              if [1m([0mpkt->pay.len [1m<[0m[39m [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [39m-    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m+    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m        [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-822[0m[39m,[0m[1;36m11[0m[39m +[0m[1;36m823[0m[39m,[0m[1;36m11[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m-    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m+    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m-    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [39m+    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip_hlen + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m        [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m            [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-888[0m[39m,[0m[1;36m10[0m[39m +[0m[1;36m889[0m[39m,[0m[1;36m11[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m    [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m       [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle IPv4 [0m [2m                [0m
[2;36m                    [0m         [39moptions[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m-    else[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+    size_t ip_hlen = [0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mip_hlen < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m IHL must be at least [0m[1;36m5[0m[39m [0m[1;39m([0m[1;36m20[0m[39m bytes[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mip_hlen > [0m[1;36m60[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Maximum IP header length is [0m[1;36m60[0m[39m bytes[0m             [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hlen[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated with [0m      [2m                [0m
[2;36m                    [0m         [39moptions[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + ip_hlen[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1191115489[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x564bb4406708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x564bb4407aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x564bb4407aa8[0m[39m,[0m[1;36m0x564bb441b448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x564bb438cc02[0m[39m bp [0m[1;36m0x7ffc5fe52700[0m[39m sp [0m[1;36m0x7ffc5fe526f8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x564bb438cc01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x564bb4374d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x564bb43898b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x564bb41f5350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x564bb41e05c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x564bb41e605f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x564bb4211302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f9df3e47082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x564bb41d87ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x564bb430111f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x564bb438979d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x564bb41f5350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x564bb41e05c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x564bb41e605f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x564bb4211302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f9df3e47082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpqxaz0aup[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m258835080[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x561ff01a2708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x561ff01a3aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x561ff01a3aa8[0m[39m,[0m[1;36m0x561ff01b7448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x561ff0128c02[0m[39m bp [0m[1;36m0x7ffc33939220[0m[39m sp [0m[1;36m0x7ffc33939218[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561ff0128c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561ff0110d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561ff01258b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561feff91350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561feff7c5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561feff8205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561feffad302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fec5899b082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561feff747ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561ff009d11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561ff012579d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561feff91350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561feff7c5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561feff8205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561feffad302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fec5899b082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpi8kbb5d5[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe initial issue reveals a heap-buffer-overflow vulnerability in the `rx_icmp` [0m    [2m                [0m
[2;36m                    [0m         [39mfunction at line [0m[1;36m385[0m[39m of `[0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m`. The AddressSanitizer [0m    [2m                [0m
[2;36m                    [0m         [39mdetected a [0m[1;36m1[0m[39m-byte read operation that accessed memory [0m[1;36m0[0m[39m bytes after a [0m[1;36m34[0m[39m-byte [0m      [2m                [0m
[2;36m                    [0m         [39mallocated region. A patch was attempted to address potential issues with IP header [0m [2m                [0m
[2;36m                    [0m         [39mlength calculations and payload pointer arithmetic in the `rx_ip` function and [0m     [2m                [0m
[2;36m                    [0m         [39mrelated packet processing code. However, after applying the patch, the identical [0m   [2m                [0m
[2;36m                    [0m         [39mheap-buffer-overflow error persists at the same location [0m[1;39m([0m[39m`rx_icmp` function, line [0m [2m                [0m
[2;36m                    [0m         [1;36m385[0m[1;39m)[0m[39m, indicating that the patch did not resolve the underlying issue.[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Initial Issue Analysis[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe initial issue presents an AddressSanitizer heap-buffer-overflow error with the [0m [2m                [0m
[2;36m                    [0m         [39mfollowing characteristics:[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Error Location**: The overflow occurs in the `rx_icmp` function at [0m            [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m`[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Memory Access Pattern**: A READ operation of size [0m[1;36m1[0m[39m at address [0m                [2m                [0m
[2;36m                    [0m         [39m`[0m[1;36m0x504000000172[0m[39m`[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Memory Region**: The accessed address is located [0m[1;36m0[0m[39m bytes after a [0m[1;36m34[0m[39m-byte [0m      [2m                [0m
[2;36m                    [0m         [39mregion `[0m[1;39m[[0m[1;36m0x504000000150[0m[39m, [0m[1;36m0x504000000172[0m[1;39m)[0m[39m` that was allocated via malloc[0m             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Call Stack**: The error propagates through:[0m                                    [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m[1;36m385[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [39m   - `mg_tcpip_rx` [0m[1;39m([0m[39mline [0m[1;36m897[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [39m   - `LLVMFuzzerTestOneInput` [0m[1;39m([0m[39mtest/fuzz.[0m[1;92mc:106[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe scariness score of [0m[1;36m12[0m[39m indicates a [0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow, which is a [0m [2m                [0m
[2;36m                    [0m         [39mmoderate severity issue.[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Patch Attempt Description[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe patch attempted to address the issue by making the following modifications to [0m  [2m                [0m
[2;36m                    [0m         [39m`src/net_builtin.c`:[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **IP Header Length Calculation**: Added explicit calculation of IP header length[0m [2m                [0m
[2;36m                    [0m         [39mat the beginning of `rx_ip` function:[0m                                               [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   size_t ip_hlen = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mip_hlen < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m IHL must be at least [0m[1;36m5[0m[39m [0m[1;39m([0m[1;36m20[0m[39m bytes[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Pointer Arithmetic Changes**: Modified all protocol header pointer [0m            [2m                [0m
[2;36m                    [0m         [39mcalculations to use the computed `ip_hlen` instead of pointer arithmetic with [0m      [2m                [0m
[2;36m                    [0m         [39m`pkt->ip + [0m[1;36m1[0m[39m`:[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m   - ICMP: `pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;`[0m               [2m                [0m
[2;36m                    [0m         [39m   - UDP: `pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;`[0m                  [2m                [0m
[2;36m                    [0m         [39m   - TCP: `pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;`[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Removed mkpay Calls**: The patch removed two `mkpay` function calls:[0m           [2m                [0m
[2;36m                    [0m         [39m   - After ICMP header assignment: `[0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;`[0m                     [2m                [0m
[2;36m                    [0m         [39m   - After UDP header assignment: `[0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;`[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **TCP Offset Calculation**: Updated TCP offset calculation to use `ip_hlen`:[0m     [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip_hlen + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Enhanced IP Options Handling**: Added additional validation in the main packet[0m [2m                [0m
[2;36m                    [0m         [39mprocessing logic:[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   - Maximum IP header length check [0m[1;39m([0m[1;36m60[0m[39m bytes[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [39m   - Truncation check after computing IP header length[0m                              [2m                [0m
[2;36m                    [0m         [39m   - Reorganized the conditional logic for IP options handling[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Post-Patch Results[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter applying the patch, the identical error persists:[0m                             [2m                [0m
[2;36m                    [0m         [39m- Same error location: `rx_icmp` function at line [0m[1;36m385[0m                               [2m                [0m
[2;36m                    [0m         [39m- Same memory address: `[0m[1;36m0x504000000172[0m[39m`[0m                                             [2m                [0m
[2;36m                    [0m         [39m- Same allocated region: [0m[1;36m34[0m[39m-byte region `[0m[1;39m[[0m[1;36m0x504000000150[0m[39m, [0m[1;36m0x504000000172[0m[1;39m)[0m[39m`[0m          [2m                [0m
[2;36m                    [0m         [39m- Identical call stack and DEDUP_TOKEN values[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis indicates that the patch modifications to the `rx_ip` function did not address[0m [2m                [0m
[2;36m                    [0m         [39mthe root cause occurring within the `rx_icmp` function itself.[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas Requiring Further Investigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo obtain a holistic view of the issue, the following areas of the codebase should [0m [2m                [0m
[2;36m                    [0m         [39mbe investigated:[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **The `rx_icmp` Function [0m[1;39m([0m[39mline [0m[1;36m385[0m[1;39m)[0m[39m**: The actual line where the overflow occurs[0m [2m                [0m
[2;36m                    [0m         [39mneeds detailed examination to understand what memory access is happening and why it[0m [2m                [0m
[2;36m                    [0m         [39mexceeds the buffer boundary.[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Packet Structure and Payload Management**: The `pkt` structure definition and [0m [2m                [0m
[2;36m                    [0m         [39mhow `pkt->pay` is managed, particularly:[0m                                            [2m                [0m
[2;36m                    [0m         [39m   - How payload length is calculated and validated[0m                                 [2m                [0m
[2;36m                    [0m         [39m   - The relationship between `pkt->raw.len`, `pkt->pay.len`, and the actual [0m       [2m                [0m
[2;36m                    [0m         [39mallocated buffer size[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **The `mkpay` Function**: Understanding what this function does and why its [0m     [2m                [0m
[2;36m                    [0m         [39mremoval in the patch [0m[1;39m([0m[39mfor ICMP and UDP cases[0m[1;39m)[0m[39m might affect buffer boundaries.[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Buffer Allocation in Fuzzer**: The allocation at `test/fuzz.[0m[1;92mc:95:17[0m[39m` creates [0m  [2m                [0m
[2;36m                    [0m         [39mthe [0m[1;36m34[0m[39m-byte buffer that is being overflowed. The relationship between the input [0m    [2m                [0m
[2;36m                    [0m         [39msize and the allocated buffer needs investigation.[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **ICMP Packet Structure**: The size requirements and field accesses within ICMP [0m [2m                [0m
[2;36m                    [0m         [39mpacket processing, particularly what happens at line [0m[1;36m385[0m[39m of `net_builtin.c`.[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Payload Pointer Initialization**: How payload pointers are set up in the [0m      [2m                [0m
[2;36m                    [0m         [39minitial packet processing [0m[1;39m([0m[39m`mg_tcpip_rx` at line [0m[1;36m897[0m[1;39m)[0m[39m and whether proper bounds [0m    [2m                [0m
[2;36m                    [0m         [39mchecking exists before the packet reaches `rx_icmp`.[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. **IP Header Options Processing**: While the patch attempted to improve this, the[0m [2m                [0m
[2;36m                    [0m         [39minteraction between IP header length, options, and subsequent protocol header [0m      [2m                [0m
[2;36m                    [0m         [39mpositioning needs verification to ensure the correct offset calculations are used [0m  [2m                [0m
[2;36m                    [0m         [39mthroughout the packet processing pipeline.[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m258835080[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x561ff01a2708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x561ff01a3aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x561ff01a3aa8[0m[39m,[0m[1;36m0x561ff01b7448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x561ff0128c02[0m[39m bp [0m[1;36m0x7ffc33939220[0m[39m sp [0m[1;36m0x7ffc33939218[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561ff0128c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561ff0110d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561ff01258b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561feff91350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561feff7c5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561feff8205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561feffad302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fec5899b082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561feff747ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561ff009d11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561ff012579d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561feff91350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561feff7c5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561feff8205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561feffad302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fec5899b082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpi8kbb5d5[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m869259888[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55679e6c7708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55679e6c8aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55679e6c8aa8[0m[39m,[0m[1;36m0x55679e6dc448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55679e64dc02[0m[39m bp [0m[1;36m0x7ffc8ca0bbc0[0m[39m sp [0m[1;36m0x7ffc8ca0bbb8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55679e64dc01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55679e635d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55679e64a8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55679e4b6350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55679e4a15c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55679e4a705f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55679e4d2302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f2cdb2bd082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55679e4997ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55679e5c211f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55679e64a79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55679e4b6350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55679e4a15c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55679e4a705f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55679e4d2302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f2cdb2bd082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp2yrbdd7r[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:129[0m[39m-[0m[1;36m141[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:struct pkt [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:  struct mg_str raw;  [0m[35m/[0m[35m/[0m[39m Raw packet data[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:  struct mg_str pay;  [0m[35m/[0m[35m/[0m[39m Payload data[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:  struct eth *eth;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:  struct llc *llc;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:  struct arp *arp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:  struct ip *ip;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:  struct ip6 *ip6;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:  struct icmp *icmp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:  struct tcp *tcp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:  struct udp *udp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:  struct dhcp *dhcp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:72[0m[39m-[0m[1;36m76[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:struct icmp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  uint8_t type;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint8_t code;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  uint16_t csum;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:806[0m[39m-[0m[1;36m809[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:824[0m[39m-[0m[1;36m827[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:498[0m[39m-[0m[1;36m518[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:static void [0m[1;35mrx_udp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:  struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, true[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:  if [0m[1;39m([0m[39mc == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:    [0m[35m/[0m[35m/[0m[39m No UDP listener on this port. Should send ICMP, but keep silent.[0m         [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:  [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:    c->rem.port = pkt->udp->sport;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39mc->rem.ip, &pkt->ip->src, [0m[1;35msizeof[0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:    struct connstate *s = [0m[1;39m([0m[39mstruct connstate *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mc + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39ms->mac, pkt->eth->src, [0m[1;35msizeof[0m[1;39m([0m[39ms->mac[0m[1;39m)[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m507[0m[39m:    if [0m[1;39m([0m[39mc->recv.len >= MG_MAX_RECV_SIZE[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:      [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"max_recv_buf_size reached"[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc->recv.size - c->recv.len < pkt->pay.len &&[0m                     [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:               ![0m[1;35mmg_iobuf_resize[0m[1;39m([0m[39m&c->recv, c->recv.len + pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:      [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"oom"[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39m&c->recv.buf[0m[1;39m[[0m[39mc->recv.len[0m[1;39m][0m[39m, pkt->pay.buf, pkt->pay.len[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:      c->recv.len += pkt->pay.len;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:      [0m[1;35mmg_call[0m[1;39m([0m[39mc, MG_EV_READ, &pkt->pay.len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m517[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m518[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:744[0m[39m-[0m[1;36m792[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m744[0m[39m:static void [0m[1;35mrx_tcp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m745[0m[39m:  struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m746[0m[39m:  struct connstate *s = c == NULL ? NULL : [0m[1;39m([0m[39mstruct connstate *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mc + [0m[1;36m1[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m747[0m[39m:#if [0m[1;36m0[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m748[0m[39m:  [0m[1;35mMG_INFO[0m[1;39m([0m[1;39m([0m[32m"%lu %hhu %d"[0m[39m, c ? c->id : [0m[1;36m0[0m[39m, pkt->tcp->flags, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m749[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m750[0m[39m:  if [0m[1;39m([0m[39mc != NULL && c->is_connecting && pkt->tcp->flags == [0m[1;39m([0m[39mTH_SYN | TH_ACK[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m751[0m[39m:    s->seq = [0m[1;35mmg_ntohl[0m[1;39m([0m[39mpkt->tcp->ack[0m[1;39m)[0m[39m, s->ack = [0m[1;35mmg_ntohl[0m[1;39m([0m[39mpkt->tcp->seq[0m[1;39m)[0m[39m + [0m[1;36m1[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m752[0m[39m:    [0m[1;35mtx_tcp_pkt[0m[1;39m([0m[39mifp, pkt, TH_ACK, pkt->tcp->ack, NULL, [0m[1;36m0[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m753[0m[39m:    c->is_connecting = [0m[1;36m0[0m[39m;  [0m[35m/[0m[35m/[0m[39m Client connected[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m754[0m[39m:    [0m[1;35msettmout[0m[1;39m([0m[39mc, MIP_TTYPE_KEEPALIVE[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m755[0m[39m:    [0m[1;35mmg_call[0m[1;39m([0m[39mc, MG_EV_CONNECT, NULL[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Let user know[0m                          [2m                [0m
[2;36m                    [0m         [1;36m756[0m[39m:    if [0m[1;39m([0m[39mc->is_tls_hs[0m[1;39m)[0m[39m [0m[1;35mmg_tls_handshake[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m757[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc != NULL && c->is_connecting && pkt->tcp->flags != TH_ACK[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m758[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_hexdump[0m[1;39m([0m[39mpkt->raw.buf, pkt->raw.len[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m759[0m[39m:    [0m[1;35mtx_tcp_pkt[0m[1;39m([0m[39mifp, pkt, TH_RST | TH_ACK, pkt->tcp->ack, NULL, [0m[1;36m0[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m760[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc != NULL && pkt->tcp->flags & TH_RST[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m761[0m[39m:    [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"peer RST"[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m RFC-[0m[1;36m1122[0m[39m [0m[1;92m4.2.2.13[0m                              [2m                [0m
[2;36m                    [0m         [1;36m762[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc != NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m763[0m[39m:#if [0m[1;36m0[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m764[0m[39m:    [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"%lu %d %M:%hu -> %M:%hu"[0m[39m, c->id, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->raw.len,[0m             [2m                [0m
[2;36m                    [0m         [1;36m765[0m[39m:              mg_print_ip4, &pkt->ip->src, [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m,[0m           [2m                [0m
[2;36m                    [0m         [1;36m766[0m[39m:              mg_print_ip4, &pkt->ip->dst, [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m767[0m[39m:    [0m[1;35mmg_hexdump[0m[1;39m([0m[39mpkt->pay.buf, pkt->pay.len[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m768[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m769[0m[39m:    s->tmiss = [0m[1;36m0[0m[39m;                         [0m[35m/[0m[35m/[0m[39m Reset missed keep-alive counter[0m    [2m                [0m
[2;36m                    [0m         [1;36m770[0m[39m:    if [0m[1;39m([0m[39ms->ttype == MIP_TTYPE_KEEPALIVE[0m[1;39m)[0m[39m  [0m[35m/[0m[35m/[0m[39m Advance keep-alive timer[0m           [2m                [0m
[2;36m                    [0m         [1;36m771[0m[39m:      [0m[1;35msettmout[0m[1;39m([0m[39mc,[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m772[0m[39m:               MIP_TTYPE_KEEPALIVE[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m unless a former ACK timeout is pending[0m [2m                [0m
[2;36m                    [0m         [1;36m773[0m[39m:    [0m[1;35mread_conn[0m[1;39m([0m[39mc, pkt[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Override timer with ACK timeout if needed[0m            [2m                [0m
[2;36m                    [0m         [1;36m774[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mc = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, true[0m[1;39m)[0m[1;39m)[0m[39m == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m775[0m[39m:    [0m[1;35mtx_tcp_pkt[0m[1;39m([0m[39mifp, pkt, TH_RST | TH_ACK, pkt->tcp->ack, NULL, [0m[1;36m0[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m776[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->tcp->flags & TH_RST[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m777[0m[39m:    if [0m[1;39m([0m[39mc->is_accepted[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"peer RST"[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m RFC-[0m[1;36m1122[0m[39m [0m[1;92m4.2.2.13[0m          [2m                [0m
[2;36m                    [0m         [1;36m778[0m[39m:    [0m[35m/[0m[35m/[0m[39m ignore RST if not connected[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m779[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->tcp->flags & TH_SYN[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m780[0m[39m:    [0m[35m/[0m[35m/[0m[39m Use peer's source port as ISN, in order to recognise the handshake[0m       [2m                [0m
[2;36m                    [0m         [1;36m781[0m[39m:    uint32_t isn = [0m[1;35mmg_htonl[0m[1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m782[0m[39m:    [0m[1;35mtx_tcp_pkt[0m[1;39m([0m[39mifp, pkt, TH_SYN | TH_ACK, isn, NULL, [0m[1;36m0[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m783[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->tcp->flags & TH_FIN[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m784[0m[39m:    [0m[1;35mtx_tcp_pkt[0m[1;39m([0m[39mifp, pkt, TH_FIN | TH_ACK, pkt->tcp->ack, NULL, [0m[1;36m0[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m785[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mmg_htonl[0m[1;39m([0m[39mpkt->tcp->ack[0m[1;39m)[0m[39m == [0m[1;35mmg_htons[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m + 1U[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m786[0m[39m:    [0m[1;35maccept_conn[0m[1;39m([0m[39mc, pkt[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m787[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39m!c->is_accepted[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m  [0m[35m/[0m[35m/[0m[39m no peer[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m788[0m[39m:    [0m[1;35mtx_tcp_pkt[0m[1;39m([0m[39mifp, pkt, TH_RST | TH_ACK, pkt->tcp->ack, NULL, [0m[1;36m0[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m789[0m[39m:  [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m790[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"dropped silently.."[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m791[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m792[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m800[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:824[0m[39m-[0m[1;36m830[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtest/fuzz.[0m[1;92mc:85[0m[39m-[0m[1;36m120[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:  if [0m[1;39m([0m[39msize > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    struct mg_tcpip_if mif = [0m[1;39m{[0m[39m.ip = [0m[1;36m0x01020304[0m[39m,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                              .mask = [0m[1;36m255[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                              .gw = [0m[1;36m0x01010101[0m[39m,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                              .driver = &mg_tcpip_driver_mock[0m[1;39m}[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    struct mg_mgr mgr;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    [0m[1;35mmg_mgr_init[0m[1;39m([0m[39m&mgr[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    [0m[1;35mmg_tcpip_init[0m[1;39m([0m[39m&mgr, &mif[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[35m/[0m[35m/[0m[39m Make a copy of the random data, in order to modify it[0m                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    void *pkt = [0m[1;35mmalloc[0m[1;39m([0m[39msize[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    struct eth *eth = [0m[1;39m([0m[39mstruct eth *[0m[1;39m)[0m[39m pkt;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39mpkt, data, size[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    if [0m[1;39m([0m[39msize > [0m[1;35msizeof[0m[1;39m([0m[39m*eth[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:      static size_t i;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:      uint16_t eth_types[0m[1;39m[[0m[1;39m][0m[39m = [0m[1;39m{[0m[1;36m0x800[0m[39m, [0m[1;36m0x800[0m[39m, [0m[1;36m0x806[0m[39m, [0m[1;36m0x86dd[0m[1;39m}[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39meth->dst, mif.mac, [0m[1;36m6[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Set valid destination MAC[0m               [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:      eth->type = [0m[1;35mmg_htons[0m[1;39m([0m[39meth_types[0m[1;39m[[0m[39mi++[0m[1;39m][0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:      if [0m[1;39m([0m[39mi >= [0m[1;35msizeof[0m[1;39m([0m[39meth_types[0m[1;39m)[0m[39m [0m[35m/[0m[39m [0m[1;35msizeof[0m[1;39m([0m[39meth_types[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[1;39m)[0m[39m i = [0m[1;36m0[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:    [0m[1;35mmg_tcpip_rx[0m[1;39m([0m[39m&mif, pkt, size[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    [0m[35m/[0m[35m/[0m[39m Test HTTP serving[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    const char *url = [0m[32m"http://localhost:12345"[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    struct mg_connection *c = [0m[1;35mmg_http_connect[0m[1;39m([0m[39m&mgr, url, fn, NULL[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    [0m[1;35mmg_iobuf_add[0m[1;39m([0m[39m&c->recv, [0m[1;36m0[0m[39m, data, size[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    c->[0m[1;35mpfn[0m[1;39m([0m[39mc, MG_EV_READ, NULL[0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m manually invoke protocol event handler[0m      [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    [0m[1;35mmg_mgr_free[0m[1;39m([0m[39m&mgr[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    [0m[1;35mfree[0m[1;39m([0m[39mpkt[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:    [0m[1;35mmg_tcpip_free[0m[1;39m([0m[39m&mif[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:  return [0m[1;36m0[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:824[0m[39m-[0m[1;36m830[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m800[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter reviewing the evaluation report and code snippets, I can identify why the [0m    [2m                [0m
[2;36m                    [0m         [39mprevious patch failed and what the actual root cause is:[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why the Previous Patch Failed[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe previous patch attempted to fix the issue by:[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Computing `ip_hlen` at the start of `rx_ip` function[0m                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Using it to position protocol headers correctly[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Removing `mkpay` calls for ICMP and UDP[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mHowever, **the patch missed the critical validation in `mg_tcpip_rx`** that must [0m   [2m                [0m
[2;36m                    [0m         [39moccur BEFORE `mkpay` is called with the IP options offset. The previous patch added[0m [2m                [0m
[2;36m                    [0m         [39mvalidation checks in the IP options handling section [0m[1;39m([0m[39mlines [0m[1;36m891[0m[39m-[0m[1;36m896[0m[1;39m)[0m[39m, but these [0m    [2m                [0m
[2;36m                    [0m         [39mchecks came AFTER the potentially out-of-bounds pointer was already calculated and [0m [2m                [0m
[2;36m                    [0m         [39mpassed to `mkpay`.[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Root Causes Identified[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThere are two interconnected root causes:[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Root Cause #[0m[1;36m1[0m[39m: Missing Bounds Validation in `mg_tcpip_rx` [0m[1;39m([0m[39mlines [0m[1;36m891[0m[39m-[0m[1;36m896[0m[1;39m)[0m[39m**[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe code calculates `[0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[39m` without validating[0m [2m                [0m
[2;36m                    [0m         [39mthat this pointer stays within `pkt.raw.buf[0m[1;39m[[0m[39mpkt.raw.len[0m[1;39m][0m[39m`. When a [0m                  [2m                [0m
[2;36m                    [0m         [39mmalicious/malformed packet claims a large IHL value [0m[1;39m([0m[39me.g., [0m[33mIHL[0m[39m=[0m[1;36m15[0m[39m meaning [0m[1;36m60[0m[39m bytes[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39mbut the actual packet is only [0m[1;36m34[0m[39m bytes [0m[1;39m([0m[1;36m14[0m[39m Ethernet + [0m[1;36m20[0m[39m IP[0m[1;39m)[0m[39m, the pointer [0m          [2m                [0m
[2;36m                    [0m         [39marithmetic produces an out-of-bounds address. When this is passed to `mkpay`, the [0m  [2m                [0m
[2;36m                    [0m         [39msubtraction underflows, producing a huge `pkt->pay.len` value.[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Root Cause #[0m[1;36m2[0m[39m: Incorrect Protocol Header Positioning in `rx_ip`**[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mEven after the previous patch modified `rx_ip` to use `ip_hlen`, the calls to [0m      [2m                [0m
[2;36m                    [0m         [39m`mkpay` were removed for ICMP and UDP. This was incorrect because:[0m                  [2m                [0m
[2;36m                    [0m         [39m- The `pkt->pay` set in `mg_tcpip_rx` points to after the IP header [0m[1;39m([0m[39mincluding [0m     [2m                [0m
[2;36m                    [0m         [39moptions[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- But the protocol-specific payload [0m[1;39m([0m[39mafter ICMP/UDP/TCP headers[0m[1;39m)[0m[39m needs to be [0m       [2m                [0m
[2;36m                    [0m         [39mrecalculated[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m- Removing `mkpay` calls means `pkt->pay` still includes the protocol header itself[0m [2m                [0m
[2;36m                    [0m         [39m- This causes consumers of `pkt->pay` to include protocol headers in the payload [0m   [2m                [0m
[2;36m                    [0m         [39mdata[0m                                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mHowever, the real issue is that these `mkpay` calls should only happen AFTER we [0m    [2m                [0m
[2;36m                    [0m         [39mverify that the protocol header itself fits within the packet.[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Comprehensive Fix Strategy[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m1[0m[39m: Fix `mg_tcpip_rx` - Add Proper IP Header Length Validation[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mIn the `mg_tcpip_rx` function [0m[1;39m([0m[39maround lines [0m[1;36m890[0m[39m-[0m[1;36m896[0m[1;39m)[0m[39m, we need to:[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Calculate IP header length early and validate it:**[0m                            [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   size_t ip_hlen = [0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Validate minimum IHL [0m[1;39m([0m[39mmust be at least [0m[1;36m5[0m[39m for [0m[1;36m20[0m[39m bytes[0m[1;39m)[0m[39m:**[0m                      [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mip_hlen < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                           [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Validate maximum IHL [0m[1;39m([0m[39mmust not exceed [0m[1;36m60[0m[39m bytes[0m[1;39m)[0m[39m:**[0m                             [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mip_hlen > [0m[1;36m60[0m[1;39m)[0m[39m return;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Critical: Validate IP header fits within packet BEFORE using it:**[0m             [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hlen > pkt.raw.len[0m[1;39m)[0m[39m return;[0m                            [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Only then call mkpay with the validated pointer:**[0m                             [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + ip_hlen[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis replaces the conditional IP options handling [0m[1;39m([0m[39mlines [0m[1;36m891[0m[39m-[0m[1;36m894[0m[1;39m)[0m[39m with [0m             [2m                [0m
[2;36m                    [0m         [39munconditional validated IP header length calculation.[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m2[0m[39m: Fix `rx_ip` - Correct Protocol Header Positioning and Payload [0m          [2m                [0m
[2;36m                    [0m         [39mCalculation[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mIn the `rx_ip` function:[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Calculate IP header length at the beginning:**[0m                                 [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   size_t ip_hlen = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m   Note: We can skip validation here since it was already validated in [0m             [2m                [0m
[2;36m                    [0m         [39m`mg_tcpip_rx`.[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Fix fragmented packet handling [0m[1;39m([0m[39mlines [0m[1;36m797[0m[39m-[0m[1;36m798[0m[1;39m)[0m[39m:**[0m                              [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Fix ICMP handling [0m[1;39m([0m[39mline [0m[1;36m802[0m[1;39m)[0m[39m:**[0m                                                [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                   [2m                [0m
[2;36m                    [0m         [39m   [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m MUST recalculate payload after protocol header[0m    [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Fix UDP handling [0m[1;39m([0m[39mline [0m[1;36m807[0m[1;39m)[0m[39m:**[0m                                                 [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                    [2m                [0m
[2;36m                    [0m         [39m   [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m MUST recalculate payload after protocol header[0m     [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Fix TCP handling [0m[1;39m([0m[39mlines [0m[1;36m825[0m[39m, [0m[1;36m829[0m[1;39m)[0m[39m:**[0m                                           [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                    [2m                [0m
[2;36m                    [0m         [39m   [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m   uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [39m   uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip_hlen + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Use [0m      [2m                [0m
[2;36m                    [0m         [39mip_hlen, not sizeof[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Critical Insight: Why `mkpay` Calls Must Be Restored[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe previous patch removed `mkpay` calls for ICMP and UDP [0m[1;39m([0m[39mlines [0m[1;36m804[0m[39m, [0m[1;36m809[0m[1;39m)[0m[39m, which [0m  [2m                [0m
[2;36m                    [0m         [39mwas incorrect. Here's why they're necessary:[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. After `mg_tcpip_rx`, `pkt->pay` points to the start of the protocol data [0m[1;39m([0m[39mafter [0m [2m                [0m
[2;36m                    [0m         [39mIP header + options[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. But the **protocol-specific payload** starts AFTER the protocol header [0m          [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mICMP/UDP/TCP[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. `[0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m` recalculates `pkt->pay` to point after the ICMP [0m     [2m                [0m
[2;36m                    [0m         [39mheader[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Without this call, `pkt->pay.buf` would include the ICMP header in the payload, [0m [2m                [0m
[2;36m                    [0m         [39mwhich is wrong[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe key is that `mkpay` must be called with a pointer that is:[0m                      [2m                [0m
[2;36m                    [0m         [39m- Within bounds [0m[1;39m([0m[39mvalidated[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [39m- Points to the actual start of the payload data[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m3[0m[39m: Validation Order is Critical[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix must ensure validations happen in this order:[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **In `mg_tcpip_rx`:**[0m                                                            [2m                [0m
[2;36m                    [0m         [39m   - Validate Ethernet header fits[0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - Validate base IP header fits [0m[1;39m([0m[1;36m20[0m[39m bytes[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [39m   - Validate IP header length field [0m[1;39m([0m[39mIHL[0m[1;39m)[0m[39m is reasonable[0m                            [2m                [0m
[2;36m                    [0m         [39m   - Validate full IP header [0m[1;39m([0m[39mbase + options[0m[1;39m)[0m[39m fits in packet[0m                        [2m                [0m
[2;36m                    [0m         [39m   - Calculate payload pointer using validated IP header length[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **In `rx_ip`:**[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m   - Use the validated IP header length to position protocol headers[0m                [2m                [0m
[2;36m                    [0m         [39m   - Validate protocol header fits within payload[0m                                   [2m                [0m
[2;36m                    [0m         [39m   - Recalculate payload to point after protocol header[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m4[0m[39m: Preserve Existing Functionality[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix must preserve:[0m                                                              [2m                [0m
[2;36m                    [0m         [39m- Ethernet frame truncation logic [0m[1;39m([0m[39mlines [0m[1;36m885[0m[39m-[0m[1;36m888[0m[1;39m)[0m[39m based on IP length field[0m          [2m                [0m
[2;36m                    [0m         [39m- Fragmentation error handling [0m[1;39m([0m[39mlines [0m[1;36m796[0m[39m-[0m[1;36m800[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [39m- DHCP client/server handling [0m[1;39m([0m[39mlines [0m[1;36m813[0m[39m-[0m[1;36m821[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [39m- TCP options handling [0m[1;39m([0m[39mlines [0m[1;36m828[0m[39m-[0m[1;36m830[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [39m- All protocol-specific validations[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Justification[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis fix strategy is optimal because:[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Addresses the actual root cause:** The missing validation in `mg_tcpip_rx` [0m    [2m                [0m
[2;36m                    [0m         [39mthat allows out-of-bounds pointers to reach `mkpay`[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Fixes the systematic issue:** All protocol handlers in `rx_ip` incorrectly [0m    [2m                [0m
[2;36m                    [0m         [39massume no IP options[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Maintains correctness:** The `mkpay` calls are necessary and must be restored [0m [2m                [0m
[2;36m                    [0m         [39mwith proper pointer positioning[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Validates early:** By validating in `mg_tcpip_rx` before calling `rx_ip`, we [0m  [2m                [0m
[2;36m                    [0m         [39mprevent all downstream issues[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Consistent with RFC [0m[1;36m791[0m[39m:** IPv4 IHL field specifies header length in [0m[1;36m32[0m[39m-bit [0m   [2m                [0m
[2;36m                    [0m         [39mwords, range [0m[1;36m5[0m[39m-[0m[1;36m15[0m[39m [0m[1;39m([0m[1;36m20[0m[39m-[0m[1;36m60[0m[39m bytes[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Preserves existing logic:** The fix doesn't change the overall packet [0m         [2m                [0m
[2;36m                    [0m         [39mprocessing flow, just adds necessary validations and corrects pointer arithmetic[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Potential Side Effects and Mitigation[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Packets with IP options will be properly handled:** Previously, such packets [0m  [2m                [0m
[2;36m                    [0m         [39mwould cause buffer overflows; now they'll be processed correctly[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Invalid packets will be rejected earlier:** Packets with malformed IHL fields [0m [2m                [0m
[2;36m                    [0m         [39mwill be dropped in `mg_tcpip_rx` instead of causing crashes[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **No performance impact:** The validations are simple arithmetic comparisons [0m    [2m                [0m
[2;36m                    [0m         [39mwith negligible overhead[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Fragmented packets:** The fix applies the same corrections to fragmented [0m      [2m                [0m
[2;36m                    [0m         [39mpacket handling for consistency[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Similar Patterns in Codebase[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe TCP handling at lines [0m[1;36m828[0m[39m-[0m[1;36m830[0m[39m already shows awareness of variable header [0m       [2m                [0m
[2;36m                    [0m         [39mlengths for TCP options. The fix applies the same principle to IP options [0m          [2m                [0m
[2;36m                    [0m         [39mconsistently across all protocol handlers.[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/10/26 07:06:46][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=82092;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=262544;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m4[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 07:11:32][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=732326;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=971681;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m4[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 07:12:30][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=694906;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=146665;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m4[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=424546;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=200654;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.86[0m seconds;              ]8;id=902956;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=427890;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 07:12:31][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Started[33m...[0m                            ]8;id=944063;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=87539;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpwqqdgmh7[0m                                                 ]8;id=181359;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=66421;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/10/26 07:12:37][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Took [1;36m6.80[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=217852;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=31047;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Started[33m...[0m                      ]8;id=738209;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=965820;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 07:12:42][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Took [1;36m4.30[0m seconds;             ]8;id=983367;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=751447;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Started[33m...[0m                         ]8;id=636021;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=755859;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 07:12:44][0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=94077;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=592177;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py#102\[2m102[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1581498677[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x559330f98708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x559330f99aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x559330f99aa8[0m[39m,[0m[1;36m0x559330fad448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x559330f1ec02[0m[39m bp [0m[1;36m0x7fffa42158e0[0m[39m sp [0m[1;36m0x7fffa42158d8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x559330f1ec01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x559330f06d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x559330f1b8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x559330d87350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x559330d725c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x559330d7805f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x559330da3302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f94f6c7e082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x559330d6a7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x559330e9311f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x559330f1b79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x559330d87350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x559330d725c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x559330d7805f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x559330da3302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f94f6c7e082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpwluei79b[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=811684;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=146502;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py#103\[2m103[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1581498677[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x559330f98708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x559330f99aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x559330f99aa8[0m[39m,[0m[1;36m0x559330fad448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x559330f1ec02[0m[39m bp [0m[1;36m0x7fffa42158e0[0m[39m sp [0m[1;36m0x7fffa42158d8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x559330f1ec01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x559330f06d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x559330f1b8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x559330d87350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x559330d725c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x559330d7805f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x559330da3302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f94f6c7e082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x559330d6a7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x559330e9311f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x559330f1b79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x559330d87350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x559330d725c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x559330d7805f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x559330da3302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f94f6c7e082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpwluei79b[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [31m╭─[0m[31m──────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m───────────────────────[0m[31m─╮[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/evaluator/services/default/[0m[1m__init__.py[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m :97 in _evaluate_internal                                                        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 94 [0m[2m│   │   [0m[94mwith[0m logging_performance(context, header=[33m"[0m[33mRunning PoV[0m[33m"[0m):           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 95 [0m[2m│   │   │   [0m[94mtry[0m:                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 96 [0m[2m│   │   │   │   [0m[94mif[0m [96mlen[0m(detection.blobs) > [94m0[0m:                               [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 97 [2m│   │   │   │   │   [0menvironment.run_pov(context, detection)                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 98 [0m[2m│   │   │   │   [0m[94melse[0m:                                                      [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 99 [0m[2m│   │   │   │   │   [0mcontext[[33m"[0m[33mlogger[0m[33m"[0m].warning([33m"[0m[33mNo blob data found for the [0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m100 [0m                                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mcached.p[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1my[0m:56 in run_pov                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 53 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, detection: Detection            [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 54 [0m[2m│   [0m) -> [96mtuple[0m[[96mstr[0m, [96mstr[0m]:                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 55 [0m[2m│   │   [0m[94massert[0m [96mlen[0m(detection.blobs) > [94m0[0m, [33m"[0m[33mAt least one blob is required[0m[33m"[0m   [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 56 [2m│   │   [0m[94mreturn[0m [1;4;96mself[0m[1;4m.environment.run_pov(context, detection)[0m                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 57 [0m[2m│   [0m                                                                       [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 58 [0m[2m│   [0m[94mdef[0m[90m [0m[92mrun_tests[0m(                                                         [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 59 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, env: [96mdict[0m[[96mstr[0m, [96mstr[0m] = {}        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mdefault.[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1mpy[0m:210 in run_pov                                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m207 [0m[2m│   │   │   │   [0mcontext, blobinfo.blob, blobinfo.harness_name              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m208 [0m[2m│   │   │   [0m)                                                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m209 [0m[2m│   │   │   [0m[94mif[0m [95mnot[0m success:                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m210 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m ChallengePoVFoundError([0m                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m211 [0m[2m│   │   │   │   │   [0m[1;4mstdout=stdout.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m212 [0m[2m│   │   │   │   │   [0m[1;4mstderr=stderr.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m213 [0m[2m│   │   │   │   [0m[1;4m)[0m                                                          [31m│[0m [2m               [0m
[2;36m                    [0m         [31m╰──────────────────────────────────────────────────────────────────────────────────╯[0m [2m               [0m
[2;36m                    [0m         [1;91mChallengePoVFoundError: [0mPoV found:                                                   [2m               [0m
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1581498677[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x559330f98708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x559330f99aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x559330f99aa8[0m[39m,[0m[1;36m0x559330fad448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x559330f1ec02[0m[39m bp [0m[1;36m0x7fffa42158e0[0m[39m sp [0m[1;36m0x7fffa42158d8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x559330f1ec01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x559330f06d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x559330f1b8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x559330d87350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x559330d725c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x559330d7805f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x559330da3302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f94f6c7e082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x559330d6a7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x559330e9311f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x559330f1b79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x559330d87350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x559330d725c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x559330d7805f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x559330da3302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f94f6c7e082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpwluei79b[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Took [1;36m2.32[0m seconds;                ]8;id=969079;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=397137;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=72305;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=520204;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 07:12:45][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.87[0m seconds;              ]8;id=578046;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=31260;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=459963;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=911466;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 07:12:46][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.98[0m seconds;              ]8;id=245502;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=657270;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=759129;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=840732;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         +++ b/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-792[0m,[1;36m41[0m +[1;36m792[0m,[1;36m51[0m @@                                                               [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          static void [1;35mrx_ip[0m[1m([0mstruct mg_tcpip_if *ifp, struct pkt *pkt[1m)[0m [1m{[0m                      [2m                [0m
[2;36m                    [0m         +  size_t ip_hlen = [1m([0mpkt->ip->ver & [1;36m0xF[0m[1m)[0m * [1;36m4[0m;                                       [2m                [0m
[2;36m                    [0m            uint16_t frag = [1;35mmg_ntohs[0m[1m([0mpkt->ip->frag[1m)[0m;                                         [2m                [0m
[2;36m                    [0m            if [1m([0mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[1m)[0m [1m{[0m                     [2m                [0m
[2;36m                    [0m         -    if [1m([0mpkt->ip->proto == [1;36m17[0m[1m)[0m pkt->udp = [1m([0mstruct udp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;             [2m                [0m
[2;36m                    [0m         -    if [1m([0mpkt->ip->proto == [1;36m6[0m[1m)[0m pkt->tcp = [1m([0mstruct tcp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;              [2m                [0m
[2;36m                    [0m         +    if [1m([0mpkt->ip->proto == [1;36m17[0m[1m)[0m [1m{[0m                                                    [2m                [0m
[2;36m                    [0m         +      pkt->udp = [1m([0mstruct udp *[1m)[0m [1m([0m[1m([0mchar *[1m)[0mpkt->ip + ip_hlen[1m)[0m;                       [2m                [0m
[2;36m                    [0m         +      uint8_t *end = [1m([0muint8_t *[1m)[0m &pkt->raw.buf[1m[[0mpkt->raw.len[1m][0m;                      [2m                [0m
[2;36m                    [0m         +      if [1m([0mend [1m<[0m[39m [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [39m+      pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m+      uint8_t *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [39m+      if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->tcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m     struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m-    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [39m+    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m+    uint8_t *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->icmp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m-    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [39m-    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m+    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m+    uint8_t *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m-    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m        [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m            [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [39m       pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [39m-      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [39m       pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [39m-      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m-    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m+    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m+    uint8_t *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->tcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m-    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m-    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [39m+    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip_hlen + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m        [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m            [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-888[0m[39m,[0m[1;36m10[0m[39m +[0m[1;36m898[0m[39m,[0m[1;36m11[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m    [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m       [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle IPv4 [0m [2m                [0m
[2;36m                    [0m         [39moptions[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m-    else[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+    size_t ip_hlen = [0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mip_hlen < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                         [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mip_hlen > [0m[1;36m60[0m[1;39m)[0m[39m return;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hlen[0m[1;39m)[0m[39m return;[0m                          [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + ip_hlen[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1581498677[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x559330f98708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x559330f99aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x559330f99aa8[0m[39m,[0m[1;36m0x559330fad448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x559330f1ec02[0m[39m bp [0m[1;36m0x7fffa42158e0[0m[39m sp [0m[1;36m0x7fffa42158d8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x559330f1ec01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x559330f06d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x559330f1b8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x559330d87350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x559330d725c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x559330d7805f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x559330da3302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f94f6c7e082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x559330d6a7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x559330e9311f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x559330f1b79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x559330d87350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x559330d725c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x559330d7805f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x559330da3302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f94f6c7e082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpwluei79b[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m258835080[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x561ff01a2708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x561ff01a3aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x561ff01a3aa8[0m[39m,[0m[1;36m0x561ff01b7448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x561ff0128c02[0m[39m bp [0m[1;36m0x7ffc33939220[0m[39m sp [0m[1;36m0x7ffc33939218[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561ff0128c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561ff0110d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561ff01258b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561feff91350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561feff7c5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561feff8205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561feffad302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fec5899b082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561feff747ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561ff009d11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561ff012579d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561feff91350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561feff7c5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561feff8205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561feffad302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fec5899b082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpi8kbb5d5[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m         [39mThe initial issue reports a heap-buffer-overflow vulnerability in the `rx_icmp` [0m    [2m                [0m
[2;36m                    [0m         [39mfunction at line [0m[1;36m385[0m[39m of `src/net_builtin.c`. The AddressSanitizer detected a [0m[1;36m1[0m[39m-byte[0m [2m                [0m
[2;36m                    [0m         [39mread operation attempting to access memory at address `[0m[1;36m0x504000000172[0m[39m`, which is [0m   [2m                [0m
[2;36m                    [0m         [39mlocated [0m[1;36m0[0m[39m bytes after a [0m[1;36m34[0m[39m-byte allocated region. A patch was attempted that [0m       [2m                [0m
[2;36m                    [0m         [39mmodified the `rx_ip` function and the main packet processing logic in `mg_tcpip_rx`[0m [2m                [0m
[2;36m                    [0m         [39mto correctly handle IP header length calculations using the IHL [0m[1;39m([0m[39mInternet Header [0m   [2m                [0m
[2;36m                    [0m         [39mLength[0m[1;39m)[0m[39m field. However, after applying the patch, the identical [0m                    [2m                [0m
[2;36m                    [0m         [39mheap-buffer-overflow error persists at the same location with the same [0m             [2m                [0m
[2;36m                    [0m         [39mcharacteristics.[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Initial Issue Analysis[0m                                                          [2m                [0m
[2;36m                    [0m         [39mThe initial issue manifests as a heap-buffer-overflow error during fuzzing [0m         [2m                [0m
[2;36m                    [0m         [39moperations. Key observations include:[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Error Location**: The overflow occurs in the `rx_icmp` function at line [0m[1;36m385[0m[39m in[0m [2m                [0m
[2;36m                    [0m         [39m`src/net_builtin.c`[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Call Stack**: The error originates from the fuzzer test input [0m                 [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`LLVMFuzzerTestOneInput` in `test/fuzz.[0m[1;92mc:106[0m[39m`[0m[1;39m)[0m[39m → `mg_tcpip_rx` → `rx_ip` [0m[1;39m([0m[39mline [0m    [2m                [0m
[2;36m                    [0m         [1;36m897[0m[1;39m)[0m[39m → `rx_icmp` [0m[1;39m([0m[39mline [0m[1;36m385[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Memory Details**: [0m                                                             [2m                [0m
[2;36m                    [0m         [39m   - A [0m[1;36m1[0m[39m-byte read operation overflows a [0m[1;36m34[0m[39m-byte heap allocation[0m                    [2m                [0m
[2;36m                    [0m         [39m   - The allocated region spans from `[0m[1;36m0x504000000150[0m[39m` to `[0m[1;36m0x504000000172[0m[39m`[0m           [2m                [0m
[2;36m                    [0m         [39m   - The overflow attempts to read at address `[0m[1;36m0x504000000172[0m[39m` [0m[1;39m([0m[39mexactly at the [0m     [2m                [0m
[2;36m                    [0m         [39mboundary[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Allocation Context**: The memory was allocated in the fuzzer harness at [0m       [2m                [0m
[2;36m                    [0m         [39m`test/fuzz.[0m[1;92mc:95[0m[39m`[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Patch Attempt Description[0m                                                       [2m                [0m
[2;36m                    [0m         [39mThe patch attempted to address potential issues with IP header length calculations [0m [2m                [0m
[2;36m                    [0m         [39mby:[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **IP Header Length Calculation**: Introduced a variable `ip_hlen` to explicitly [0m [2m                [0m
[2;36m                    [0m         [39mcalculate the IP header length as `[0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m`, which extracts the [0m   [2m                [0m
[2;36m                    [0m         [39mIHL field from the IP version byte[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Pointer Arithmetic Correction**: Modified all instances where protocol headers[0m [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mICMP, UDP, TCP[0m[1;39m)[0m[39m are located after the IP header, changing from `[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m` to [0m [2m                [0m
[2;36m                    [0m         [39m`[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m` to account for variable-length IP headers with [0m       [2m                [0m
[2;36m                    [0m         [39moptions[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Validation Checks**: Added three validation checks in `mg_tcpip_rx`:[0m           [2m                [0m
[2;36m                    [0m         [39m   - Minimum IHL check: `if [0m[1;39m([0m[39mip_hlen < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;`[0m                    [2m                [0m
[2;36m                    [0m         [39m   - Maximum IHL check: `if [0m[1;39m([0m[39mip_hlen > [0m[1;36m60[0m[1;39m)[0m[39m return;`[0m                                 [2m                [0m
[2;36m                    [0m         [39m   - Truncation check with options: `if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hlen[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39mreturn;`[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Consistent Header Length Usage**: Applied the `ip_hlen` variable throughout [0m   [2m                [0m
[2;36m                    [0m         [39mthe `rx_ip` function for TCP offset calculations[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe specific changes were made at:[0m                                                  [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m795[0m[39m: Added `size_t ip_hlen = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;`[0m                      [2m                [0m
[2;36m                    [0m         [39m- Lines [0m[1;36m798[0m[39m-[0m[1;36m799[0m[39m, [0m[1;36m803[0m[39m, [0m[1;36m808[0m[39m, [0m[1;36m826[0m[39m, [0m[1;36m830[0m[39m: Modified pointer arithmetic for UDP, TCP, and [0m [2m                [0m
[2;36m                    [0m         [39mICMP headers[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m- Lines [0m[1;36m892[0m[39m-[0m[1;36m896[0m[39m: Added validation checks and modified the `mkpay` call in [0m          [2m                [0m
[2;36m                    [0m         [39m`mg_tcpip_rx`[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Patch Result Analysis[0m                                                           [2m                [0m
[2;36m                    [0m         [39mAfter applying the patch, the fuzzing operation produces the identical error:[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Same Error Location**: The heap-buffer-overflow still occurs at `rx_icmp` line[0m [2m                [0m
[2;36m                    [0m         [1;36m385[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Identical Memory Pattern**: The overflow still attempts to read at [0m            [2m                [0m
[2;36m                    [0m         [39m`[0m[1;36m0x504000000172[0m[39m`, which is [0m[1;36m0[0m[39m bytes after the same [0m[1;36m34[0m[39m-byte region[0m                    [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Unchanged Call Stack**: The execution path remains identical: [0m                 [2m                [0m
[2;36m                    [0m         [39m`LLVMFuzzerTestOneInput` → `mg_tcpip_rx` [0m[1;39m([0m[39mline [0m[1;36m897[0m[1;39m)[0m[39m → `rx_icmp` [0m[1;39m([0m[39mline [0m[1;36m385[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Same Root Allocation**: The memory allocation still originates from [0m           [2m                [0m
[2;36m                    [0m         [39m`test/fuzz.[0m[1;92mc:95[0m[39m`[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fact that line numbers remain the same [0m[1;39m([0m[1;36m385[0m[39m for `rx_icmp`, [0m[1;36m897[0m[39m for [0m             [2m                [0m
[2;36m                    [0m         [39m`mg_tcpip_rx`[0m[1;39m)[0m[39m suggests the error location hasn't shifted despite the [0m              [2m                [0m
[2;36m                    [0m         [39mmodifications.[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas Requiring Further Investigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo obtain a holistic view of the issue, the following areas should be investigated:[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **The `rx_icmp` Function [0m[1;39m([0m[39mline [0m[1;36m385[0m[1;39m)[0m[39m**: This is where the actual overflow occurs.[0m [2m                [0m
[2;36m                    [0m         [39mThe function's implementation needs examination to understand what specific [0m        [2m                [0m
[2;36m                    [0m         [39moperation at line [0m[1;36m385[0m[39m causes the out-of-bounds read, particularly how it processes [0m [2m                [0m
[2;36m                    [0m         [39mICMP packet payloads.[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **The `mkpay` Function**: This function is called before `rx_icmp` is invoked [0m   [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mline [0m[1;36m804[0m[39m in the patched code[0m[1;39m)[0m[39m and appears to set up the payload structure. Its [0m    [2m                [0m
[2;36m                    [0m         [39mimplementation should be reviewed to understand how it calculates and validates [0m    [2m                [0m
[2;36m                    [0m         [39mpayload boundaries.[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Packet Structure and Buffer Management**: The `struct pkt` definition and how [0m [2m                [0m
[2;36m                    [0m         [39mthe `pay` [0m[1;39m([0m[39mpayload[0m[1;39m)[0m[39m member is populated needs investigation, as the overflow occurs[0m [2m                [0m
[2;36m                    [0m         [39mwhen accessing packet data.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **ICMP Packet Parsing Logic**: The specific code path in `rx_icmp` at line [0m[1;36m385[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mneeds detailed examination to understand what field or data it's trying to access [0m  [2m                [0m
[2;36m                    [0m         [39mthat exceeds the buffer boundary.[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Input Validation in `mg_tcpip_rx`**: While the patch added some validation [0m    [2m                [0m
[2;36m                    [0m         [39mchecks for IP header length, there may be missing validation for the total packet [0m  [2m                [0m
[2;36m                    [0m         [39mlength versus the available buffer size before protocol-specific handlers are [0m      [2m                [0m
[2;36m                    [0m         [39mcalled.[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **The Fuzzer Harness [0m[1;39m([0m[39m`test/fuzz.[0m[1;92mc:95[0m[39m` and `[0m[1;36m106[0m[39m`[0m[1;39m)[0m[39m**: Understanding how the test [0m [2m                [0m
[2;36m                    [0m         [39minput is constructed and allocated could reveal whether the [0m[1;36m34[0m[39m-byte allocation is [0m  [2m                [0m
[2;36m                    [0m         [39mintentionally small for testing or if there's a size calculation issue.[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. **Interaction Between IP Header Processing and ICMP Payload**: The patch [0m        [2m                [0m
[2;36m                    [0m         [39maddresses IP header length but doesn't appear to affect how the ICMP payload [0m       [2m                [0m
[2;36m                    [0m         [39mboundaries are calculated, which may be the actual source of the overflow.[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m258835080[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x561ff01a2708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x561ff01a3aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x561ff01a3aa8[0m[39m,[0m[1;36m0x561ff01b7448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x561ff0128c02[0m[39m bp [0m[1;36m0x7ffc33939220[0m[39m sp [0m[1;36m0x7ffc33939218[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561ff0128c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561ff0110d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561ff01258b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561feff91350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561feff7c5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561feff8205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561feffad302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fec5899b082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561feff747ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561ff009d11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561ff012579d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561feff91350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561feff7c5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561feff8205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561feffad302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fec5899b082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpi8kbb5d5[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1191115489[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x564bb4406708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x564bb4407aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x564bb4407aa8[0m[39m,[0m[1;36m0x564bb441b448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x564bb438cc02[0m[39m bp [0m[1;36m0x7ffc5fe52700[0m[39m sp [0m[1;36m0x7ffc5fe526f8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x564bb438cc01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x564bb4374d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x564bb43898b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x564bb41f5350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x564bb41e05c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x564bb41e605f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x564bb4211302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f9df3e47082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x564bb41d87ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x564bb430111f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x564bb438979d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x564bb41f5350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x564bb41e05c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x564bb41e605f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x564bb4211302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f9df3e47082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpqxaz0aup[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:129[0m[39m-[0m[1;36m141[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:struct pkt [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:  struct mg_str raw;  [0m[35m/[0m[35m/[0m[39m Raw packet data[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:  struct mg_str pay;  [0m[35m/[0m[35m/[0m[39m Payload data[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:  struct eth *eth;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:  struct llc *llc;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:  struct arp *arp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:  struct ip *ip;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:  struct ip6 *ip6;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:  struct icmp *icmp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:  struct tcp *tcp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:  struct udp *udp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:  struct dhcp *dhcp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:806[0m[39m-[0m[1;36m823[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:824[0m[39m-[0m[1;36m835[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:795[0m[39m-[0m[1;36m800[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:26[0m[39m-[0m[1;36m45[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:#define MIP_TTYPE_ARP [0m[1;36m2[0m[39m        [0m[35m/[0m[35m/[0m[39m ARP resolve sent, waiting for response[0m         [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:#define MIP_TTYPE_SYN [0m[1;36m3[0m[39m        [0m[35m/[0m[35m/[0m[39m SYN sent, waiting for response[0m                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:#define MIP_TTYPE_FIN [0m[1;36m4[0m[39m  [0m[35m/[0m[35m/[0m[39m FIN sent, waiting until terminating the connection[0m   [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:  uint8_t tmiss;         [0m[35m/[0m[35m/[0m[39m Number of keep-alive misses[0m                          [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:  struct mg_iobuf raw;   [0m[35m/[0m[35m/[0m[39m For TLS only. Incoming raw data[0m                      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:  bool fin_rcvd;         [0m[35m/[0m[35m/[0m[39m We have received FIN from the peer[0m                   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:  bool twclosure;        [0m[35m/[0m[35m/[0m[39m [0m[1;36m3[0m[39m-way closure done[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:#pragma [0m[1;35mpack[0m[1;39m([0m[39mpush, [0m[1;36m1[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:struct lcp [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:  uint8_t addr, ctrl, proto[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m, code, id, len[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:struct eth [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:  uint8_t dst[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Destination MAC address[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:  uint8_t src[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Source MAC address[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:  uint16_t type;   [0m[35m/[0m[35m/[0m[39m Ethernet type[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:62[0m[39m-[0m[1;36m70[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:struct ip6 [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:  uint8_t ver;      [0m[35m/[0m[35m/[0m[39m Version[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:  uint8_t opts[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Options[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:  uint16_t len;     [0m[35m/[0m[35m/[0m[39m Length[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:  uint8_t proto;    [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:  uint8_t ttl;      [0m[35m/[0m[35m/[0m[39m Time to live[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:  uint8_t src[0m[1;39m[[0m[1;36m16[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:  uint8_t dst[0m[1;39m[[0m[1;36m16[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:72[0m[39m-[0m[1;36m76[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:struct icmp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  uint8_t type;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint8_t code;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  uint16_t csum;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:398[0m[39m-[0m[1;36m404[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:static void [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:  uint32_t ip = [0m[1;36m0[0m[39m, gw = [0m[1;36m0[0m[39m, mask = [0m[1;36m0[0m[39m, lease = [0m[1;36m0[0m[39m, dns = [0m[1;36m0[0m[39m, sntp = [0m[1;36m0[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:  uint8_t msgtype = [0m[1;36m0[0m[39m, state = ifp->state;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:  [0m[35m/[0m[35m/[0m[39m perform size check first, then access fields[0m                               [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:  uint8_t *p = pkt->dhcp->options,[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:          *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:  if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:459[0m[39m-[0m[1;36m462[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m459[0m[39m:static void [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m460[0m[39m:  uint8_t op = [0m[1;36m0[0m[39m, *p = pkt->dhcp->options,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m461[0m[39m:          *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m462[0m[39m:  if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:78[0m[39m-[0m[1;36m120[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:struct arp [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:  uint16_t fmt;    [0m[35m/[0m[35m/[0m[39m Format of hardware address[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:  uint16_t pro;    [0m[35m/[0m[35m/[0m[39m Format of protocol address[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:  uint8_t hlen;    [0m[35m/[0m[35m/[0m[39m Length of hardware address[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:  uint8_t plen;    [0m[35m/[0m[35m/[0m[39m Length of protocol address[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:  uint16_t op;     [0m[35m/[0m[35m/[0m[39m Operation[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:  uint8_t sha[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Sender hardware address[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:  uint32_t spa;    [0m[35m/[0m[35m/[0m[39m Sender protocol address[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:  uint8_t tha[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Target hardware address[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:  uint32_t tpa;    [0m[35m/[0m[35m/[0m[39m Target protocol address[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:struct tcp [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:  uint16_t sport;  [0m[35m/[0m[35m/[0m[39m Source port[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:  uint16_t dport;  [0m[35m/[0m[35m/[0m[39m Destination port[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:  uint32_t seq;    [0m[35m/[0m[35m/[0m[39m Sequence number[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:  uint32_t ack;    [0m[35m/[0m[35m/[0m[39m Acknowledgement number[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:  uint8_t off;     [0m[35m/[0m[35m/[0m[39m Data offset[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:  uint8_t flags;   [0m[35m/[0m[35m/[0m[39m TCP flags[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:#define TH_FIN [0m[1;36m0x01[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:#define TH_SYN [0m[1;36m0x02[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:#define TH_RST [0m[1;36m0x04[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:#define TH_PUSH [0m[1;36m0x08[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:#define TH_ACK [0m[1;36m0x10[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:#define TH_URG [0m[1;36m0x20[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:#define TH_ECE [0m[1;36m0x40[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:#define TH_CWR [0m[1;36m0x80[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:  uint16_t win;   [0m[35m/[0m[35m/[0m[39m Window[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:  uint16_t urp;   [0m[35m/[0m[35m/[0m[39m Urgent pointer[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:struct udp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:  uint16_t sport;  [0m[35m/[0m[35m/[0m[39m Source port[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:  uint16_t dport;  [0m[35m/[0m[35m/[0m[39m Destination port[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:  uint16_t len;    [0m[35m/[0m[35m/[0m[39m UDP length[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:  uint16_t csum;   [0m[35m/[0m[35m/[0m[39m UDP checksum[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:struct dhcp [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:  uint8_t op, htype, hlen, hops;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:  uint32_t xid;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:  uint16_t secs, flags;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:654[0m[39m-[0m[1;36m709[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m654[0m[39m:    long n = [0m[1;35mmg_tls_recv[0m[1;39m([0m[39mc, &io->buf[0m[1;39m[[0m[39mio->len[0m[1;39m][0m[39m, io->size - io->len[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m655[0m[39m:    if [0m[1;39m([0m[39mn == MG_IO_ERR[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m656[0m[39m:      [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"TLS recv error"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m657[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mn > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m658[0m[39m:      [0m[35m/[0m[35m/[0m[39m Decrypted successfully - trigger MG_EV_READ[0m                            [2m                [0m
[2;36m                    [0m         [1;36m659[0m[39m:      io->len += [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m n;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m660[0m[39m:      [0m[1;35mmg_call[0m[1;39m([0m[39mc, MG_EV_READ, &n[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m661[0m[39m:    [0m[1;39m}[0m[39m  [0m[35m/[0m[35m/[0m[39m else n < [0m[1;36m0[0m[39m: outstanding data to be moved to c->recv[0m                   [2m                [0m
[2;36m                    [0m         [1;36m662[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m663[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m664[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m665[0m[39m:static void [0m[1;35mread_conn[0m[1;39m([0m[39mstruct mg_connection *c, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m666[0m[39m:  struct connstate *s = [0m[1;39m([0m[39mstruct connstate *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mc + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m667[0m[39m:  struct mg_iobuf *io = c->is_tls ? &c->rtls : &c->recv;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m668[0m[39m:  uint32_t seq = [0m[1;35mmg_ntohl[0m[1;39m([0m[39mpkt->tcp->seq[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m669[0m[39m:  uint32_t rem_ip;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m670[0m[39m:  [0m[1;35mmemcpy[0m[1;39m([0m[39m&rem_ip, c->rem.ip, [0m[1;35msizeof[0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m671[0m[39m:  if [0m[1;39m([0m[39mpkt->tcp->flags & TH_FIN[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m672[0m[39m:    [0m[35m/[0m[35m/[0m[39m If we initiated the closure, we reply with ACK upon receiving FIN[0m        [2m                [0m
[2;36m                    [0m         [1;36m673[0m[39m:    [0m[35m/[0m[35m/[0m[39m If we didn't initiate it, we reply with FIN as part of the normal TCP[0m    [2m                [0m
[2;36m                    [0m         [1;36m674[0m[39m:    [0m[35m/[0m[35m/[0m[39m closure process[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m675[0m[39m:    uint8_t flags = TH_ACK;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m676[0m[39m:    s->ack = [0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35mmg_htonl[0m[1;39m([0m[39mpkt->tcp->seq[0m[1;39m)[0m[39m + pkt->pay.len + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m677[0m[39m:    s->fin_rcvd = true;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m678[0m[39m:    if [0m[1;39m([0m[39mc->is_draining && s->ttype == MIP_TTYPE_FIN[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m679[0m[39m:      if [0m[1;39m([0m[39ms->seq == [0m[1;35mmg_htonl[0m[1;39m([0m[39mpkt->tcp->ack[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m  [0m[35m/[0m[35m/[0m[39m Simultaneous closure ?[0m       [2m                [0m
[2;36m                    [0m         [1;36m680[0m[39m:        s->seq++;                               [0m[35m/[0m[35m/[0m[39m Yes. Increment our SEQ[0m       [2m                [0m
[2;36m                    [0m         [1;36m681[0m[39m:      [0m[1;39m}[0m[39m else [0m[1;39m{[0m[39m                                  [0m[35m/[0m[35m/[0m[39m Otherwise,[0m                   [2m                [0m
[2;36m                    [0m         [1;36m682[0m[39m:        s->seq = [0m[1;35mmg_htonl[0m[1;39m([0m[39mpkt->tcp->ack[0m[1;39m)[0m[39m;       [0m[35m/[0m[35m/[0m[39m Set to peer's ACK[0m            [2m                [0m
[2;36m                    [0m         [1;36m683[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m684[0m[39m:      s->twclosure = true;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m685[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m686[0m[39m:      flags |= TH_FIN;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m687[0m[39m:      c->is_draining = [0m[1;36m1[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m688[0m[39m:      [0m[1;35msettmout[0m[1;39m([0m[39mc, MIP_TTYPE_FIN[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m689[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m690[0m[39m:    [0m[1;35mtx_tcp[0m[1;39m([0m[39mc->mgr->ifp, s->mac, rem_ip, flags, c->loc.port, c->rem.port,[0m        [2m                [0m
[2;36m                    [0m         [1;36m691[0m[39m:           [0m[1;35mmg_htonl[0m[1;39m([0m[39ms->seq[0m[1;39m)[0m[39m, [0m[1;35mmg_htonl[0m[1;39m([0m[39ms->ack[0m[1;39m)[0m[39m, [0m[32m""[0m[39m, [0m[1;36m0[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m692[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->pay.len == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m  [0m[35m/[0m[35m/[0m[39m this is an ACK[0m                            [2m                [0m
[2;36m                    [0m         [1;36m693[0m[39m:    if [0m[1;39m([0m[39ms->fin_rcvd && s->ttype == MIP_TTYPE_FIN[0m[1;39m)[0m[39m s->twclosure = true;[0m          [2m                [0m
[2;36m                    [0m         [1;36m694[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mseq != s->ack[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m695[0m[39m:    uint32_t ack = [0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35mmg_htonl[0m[1;39m([0m[39mpkt->tcp->seq[0m[1;39m)[0m[39m + pkt->pay.len[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m696[0m[39m:    if [0m[1;39m([0m[39ms->ack == ack[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m697[0m[39m:      [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"ignoring duplicate pkt"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m698[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m699[0m[39m:      [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"SEQ != ACK: %x %x %x"[0m[39m, seq, s->ack, ack[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m700[0m[39m:      [0m[1;35mtx_tcp[0m[1;39m([0m[39mc->mgr->ifp, s->mac, rem_ip, TH_ACK, c->loc.port, c->rem.port,[0m     [2m                [0m
[2;36m                    [0m         [1;36m701[0m[39m:             [0m[1;35mmg_htonl[0m[1;39m([0m[39ms->seq[0m[1;39m)[0m[39m, [0m[1;35mmg_htonl[0m[1;39m([0m[39ms->ack[0m[1;39m)[0m[39m, [0m[32m""[0m[39m, [0m[1;36m0[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m702[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m703[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mio->size - io->len < pkt->pay.len &&[0m                               [2m                [0m
[2;36m                    [0m         [1;36m704[0m[39m:             ![0m[1;35mmg_iobuf_resize[0m[1;39m([0m[39mio, io->len + pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m705[0m[39m:    [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"oom"[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m706[0m[39m:  [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m707[0m[39m:    [0m[35m/[0m[35m/[0m[39m Copy TCP payload into the IO buffer. If the connection is plain text,[0m    [2m                [0m
[2;36m                    [0m         [1;36m708[0m[39m:    [0m[35m/[0m[35m/[0m[39m we copy to c->recv. If the connection is TLS, this data is encrypted,[0m    [2m                [0m
[2;36m                    [0m         [1;36m709[0m[39m:    [0m[35m/[0m[35m/[0m[39m therefore we copy that encrypted data to the c->rtls iobuffer instead,[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:26[0m[39m-[0m[1;36m45[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:#define MIP_TTYPE_ARP [0m[1;36m2[0m[39m        [0m[35m/[0m[35m/[0m[39m ARP resolve sent, waiting for response[0m         [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:#define MIP_TTYPE_SYN [0m[1;36m3[0m[39m        [0m[35m/[0m[35m/[0m[39m SYN sent, waiting for response[0m                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:#define MIP_TTYPE_FIN [0m[1;36m4[0m[39m  [0m[35m/[0m[35m/[0m[39m FIN sent, waiting until terminating the connection[0m   [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:  uint8_t tmiss;         [0m[35m/[0m[35m/[0m[39m Number of keep-alive misses[0m                          [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:  struct mg_iobuf raw;   [0m[35m/[0m[35m/[0m[39m For TLS only. Incoming raw data[0m                      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:  bool fin_rcvd;         [0m[35m/[0m[35m/[0m[39m We have received FIN from the peer[0m                   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:  bool twclosure;        [0m[35m/[0m[35m/[0m[39m [0m[1;36m3[0m[39m-way closure done[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:#pragma [0m[1;35mpack[0m[1;39m([0m[39mpush, [0m[1;36m1[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:struct lcp [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:  uint8_t addr, ctrl, proto[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m, code, id, len[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:struct eth [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:  uint8_t dst[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Destination MAC address[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:  uint8_t src[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Source MAC address[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:  uint16_t type;   [0m[35m/[0m[35m/[0m[39m Ethernet type[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:854[0m[39m-[0m[1;36m900[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m854[0m[39m:void [0m[1;35mmg_tcpip_rx[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, void *buf, size_t len[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m855[0m[39m:  struct pkt pkt;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m856[0m[39m:  [0m[1;35mmemset[0m[1;39m([0m[39m&pkt, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mpkt[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m857[0m[39m:  pkt.raw.buf = [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m buf;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m858[0m[39m:  pkt.raw.len = len;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m859[0m[39m:  pkt.eth = [0m[1;39m([0m[39mstruct eth *[0m[1;39m)[0m[39m buf;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m860[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_hexdump[0m[1;39m([0m[39mbuf, len > [0m[1;36m16[0m[39m ? [0m[1;36m16[0m[39m: len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m861[0m[39m:  if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated - runt?[0m             [2m                [0m
[2;36m                    [0m         [1;36m862[0m[39m:  if [0m[1;39m([0m[39mifp->enable_mac_check &&[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m863[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, ifp->mac, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[39m &&[0m              [2m                [0m
[2;36m                    [0m         [1;36m864[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, broadcast, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m865[0m[39m:    return;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m866[0m[39m:  if [0m[1;39m([0m[39mifp->enable_crc32_check && len > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m867[0m[39m:    len -= [0m[1;36m4[0m[39m;  [0m[35m/[0m[35m/[0m[39m [0m[1;35mTODO[0m[1;39m([0m[39mscaprile[0m[1;39m)[0m[39m: check on bigendian[0m                            [2m                [0m
[2;36m                    [0m         [1;36m868[0m[39m:    uint32_t crc = [0m[1;35mmg_crc32[0m[1;39m([0m[1;36m0[0m[39m, [0m[1;39m([0m[39mconst char *[0m[1;39m)[0m[39m buf, len[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m869[0m[39m:    if [0m[1;39m([0m[1;35mmemcmp[0m[1;39m([0m[1;39m([0m[39mvoid *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m buf + len[0m[1;39m)[0m[39m, &crc, [0m[1;35msizeof[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m return;[0m       [2m                [0m
[2;36m                    [0m         [1;36m870[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m871[0m[39m:  if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x806[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m872[0m[39m:    pkt.arp = [0m[1;39m([0m[39mstruct arp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m873[0m[39m:    if [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.arp[0m[1;39m)[0m[39m > pkt.raw.len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m874[0m[39m:    [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mifp, MG_TCPIP_EV_ARP, &pkt.raw[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m875[0m[39m:    [0m[1;35mrx_arp[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m876[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x86dd[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m877[0m[39m:    pkt.ip6 = [0m[1;39m([0m[39mstruct ip6 *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m878[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip6[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m879[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip6->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m0x6[0m[1;39m)[0m[39m return;                         [0m[35m/[0m[35m/[0m[39m Not IP[0m   [2m                [0m
[2;36m                    [0m         [1;36m880[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m881[0m[39m:    [0m[1;35mrx_ip6[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m897[0m[39m:  [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m898[0m[39m:    [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"Unknown eth type %x"[0m[39m, [0m[1;35mmg_htons[0m[1;39m([0m[39mpkt.eth->type[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m899[0m[39m:    if [0m[1;39m([0m[39mmg_log_level >= MG_LL_VERBOSE[0m[1;39m)[0m[39m [0m[1;35mmg_hexdump[0m[1;39m([0m[39mbuf, len >= [0m[1;36m32[0m[39m ? [0m[1;36m32[0m[39m : len[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m900[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtest/fuzz.[0m[1;92mc:85[0m[39m-[0m[1;36m120[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:  if [0m[1;39m([0m[39msize > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    struct mg_tcpip_if mif = [0m[1;39m{[0m[39m.ip = [0m[1;36m0x01020304[0m[39m,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                              .mask = [0m[1;36m255[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                              .gw = [0m[1;36m0x01010101[0m[39m,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                              .driver = &mg_tcpip_driver_mock[0m[1;39m}[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    struct mg_mgr mgr;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    [0m[1;35mmg_mgr_init[0m[1;39m([0m[39m&mgr[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    [0m[1;35mmg_tcpip_init[0m[1;39m([0m[39m&mgr, &mif[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[35m/[0m[35m/[0m[39m Make a copy of the random data, in order to modify it[0m                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    void *pkt = [0m[1;35mmalloc[0m[1;39m([0m[39msize[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    struct eth *eth = [0m[1;39m([0m[39mstruct eth *[0m[1;39m)[0m[39m pkt;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39mpkt, data, size[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    if [0m[1;39m([0m[39msize > [0m[1;35msizeof[0m[1;39m([0m[39m*eth[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:      static size_t i;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:      uint16_t eth_types[0m[1;39m[[0m[1;39m][0m[39m = [0m[1;39m{[0m[1;36m0x800[0m[39m, [0m[1;36m0x800[0m[39m, [0m[1;36m0x806[0m[39m, [0m[1;36m0x86dd[0m[1;39m}[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39meth->dst, mif.mac, [0m[1;36m6[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Set valid destination MAC[0m               [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:      eth->type = [0m[1;35mmg_htons[0m[1;39m([0m[39meth_types[0m[1;39m[[0m[39mi++[0m[1;39m][0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:      if [0m[1;39m([0m[39mi >= [0m[1;35msizeof[0m[1;39m([0m[39meth_types[0m[1;39m)[0m[39m [0m[35m/[0m[39m [0m[1;35msizeof[0m[1;39m([0m[39meth_types[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[1;39m)[0m[39m i = [0m[1;36m0[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:    [0m[1;35mmg_tcpip_rx[0m[1;39m([0m[39m&mif, pkt, size[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    [0m[35m/[0m[35m/[0m[39m Test HTTP serving[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    const char *url = [0m[32m"http://localhost:12345"[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    struct mg_connection *c = [0m[1;35mmg_http_connect[0m[1;39m([0m[39m&mgr, url, fn, NULL[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    [0m[1;35mmg_iobuf_add[0m[1;39m([0m[39m&c->recv, [0m[1;36m0[0m[39m, data, size[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    c->[0m[1;35mpfn[0m[1;39m([0m[39mc, MG_EV_READ, NULL[0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m manually invoke protocol event handler[0m      [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    [0m[1;35mmg_mgr_free[0m[1;39m([0m[39m&mgr[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    [0m[1;35mfree[0m[1;39m([0m[39mpkt[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:    [0m[1;35mmg_tcpip_free[0m[1;39m([0m[39m&mif[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:  return [0m[1;36m0[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:398[0m[39m-[0m[1;36m404[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:static void [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:  uint32_t ip = [0m[1;36m0[0m[39m, gw = [0m[1;36m0[0m[39m, mask = [0m[1;36m0[0m[39m, lease = [0m[1;36m0[0m[39m, dns = [0m[1;36m0[0m[39m, sntp = [0m[1;36m0[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:  uint8_t msgtype = [0m[1;36m0[0m[39m, state = ifp->state;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:  [0m[35m/[0m[35m/[0m[39m perform size check first, then access fields[0m                               [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:  uint8_t *p = pkt->dhcp->options,[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:          *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:  if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:459[0m[39m-[0m[1;36m462[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m459[0m[39m:static void [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m460[0m[39m:  uint8_t op = [0m[1;36m0[0m[39m, *p = pkt->dhcp->options,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m461[0m[39m:          *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m462[0m[39m:  if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:824[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:884[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:891[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis of the Issue[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter analyzing the evaluation report and code snippets, I've identified the root [0m  [2m                [0m
[2;36m                    [0m         [39mcause of the persistent heap-buffer-overflow:[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Root Cause[0m                                                                      [2m                [0m
[2;36m                    [0m         [39mThe previous patch attempted to fix IP header length calculations in `mg_tcpip_rx` [0m [2m                [0m
[2;36m                    [0m         [39mand used `ip_hlen` for pointer arithmetic in `rx_ip`. However, the patch **failed [0m  [2m                [0m
[2;36m                    [0m         [39mto add critical bounds validation** before accessing protocol header fields. The [0m   [2m                [0m
[2;36m                    [0m         [39mcrash occurs at line [0m[1;36m384[0m[39m in `rx_icmp` when accessing `pkt->icmp->type` because:[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. When a [0m[1;36m34[0m[39m-byte packet arrives [0m[1;39m([0m[1;36m14[0m[39m bytes Ethernet + [0m[1;36m20[0m[39m bytes IP[0m[1;39m)[0m[39m, and the IP [0m     [2m                [0m
[2;36m                    [0m         [39mheader claims to have options [0m[1;39m([0m[39mIHL > [0m[1;36m5[0m[1;39m)[0m[39m, the ICMP pointer is positioned at the [0m     [2m                [0m
[2;36m                    [0m         [39mbuffer boundary[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Even though the previous patch corrected the pointer arithmetic to use [0m          [2m                [0m
[2;36m                    [0m         [39m`ip_hlen`, it didn't validate that the protocol header actually fits within the [0m    [2m                [0m
[2;36m                    [0m         [39mbuffer before dereferencing it[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. The check at line [0m[1;36m803[0m[39m [0m[1;39m([0m[39m`if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;`[0m[1;39m)[0m[39m uses [0m   [2m                [0m
[2;36m                    [0m         [39mthe correctly calculated `pkt->pay.len` from `mg_tcpip_rx`, but this happens AFTER [0m [2m                [0m
[2;36m                    [0m         [39mline [0m[1;36m802[0m[39m sets `pkt->icmp`, so accessing any field of `pkt->icmp` before this check [0m [2m                [0m
[2;36m                    [0m         [39mcauses the overflow[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. The crash at line [0m[1;36m384[0m[39m [0m[1;39m([0m[39m`pkt->icmp->type`[0m[1;39m)[0m[39m occurs because this field access [0m      [2m                [0m
[2;36m                    [0m         [39mhappens before any validation that the ICMP structure actually exists within the [0m   [2m                [0m
[2;36m                    [0m         [39mbuffer[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why the Previous Patch Failed[0m                                                   [2m                [0m
[2;36m                    [0m         [39mThe previous patch fixed the pointer arithmetic but didn't follow the defensive [0m    [2m                [0m
[2;36m                    [0m         [39mprogramming pattern used in the DHCP handlers [0m[1;39m([0m[39m`rx_dhcp_client` and [0m                [2m                [0m
[2;36m                    [0m         [39m`rx_dhcp_server`[0m[1;39m)[0m[39m, which validate that structures are within bounds BEFORE [0m         [2m                [0m
[2;36m                    [0m         [39maccessing any fields.[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Comprehensive Fix Strategy[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m1[0m[39m. Add Bounds Validation in `rx_ip` Function [0m[1;39m([0m[39mLines [0m[1;36m795[0m[39m-[0m[1;36m836[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mFor each protocol handler block [0m[1;39m([0m[39mICMP, UDP, TCP, fragmentation[0m[1;39m)[0m[39m, add bounds [0m        [2m                [0m
[2;36m                    [0m         [39mvalidation IMMEDIATELY after positioning the protocol header pointer and BEFORE [0m    [2m                [0m
[2;36m                    [0m         [39maccessing any fields:[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Pattern to Apply:**[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m After: pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Add: Bounds check[0m                                                                [2m                [0m
[2;36m                    [0m         [39muint8_t *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->icmp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis check ensures that the entire protocol header structure fits within the raw [0m   [2m                [0m
[2;36m                    [0m         [39mbuffer before any field [0m[1;39m([0m[39mlike `type`, `sport`, `dport`[0m[1;39m)[0m[39m is accessed.[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Specific locations requiring bounds validation:**[0m                                 [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m802[0m[39m: After positioning `pkt->icmp`, add bounds check BEFORE line [0m[1;36m803[0m         [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m807[0m[39m: After positioning `pkt->udp`, add bounds check BEFORE line [0m[1;36m808[0m          [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m825[0m[39m: After positioning `pkt->tcp`, add bounds check BEFORE line [0m[1;36m826[0m          [2m                [0m
[2;36m                    [0m         [39m- Lines [0m[1;36m797[0m[39m-[0m[1;36m798[0m[39m: After positioning fragmented UDP/TCP, add bounds checks[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m2[0m[39m. Fix Remaining Issues with IP Header Length Calculation[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe previous patch already introduced `ip_hlen` calculation, but line [0m[1;36m829[0m[39m in the [0m   [2m                [0m
[2;36m                    [0m         [39mTCP handler still uses `[0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m`:[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**At line [0m[1;36m829[0m[39m, change:**[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39muint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**To:**[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39muint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip_hlen + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis ensures TCP payload length calculation accounts for IP options.[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m3[0m[39m. Remove Redundant `mkpay` Calls in `rx_ip`[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe previous patch already modified `mg_tcpip_rx` to correctly set up `pkt.pay` [0m    [2m                [0m
[2;36m                    [0m         [39maccounting for IP options. The `mkpay` calls in `rx_ip` at lines [0m[1;36m804[0m[39m, [0m[1;36m809[0m[39m, [0m[1;36m815[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m, and [0m[1;36m827[0m[39m should be **removed** because:[0m                                         [2m                [0m
[2;36m                    [0m         [39m- They recalculate the payload using protocol header pointers that have already [0m    [2m                [0m
[2;36m                    [0m         [39mbeen validated[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m- The payload was correctly set up in `mg_tcpip_rx` before calling `rx_ip`[0m          [2m                [0m
[2;36m                    [0m         [39m- These calls are redundant and can cause issues if protocol headers are at unusual[0m [2m                [0m
[2;36m                    [0m         [39mpositions[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Remove these lines:**[0m                                                             [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m804[0m[39m: `[0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;`[0m                                            [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m809[0m[39m: `[0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;`[0m                                             [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m815[0m[39m: `[0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;`[0m                                            [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m819[0m[39m: `[0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;`[0m                                            [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m827[0m[39m: `[0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;`[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m4[0m[39m. Reapply and Extend Previous Patch Validations in `mg_tcpip_rx`[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe previous patch added validation checks at lines [0m[1;36m892[0m[39m-[0m[1;36m896[0m[39m. Ensure these remain [0m   [2m                [0m
[2;36m                    [0m         [39mand add one more check:[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**After calculating `ip_hlen` at line [0m[1;36m894[0m[39m [0m[1;39m([0m[39min previous patch[0m[1;39m)[0m[39m, add:**[0m               [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hlen[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Ensure IP header with [0m    [2m                [0m
[2;36m                    [0m         [39moptions fits[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis was already in the previous patch, so ensure it's preserved.[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m5[0m[39m. Fix DHCP Handler Positioning[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe DHCP handlers at lines [0m[1;36m814[0m[39m and [0m[1;36m818[0m[39m position `pkt->dhcp` as `[0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m`. This is correct ONLY if we've already validated that `pkt->udp` is[0m [2m                [0m
[2;36m                    [0m         [39mcorrectly positioned and within bounds. Since we're now adding bounds validation [0m   [2m                [0m
[2;36m                    [0m         [39mfor UDP, this should work correctly. However, we should also validate DHCP pointer [0m [2m                [0m
[2;36m                    [0m         [39mbefore the existing checks at lines [0m[1;36m404[0m[39m and [0m[1;36m462[0m[39m.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Actually, the existing DHCP bounds checks are already correct** - they validate [0m  [2m                [0m
[2;36m                    [0m         [39mat lines [0m[1;36m404[0m[39m and [0m[1;36m462[0m[39m:[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mSo no changes needed for DHCP handlers themselves.[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Implementation Steps [0m[1;39m([0m[39mFrom Initial Codebase[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m1[0m[39m: Modify `rx_ip` Function [0m[1;39m([0m[39mStarting at Line [0m[1;36m792[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **At line [0m[1;36m795[0m[39m, add IP header length calculation:**[0m                               [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [39m     size_t ip_hlen = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [39m     uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **At lines [0m[1;36m797[0m[39m-[0m[1;36m800[0m[39m [0m[1;39m([0m[39mfragmentation handling[0m[1;39m)[0m[39m, update:**[0m                           [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [39m       pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m       uint8_t *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [39m       if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [39m       pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m       uint8_t *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [39m       if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->tcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m     struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **At lines [0m[1;36m801[0m[39m-[0m[1;36m805[0m[39m [0m[1;39m([0m[39mICMP handling[0m[1;39m)[0m[39m, update:**[0m                                    [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m     pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m     uint8_t *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->icmp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   **Note: Remove the `[0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;` call that was at line [0m[1;36m804[0m[39m**[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **At lines [0m[1;36m806[0m[39m-[0m[1;36m823[0m[39m [0m[1;39m([0m[39mUDP handling[0m[1;39m)[0m[39m, update:**[0m                                     [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [39m     pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m     uint8_t *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m        [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m            [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [39m       pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [39m       pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   **Note: Remove all `mkpay` calls that were at lines [0m[1;36m809[0m[39m, [0m[1;36m815[0m[39m, and [0m[1;36m819[0m[39m**[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **At lines [0m[1;36m824[0m[39m-[0m[1;36m835[0m[39m [0m[1;39m([0m[39mTCP handling[0m[1;39m)[0m[39m, update:**[0m                                     [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m     pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m     uint8_t *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->tcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m     uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip_hlen + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m        [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m            [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   **Note: Remove the `[0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;` call and fix line [0m[1;36m829[0m[39m to use [0m     [2m                [0m
[2;36m                    [0m         [39m`ip_hlen`**[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m2[0m[39m: Keep Previous Patch Changes in `mg_tcpip_rx` [0m[1;39m([0m[39mLines [0m[1;36m888[0m[39m-[0m[1;36m896[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mEnsure the previous patch's changes to `mg_tcpip_rx` are preserved:[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m         [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m            [2m                [0m
[2;36m                    [0m         [39msize_t ip_hlen = [0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mip_hlen < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m IHL must be at least [0m[1;36m5[0m[39m [0m[1;39m([0m[1;36m20[0m[39m bytes[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mip_hlen > [0m[1;36m60[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Maximum IP header length is [0m[1;36m60[0m[39m bytes[0m                  [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hlen[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated with options[0m    [2m                [0m
[2;36m                    [0m         [1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + ip_hlen[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Justification[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This is the Optimal Approach[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Follows Existing Pattern:** The DHCP handlers already demonstrate the correct [0m [2m                [0m
[2;36m                    [0m         [39mbounds validation pattern. This fix applies the same pattern consistently to all [0m   [2m                [0m
[2;36m                    [0m         [39mprotocol handlers.[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Defense in Depth:** Adds validation at multiple levels:[0m                        [2m                [0m
[2;36m                    [0m         [39m   - `mg_tcpip_rx` validates IP header length and ensures it fits[0m                   [2m                [0m
[2;36m                    [0m         [39m   - `rx_ip` validates each protocol header fits before accessing fields[0m            [2m                [0m
[2;36m                    [0m         [39m   - Existing checks for payload length remain as additional safety[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Minimal Code Changes:** Builds on the previous patch's correct pointer [0m        [2m                [0m
[2;36m                    [0m         [39marithmetic, only adding missing bounds checks and removing redundant operations.[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Preserves Existing Logic:** [0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - Keeps all existing validation checks[0m                                           [2m                [0m
[2;36m                    [0m         [39m   - Maintains the same protocol handling flow[0m                                      [2m                [0m
[2;36m                    [0m         [39m   - Doesn't alter the fundamental packet processing design[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Addresses the Issue[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Prevents the Crash:** The bounds check `if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->icmp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39mreturn;` inserted BEFORE line [0m[1;36m384[0m[39m's `pkt->icmp->type` access prevents reading [0m      [2m                [0m
[2;36m                    [0m         [39mbeyond the buffer boundary.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Handles All Edge Cases:**[0m                                                      [2m                [0m
[2;36m                    [0m         [39m   - [0m[1;36m34[0m[39m-byte packets with no protocol data[0m                                          [2m                [0m
[2;36m                    [0m         [39m   - IP packets with options but insufficient space[0m                                 [2m                [0m
[2;36m                    [0m         [39m   - Malformed packets with inconsistent length fields[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Fixes All Affected Protocols:** ICMP, UDP, TCP, and fragmentation handling all[0m [2m                [0m
[2;36m                    [0m         [39mreceive the same treatment.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Potential Side Effects and Mitigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **More Aggressive Packet Rejection:** Malformed packets will be dropped earlier.[0m [2m                [0m
[2;36m                    [0m         [39mThis is desired behavior for security.[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **No Impact on Valid Packets:** Valid packets that previously worked will [0m       [2m                [0m
[2;36m                    [0m         [39mcontinue to work because they already had sufficient space for headers.[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Performance Impact:** Minimal - only adds a few pointer comparisons per [0m       [2m                [0m
[2;36m                    [0m         [39mpacket, which are negligible compared to existing processing.[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Similar Solutions in Codebase[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe DHCP handler bounds checks at lines [0m[1;36m404[0m[39m and [0m[1;36m462[0m[39m demonstrate this pattern is [0m    [2m                [0m
[2;36m                    [0m         [39malready accepted and used in the codebase. This fix simply extends it to all [0m       [2m                [0m
[2;36m                    [0m         [39mprotocol handlers for consistency and safety.[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/10/26 07:13:15][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=153621;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=490651;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m5[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 07:17:54][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=606636;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=706432;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m5[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 07:21:48][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=279671;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=834394;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m5[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=96199;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=763602;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.88[0m seconds;              ]8;id=602737;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=143723;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 07:21:49][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Started[33m...[0m                            ]8;id=159187;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=192774;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp_9p8sfm8[0m                                                 ]8;id=519618;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=816049;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/10/26 07:21:56][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Took [1;36m6.92[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=851796;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=944383;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Started[33m...[0m                      ]8;id=196662;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=216587;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 07:22:00][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Took [1;36m4.30[0m seconds;             ]8;id=945738;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=173488;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Started[33m...[0m                         ]8;id=362341;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=737883;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 07:22:02][0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=826895;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=770623;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py#102\[2m102[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2139722723[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x562e2172f708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x562e21730aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x562e21730aa8[0m[39m,[0m[1;36m0x562e21744448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x562e216b5c02[0m[39m bp [0m[1;36m0x7fff032c9e00[0m[39m sp [0m[1;36m0x7fff032c9df8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x562e216b5c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x562e2169dd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x562e216b28b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x562e2151e350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x562e215095c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x562e2150f05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x562e2153a302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f46b7fef082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x562e215017ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x562e2162a11f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x562e216b279d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x562e2151e350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x562e215095c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x562e2150f05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x562e2153a302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f46b7fef082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpr_77npiq[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=762188;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=200771;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py#103\[2m103[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2139722723[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x562e2172f708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x562e21730aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x562e21730aa8[0m[39m,[0m[1;36m0x562e21744448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x562e216b5c02[0m[39m bp [0m[1;36m0x7fff032c9e00[0m[39m sp [0m[1;36m0x7fff032c9df8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x562e216b5c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x562e2169dd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x562e216b28b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x562e2151e350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x562e215095c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x562e2150f05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x562e2153a302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f46b7fef082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x562e215017ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x562e2162a11f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x562e216b279d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x562e2151e350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x562e215095c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x562e2150f05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x562e2153a302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f46b7fef082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpr_77npiq[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [31m╭─[0m[31m──────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m───────────────────────[0m[31m─╮[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/evaluator/services/default/[0m[1m__init__.py[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m :97 in _evaluate_internal                                                        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 94 [0m[2m│   │   [0m[94mwith[0m logging_performance(context, header=[33m"[0m[33mRunning PoV[0m[33m"[0m):           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 95 [0m[2m│   │   │   [0m[94mtry[0m:                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 96 [0m[2m│   │   │   │   [0m[94mif[0m [96mlen[0m(detection.blobs) > [94m0[0m:                               [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 97 [2m│   │   │   │   │   [0menvironment.run_pov(context, detection)                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 98 [0m[2m│   │   │   │   [0m[94melse[0m:                                                      [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 99 [0m[2m│   │   │   │   │   [0mcontext[[33m"[0m[33mlogger[0m[33m"[0m].warning([33m"[0m[33mNo blob data found for the [0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m100 [0m                                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mcached.p[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1my[0m:56 in run_pov                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 53 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, detection: Detection            [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 54 [0m[2m│   [0m) -> [96mtuple[0m[[96mstr[0m, [96mstr[0m]:                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 55 [0m[2m│   │   [0m[94massert[0m [96mlen[0m(detection.blobs) > [94m0[0m, [33m"[0m[33mAt least one blob is required[0m[33m"[0m   [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 56 [2m│   │   [0m[94mreturn[0m [1;4;96mself[0m[1;4m.environment.run_pov(context, detection)[0m                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 57 [0m[2m│   [0m                                                                       [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 58 [0m[2m│   [0m[94mdef[0m[90m [0m[92mrun_tests[0m(                                                         [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 59 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, env: [96mdict[0m[[96mstr[0m, [96mstr[0m] = {}        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mdefault.[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1mpy[0m:210 in run_pov                                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m207 [0m[2m│   │   │   │   [0mcontext, blobinfo.blob, blobinfo.harness_name              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m208 [0m[2m│   │   │   [0m)                                                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m209 [0m[2m│   │   │   [0m[94mif[0m [95mnot[0m success:                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m210 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m ChallengePoVFoundError([0m                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m211 [0m[2m│   │   │   │   │   [0m[1;4mstdout=stdout.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m212 [0m[2m│   │   │   │   │   [0m[1;4mstderr=stderr.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m213 [0m[2m│   │   │   │   [0m[1;4m)[0m                                                          [31m│[0m [2m               [0m
[2;36m                    [0m         [31m╰──────────────────────────────────────────────────────────────────────────────────╯[0m [2m               [0m
[2;36m                    [0m         [1;91mChallengePoVFoundError: [0mPoV found:                                                   [2m               [0m
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2139722723[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x562e2172f708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x562e21730aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x562e21730aa8[0m[39m,[0m[1;36m0x562e21744448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x562e216b5c02[0m[39m bp [0m[1;36m0x7fff032c9e00[0m[39m sp [0m[1;36m0x7fff032c9df8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x562e216b5c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x562e2169dd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x562e216b28b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x562e2151e350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x562e215095c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x562e2150f05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x562e2153a302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f46b7fef082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x562e215017ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x562e2162a11f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x562e216b279d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x562e2151e350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x562e215095c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x562e2150f05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x562e2153a302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f46b7fef082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpr_77npiq[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Took [1;36m2.35[0m seconds;                ]8;id=840200;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=952229;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=610748;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=424046;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 07:22:03][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.94[0m seconds;              ]8;id=958682;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=647975;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=741101;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=315587;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 07:22:04][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.95[0m seconds;              ]8;id=767962;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=727792;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 07:22:05][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=342589;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=642823;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         +++ b/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-792[0m,[1;36m19[0m +[1;36m792[0m,[1;36m24[0m @@                                                               [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          static void [1;35mrx_ip[0m[1m([0mstruct mg_tcpip_if *ifp, struct pkt *pkt[1m)[0m [1m{[0m                      [2m                [0m
[2;36m                    [0m         +  size_t ip_hlen = [1m([0mpkt->ip->ver & [1;36m0xF[0m[1m)[0m * [1;36m4[0m;                                       [2m                [0m
[2;36m                    [0m            uint16_t frag = [1;35mmg_ntohs[0m[1m([0mpkt->ip->frag[1m)[0m;                                         [2m                [0m
[2;36m                    [0m            if [1m([0mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[1m)[0m [1m{[0m                     [2m                [0m
[2;36m                    [0m         -    if [1m([0mpkt->ip->proto == [1;36m17[0m[1m)[0m pkt->udp = [1m([0mstruct udp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;             [2m                [0m
[2;36m                    [0m         -    if [1m([0mpkt->ip->proto == [1;36m6[0m[1m)[0m pkt->tcp = [1m([0mstruct tcp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;              [2m                [0m
[2;36m                    [0m         +    if [1m([0mpkt->ip->proto == [1;36m17[0m[1m)[0m pkt->udp = [1m([0mstruct udp *[1m)[0m [1m([0m[1m([0mchar *[1m)[0mpkt->ip +         [2m                [0m
[2;36m                    [0m         ip_hlen[1m)[0m;                                                                           [2m                [0m
[2;36m                    [0m         +    if [1m([0mpkt->ip->proto == [1;36m6[0m[1m)[0m pkt->tcp = [1m([0mstruct tcp *[1m)[0m [1m([0m[1m([0mchar *[1m)[0mpkt->ip +          [2m                [0m
[2;36m                    [0m         ip_hlen[1m)[0m;                                                                           [2m                [0m
[2;36m                    [0m              struct mg_connection *c = [1;35mgetpeer[0m[1m([0mifp->mgr, pkt, false[1m)[0m;                       [2m                [0m
[2;36m                    [0m              if [1m([0mc[1m)[0m [1;35mmg_error[0m[1m([0mc, [32m"Received fragmented packet"[0m[1m)[0m;                              [2m                [0m
[2;36m                    [0m            [1m}[0m else if [1m([0mpkt->ip->proto == [1;36m1[0m[1m)[0m [1m{[0m                                                [2m                [0m
[2;36m                    [0m         -    pkt->icmp = [1m([0mstruct icmp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;                                     [2m                [0m
[2;36m                    [0m         +    pkt->icmp = [1m([0mstruct icmp *[1m)[0m [1m([0m[1m([0mchar *[1m)[0mpkt->ip + ip_hlen[1m)[0m;                       [2m                [0m
[2;36m                    [0m         +    uint8_t *end = [1m([0muint8_t *[1m)[0m &pkt->raw.buf[1m[[0mpkt->raw.len[1m][0m;                        [2m                [0m
[2;36m                    [0m         +    if [1m([0mend [1m<[0m[39m [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->icmp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [39m-    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m+    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m+    uint8_t *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m        [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-822[0m[39m,[0m[1;36m11[0m[39m +[0m[1;36m827[0m[39m,[0m[1;36m13[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m-    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m+    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m+    uint8_t *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->tcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m-    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [39m+    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip_hlen + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m        [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m            [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-888[0m[39m,[0m[1;36m10[0m[39m +[0m[1;36m895[0m[39m,[0m[1;36m11[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m    [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m       [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle IPv4 [0m [2m                [0m
[2;36m                    [0m         [39moptions[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m-    else[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+    size_t ip_hlen = [0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mip_hlen < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                         [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mip_hlen > [0m[1;36m60[0m[1;39m)[0m[39m return;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hlen[0m[1;39m)[0m[39m return;[0m                          [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + ip_hlen[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2139722723[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x562e2172f708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x562e21730aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x562e21730aa8[0m[39m,[0m[1;36m0x562e21744448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x562e216b5c02[0m[39m bp [0m[1;36m0x7fff032c9e00[0m[39m sp [0m[1;36m0x7fff032c9df8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x562e216b5c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x562e2169dd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x562e216b28b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x562e2151e350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x562e215095c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x562e2150f05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x562e2153a302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f46b7fef082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x562e215017ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x562e2162a11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x562e216b279d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x562e2151e350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x562e215095c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x562e2150f05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x562e2153a302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f46b7fef082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpr_77npiq[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m258835080[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x561ff01a2708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x561ff01a3aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x561ff01a3aa8[0m[39m,[0m[1;36m0x561ff01b7448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x561ff0128c02[0m[39m bp [0m[1;36m0x7ffc33939220[0m[39m sp [0m[1;36m0x7ffc33939218[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561ff0128c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561ff0110d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561ff01258b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561feff91350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561feff7c5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561feff8205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561feffad302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fec5899b082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561feff747ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561ff009d11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561ff012579d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561feff91350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561feff7c5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561feff8205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561feffad302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fec5899b082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpi8kbb5d5[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe initial issue is a heap-buffer-overflow vulnerability detected by [0m              [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer during fuzzing. The overflow occurs in the `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` function at[0m [2m                [0m
[2;36m                    [0m         [39mline [0m[1;36m385[0m[39m of `src/net_builtin.c`, where a [0m[1;36m1[0m[39m-byte read operation attempts to access [0m  [2m                [0m
[2;36m                    [0m         [39mmemory at address `[0m[1;36m0x504000000172[0m[39m`, which is located immediately after a [0m[1;36m34[0m[39m-byte [0m   [2m                [0m
[2;36m                    [0m         [39mallocated heap region. A patch was applied to add bounds checking for IP header [0m    [2m                [0m
[2;36m                    [0m         [39mlength calculations and protocol-specific structure access in the `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m` [0m        [2m                [0m
[2;36m                    [0m         [39mfunction and the packet processing pipeline. However, after applying the patch, the[0m [2m                [0m
[2;36m                    [0m         [39msame heap-buffer-overflow error persists with identical characteristics, indicating[0m [2m                [0m
[2;36m                    [0m         [39mthe patch did not address the root cause of the vulnerability.[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Initial Issue Analysis[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe initial issue manifests as a heap-buffer-overflow with the following [0m           [2m                [0m
[2;36m                    [0m         [39mcharacteristics:[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Error Location**: The overflow occurs at [0m                                      [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m` in the `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` function during a READ [0m [2m                [0m
[2;36m                    [0m         [39moperation of size [0m[1;36m1[0m[39m.[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Memory Context**: The address `[0m[1;36m0x504000000172[0m[39m` being accessed is located [0m[1;36m0[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mbytes after a [0m[1;36m34[0m[39m-byte region allocated at `[0m[1;39m[[0m[1;36m0x504000000150[0m[39m, [0m[1;36m0x504000000172[0m[1;39m)[0m[39m`. This [0m [2m                [0m
[2;36m                    [0m         [39mindicates an attempt to read immediately past the end of a valid heap allocation.[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Call Stack**: The error propagates through the following call chain:[0m           [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` - where the actual overflow occurs[0m                                 [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m` - line [0m[1;36m897[0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mLLVMFuzzerTestOneInput[0m[1;39m([0m[1;39m)[0m[39m` - the fuzzer entry point at line [0m[1;36m106[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Allocation Context**: The [0m[1;36m34[0m[39m-byte buffer was allocated in [0m                     [2m                [0m
[2;36m                    [0m         [39m`LLVMFuzzerTestOneInput` at line [0m[1;36m95[0m[39m, suggesting the fuzzer created a minimal test [0m  [2m                [0m
[2;36m                    [0m         [39mcase that triggers the vulnerability.[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Patch Attempt Details[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe patch modifies the `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m` function in `src/net_builtin.c` with the following[0m [2m                [0m
[2;36m                    [0m         [39mchanges:[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **IP Header Length Calculation**: Introduces `ip_hlen` calculation at the [0m       [2m                [0m
[2;36m                    [0m         [39mbeginning of `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m`:[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   size_t ip_hlen = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Pointer Arithmetic Updates**: Changes all protocol structure pointer [0m          [2m                [0m
[2;36m                    [0m         [39mcalculations from `[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m` to `[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m` for:[0m             [2m                [0m
[2;36m                    [0m         [39m   - UDP packets [0m[1;39m([0m[39m`pkt->udp`[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [39m   - TCP packets [0m[1;39m([0m[39m`pkt->tcp`[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [39m   - ICMP packets [0m[1;39m([0m[39m`pkt->icmp`[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Bounds Checking**: Adds validation checks before accessing protocol [0m           [2m                [0m
[2;36m                    [0m         [39mstructures:[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   uint8_t *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                    [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   This pattern is applied for UDP, TCP, and ICMP protocols.[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **IP Header Validation**: In `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m` function, adds validation:[0m          [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mip_hlen < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                           [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mip_hlen > [0m[1;36m60[0m[1;39m)[0m[39m return;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hlen[0m[1;39m)[0m[39m return;[0m                            [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Removal of `[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m` Calls**: The patch removes several `[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m` function [0m    [2m                [0m
[2;36m                    [0m         [39mcalls that were previously used to set up the payload pointer after protocol [0m       [2m                [0m
[2;36m                    [0m         [39mheaders.[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Post-Patch Results[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter applying the patch, the identical error persists:[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Same Error Location**: The heap-buffer-overflow still occurs at line [0m[1;36m385[0m[39m in [0m   [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m`.[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Identical Memory Address**: The same address `[0m[1;36m0x504000000172[0m[39m` is accessed, [0m    [2m                [0m
[2;36m                    [0m         [39mwith the same [0m[1;36m34[0m[39m-byte region context.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Unchanged Call Stack**: The error propagates through the same function chain.[0m  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Same Scariness Score**: The AddressSanitizer reports a scariness score of [0m[1;36m12[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m[39m in both cases.[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis indicates that while the patch attempted to add bounds checking at the [0m        [2m                [0m
[2;36m                    [0m         [39mprotocol structure level, it did not prevent the actual out-of-bounds read [0m         [2m                [0m
[2;36m                    [0m         [39moccurring within the `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` function itself.[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas Requiring Further Investigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **`[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` Function**: The function at line [0m[1;36m385[0m[39m where the actual overflow [0m    [2m                [0m
[2;36m                    [0m         [39moccurs needs detailed examination. The bounds checks added in `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m` [0m            [2m                [0m
[2;36m                    [0m         [39msuccessfully validate that `pkt->icmp` pointer is valid, but something within [0m      [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` still attempts to read beyond the buffer.[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **ICMP Packet Structure and Payload Handling**: The patch removes the [0m           [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m` call that was previously executed before calling [0m       [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m`. This may affect how the payload is accessed within `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m`.[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Packet Payload [0m[1;39m([0m[39m`pkt->pay`[0m[1;39m)[0m[39m Initialization**: The relationship between the [0m    [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m` function calls [0m[1;39m([0m[39mwhich were removed[0m[1;39m)[0m[39m and the subsequent payload access [0m    [2m                [0m
[2;36m                    [0m         [39mneeds investigation, as these calls may have been critical for setting up valid [0m    [2m                [0m
[2;36m                    [0m         [39mpayload boundaries.[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Buffer Size Validation**: The [0m[1;36m34[0m[39m-byte buffer size suggests a minimal packet [0m   [2m                [0m
[2;36m                    [0m         [39mstructure. Understanding what constitutes a valid minimum packet size for ICMP [0m     [2m                [0m
[2;36m                    [0m         [39mprocessing is necessary.[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Interaction Between Bounds Checks**: The patch adds checks like `if [0m           [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;` before calling `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m`, but the [0m   [2m                [0m
[2;36m                    [0m         [39moverflow still occurs, suggesting the check may not be sufficient or the actual [0m    [2m                [0m
[2;36m                    [0m         [39maccess pattern in `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` differs from what was anticipated.[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **ICMP Message Format**: Line [0m[1;36m385[0m[39m in `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` needs to be examined to [0m        [2m                [0m
[2;36m                    [0m         [39munderstand what specific field or operation causes the [0m[1;36m1[0m[39m-byte read beyond the [0m      [2m                [0m
[2;36m                    [0m         [39mallocated buffer, considering the ICMP header structure and any subsequent data [0m    [2m                [0m
[2;36m                    [0m         [39maccess patterns.[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m258835080[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x561ff01a2708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x561ff01a3aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x561ff01a3aa8[0m[39m,[0m[1;36m0x561ff01b7448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x561ff0128c02[0m[39m bp [0m[1;36m0x7ffc33939220[0m[39m sp [0m[1;36m0x7ffc33939218[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561ff0128c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561ff0110d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561ff01258b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561feff91350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561feff7c5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561feff8205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561feffad302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fec5899b082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561feff747ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561ff009d11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561ff012579d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561feff91350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561feff7c5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561feff8205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561feffad302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fec5899b082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpi8kbb5d5[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1581498677[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x559330f98708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x559330f99aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x559330f99aa8[0m[39m,[0m[1;36m0x559330fad448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x559330f1ec02[0m[39m bp [0m[1;36m0x7fffa42158e0[0m[39m sp [0m[1;36m0x7fffa42158d8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x559330f1ec01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x559330f06d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x559330f1b8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x559330d87350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x559330d725c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x559330d7805f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x559330da3302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f94f6c7e082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x559330d6a7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x559330e9311f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x559330f1b79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x559330d87350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x559330d725c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x559330d7805f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x559330da3302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f94f6c7e082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpwluei79b[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:72[0m[39m-[0m[1;36m76[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:struct icmp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  uint8_t type;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint8_t code;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  uint16_t csum;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:129[0m[39m-[0m[1;36m141[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:struct pkt [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:  struct mg_str raw;  [0m[35m/[0m[35m/[0m[39m Raw packet data[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:  struct mg_str pay;  [0m[35m/[0m[35m/[0m[39m Payload data[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:  struct eth *eth;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:  struct llc *llc;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:  struct arp *arp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:  struct ip *ip;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:  struct ip6 *ip6;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:  struct icmp *icmp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:  struct tcp *tcp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:  struct udp *udp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:  struct dhcp *dhcp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:806[0m[39m-[0m[1;36m823[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:824[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:793[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m793[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:41[0m[39m-[0m[1;36m45[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:struct eth [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:  uint8_t dst[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Destination MAC address[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:  uint8_t src[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Source MAC address[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:  uint16_t type;   [0m[35m/[0m[35m/[0m[39m Ethernet type[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:72[0m[39m-[0m[1;36m76[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:struct icmp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  uint8_t type;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint8_t code;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  uint16_t csum;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:824[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:876[0m[39m-[0m[1;36m881[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m876[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x86dd[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m877[0m[39m:    pkt.ip6 = [0m[1;39m([0m[39mstruct ip6 *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m878[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip6[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m879[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip6->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m0x6[0m[1;39m)[0m[39m return;                         [0m[35m/[0m[35m/[0m[39m Not IP[0m   [2m                [0m
[2;36m                    [0m         [1;36m880[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m881[0m[39m:    [0m[1;35mrx_ip6[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:838[0m[39m-[0m[1;36m850[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m838[0m[39m:static void [0m[1;35mrx_ip6[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m839[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"IP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m840[0m[39m:  if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m1[0m[39m || pkt->ip6->proto == [0m[1;36m58[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m841[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m842[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m843[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m844[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m845[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m846[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m847[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m848[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"  UDP %u %u -> %u"[0m[39m, len, [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->sport[0m[1;39m)[0m[39m,[0m                [2m                [0m
[2;36m                    [0m         [1;36m849[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->dport[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m850[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:795[0m[39m-[0m[1;36m800[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:53[0m[39m-[0m[1;36m54[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:876[0m[39m-[0m[1;36m881[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m876[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x86dd[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m877[0m[39m:    pkt.ip6 = [0m[1;39m([0m[39mstruct ip6 *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m878[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip6[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m879[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip6->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m0x6[0m[1;39m)[0m[39m return;                         [0m[35m/[0m[35m/[0m[39m Not IP[0m   [2m                [0m
[2;36m                    [0m         [1;36m880[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m881[0m[39m:    [0m[1;35mrx_ip6[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter examining the code snippets and evaluation report, I've identified the root [0m  [2m                [0m
[2;36m                    [0m         [39mcause of the persistent heap-buffer-overflow:[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Root Cause[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability occurs in `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m` at lines [0m[1;36m891[0m[39m-[0m[1;36m894[0m[39m where the code calls [0m  [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m` without validating that the IP header length [0m[1;39m([0m[39mincluding options[0m[1;39m)[0m[39m fits [0m    [2m                [0m
[2;36m                    [0m         [39mwithin the packet buffer. When an attacker crafts a packet with:[0m                    [2m                [0m
[2;36m                    [0m         [39m- Total buffer size: [0m[1;36m34[0m[39m bytes [0m[1;39m([0m[39mEthernet header [0m[1;36m14[0m[39m bytes + IP header claiming larger[0m [2m                [0m
[2;36m                    [0m         [39msize[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m- IP IHL field indicating header length > actual remaining bytes[0m                    [2m                [0m
[2;36m                    [0m         [39m- The calculation `[0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[39m` produces a pointer [0m  [2m                [0m
[2;36m                    [0m         [39mbeyond the buffer end[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- `[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m` then calculates: `&buf[0m[1;39m[[0m[1;36m34[0m[1;39m][0m[39m - &buf[0m[1;39m[[0m[1;36m38[0m[1;39m][0m[39m = [0m[1;36m-4[0m[39m`, which underflows to a huge[0m [2m                [0m
[2;36m                    [0m         [39mpositive `size_t` value[0m                                                             [2m                [0m
[2;36m                    [0m         [39m- This corrupted `pkt->pay.len` bypasses subsequent bounds checks[0m                   [2m                [0m
[2;36m                    [0m         [39m- Eventually `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` dereferences `pkt->icmp->type` at an invalid address[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why Previous Patch Failed[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe previous patch attempted to:[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Calculate protocol pointers correctly using `ip_hlen`[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Add bounds checks before accessing protocol structures[0m                           [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Remove `[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m` calls in `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m`[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mHowever, it **failed to fix the root cause** in `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m` where the initial [0m  [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m` call creates the corrupted `pkt->pay`. All subsequent checks used this [0m   [2m                [0m
[2;36m                    [0m         [39mcorrupted value, so they failed to prevent the overflow.[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Primary Fix: Add IP Header Length Validation in `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m`[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** `src/net_builtin.c` lines [0m[1;36m890[0m[39m-[0m[1;36m894[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes needed:**[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. After line [0m[1;36m890[0m[39m [0m[1;39m([0m[39mIP version check[0m[1;39m)[0m[39m, add validation for IP header length[0m           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Calculate `ip_hlen` once and validate it before calling `[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m`[0m                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Ensure the IP header [0m[1;39m([0m[39mwith options[0m[1;39m)[0m[39m fits within the packet buffer[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation:**[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Line [0m[1;36m890[0m[39m: if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m ADD AFTER LINE [0m[1;36m890[0m[39m:[0m                                                              [2m                [0m
[2;36m                    [0m         [39msize_t ip_hlen = [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mip_hlen < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m IHL < [0m[1;36m5[0m[39m is invalid [0m[1;39m([0m[39m< [0m[1;36m20[0m[39m bytes[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mip_hlen > [0m[1;36m60[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m IHL > [0m[1;36m15[0m[39m is invalid [0m[1;39m([0m[39m> [0m[1;36m60[0m[39m bytes[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hlen > pkt.raw.len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Header exceeds packet[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m MODIFY LINES [0m[1;36m891[0m[39m-[0m[1;36m894[0m[39m:[0m                                                            [2m                [0m
[2;36m                    [0m         [1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + ip_hlen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Always use calculated ip_hlen[0m          [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Remove the conditional [0m[1;39m([0m[39mlines [0m[1;36m891[0m[39m-[0m[1;36m894[0m[1;39m)[0m[39m since ip_hlen handles both cases[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis prevents `[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m` from being called with an out-of-bounds pointer, which is [0m  [2m                [0m
[2;36m                    [0m         [39mthe root cause of the size_t underflow.[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Secondary Fix: Correct Protocol Pointer Calculations in `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m`[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** `src/net_builtin.c` lines [0m[1;36m794[0m[39m-[0m[1;36m836[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes needed:**[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Calculate `ip_hlen` at the start of `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m` function[0m                           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Update all protocol pointer calculations to use `ip_hlen` instead of `pkt->ip + [0m [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m`[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Remove redundant `[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m` calls since `pkt->pay` is already correctly set[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation:**[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAt the start of `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mafter line [0m[1;36m794[0m[1;39m)[0m[39m:[0m                                         [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mstatic void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [39m  size_t ip_hlen = [0m[1;39m([0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m ADD THIS[0m                         [2m                [0m
[2;36m                    [0m         [39m  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mFor fragmented packets [0m[1;39m([0m[39mlines [0m[1;36m797[0m[39m-[0m[1;36m798[0m[1;39m)[0m[39m:[0m                                             [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mFor ICMP [0m[1;39m([0m[39mlines [0m[1;36m801[0m[39m-[0m[1;36m805[0m[1;39m)[0m[39m:[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [39m  pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [39m  if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                    [2m                [0m
[2;36m                    [0m         [39m  [0m[35m/[0m[35m/[0m[39m REMOVE: [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;  - pkt->pay already set correctly[0m           [2m                [0m
[2;36m                    [0m         [39m  [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mFor UDP [0m[1;39m([0m[39mlines [0m[1;36m806[0m[39m-[0m[1;36m823[0m[1;39m)[0m[39m:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [39m  pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [39m  if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                     [2m                [0m
[2;36m                    [0m         [39m  [0m[35m/[0m[35m/[0m[39m REMOVE: [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;  - pkt->pay already set correctly[0m            [2m                [0m
[2;36m                    [0m         [39m  [0m[35m/[0m[35m/[0m[39m Keep rest of UDP handling unchanged[0m                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mFor TCP [0m[1;39m([0m[39mlines [0m[1;36m824[0m[39m-[0m[1;36m836[0m[1;39m)[0m[39m:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [39m  pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [39m  if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                     [2m                [0m
[2;36m                    [0m         [39m  [0m[35m/[0m[35m/[0m[39m REMOVE: [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;  - pkt->pay already set correctly[0m            [2m                [0m
[2;36m                    [0m         [39m  uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [39m  uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip_hlen + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Use [0m       [2m                [0m
[2;36m                    [0m         [39mip_hlen not [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [39m  if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Additional Fix: Handle DHCP Pointer Calculations[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** Lines [0m[1;36m814[0m[39m and [0m[1;36m818[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mFor DHCP client/server, the `pkt->dhcp` pointer must also account for UDP being at [0m [2m                [0m
[2;36m                    [0m         [39mthe correct offset:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mpkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m REMOVE: [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;  - Not needed[0m                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Justification[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This Approach Is Optimal[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Addresses Root Cause:** The primary fix in `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m` prevents the size_t[0m [2m                [0m
[2;36m                    [0m         [39munderflow that corrupts `pkt->pay.len`, which was the fundamental issue the [0m        [2m                [0m
[2;36m                    [0m         [39mprevious patch missed.[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Defense in Depth:** The secondary fixes in `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m` ensure protocol pointers [0m [2m                [0m
[2;36m                    [0m         [39mare calculated correctly even if IP options are present, providing an additional [0m   [2m                [0m
[2;36m                    [0m         [39mlayer of protection.[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Preserves Existing Logic:** [0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - The validation checks follow the same pattern as IPv6 handling [0m[1;39m([0m[39mline [0m[1;36m878[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m   - Removing redundant `[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m` calls simplifies the code since `pkt->pay` is [0m    [2m                [0m
[2;36m                    [0m         [39malready correctly set in `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m`[0m                                            [2m                [0m
[2;36m                    [0m         [39m   - TCP's special payload length recalculation [0m[1;39m([0m[39mlines [0m[1;36m828[0m[39m-[0m[1;36m830[0m[1;39m)[0m[39m is preserved with [0m  [2m                [0m
[2;36m                    [0m         [39mcorrected offset calculation[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Consistent with Standards:** IP header length must be between [0m[1;36m20[0m[39m-[0m[1;36m60[0m[39m bytes [0m[1;39m([0m[39mIHL[0m [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m-[0m[1;36m15[0m[1;39m)[0m[39m, and the validation enforces this RFC [0m[1;36m791[0m[39m requirement.[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Preserves Existing Logic[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Maintains Packet Processing Flow:** All protocol handlers continue to work as [0m [2m                [0m
[2;36m                    [0m         [39mbefore, just with corrected pointer arithmetic.[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Keeps Fragmentation Handling:** The fragmentation error reporting [0m[1;39m([0m[39mlines [0m      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m-[0m[1;36m800[0m[1;39m)[0m[39m is unchanged, just with corrected pointers.[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Preserves DHCP Functionality:** DHCP client/server handling remains intact, [0m   [2m                [0m
[2;36m                    [0m         [39mwith only pointer calculations corrected.[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **TCP Special Case:** The TCP payload length recalculation [0m[1;39m([0m[39mlines [0m[1;36m828[0m[39m-[0m[1;36m830[0m[1;39m)[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mcontinues to work, now using the correct `ip_hlen` value.[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Addresses the Evaluation Report Issues[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Fixes Line [0m[1;36m385[0m[39m Overflow:** By ensuring `pkt->pay` has valid pointer and [0m       [2m                [0m
[2;36m                    [0m         [39mlength, the access to `pkt->pay.len` in `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m386[0m[39m [0m[1;39m([0m[39mwhich may be [0m      [2m                [0m
[2;36m                    [0m         [39mattributed to line [0m[1;36m385[0m[39m due to compiler optimization[0m[1;39m)[0m[39m no longer reads beyond the [0m    [2m                [0m
[2;36m                    [0m         [39mbuffer.[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Handles [0m[1;36m34[0m[39m-byte Test Case:** With validation, a [0m[1;36m34[0m[39m-byte packet claiming [0m[33mIHL[0m[39m=[0m[1;36m6[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;36m24[0m[39m-byte header[0m[1;39m)[0m[39m will be rejected at the check `[0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hlen > [0m       [2m                [0m
[2;36m                    [0m         [39mpkt.raw.len` → `[0m[1;36m14[0m[39m + [0m[1;36m24[0m[39m > [0m[1;36m34[0m[39m` → rejected.[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Prevents Size_t Underflow:** The primary fix ensures `[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m` is never called[0m [2m                [0m
[2;36m                    [0m         [39mwith a pointer beyond the buffer, preventing the negative subtraction that wraps [0m   [2m                [0m
[2;36m                    [0m         [39maround.[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Potential Side Effects and Mitigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Malformed Packet Rejection:** Packets with invalid IHL values will now be [0m     [2m                [0m
[2;36m                    [0m         [39mdropped. This is the correct behavior per RFC [0m[1;36m791[0m[39m and improves security.[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **No Impact on Valid Traffic:** All valid IPv4 packets [0m[1;39m([0m[39mwith or without options[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39mwill continue to be processed correctly.[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Test Compatibility:** The changes don't modify any API or functionality [0m       [2m                [0m
[2;36m                    [0m         [39mvisible to tests; they only add validation to reject malformed packets earlier.[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Similar Solutions in Codebase[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix mirrors the IPv6 handling pattern at lines [0m[1;36m876[0m[39m-[0m[1;36m881[0m[39m where:[0m                   [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip6[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39mvalidates the header fits before calling `[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m`. We apply the same pattern to [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 with variable-length headers.[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/10/26 07:22:34][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=922095;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=68473;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m6[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=527239;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=323815;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpne_6nu42[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/mongoose_mg-delta-02_mongoose[0m [2m               [0m
[2;36m                    [0m         [35m_2/[0m[95magent-output-1768029754.9592638[0m                                                   [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/mongoose_mg-delta-02_mongoose_2.toml                [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-mongoose[0m         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/10/26 07:22:37][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/qqor/crete/.cache/environments/[0m[95mmongoose[0m       ]8;id=406447;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=106907;file:///home/qqor/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=429202;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=494960;file:///home/qqor/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mmongoose[0m              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=519395;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=488737;file:///home/qqor/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m               [2m               [0m
