[2;36m[01/10/26 21:51:25][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=347008;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=681572;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpschj01hf[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/xz_xz-full-01_xz-001/[0m[95magent-ou[0m [2m               [0m
[2;36m                    [0m         [95mtput-1768081885.854818[0m                                                               [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc-delta-full/xz_xz-full-01_xz-[1;36m001.[0mtoml    [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-xz[0m               [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mxz Building Cached for CLEAN environment[1m)[0m Started[33m...[0m     ]8;id=9533;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=656701;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 21:52:02][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mxz Building Cached for CLEAN environment[1m)[0m Took [1;36m36.85[0m    ]8;id=797459;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=831844;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mxz Running tests for Cached for CLEAN environment[1m)[0m       ]8;id=986366;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=172772;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mxz Running tests for Cached for CLEAN environment[1m)[0m Took ]8;id=401231;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=453467;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                 [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=383261;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=203278;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m36[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mxz Setting owner[1m)[0m Started[33m...[0m                             ]8;id=879149;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=352266;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 21:52:03][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mxz Setting owner[1m)[0m Took [1;36m0.97[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=132078;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=910293;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/10/26 21:52:04][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=80178;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=914529;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=296505;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=560328;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=589675;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=162192;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mxz Setting owner[1m)[0m Started[33m...[0m                             ]8;id=233288;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=989498;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 21:52:05][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mxz Setting owner[1m)[0m Took [1;36m1.05[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=535406;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=758279;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mxz Setting owner[1m)[0m Started[33m...[0m                             ]8;id=498334;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=28012;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 21:52:06][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mxz Setting owner[1m)[0m Took [1;36m0.98[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=142494;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=488677;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/10/26 21:52:09][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=443791;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=548032;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz_encode_stream[0m                                                         [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer fuzz_encode_stream -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                 [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz_encode_stream[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m          [2m                [0m
[2;36m                    [0m         -[33mmax_len[0m=[1;36m4096[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m                                       [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2806381060[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m2399[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m2399[0m[39m [0m[1;39m[[0m[1;36m0x55aed5b4d3e8[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55aed5b4dd47[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m2399[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m2399[0m[39m [0m[1;39m[[0m[1;36m0x55aed5b4dd48[0m[39m,[0m[1;36m0x55aed5b57338[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz_encode_stream[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                         [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-use-after-free on address [0m[1;36m0x5060000000a0[0m[39m at pc [0m [2m                [0m
[2;36m                    [0m         [1;36m0x55aed5ab53cc[0m[39m bp [0m[1;36m0x7ffca3d2e2d0[0m[39m sp [0m[1;36m0x7ffca3d2e2c8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m8[0m[39m at [0m[1;36m0x5060000000a0[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m51[0m[39m [0m[1;39m([0m[1;36m8[0m[39m-byte-read-heap-use-after-free[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55aed5ab53cb[0m[39m in compute_tree_checksum [0m                                     [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m79:34[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55aed5ab4ca6[0m[39m in lzma_tree [0m[35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m100:15[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55aed5ab49ea[0m[39m in lzma_check_update [0m[35m/src/xz/src/liblzma/check/[0m[95mcheck.c[0m[39m:[0m[1;92m143:23[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55aed5ab0a9e[0m[39m in block_encode [0m                                              [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/common/[0m[95mblock_encoder.c[0m[39m:[0m[1;92m82:4[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55aed5aa6094[0m[39m in stream_encode [0m                                             [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/common/[0m[95mstream_encoder.c[0m[39m:[0m[1;92m158:24[0m                                  [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55aed5aa439c[0m[39m in lzma_code [0m[35m/src/xz/src/liblzma/common/[0m[95mcommon.c[0m[39m:[0m[1;92m293:17[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55aed5aa2b32[0m[39m in fuzz_code [0m[35m/src/xz/tests/ossfuzz/./[0m[95mfuzz_common.h[0m[39m:[0m[1;92m63:18[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55aed5aa2b32[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/xz/tests/ossfuzz/[0m[95mfuzz_encode_stream.c[0m[39m:[0m[1;92m81:2[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55aed59572e0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55aed5942555[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55aed5947fef[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55aed5973292[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x7ff29013f082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55aed593a73d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz_encode_stream+0x4c73d[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: compute_tree_checksum--lzma_tree--lzma_check_update[0m                    [2m                [0m
[2;36m                    [0m         [1;36m0x5060000000a0[0m[39m is located [0m[1;36m32[0m[39m bytes inside of [0m[1;36m56[0m[39m-byte region [0m                        [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x506000000080[0m[39m,[0m[1;36m0x5060000000b8[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mfreed by thread T0 here:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55aed5a62e16[0m[39m in free [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m52:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55aed5ab534c[0m[39m in compute_tree_checksum [0m                                     [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m90:3[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55aed5ab52a4[0m[39m in compute_tree_checksum [0m                                     [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m82:16[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55aed5ab52a4[0m[39m in compute_tree_checksum [0m                                     [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m82:16[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55aed5ab4ca6[0m[39m in lzma_tree [0m[35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m100:15[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55aed5ab49ea[0m[39m in lzma_check_update [0m[35m/src/xz/src/liblzma/check/[0m[95mcheck.c[0m[39m:[0m[1;92m143:23[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55aed5ab0a9e[0m[39m in block_encode [0m                                              [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/common/[0m[95mblock_encoder.c[0m[39m:[0m[1;92m82:4[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55aed5aa6094[0m[39m in stream_encode [0m                                             [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/common/[0m[95mstream_encoder.c[0m[39m:[0m[1;92m158:24[0m                                  [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55aed5aa439c[0m[39m in lzma_code [0m[35m/src/xz/src/liblzma/common/[0m[95mcommon.c[0m[39m:[0m[1;92m293:17[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55aed5aa2b32[0m[39m in fuzz_code [0m[35m/src/xz/tests/ossfuzz/./[0m[95mfuzz_common.h[0m[39m:[0m[1;92m63:18[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55aed5aa2b32[0m[39m in LLVMFuzzerTestOneInput [0m                                   [2m                [0m
[2;36m                    [0m         [35m/src/xz/tests/ossfuzz/[0m[95mfuzz_encode_stream.c[0m[39m:[0m[1;92m81:2[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55aed59572e0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m    [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x55aed5942555[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55aed5947fef[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x55aed5973292[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m15[0m[39m [0m[1;36m0x7ff29013f082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_free--compute_tree_checksum--compute_tree_checksum[0m       [2m                [0m
[2;36m                    [0m         [39mpreviously allocated by thread T0 here:[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55aed5a630af[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55aed5ab4d4a[0m[39m in create_tree [0m[35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m33:20[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55aed5ab4c9c[0m[39m in lzma_tree [0m[35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m99:20[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55aed5ab49ea[0m[39m in lzma_check_update [0m[35m/src/xz/src/liblzma/check/[0m[95mcheck.c[0m[39m:[0m[1;92m143:23[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55aed5ab0a9e[0m[39m in block_encode [0m                                              [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/common/[0m[95mblock_encoder.c[0m[39m:[0m[1;92m82:4[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55aed5aa6094[0m[39m in stream_encode [0m                                             [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/common/[0m[95mstream_encoder.c[0m[39m:[0m[1;92m158:24[0m                                  [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55aed5aa439c[0m[39m in lzma_code [0m[35m/src/xz/src/liblzma/common/[0m[95mcommon.c[0m[39m:[0m[1;92m293:17[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55aed5aa2b32[0m[39m in fuzz_code [0m[35m/src/xz/tests/ossfuzz/./[0m[95mfuzz_common.h[0m[39m:[0m[1;92m63:18[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55aed5aa2b32[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/xz/tests/ossfuzz/[0m[95mfuzz_encode_stream.c[0m[39m:[0m[1;92m81:2[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55aed59572e0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55aed5942555[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55aed5947fef[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x55aed5973292[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x7ff29013f082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--create_tree--lzma_tree[0m                           [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-use-after-free [0m                                     [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m79:34[0m[39m in compute_tree_checksum[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x505ffffffe00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x505ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x505fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x505fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000000[0m[39m: fa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m01[0m[39m fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x506000000080[0m[39m: fd fd fd fd[0m[1;39m[[0m[39mfd[0m[1;39m][0m[39mfd fd fa fa fa fa fa fd fd fd fd[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000100[0m[39m: fd fd fd fa fa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000180[0m[39m: fa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000200[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39mMS: [0m[1;36m0[0m[39m ; base unit: [0m[1;36m0000000000000000000000000000000000000000[0m                         [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mxz[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m           [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp9nhgtsim[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz_encode_stream -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz_encode_stream[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz_encode_stream -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                 [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz_encode_stream[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39m-[0m[33mmax_len[0m[39m=[0m[1;36m4096[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                       [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2806381060[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m2399[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m2399[0m[39m [0m[1;39m[[0m[1;36m0x55aed5b4d3e8[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55aed5b4dd47[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m2399[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m2399[0m[39m [0m[1;39m[[0m[1;36m0x55aed5b4dd48[0m[39m,[0m[1;36m0x55aed5b57338[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz_encode_stream[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                         [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-use-after-free on address [0m[1;36m0x5060000000a0[0m[39m at pc [0m [2m                [0m
[2;36m                    [0m         [1;36m0x55aed5ab53cc[0m[39m bp [0m[1;36m0x7ffca3d2e2d0[0m[39m sp [0m[1;36m0x7ffca3d2e2c8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m8[0m[39m at [0m[1;36m0x5060000000a0[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m51[0m[39m [0m[1;39m([0m[1;36m8[0m[39m-byte-read-heap-use-after-free[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55aed5ab53cb[0m[39m in compute_tree_checksum [0m                                     [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m79:34[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55aed5ab4ca6[0m[39m in lzma_tree [0m[35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m100:15[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55aed5ab49ea[0m[39m in lzma_check_update [0m[35m/src/xz/src/liblzma/check/[0m[95mcheck.c[0m[39m:[0m[1;92m143:23[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55aed5ab0a9e[0m[39m in block_encode [0m                                              [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/common/[0m[95mblock_encoder.c[0m[39m:[0m[1;92m82:4[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55aed5aa6094[0m[39m in stream_encode [0m                                             [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/common/[0m[95mstream_encoder.c[0m[39m:[0m[1;92m158:24[0m                                  [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55aed5aa439c[0m[39m in lzma_code [0m[35m/src/xz/src/liblzma/common/[0m[95mcommon.c[0m[39m:[0m[1;92m293:17[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55aed5aa2b32[0m[39m in fuzz_code [0m[35m/src/xz/tests/ossfuzz/./[0m[95mfuzz_common.h[0m[39m:[0m[1;92m63:18[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55aed5aa2b32[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/xz/tests/ossfuzz/[0m[95mfuzz_encode_stream.c[0m[39m:[0m[1;92m81:2[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55aed59572e0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55aed5942555[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55aed5947fef[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55aed5973292[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x7ff29013f082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55aed593a73d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz_encode_stream+0x4c73d[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: compute_tree_checksum--lzma_tree--lzma_check_update[0m                    [2m                [0m
[2;36m                    [0m         [1;36m0x5060000000a0[0m[39m is located [0m[1;36m32[0m[39m bytes inside of [0m[1;36m56[0m[39m-byte region [0m                        [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x506000000080[0m[39m,[0m[1;36m0x5060000000b8[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mfreed by thread T0 here:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55aed5a62e16[0m[39m in free [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m52:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55aed5ab534c[0m[39m in compute_tree_checksum [0m                                     [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m90:3[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55aed5ab52a4[0m[39m in compute_tree_checksum [0m                                     [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m82:16[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55aed5ab52a4[0m[39m in compute_tree_checksum [0m                                     [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m82:16[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55aed5ab4ca6[0m[39m in lzma_tree [0m[35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m100:15[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55aed5ab49ea[0m[39m in lzma_check_update [0m[35m/src/xz/src/liblzma/check/[0m[95mcheck.c[0m[39m:[0m[1;92m143:23[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55aed5ab0a9e[0m[39m in block_encode [0m                                              [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/common/[0m[95mblock_encoder.c[0m[39m:[0m[1;92m82:4[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55aed5aa6094[0m[39m in stream_encode [0m                                             [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/common/[0m[95mstream_encoder.c[0m[39m:[0m[1;92m158:24[0m                                  [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55aed5aa439c[0m[39m in lzma_code [0m[35m/src/xz/src/liblzma/common/[0m[95mcommon.c[0m[39m:[0m[1;92m293:17[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55aed5aa2b32[0m[39m in fuzz_code [0m[35m/src/xz/tests/ossfuzz/./[0m[95mfuzz_common.h[0m[39m:[0m[1;92m63:18[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55aed5aa2b32[0m[39m in LLVMFuzzerTestOneInput [0m                                   [2m                [0m
[2;36m                    [0m         [35m/src/xz/tests/ossfuzz/[0m[95mfuzz_encode_stream.c[0m[39m:[0m[1;92m81:2[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55aed59572e0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m    [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x55aed5942555[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55aed5947fef[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x55aed5973292[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m15[0m[39m [0m[1;36m0x7ff29013f082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_free--compute_tree_checksum--compute_tree_checksum[0m       [2m                [0m
[2;36m                    [0m         [39mpreviously allocated by thread T0 here:[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55aed5a630af[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55aed5ab4d4a[0m[39m in create_tree [0m[35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m33:20[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55aed5ab4c9c[0m[39m in lzma_tree [0m[35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m99:20[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55aed5ab49ea[0m[39m in lzma_check_update [0m[35m/src/xz/src/liblzma/check/[0m[95mcheck.c[0m[39m:[0m[1;92m143:23[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55aed5ab0a9e[0m[39m in block_encode [0m                                              [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/common/[0m[95mblock_encoder.c[0m[39m:[0m[1;92m82:4[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55aed5aa6094[0m[39m in stream_encode [0m                                             [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/common/[0m[95mstream_encoder.c[0m[39m:[0m[1;92m158:24[0m                                  [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55aed5aa439c[0m[39m in lzma_code [0m[35m/src/xz/src/liblzma/common/[0m[95mcommon.c[0m[39m:[0m[1;92m293:17[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55aed5aa2b32[0m[39m in fuzz_code [0m[35m/src/xz/tests/ossfuzz/./[0m[95mfuzz_common.h[0m[39m:[0m[1;92m63:18[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55aed5aa2b32[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/xz/tests/ossfuzz/[0m[95mfuzz_encode_stream.c[0m[39m:[0m[1;92m81:2[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55aed59572e0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55aed5942555[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55aed5947fef[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x55aed5973292[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x7ff29013f082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--create_tree--lzma_tree[0m                           [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-use-after-free [0m                                     [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m79:34[0m[39m in compute_tree_checksum[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x505ffffffe00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x505ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x505fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x505fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000000[0m[39m: fa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m01[0m[39m fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x506000000080[0m: fd fd fd fd[1m[[0mfd[1m][0mfd fd fa fa fa fa fa fd fd fd fd                   [2m                [0m
[2;36m                    [0m           [1;36m0x506000000100[0m: fd fd fd fa fa fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x506000000180[0m: fa fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x506000000200[0m: [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x506000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x506000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                [2m                [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                       [2m                [0m
[2;36m                    [0m           Heap left redzone:       fa                                                       [2m                [0m
[2;36m                    [0m           Freed heap region:       fd                                                       [2m                [0m
[2;36m                    [0m           Stack left redzone:      f1                                                       [2m                [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                       [2m                [0m
[2;36m                    [0m           Stack right redzone:     f3                                                       [2m                [0m
[2;36m                    [0m           Stack after return:      f5                                                       [2m                [0m
[2;36m                    [0m           Stack use after scope:   f8                                                       [2m                [0m
[2;36m                    [0m           Global redzone:          f9                                                       [2m                [0m
[2;36m                    [0m           Global init order:       f6                                                       [2m                [0m
[2;36m                    [0m           Poisoned by user:        f7                                                       [2m                [0m
[2;36m                    [0m           Container overflow:      fc                                                       [2m                [0m
[2;36m                    [0m           Array cookie:            ac                                                       [2m                [0m
[2;36m                    [0m           Intra object redzone:    bb                                                       [2m                [0m
[2;36m                    [0m           ASan internal:           fe                                                       [2m                [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                       [2m                [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                       [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                      [2m                [0m
[2;36m                    [0m         MS: [1;36m0[0m ; base unit: [1;36m0000000000000000000000000000000000000000[0m                         [2m                [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                               [2m                [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64 [2m                [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                    [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mxz[0m:[35m/[0m[95mout[0m -v            [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp9nhgtsim[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce     [2m                [0m
[2;36m                    [0m         fuzz_encode_stream -[33mruns[0m=[1;36m100[0m.                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/10/26 21:52:31][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=281908;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=62738;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 21:57:07][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=552989;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=529973;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 21:57:48][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=740493;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=215885;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mxz Setting owner[1m)[0m Started[33m...[0m                             ]8;id=136875;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=297200;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 21:57:49][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mxz Setting owner[1m)[0m Took [1;36m0.99[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=652062;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=213262;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/10/26 21:57:50][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mxz Patching[1m)[0m Started[33m...[0m                                  ]8;id=201864;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=740953;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmphv8dlpax[0m                                                 ]8;id=29833;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=193496;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/10/26 21:58:18][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mxz Patching[1m)[0m Took [1;36m28.47[0m seconds; [33mexception[0m=[3;91mFalse[0m        ]8;id=893022;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=565064;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mxz Checking build[1m)[0m Started[33m...[0m                            ]8;id=864608;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=430232;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 21:58:22][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mxz Checking build[1m)[0m Took [1;36m3.88[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=656507;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=821657;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mxz Running PoV[1m)[0m Started[33m...[0m                               ]8;id=619478;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=383931;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 21:58:24][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mxz Running PoV[1m)[0m Took [1;36m2.39[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=861252;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=993828;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mxz Testing[1m)[0m Started[33m...[0m                                   ]8;id=345742;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=1955;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mxz Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m          ]8;id=128976;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=422225;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mxz Setting owner[1m)[0m Started[33m...[0m                             ]8;id=792922;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=671787;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 21:58:25][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mxz Setting owner[1m)[0m Took [1;36m0.94[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=997090;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=913852;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/10/26 21:58:26][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mxz Setting owner[1m)[0m Started[33m...[0m                             ]8;id=560731;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=784189;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 21:58:27][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mxz Setting owner[1m)[0m Took [1;36m0.96[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=973806;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=355372;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mxz Setting owner[1m)[0m Started[33m...[0m                             ]8;id=773731;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=163537;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 21:58:28][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mxz Setting owner[1m)[0m Took [1;36m1.11[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=729036;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=207206;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=558448;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=523963;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/liblzma/check/treeck.c                                                    [2m                [0m
[2;36m                    [0m         +++ b/src/liblzma/check/treeck.c                                                    [2m                [0m
[2;36m                    [0m         @@ [1;36m-62[0m,[1;36m8[0m +[1;36m62[0m,[1;36m8[0m @@                                                                   [2m                [0m
[2;36m                    [0m            return node;                                                                     [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         -[35m/[0m[35m/[0m Walk the tree to calculate the e37vk checksum                                   [2m                [0m
[2;36m                    [0m         -static uint32_t [1;35mcompute_tree_checksum[0m[1m([0mTreeNode *node, unsigned int depth[1m)[0m          [2m                [0m
[2;36m                    [0m         +[35m/[0m[35m/[0m Walk the tree to calculate the e37vk checksum [1m([0mtraversal only, no freeing[1m)[0m      [2m                [0m
[2;36m                    [0m         +static uint32_t [1;35mcompute_tree_checksum_internal[0m[1m([0mTreeNode *node, unsigned int depth[1m)[0m [2m                [0m
[2;36m                    [0m          [1m{[0m                                                                                  [2m                [0m
[2;36m                    [0m            [35m/[0m[35m/[0m Skip if already hashed                                                        [2m                [0m
[2;36m                    [0m            if [1m([0m!node || node->state == STATE_HASHED[1m)[0m [1m{[0m                                      [2m                [0m
[2;36m                    [0m         @@ [1;36m-79[0m,[1;36m15[0m +[1;36m79[0m,[1;36m48[0m @@                                                                 [2m                [0m
[2;36m                    [0m              for [1m([0msize_t i = [1;36m0[0m; i [1m<[0m[39m node->edge_count; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [39m       TreeNode *child = node->edges[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [39m       if [0m[1;39m([0m[39mchild[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m-        sum += [0m[1;35mcompute_tree_checksum[0m[1;39m([0m[39mchild, depth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [39m+        sum += [0m[1;35mcompute_tree_checksum_internal[0m[1;39m([0m[39mchild, depth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m       [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m     node->state = STATE_HASHED;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m-  [0m[35m/[0m[35m/[0m[39m Free the node and edges[0m                                                       [2m                [0m
[2;36m                    [0m         [39m-  [0m[1;35mfree[0m[1;39m([0m[39mnode->edges[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m+  return sum;[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+[0m[1;39m}[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+[0m[35m/[0m[35m/[0m[39m Free all nodes in the tree safely, handling cycles[0m                              [2m                [0m
[2;36m                    [0m         [39m+static void [0m[1;35mfree_tree_nodes[0m[1;39m([0m[39mTreeNode *node[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [39m+[0m[1;39m{[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m+  [0m[35m/[0m[35m/[0m[39m Skip if node is NULL or already freed[0m                                         [2m                [0m
[2;36m                    [0m         [39m+  if [0m[1;39m([0m[39m!node || node->state != STATE_HASHED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [39m+    return;[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m+  [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+  [0m[35m/[0m[35m/[0m[39m Mark as being freed to prevent cycles[0m                                         [2m                [0m
[2;36m                    [0m         [39m+  node->state = STATE_CLEAR;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+  [0m[35m/[0m[35m/[0m[39m Recursively free children[0m                                                     [2m                [0m
[2;36m                    [0m         [39m+  if [0m[1;39m([0m[39mnode->edges[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [39m+    for [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < node->edge_count; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [39m+      if [0m[1;39m([0m[39mnode->edges[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;35mfree_tree_nodes[0m[1;39m([0m[39mnode->edges[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [39m+      [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mfree[0m[1;39m([0m[39mnode->edges[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m+  [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+  [0m[35m/[0m[35m/[0m[39m Free the node itself[0m                                                          [2m                [0m
[2;36m                    [0m         [39m   [0m[1;35mfree[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+[0m[1;39m}[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+[0m[35m/[0m[35m/[0m[39m Walk the tree to calculate the e37vk checksum[0m                                   [2m                [0m
[2;36m                    [0m         [39m+static uint32_t [0m[1;35mcompute_tree_checksum[0m[1;39m([0m[39mTreeNode *node, unsigned int depth[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m+[0m[1;39m{[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m+  [0m[35m/[0m[35m/[0m[39m Phase [0m[1;36m1[0m[39m: Compute checksum without freeing[0m                                     [2m                [0m
[2;36m                    [0m         [39m+  uint32_t sum = [0m[1;35mcompute_tree_checksum_internal[0m[1;39m([0m[39mnode, depth[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+  [0m[35m/[0m[35m/[0m[39m Phase [0m[1;36m2[0m[39m: Free all allocated nodes safely[0m                                      [2m                [0m
[2;36m                    [0m         [39m+  [0m[1;35mfree_tree_nodes[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m   return sum;[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m [0m[1;39m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz_encode_stream[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz_encode_stream -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                 [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz_encode_stream[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39m-[0m[33mmax_len[0m[39m=[0m[1;36m4096[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                       [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2806381060[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m2399[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m2399[0m[39m [0m[1;39m[[0m[1;36m0x55aed5b4d3e8[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55aed5b4dd47[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m2399[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m2399[0m[39m [0m[1;39m[[0m[1;36m0x55aed5b4dd48[0m[39m,[0m[1;36m0x55aed5b57338[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz_encode_stream[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                         [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-use-after-free on address [0m[1;36m0x5060000000a0[0m[39m at pc [0m [2m                [0m
[2;36m                    [0m         [1;36m0x55aed5ab53cc[0m[39m bp [0m[1;36m0x7ffca3d2e2d0[0m[39m sp [0m[1;36m0x7ffca3d2e2c8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m8[0m[39m at [0m[1;36m0x5060000000a0[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m51[0m[39m [0m[1;39m([0m[1;36m8[0m[39m-byte-read-heap-use-after-free[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55aed5ab53cb[0m[39m in compute_tree_checksum [0m                                     [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m79:34[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55aed5ab4ca6[0m[39m in lzma_tree [0m[35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m100:15[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55aed5ab49ea[0m[39m in lzma_check_update [0m[35m/src/xz/src/liblzma/check/[0m[95mcheck.c[0m[39m:[0m[1;92m143:23[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55aed5ab0a9e[0m[39m in block_encode [0m                                              [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/common/[0m[95mblock_encoder.c[0m[39m:[0m[1;92m82:4[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55aed5aa6094[0m[39m in stream_encode [0m                                             [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/common/[0m[95mstream_encoder.c[0m[39m:[0m[1;92m158:24[0m                                  [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55aed5aa439c[0m[39m in lzma_code [0m[35m/src/xz/src/liblzma/common/[0m[95mcommon.c[0m[39m:[0m[1;92m293:17[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55aed5aa2b32[0m[39m in fuzz_code [0m[35m/src/xz/tests/ossfuzz/./[0m[95mfuzz_common.h[0m[39m:[0m[1;92m63:18[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55aed5aa2b32[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/xz/tests/ossfuzz/[0m[95mfuzz_encode_stream.c[0m[39m:[0m[1;92m81:2[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55aed59572e0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55aed5942555[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55aed5947fef[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55aed5973292[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x7ff29013f082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55aed593a73d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz_encode_stream+0x4c73d[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: compute_tree_checksum--lzma_tree--lzma_check_update[0m                    [2m                [0m
[2;36m                    [0m         [1;36m0x5060000000a0[0m[39m is located [0m[1;36m32[0m[39m bytes inside of [0m[1;36m56[0m[39m-byte region [0m                        [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x506000000080[0m[39m,[0m[1;36m0x5060000000b8[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mfreed by thread T0 here:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55aed5a62e16[0m[39m in free [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m52:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55aed5ab534c[0m[39m in compute_tree_checksum [0m                                     [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m90:3[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55aed5ab52a4[0m[39m in compute_tree_checksum [0m                                     [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m82:16[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55aed5ab52a4[0m[39m in compute_tree_checksum [0m                                     [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m82:16[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55aed5ab4ca6[0m[39m in lzma_tree [0m[35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m100:15[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55aed5ab49ea[0m[39m in lzma_check_update [0m[35m/src/xz/src/liblzma/check/[0m[95mcheck.c[0m[39m:[0m[1;92m143:23[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55aed5ab0a9e[0m[39m in block_encode [0m                                              [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/common/[0m[95mblock_encoder.c[0m[39m:[0m[1;92m82:4[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55aed5aa6094[0m[39m in stream_encode [0m                                             [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/common/[0m[95mstream_encoder.c[0m[39m:[0m[1;92m158:24[0m                                  [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55aed5aa439c[0m[39m in lzma_code [0m[35m/src/xz/src/liblzma/common/[0m[95mcommon.c[0m[39m:[0m[1;92m293:17[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55aed5aa2b32[0m[39m in fuzz_code [0m[35m/src/xz/tests/ossfuzz/./[0m[95mfuzz_common.h[0m[39m:[0m[1;92m63:18[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55aed5aa2b32[0m[39m in LLVMFuzzerTestOneInput [0m                                   [2m                [0m
[2;36m                    [0m         [35m/src/xz/tests/ossfuzz/[0m[95mfuzz_encode_stream.c[0m[39m:[0m[1;92m81:2[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55aed59572e0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m    [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x55aed5942555[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55aed5947fef[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x55aed5973292[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m15[0m[39m [0m[1;36m0x7ff29013f082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_free--compute_tree_checksum--compute_tree_checksum[0m       [2m                [0m
[2;36m                    [0m         [39mpreviously allocated by thread T0 here:[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55aed5a630af[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55aed5ab4d4a[0m[39m in create_tree [0m[35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m33:20[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55aed5ab4c9c[0m[39m in lzma_tree [0m[35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m99:20[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55aed5ab49ea[0m[39m in lzma_check_update [0m[35m/src/xz/src/liblzma/check/[0m[95mcheck.c[0m[39m:[0m[1;92m143:23[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55aed5ab0a9e[0m[39m in block_encode [0m                                              [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/common/[0m[95mblock_encoder.c[0m[39m:[0m[1;92m82:4[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55aed5aa6094[0m[39m in stream_encode [0m                                             [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/common/[0m[95mstream_encoder.c[0m[39m:[0m[1;92m158:24[0m                                  [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55aed5aa439c[0m[39m in lzma_code [0m[35m/src/xz/src/liblzma/common/[0m[95mcommon.c[0m[39m:[0m[1;92m293:17[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55aed5aa2b32[0m[39m in fuzz_code [0m[35m/src/xz/tests/ossfuzz/./[0m[95mfuzz_common.h[0m[39m:[0m[1;92m63:18[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55aed5aa2b32[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/xz/tests/ossfuzz/[0m[95mfuzz_encode_stream.c[0m[39m:[0m[1;92m81:2[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55aed59572e0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55aed5942555[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55aed5947fef[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x55aed5973292[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x7ff29013f082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--create_tree--lzma_tree[0m                           [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-use-after-free [0m                                     [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m79:34[0m[39m in compute_tree_checksum[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x505ffffffe00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x505ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x505fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x505fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000000[0m[39m: fa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m01[0m[39m fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x506000000080[0m[39m: fd fd fd fd[0m[1;39m[[0m[39mfd[0m[1;39m][0m[39mfd fd fa fa fa fa fa fd fd fd fd[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000100[0m[39m: fd fd fd fa fa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000180[0m[39m: fa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000200[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39mMS: [0m[1;36m0[0m[39m ; base unit: [0m[1;36m0000000000000000000000000000000000000000[0m                         [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mxz[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m           [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp9nhgtsim[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz_encode_stream -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA heap-use-after-free vulnerability has been detected in the XZ Utils library [0m      [2m                [0m
[2;36m                    [0m         [39mduring fuzz testing of the `fuzz_encode_stream` component. The issue occurs in the [0m [2m                [0m
[2;36m                    [0m         [39m`compute_tree_checksum` function within the `treeck.c` file, where memory is [0m       [2m                [0m
[2;36m                    [0m         [39maccessed after being freed. This vulnerability has been assigned a scariness score [0m [2m                [0m
[2;36m                    [0m         [39mof [0m[1;36m51[0m[39m and is classified as an [0m[1;36m8[0m[39m-byte-read-heap-use-after-free error.[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Issue Overview[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mThe AddressSanitizer [0m[1;39m([0m[39mASan[0m[1;39m)[0m[39m detected a heap-use-after-free vulnerability where a [0m   [2m                [0m
[2;36m                    [0m         [39mREAD operation of [0m[1;36m8[0m[39m bytes is performed on a memory address [0m[1;39m([0m[39m`[0m[1;36m0x5060000000a0[0m[39m`[0m[1;39m)[0m[39m that [0m [2m                [0m
[2;36m                    [0m         [39mhas already been freed. The error occurs during the execution of the [0m               [2m                [0m
[2;36m                    [0m         [39m`fuzz_encode_stream` fuzzer with the following configuration:[0m                       [2m                [0m
[2;36m                    [0m         [39m- RSS limit: [0m[1;36m2560[0m[39m MB[0m                                                                [2m                [0m
[2;36m                    [0m         [39m- Timeout: [0m[1;36m25[0m[39m seconds[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Runs: [0m[1;36m100[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m- Max length: [0m[1;36m4096[0m[39m bytes[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Vulnerability Type[0m                                                              [2m                [0m
[2;36m                    [0m         [39mThis is a **heap-use-after-free** vulnerability, which occurs when a program [0m       [2m                [0m
[2;36m                    [0m         [39mattempts to access memory that has already been deallocated. This type of [0m          [2m                [0m
[2;36m                    [0m         [39mvulnerability can lead to:[0m                                                          [2m                [0m
[2;36m                    [0m         [39m- Crashes and program instability[0m                                                   [2m                [0m
[2;36m                    [0m         [39m- Potential arbitrary code execution[0m                                                [2m                [0m
[2;36m                    [0m         [39m- Information disclosure[0m                                                            [2m                [0m
[2;36m                    [0m         [39m- Data corruption[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Stack Trace Analysis[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**The problematic read operation occurs at:**[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m#[0m[1;36m0[0m[39m compute_tree_checksum [0m[1;39m([0m[35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m79:34[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [39m#[0m[1;36m1[0m[39m lzma_tree [0m[1;39m([0m[35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m100:15[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [39m#[0m[1;36m2[0m[39m lzma_check_update [0m[1;39m([0m[35m/src/xz/src/liblzma/check/[0m[95mcheck.c[0m[39m:[0m[1;92m143:23[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [39m#[0m[1;36m3[0m[39m block_encode [0m[1;39m([0m[35m/src/xz/src/liblzma/common/[0m[95mblock_encoder.c[0m[39m:[0m[1;92m82:4[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m#[0m[1;36m4[0m[39m stream_encode [0m[1;39m([0m[35m/src/xz/src/liblzma/common/[0m[95mstream_encoder.c[0m[39m:[0m[1;92m158:24[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39m#[0m[1;36m5[0m[39m lzma_code [0m[1;39m([0m[35m/src/xz/src/liblzma/common/[0m[95mcommon.c[0m[39m:[0m[1;92m293:17[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**The memory was freed by:**[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m#[0m[1;36m0[0m[39m free[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m#[0m[1;36m1[0m[39m compute_tree_checksum [0m[1;39m([0m[35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m90:3[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [39m#[0m[1;36m2[0m[39m compute_tree_checksum [0m[1;39m([0m[35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m82:16[0m[1;39m)[0m[39m [0m[1;39m[[0m[39mrecursive [0m     [2m                [0m
[2;36m                    [0m         [39mcall[0m[1;39m][0m                                                                               [2m                [0m
[2;36m                    [0m         [39m#[0m[1;36m3[0m[39m compute_tree_checksum [0m[1;39m([0m[35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m82:16[0m[1;39m)[0m[39m [0m[1;39m[[0m[39mrecursive [0m     [2m                [0m
[2;36m                    [0m         [39mcall[0m[1;39m][0m                                                                               [2m                [0m
[2;36m                    [0m         [39m#[0m[1;36m4[0m[39m lzma_tree [0m[1;39m([0m[35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m100:15[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**The memory was originally allocated by:**[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m#[0m[1;36m0[0m[39m malloc[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m#[0m[1;36m1[0m[39m create_tree [0m[1;39m([0m[35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m33:20[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [39m#[0m[1;36m2[0m[39m lzma_tree [0m[1;39m([0m[35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m99:20[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Important Observations[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Recursive Function Behavior**: The `compute_tree_checksum` function appears to[0m [2m                [0m
[2;36m                    [0m         [39mbe called recursively, as evidenced by the stack trace showing multiple entries at [0m [2m                [0m
[2;36m                    [0m         [39mline [0m[1;36m82[0m[39m. The memory is freed during one of these recursive calls [0m[1;39m([0m[39mat line [0m[1;36m90[0m[1;39m)[0m[39m, but [0m [2m                [0m
[2;36m                    [0m         [39mis subsequently accessed at line [0m[1;36m79[0m[39m.[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Memory Region Details**: The affected memory region is a [0m[1;36m56[0m[39m-byte allocation at[0m [2m                [0m
[2;36m                    [0m         [39maddress range `[0m[1;39m[[0m[1;36m0x506000000080[0m[39m, [0m[1;36m0x5060000000b8[0m[1;39m)[0m[39m`. The use-after-free occurs [0m[1;36m32[0m[39m [0m     [2m                [0m
[2;36m                    [0m         [39mbytes into this region at address `[0m[1;36m0x5060000000a0[0m[39m`.[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Tree Structure Management**: The issue involves tree structure manipulation, [0m  [2m                [0m
[2;36m                    [0m         [39mwith functions `create_tree`, `compute_tree_checksum`, and `lzma_tree` being key [0m   [2m                [0m
[2;36m                    [0m         [39mcomponents in the allocation, deallocation, and traversal of tree nodes.[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Call Chain**: The vulnerability is triggered through the encoding pipeline: [0m   [2m                [0m
[2;36m                    [0m         [39m`lzma_code` → `stream_encode` → `block_encode` → `lzma_check_update` → `lzma_tree` [0m [2m                [0m
[2;36m                    [0m         [39m→ `compute_tree_checksum`.[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas Requiring Investigation[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo gain a holistic understanding of this vulnerability, the following parts of the [0m [2m                [0m
[2;36m                    [0m         [39mcodebase should be thoroughly examined:[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **`[0m[35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m`**:[0m                                        [2m                [0m
[2;36m                    [0m         [39m   - Lines [0m[1;36m79[0m[39m-[0m[1;36m90[0m[39m: The critical section where the use-after-free occurs[0m              [2m                [0m
[2;36m                    [0m         [39m   - The `compute_tree_checksum` function: Understanding its recursive logic and [0m   [2m                [0m
[2;36m                    [0m         [39mmemory management[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   - The `create_tree` function [0m[1;39m([0m[39mline [0m[1;36m33[0m[1;39m)[0m[39m: How tree nodes are allocated[0m             [2m                [0m
[2;36m                    [0m         [39m   - The `lzma_tree` function [0m[1;39m([0m[39mlines [0m[1;36m99[0m[39m-[0m[1;36m100[0m[1;39m)[0m[39m: The entry point for tree operations[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **`[0m[35m/src/xz/src/liblzma/check/[0m[95mcheck.c[0m[39m`**:[0m                                         [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m143[0m[39m: The `lzma_check_update` function that calls into the tree checksum [0m  [2m                [0m
[2;36m                    [0m         [39mlogic[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **`[0m[35m/src/xz/src/liblzma/common/[0m[95mblock_encoder.c[0m[39m`**:[0m                                [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m82[0m[39m: The `block_encode` function that initiates checksum updates[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **`[0m[35m/src/xz/src/liblzma/common/[0m[95mstream_encoder.c[0m[39m`**:[0m                               [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m158[0m[39m: The `stream_encode` function in the encoding pipeline[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **`[0m[35m/src/xz/src/liblzma/common/[0m[95mcommon.c[0m[39m`**:[0m                                       [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m293[0m[39m: The `lzma_code` function as the main API entry point[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe investigation should focus on understanding the lifecycle of tree node [0m         [2m                [0m
[2;36m                    [0m         [39mallocations, the recursive traversal patterns in `compute_tree_checksum`, and the [0m  [2m                [0m
[2;36m                    [0m         [39mconditions under which nodes are freed while still being referenced by other parts [0m [2m                [0m
[2;36m                    [0m         [39mof the tree structure.[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz_encode_stream[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz_encode_stream -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                 [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz_encode_stream[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39m-[0m[33mmax_len[0m[39m=[0m[1;36m4096[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                       [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2806381060[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m2399[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m2399[0m[39m [0m[1;39m[[0m[1;36m0x55aed5b4d3e8[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55aed5b4dd47[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m2399[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m2399[0m[39m [0m[1;39m[[0m[1;36m0x55aed5b4dd48[0m[39m,[0m[1;36m0x55aed5b57338[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz_encode_stream[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                         [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-use-after-free on address [0m[1;36m0x5060000000a0[0m[39m at pc [0m [2m                [0m
[2;36m                    [0m         [1;36m0x55aed5ab53cc[0m[39m bp [0m[1;36m0x7ffca3d2e2d0[0m[39m sp [0m[1;36m0x7ffca3d2e2c8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m8[0m[39m at [0m[1;36m0x5060000000a0[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m51[0m[39m [0m[1;39m([0m[1;36m8[0m[39m-byte-read-heap-use-after-free[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55aed5ab53cb[0m[39m in compute_tree_checksum [0m                                     [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m79:34[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55aed5ab4ca6[0m[39m in lzma_tree [0m[35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m100:15[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55aed5ab49ea[0m[39m in lzma_check_update [0m[35m/src/xz/src/liblzma/check/[0m[95mcheck.c[0m[39m:[0m[1;92m143:23[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55aed5ab0a9e[0m[39m in block_encode [0m                                              [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/common/[0m[95mblock_encoder.c[0m[39m:[0m[1;92m82:4[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55aed5aa6094[0m[39m in stream_encode [0m                                             [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/common/[0m[95mstream_encoder.c[0m[39m:[0m[1;92m158:24[0m                                  [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55aed5aa439c[0m[39m in lzma_code [0m[35m/src/xz/src/liblzma/common/[0m[95mcommon.c[0m[39m:[0m[1;92m293:17[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55aed5aa2b32[0m[39m in fuzz_code [0m[35m/src/xz/tests/ossfuzz/./[0m[95mfuzz_common.h[0m[39m:[0m[1;92m63:18[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55aed5aa2b32[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/xz/tests/ossfuzz/[0m[95mfuzz_encode_stream.c[0m[39m:[0m[1;92m81:2[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55aed59572e0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55aed5942555[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55aed5947fef[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55aed5973292[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x7ff29013f082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55aed593a73d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz_encode_stream+0x4c73d[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: compute_tree_checksum--lzma_tree--lzma_check_update[0m                    [2m                [0m
[2;36m                    [0m         [1;36m0x5060000000a0[0m[39m is located [0m[1;36m32[0m[39m bytes inside of [0m[1;36m56[0m[39m-byte region [0m                        [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x506000000080[0m[39m,[0m[1;36m0x5060000000b8[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mfreed by thread T0 here:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55aed5a62e16[0m[39m in free [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m52:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55aed5ab534c[0m[39m in compute_tree_checksum [0m                                     [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m90:3[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55aed5ab52a4[0m[39m in compute_tree_checksum [0m                                     [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m82:16[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55aed5ab52a4[0m[39m in compute_tree_checksum [0m                                     [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m82:16[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55aed5ab4ca6[0m[39m in lzma_tree [0m[35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m100:15[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55aed5ab49ea[0m[39m in lzma_check_update [0m[35m/src/xz/src/liblzma/check/[0m[95mcheck.c[0m[39m:[0m[1;92m143:23[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55aed5ab0a9e[0m[39m in block_encode [0m                                              [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/common/[0m[95mblock_encoder.c[0m[39m:[0m[1;92m82:4[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55aed5aa6094[0m[39m in stream_encode [0m                                             [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/common/[0m[95mstream_encoder.c[0m[39m:[0m[1;92m158:24[0m                                  [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55aed5aa439c[0m[39m in lzma_code [0m[35m/src/xz/src/liblzma/common/[0m[95mcommon.c[0m[39m:[0m[1;92m293:17[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55aed5aa2b32[0m[39m in fuzz_code [0m[35m/src/xz/tests/ossfuzz/./[0m[95mfuzz_common.h[0m[39m:[0m[1;92m63:18[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55aed5aa2b32[0m[39m in LLVMFuzzerTestOneInput [0m                                   [2m                [0m
[2;36m                    [0m         [35m/src/xz/tests/ossfuzz/[0m[95mfuzz_encode_stream.c[0m[39m:[0m[1;92m81:2[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55aed59572e0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m    [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x55aed5942555[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55aed5947fef[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x55aed5973292[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m15[0m[39m [0m[1;36m0x7ff29013f082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_free--compute_tree_checksum--compute_tree_checksum[0m       [2m                [0m
[2;36m                    [0m         [39mpreviously allocated by thread T0 here:[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55aed5a630af[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55aed5ab4d4a[0m[39m in create_tree [0m[35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m33:20[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55aed5ab4c9c[0m[39m in lzma_tree [0m[35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m99:20[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55aed5ab49ea[0m[39m in lzma_check_update [0m[35m/src/xz/src/liblzma/check/[0m[95mcheck.c[0m[39m:[0m[1;92m143:23[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55aed5ab0a9e[0m[39m in block_encode [0m                                              [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/common/[0m[95mblock_encoder.c[0m[39m:[0m[1;92m82:4[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55aed5aa6094[0m[39m in stream_encode [0m                                             [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/common/[0m[95mstream_encoder.c[0m[39m:[0m[1;92m158:24[0m                                  [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55aed5aa439c[0m[39m in lzma_code [0m[35m/src/xz/src/liblzma/common/[0m[95mcommon.c[0m[39m:[0m[1;92m293:17[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55aed5aa2b32[0m[39m in fuzz_code [0m[35m/src/xz/tests/ossfuzz/./[0m[95mfuzz_common.h[0m[39m:[0m[1;92m63:18[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55aed5aa2b32[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/xz/tests/ossfuzz/[0m[95mfuzz_encode_stream.c[0m[39m:[0m[1;92m81:2[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55aed59572e0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55aed5942555[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55aed5947fef[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x55aed5973292[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x7ff29013f082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--create_tree--lzma_tree[0m                           [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-use-after-free [0m                                     [2m                [0m
[2;36m                    [0m         [35m/src/xz/src/liblzma/check/[0m[95mtreeck.c[0m[39m:[0m[1;92m79:34[0m[39m in compute_tree_checksum[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x505ffffffe00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x505ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x505fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x505fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000000[0m[39m: fa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m01[0m[39m fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x506000000080[0m[39m: fd fd fd fd[0m[1;39m[[0m[39mfd[0m[1;39m][0m[39mfd fd fa fa fa fa fa fd fd fd fd[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000100[0m[39m: fd fd fd fa fa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000180[0m[39m: fa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000200[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39mMS: [0m[1;36m0[0m[39m ; base unit: [0m[1;36m0000000000000000000000000000000000000000[0m                         [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mxz[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m           [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp9nhgtsim[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz_encode_stream -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/check/treeck.[0m[1;92mc:1[0m[39m-[0m[1;36m103[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \file       treeck.c[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \brief      Tree based checksum for the embedded e37vk file type[0m              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:#include [0m[32m"check.h"[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:#include [0m[32m"treeck.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:#include <stdlib.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:#include <stdint.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:#include <string.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:[0m[35m/[0m[35m/[0m[39m Simple deterministic hash function [0m[1;39m([0m[39mdjb2[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:static unsigned long [0m[1;35mhash_data[0m[1;39m([0m[39mconst uint8_t *data, size_t len[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:  unsigned long hash = HASH_SEED;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:  for [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < len; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:    hash = [0m[1;39m([0m[1;39m([0m[39mhash << [0m[1;36m5[0m[1;39m)[0m[39m + hash[0m[1;39m)[0m[39m + data[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m; [0m[35m/[0m[35m/[0m[39m hash * [0m[1;36m33[0m[39m + c[0m                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:  return hash;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m[35m/[0m[35m/[0m[39m Create a checksum tree from the input data[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:static TreeNode* [0m[1;35mcreate_tree[0m[1;39m([0m[39mconst uint8_t *data, size_t len, size_t depth, [0m     [2m                [0m
[2;36m                    [0m         [39msize_t max_depth, unsigned long seed, TreeNode* parent[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:  [0m[35m/[0m[35m/[0m[39m Basic checks on remaining data[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:  if [0m[1;39m([0m[39mdepth >= max_depth || len < [0m[1;35msizeof[0m[1;39m([0m[39mtree_field_t[0m[1;39m)[0m[39m*TREE_FIELDS[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:    return NULL;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:  [0m[35m/[0m[35m/[0m[39m Create tree node[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:  TreeNode *node = [0m[1;35mmalloc[0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39mTreeNode[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:  if [0m[1;39m([0m[39m!node[0m[1;39m)[0m[39m [0m[1;35mexit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:  [0m[35m/[0m[35m/[0m[39m Configure the node block[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:  node->value = data[0m[1;39m[[0m[39mdepth % len[0m[1;39m][0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:  node->state = STATE_CLEAR;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:  node->block_width = *[0m[1;39m([0m[39mtree_field_t*[0m[1;39m)[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:  node->block_height = *[0m[1;39m([0m[39mtree_field_t*[0m[1;39m)[0m[1;39m([0m[39mdata+[0m[1;35msizeof[0m[1;39m([0m[39mtree_field_t[0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:  node->block_size = node->block_width * node->block_height;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:  [0m[35m/[0m[35m/[0m[39m Decide edge count[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:  seed = seed * [0m[1;36m31[0m[39m + node->value;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:  node->edge_count = [0m[1;39m([0m[39mseed % [0m[1;39m([0m[39mMAX_EDGES + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:  node->edges = [0m[1;35mmalloc[0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39mTreeNode*[0m[1;39m)[0m[39m * node->edge_count[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:  if [0m[1;39m([0m[39m!node->edges[0m[1;39m)[0m[39m [0m[1;35mexit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  [0m[35m/[0m[35m/[0m[39m Build child nodes[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  for [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < node->edge_count; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    if [0m[1;39m([0m[33mi[0m[39m==node->edge_count-[0m[1;36m1[0m[39m && [0m                                                [2m                [0m
[2;36m                    [0m         [39mnode->[0m[33mblock_size[0m[39m==MAX_BLOCK_WIDTH*MAX_BLOCK_HEIGHT[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:      [0m[35m/[0m[35m/[0m[39m Max-sized sections must maintain a backlink to the parent[0m               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:      node->edges[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = parent;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    else [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:      [0m[35m/[0m[35m/[0m[39m Use offset in seed to choose next depth[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:      size_t next_depth = depth + [0m[1;39m([0m[39mseed % [0m[1;39m([0m[39mmax_depth - depth[0m[1;39m)[0m[1;39m)[0m[39m + [0m[1;36m1[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:      node->edges[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = [0m[1;35mcreate_tree[0m[1;39m([0m[39mdata + node->edge_count, len - [0m               [2m                [0m
[2;36m                    [0m         [39mnode->edge_count, next_depth, max_depth, seed + i * [0m[1;36m13[0m[39m, node[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:  return node;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m[35m/[0m[35m/[0m[39m Walk the tree to calculate the e37vk checksum[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:static uint32_t [0m[1;35mcompute_tree_checksum[0m[1;39m([0m[39mTreeNode *node, unsigned int depth[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:  [0m[35m/[0m[35m/[0m[39m Skip if already hashed[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:  if [0m[1;39m([0m[39m!node || node->state == STATE_HASHED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    return [0m[1;36m0[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  [0m[35m/[0m[35m/[0m[39m Compute initial checksum from depth and value[0m                               [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint32_t sum = node->value * [0m[1;39m([0m[39mdepth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:  [0m[35m/[0m[35m/[0m[39m Traverse the child nodes if not already visited[0m                             [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:  if [0m[1;39m([0m[39mnode->state == STATE_CLEAR[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    node->state = STATE_VISITED;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    for [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < node->edge_count; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:      TreeNode *child = node->edges[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:      if [0m[1;39m([0m[39mchild[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        sum += [0m[1;35mcompute_tree_checksum[0m[1;39m([0m[39mchild, depth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:      [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    node->state = STATE_HASHED;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:  [0m[35m/[0m[35m/[0m[39m Free the node and edges[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:  [0m[1;35mfree[0m[1;39m([0m[39mnode->edges[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:  [0m[1;35mfree[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:  return sum;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m95:e[0m[39mxtern [0m[1;35mLZMA_API[0m[1;39m([0m[39muint32_t[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m[1;35mlzma_tree[0m[1;39m([0m[39mconst uint8_t *buf, size_t size, uint32_t checksum[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:  unsigned long seed = [0m[1;35mhash_data[0m[1;39m([0m[39mbuf, size[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:  TreeNode *root = [0m[1;35mcreate_tree[0m[1;39m([0m[39mbuf, size, [0m[1;36m0[0m[39m, [0m[1;36m16[0m[39m, seed, NULL[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:  checksum ^= [0m[1;35mcompute_tree_checksum[0m[1;39m([0m[39mroot, [0m[1;36m0[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:  return checksum;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/check/treeck.[0m[1;92mc:1[0m[39m-[0m[1;36m103[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \file       treeck.c[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \brief      Tree based checksum for the embedded e37vk file type[0m              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:#include [0m[32m"check.h"[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:#include [0m[32m"treeck.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:#include <stdlib.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:#include <stdint.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:#include <string.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:[0m[35m/[0m[35m/[0m[39m Simple deterministic hash function [0m[1;39m([0m[39mdjb2[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:static unsigned long [0m[1;35mhash_data[0m[1;39m([0m[39mconst uint8_t *data, size_t len[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:  unsigned long hash = HASH_SEED;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:  for [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < len; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:    hash = [0m[1;39m([0m[1;39m([0m[39mhash << [0m[1;36m5[0m[1;39m)[0m[39m + hash[0m[1;39m)[0m[39m + data[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m; [0m[35m/[0m[35m/[0m[39m hash * [0m[1;36m33[0m[39m + c[0m                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:  return hash;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m[35m/[0m[35m/[0m[39m Create a checksum tree from the input data[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:static TreeNode* [0m[1;35mcreate_tree[0m[1;39m([0m[39mconst uint8_t *data, size_t len, size_t depth, [0m     [2m                [0m
[2;36m                    [0m         [39msize_t max_depth, unsigned long seed, TreeNode* parent[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:  [0m[35m/[0m[35m/[0m[39m Basic checks on remaining data[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:  if [0m[1;39m([0m[39mdepth >= max_depth || len < [0m[1;35msizeof[0m[1;39m([0m[39mtree_field_t[0m[1;39m)[0m[39m*TREE_FIELDS[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:    return NULL;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:  [0m[35m/[0m[35m/[0m[39m Create tree node[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:  TreeNode *node = [0m[1;35mmalloc[0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39mTreeNode[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:  if [0m[1;39m([0m[39m!node[0m[1;39m)[0m[39m [0m[1;35mexit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:  [0m[35m/[0m[35m/[0m[39m Configure the node block[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:  node->value = data[0m[1;39m[[0m[39mdepth % len[0m[1;39m][0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:  node->state = STATE_CLEAR;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:  node->block_width = *[0m[1;39m([0m[39mtree_field_t*[0m[1;39m)[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:  node->block_height = *[0m[1;39m([0m[39mtree_field_t*[0m[1;39m)[0m[1;39m([0m[39mdata+[0m[1;35msizeof[0m[1;39m([0m[39mtree_field_t[0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:  node->block_size = node->block_width * node->block_height;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:  [0m[35m/[0m[35m/[0m[39m Decide edge count[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:  seed = seed * [0m[1;36m31[0m[39m + node->value;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:  node->edge_count = [0m[1;39m([0m[39mseed % [0m[1;39m([0m[39mMAX_EDGES + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:  node->edges = [0m[1;35mmalloc[0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39mTreeNode*[0m[1;39m)[0m[39m * node->edge_count[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:  if [0m[1;39m([0m[39m!node->edges[0m[1;39m)[0m[39m [0m[1;35mexit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  [0m[35m/[0m[35m/[0m[39m Build child nodes[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  for [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < node->edge_count; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    if [0m[1;39m([0m[33mi[0m[39m==node->edge_count-[0m[1;36m1[0m[39m && [0m                                                [2m                [0m
[2;36m                    [0m         [39mnode->[0m[33mblock_size[0m[39m==MAX_BLOCK_WIDTH*MAX_BLOCK_HEIGHT[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:      [0m[35m/[0m[35m/[0m[39m Max-sized sections must maintain a backlink to the parent[0m               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:      node->edges[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = parent;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    else [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:      [0m[35m/[0m[35m/[0m[39m Use offset in seed to choose next depth[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:      size_t next_depth = depth + [0m[1;39m([0m[39mseed % [0m[1;39m([0m[39mmax_depth - depth[0m[1;39m)[0m[1;39m)[0m[39m + [0m[1;36m1[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:      node->edges[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = [0m[1;35mcreate_tree[0m[1;39m([0m[39mdata + node->edge_count, len - [0m               [2m                [0m
[2;36m                    [0m         [39mnode->edge_count, next_depth, max_depth, seed + i * [0m[1;36m13[0m[39m, node[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:  return node;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m[35m/[0m[35m/[0m[39m Walk the tree to calculate the e37vk checksum[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:static uint32_t [0m[1;35mcompute_tree_checksum[0m[1;39m([0m[39mTreeNode *node, unsigned int depth[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:  [0m[35m/[0m[35m/[0m[39m Skip if already hashed[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:  if [0m[1;39m([0m[39m!node || node->state == STATE_HASHED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    return [0m[1;36m0[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  [0m[35m/[0m[35m/[0m[39m Compute initial checksum from depth and value[0m                               [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint32_t sum = node->value * [0m[1;39m([0m[39mdepth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:  [0m[35m/[0m[35m/[0m[39m Traverse the child nodes if not already visited[0m                             [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:  if [0m[1;39m([0m[39mnode->state == STATE_CLEAR[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    node->state = STATE_VISITED;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    for [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < node->edge_count; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:      TreeNode *child = node->edges[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:      if [0m[1;39m([0m[39mchild[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        sum += [0m[1;35mcompute_tree_checksum[0m[1;39m([0m[39mchild, depth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:      [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    node->state = STATE_HASHED;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:  [0m[35m/[0m[35m/[0m[39m Free the node and edges[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:  [0m[1;35mfree[0m[1;39m([0m[39mnode->edges[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:  [0m[1;35mfree[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:  return sum;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m95:e[0m[39mxtern [0m[1;35mLZMA_API[0m[1;39m([0m[39muint32_t[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m[1;35mlzma_tree[0m[1;39m([0m[39mconst uint8_t *buf, size_t size, uint32_t checksum[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:  unsigned long seed = [0m[1;35mhash_data[0m[1;39m([0m[39mbuf, size[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:  TreeNode *root = [0m[1;35mcreate_tree[0m[1;39m([0m[39mbuf, size, [0m[1;36m0[0m[39m, [0m[1;36m16[0m[39m, seed, NULL[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:  checksum ^= [0m[1;35mcompute_tree_checksum[0m[1;39m([0m[39mroot, [0m[1;36m0[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:  return checksum;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/check/check.[0m[1;92mc:140[0m[39m-[0m[1;36m150[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:    [0m[39mcase LZMA_CHECK_TREE:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    [0m[39m        [0m[39mcheck->state.tree = [0m[1;35mlzma_tree[0m[1;39m([0m[39mbuf, size, check->state.tree[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:    [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:    [0m[39mdefault:[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    [0m[39mreturn;[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/check/treeck.[0m[1;92mc:15[0m[39m-[0m[1;36m25[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:[0m[35m/[0m[35m/[0m[39m Simple deterministic hash function [0m[1;39m([0m[39mdjb2[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:static unsigned long [0m[1;35mhash_data[0m[1;39m([0m[39mconst uint8_t *data, size_t len[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:  unsigned long hash = HASH_SEED;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:  for [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < len; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:    hash = [0m[1;39m([0m[1;39m([0m[39mhash << [0m[1;36m5[0m[1;39m)[0m[39m + hash[0m[1;39m)[0m[39m + data[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m; [0m[35m/[0m[35m/[0m[39m hash * [0m[1;36m33[0m[39m + c[0m                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:  return hash;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m[35m/[0m[35m/[0m[39m Create a checksum tree from the input data[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/check/treeck.[0m[1;92mc:26[0m[39m-[0m[1;36m55[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:static TreeNode* [0m[1;35mcreate_tree[0m[1;39m([0m[39mconst uint8_t *data, size_t len, size_t depth, [0m     [2m                [0m
[2;36m                    [0m         [39msize_t max_depth, unsigned long seed, TreeNode* parent[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:  [0m[35m/[0m[35m/[0m[39m Basic checks on remaining data[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:  if [0m[1;39m([0m[39mdepth >= max_depth || len < [0m[1;35msizeof[0m[1;39m([0m[39mtree_field_t[0m[1;39m)[0m[39m*TREE_FIELDS[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:    return NULL;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:  [0m[35m/[0m[35m/[0m[39m Create tree node[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:  TreeNode *node = [0m[1;35mmalloc[0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39mTreeNode[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:  if [0m[1;39m([0m[39m!node[0m[1;39m)[0m[39m [0m[1;35mexit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:  [0m[35m/[0m[35m/[0m[39m Configure the node block[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:  node->value = data[0m[1;39m[[0m[39mdepth % len[0m[1;39m][0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:  node->state = STATE_CLEAR;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:  node->block_width = *[0m[1;39m([0m[39mtree_field_t*[0m[1;39m)[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:  node->block_height = *[0m[1;39m([0m[39mtree_field_t*[0m[1;39m)[0m[1;39m([0m[39mdata+[0m[1;35msizeof[0m[1;39m([0m[39mtree_field_t[0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:  node->block_size = node->block_width * node->block_height;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:  [0m[35m/[0m[35m/[0m[39m Decide edge count[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:  seed = seed * [0m[1;36m31[0m[39m + node->value;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:  node->edge_count = [0m[1;39m([0m[39mseed % [0m[1;39m([0m[39mMAX_EDGES + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:  node->edges = [0m[1;35mmalloc[0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39mTreeNode*[0m[1;39m)[0m[39m * node->edge_count[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:  if [0m[1;39m([0m[39m!node->edges[0m[1;39m)[0m[39m [0m[1;35mexit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  [0m[35m/[0m[35m/[0m[39m Build child nodes[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  for [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < node->edge_count; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    if [0m[1;39m([0m[33mi[0m[39m==node->edge_count-[0m[1;36m1[0m[39m && [0m                                                [2m                [0m
[2;36m                    [0m         [39mnode->[0m[33mblock_size[0m[39m==MAX_BLOCK_WIDTH*MAX_BLOCK_HEIGHT[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:      [0m[35m/[0m[35m/[0m[39m Max-sized sections must maintain a backlink to the parent[0m               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:      node->edges[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = parent;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    else [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/check/treeck.[0m[1;92mc:69[0m[39m-[0m[1;36m95[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:  if [0m[1;39m([0m[39m!node || node->state == STATE_HASHED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    return [0m[1;36m0[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  [0m[35m/[0m[35m/[0m[39m Compute initial checksum from depth and value[0m                               [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint32_t sum = node->value * [0m[1;39m([0m[39mdepth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:  [0m[35m/[0m[35m/[0m[39m Traverse the child nodes if not already visited[0m                             [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:  if [0m[1;39m([0m[39mnode->state == STATE_CLEAR[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    node->state = STATE_VISITED;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    for [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < node->edge_count; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:      TreeNode *child = node->edges[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:      if [0m[1;39m([0m[39mchild[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        sum += [0m[1;35mcompute_tree_checksum[0m[1;39m([0m[39mchild, depth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:      [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    node->state = STATE_HASHED;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:  [0m[35m/[0m[35m/[0m[39m Free the node and edges[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:  [0m[1;35mfree[0m[1;39m([0m[39mnode->edges[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:  [0m[1;35mfree[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:  return sum;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m95:e[0m[39mxtern [0m[1;35mLZMA_API[0m[1;39m([0m[39muint32_t[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/check/treeck.[0m[1;92mc:96[0m[39m-[0m[1;36m103[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m[1;35mlzma_tree[0m[1;39m([0m[39mconst uint8_t *buf, size_t size, uint32_t checksum[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:  unsigned long seed = [0m[1;35mhash_data[0m[1;39m([0m[39mbuf, size[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:  TreeNode *root = [0m[1;35mcreate_tree[0m[1;39m([0m[39mbuf, size, [0m[1;36m0[0m[39m, [0m[1;36m16[0m[39m, seed, NULL[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:  checksum ^= [0m[1;35mcompute_tree_checksum[0m[1;39m([0m[39mroot, [0m[1;36m0[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:  return checksum;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/check/treeck.[0m[1;92mc:1[0m[39m-[0m[1;36m103[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \file       treeck.c[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \brief      Tree based checksum for the embedded e37vk file type[0m              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:#include [0m[32m"check.h"[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:#include [0m[32m"treeck.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:#include <stdlib.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:#include <stdint.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:#include <string.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:[0m[35m/[0m[35m/[0m[39m Simple deterministic hash function [0m[1;39m([0m[39mdjb2[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:static unsigned long [0m[1;35mhash_data[0m[1;39m([0m[39mconst uint8_t *data, size_t len[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:  unsigned long hash = HASH_SEED;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:  for [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < len; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:    hash = [0m[1;39m([0m[1;39m([0m[39mhash << [0m[1;36m5[0m[1;39m)[0m[39m + hash[0m[1;39m)[0m[39m + data[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m; [0m[35m/[0m[35m/[0m[39m hash * [0m[1;36m33[0m[39m + c[0m                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:  return hash;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m[35m/[0m[35m/[0m[39m Create a checksum tree from the input data[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:static TreeNode* [0m[1;35mcreate_tree[0m[1;39m([0m[39mconst uint8_t *data, size_t len, size_t depth, [0m     [2m                [0m
[2;36m                    [0m         [39msize_t max_depth, unsigned long seed, TreeNode* parent[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:  [0m[35m/[0m[35m/[0m[39m Basic checks on remaining data[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:  if [0m[1;39m([0m[39mdepth >= max_depth || len < [0m[1;35msizeof[0m[1;39m([0m[39mtree_field_t[0m[1;39m)[0m[39m*TREE_FIELDS[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:    return NULL;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:  [0m[35m/[0m[35m/[0m[39m Create tree node[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:  TreeNode *node = [0m[1;35mmalloc[0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39mTreeNode[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:  if [0m[1;39m([0m[39m!node[0m[1;39m)[0m[39m [0m[1;35mexit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:  [0m[35m/[0m[35m/[0m[39m Configure the node block[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:  node->value = data[0m[1;39m[[0m[39mdepth % len[0m[1;39m][0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:  node->state = STATE_CLEAR;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:  node->block_width = *[0m[1;39m([0m[39mtree_field_t*[0m[1;39m)[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:  node->block_height = *[0m[1;39m([0m[39mtree_field_t*[0m[1;39m)[0m[1;39m([0m[39mdata+[0m[1;35msizeof[0m[1;39m([0m[39mtree_field_t[0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:  node->block_size = node->block_width * node->block_height;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:  [0m[35m/[0m[35m/[0m[39m Decide edge count[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:  seed = seed * [0m[1;36m31[0m[39m + node->value;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:  node->edge_count = [0m[1;39m([0m[39mseed % [0m[1;39m([0m[39mMAX_EDGES + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:  node->edges = [0m[1;35mmalloc[0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39mTreeNode*[0m[1;39m)[0m[39m * node->edge_count[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:  if [0m[1;39m([0m[39m!node->edges[0m[1;39m)[0m[39m [0m[1;35mexit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  [0m[35m/[0m[35m/[0m[39m Build child nodes[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  for [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < node->edge_count; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    if [0m[1;39m([0m[33mi[0m[39m==node->edge_count-[0m[1;36m1[0m[39m && [0m                                                [2m                [0m
[2;36m                    [0m         [39mnode->[0m[33mblock_size[0m[39m==MAX_BLOCK_WIDTH*MAX_BLOCK_HEIGHT[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:      [0m[35m/[0m[35m/[0m[39m Max-sized sections must maintain a backlink to the parent[0m               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:      node->edges[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = parent;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    else [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:      [0m[35m/[0m[35m/[0m[39m Use offset in seed to choose next depth[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:      size_t next_depth = depth + [0m[1;39m([0m[39mseed % [0m[1;39m([0m[39mmax_depth - depth[0m[1;39m)[0m[1;39m)[0m[39m + [0m[1;36m1[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:      node->edges[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = [0m[1;35mcreate_tree[0m[1;39m([0m[39mdata + node->edge_count, len - [0m               [2m                [0m
[2;36m                    [0m         [39mnode->edge_count, next_depth, max_depth, seed + i * [0m[1;36m13[0m[39m, node[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:  return node;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m[35m/[0m[35m/[0m[39m Walk the tree to calculate the e37vk checksum[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:static uint32_t [0m[1;35mcompute_tree_checksum[0m[1;39m([0m[39mTreeNode *node, unsigned int depth[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:  [0m[35m/[0m[35m/[0m[39m Skip if already hashed[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:  if [0m[1;39m([0m[39m!node || node->state == STATE_HASHED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    return [0m[1;36m0[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  [0m[35m/[0m[35m/[0m[39m Compute initial checksum from depth and value[0m                               [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint32_t sum = node->value * [0m[1;39m([0m[39mdepth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:  [0m[35m/[0m[35m/[0m[39m Traverse the child nodes if not already visited[0m                             [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:  if [0m[1;39m([0m[39mnode->state == STATE_CLEAR[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    node->state = STATE_VISITED;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    for [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < node->edge_count; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:      TreeNode *child = node->edges[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:      if [0m[1;39m([0m[39mchild[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        sum += [0m[1;35mcompute_tree_checksum[0m[1;39m([0m[39mchild, depth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:      [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    node->state = STATE_HASHED;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:  [0m[35m/[0m[35m/[0m[39m Free the node and edges[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:  [0m[1;35mfree[0m[1;39m([0m[39mnode->edges[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:  [0m[1;35mfree[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:  return sum;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m95:e[0m[39mxtern [0m[1;35mLZMA_API[0m[1;39m([0m[39muint32_t[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m[1;35mlzma_tree[0m[1;39m([0m[39mconst uint8_t *buf, size_t size, uint32_t checksum[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:  unsigned long seed = [0m[1;35mhash_data[0m[1;39m([0m[39mbuf, size[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:  TreeNode *root = [0m[1;35mcreate_tree[0m[1;39m([0m[39mbuf, size, [0m[1;36m0[0m[39m, [0m[1;36m16[0m[39m, seed, NULL[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:  checksum ^= [0m[1;35mcompute_tree_checksum[0m[1;39m([0m[39mroot, [0m[1;36m0[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:  return checksum;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/check/check.h:[0m[1;36m1[0m[39m-[0m[1;36m100[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[35m/[0m[39m SPDX-License-Identifier: 0BSD[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \file       check.h[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \brief      Internal API to different integrity check functions[0m               [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m[35m/[0m[35m/[0m[39m  Author:     Lasse Collin[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m  [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:#ifndef LZMA_CHECK_H[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:#define LZMA_CHECK_H[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:#include [0m[32m"common.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m[35m/[0m[35m/[0m[39m If the function for external SHA-[0m[1;36m256[0m[39m is missing, use the internal SHA-[0m[1;36m256[0m     [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m[35m/[0m[35m/[0m[39m code. Due to how configure works, these defines can only get defined when[0m     [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m[35m/[0m[35m/[0m[39m both a usable header and a type have already been found.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:#if ![0m[1;39m([0m[1;35mdefined[0m[1;39m([0m[39mHAVE_CC_SHA256_INIT[0m[1;39m)[0m[39m \[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:     [0m[39m        [0m[39m|| [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_SHA256_INIT[0m[1;39m)[0m[39m \[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:     [0m[39m        [0m[39m|| [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_SHA256INIT[0m[1;39m)[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:#    [0m[39mdefine HAVE_INTERNAL_SHA256 [0m[1;36m1[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_INTERNAL_SHA256[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m[35m/[0m[35m/[0m[39m Nothing[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_COMMONCRYPTO_COMMONDIGEST_H[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:#    [0m[39minclude <CommonCrypto/CommonDigest.h>[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_SHA256_H[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:#    [0m[39minclude <sys/types.h>[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:#    [0m[39minclude <sha256.h>[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_SHA2_H[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:#    [0m[39minclude <sys/types.h>[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:#    [0m[39minclude <sha2.h>[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_INTERNAL_SHA256[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m State for the internal SHA-[0m[1;36m256[0m[39m implementation[0m                                [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:typedef struct [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     [0m[35m/[0m[35m/[0m[35m/[0m[39m Internal state[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     [0m[39muint32_t state[0m[1;39m[[0m[1;36m8[0m[1;39m][0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     [0m[35m/[0m[35m/[0m[35m/[0m[39m Size of the message excluding padding[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     [0m[39muint64_t size;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m[1;39m}[0m[39m lzma_sha256_state;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_CC_SHA256_CTX[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:typedef CC_SHA256_CTX lzma_sha256_state;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_SHA256_CTX[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:typedef SHA256_CTX lzma_sha256_state;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_SHA2_CTX[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:typedef SHA2_CTX lzma_sha256_state;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_INTERNAL_SHA256[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m[35m/[0m[35m/[0m[39m Nothing[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_CC_SHA256_INIT[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:#    [0m[39mdefine [0m[1;35mLZMA_SHA256FUNC[0m[1;39m([0m[39mx[0m[1;39m)[0m[39m CC_SHA256_ ## x[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_SHA256_INIT[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:#    [0m[39mdefine [0m[1;35mLZMA_SHA256FUNC[0m[1;39m([0m[39mx[0m[1;39m)[0m[39m SHA256_ ## x[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_SHA256INIT[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:#    [0m[39mdefine [0m[1;35mLZMA_SHA256FUNC[0m[1;39m([0m[39mx[0m[1;39m)[0m[39m SHA256 ## x[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m[35m/[0m[35m/[0m[39m Index hashing needs the best possible hash function [0m[1;39m([0m[39mpreferably[0m               [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m[35m/[0m[35m/[0m[39m a cryptographic hash[0m[1;39m)[0m[39m for maximum reliability.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_CHECK_SHA256[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:#    [0m[39mdefine LZMA_CHECK_BEST LZMA_CHECK_SHA256[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_CHECK_CRC64[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:#    [0m[39mdefine LZMA_CHECK_BEST LZMA_CHECK_CRC64[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:#else[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:#    [0m[39mdefine LZMA_CHECK_BEST LZMA_CHECK_CRC32[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \brief      Structure to hold internal state of the check being calculated[0m   [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \note       This is not in the public API because this structure may[0m         [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m             change in future if new integrity check algorithms are added.[0m    [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:typedef struct [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     [0m[35m/[0m[35m/[0m[35m/[0m[39m Buffer to hold the final result and a temporary buffer for SHA256.[0m      [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     [0m[39munion [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     [0m[39m        [0m[39muint8_t u8[0m[1;39m[[0m[1;36m64[0m[1;39m][0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     [0m[39m        [0m[39muint32_t u32[0m[1;39m[[0m[1;36m16[0m[1;39m][0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     [0m[39m        [0m[39muint64_t u64[0m[1;39m[[0m[1;36m8[0m[1;39m][0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     [0m[1;39m}[0m[39m buffer;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     [0m[35m/[0m[35m/[0m[35m/[0m[39m Check-specific data[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     [0m[39munion [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     [0m[39m        [0m[39muint32_t crc32;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     [0m[39m        [0m[39muint64_t crc64;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     [0m[39m        [0m[39muint32_t tree;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:     [0m[39m        [0m[39mlzma_sha256_state sha256;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:     [0m[1;39m}[0m[39m state;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m[1;39m}[0m[39m lzma_check_state;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \brief      Initialize *check depending on type[0m                              [2m                [0m
[2;36m                    [0m         [1;92m100:e[0m[39mxtern void [0m[1;35mlzma_check_init[0m[1;39m([0m[39mlzma_check_state *check, lzma_check type[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/common/block_encoder.[0m[1;92mc:75[0m[39m-[0m[1;36m90[0m                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     [0m[39m        [0m[35m/[0m[35m/[0m[39m No need to check for overflow because we have already[0m            [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     [0m[39m        [0m[35m/[0m[35m/[0m[39m checked it at the beginning of this function.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     [0m[39m        [0m[39mcoder->uncompressed_size += in_used;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     [0m[39m        [0m[35m/[0m[35m/[0m[39m Call [0m[1;35mlzma_check_update[0m[1;39m([0m[1;39m)[0m[39m only if input was consumed. This[0m        [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     [0m[39m        [0m[35m/[0m[35m/[0m[39m avoids null pointer + [0m[1;36m0[0m[39m [0m[1;39m([0m[39mundefined behavior[0m[1;39m)[0m[39m when in == [0m[1;36m0[0m[39m.[0m       [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     [0m[39m        [0m[39mif [0m[1;39m([0m[39min_used > [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     [0m[39m        [0m[39m        [0m[1;35mlzma_check_update[0m[1;39m([0m[39m&coder->check, coder->block->check,[0m       [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39min + in_start, in_used[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     [0m[39m        [0m[39mif [0m[1;39m([0m[39mret != LZMA_STREAM_END || action == LZMA_SYNC_FLUSH[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     [0m[39m        [0m[39m        [0m[39mreturn ret;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     [0m[39m        [0m[1;35massert[0m[1;39m([0m[39m*in_pos == in_size[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     [0m[39m        [0m[1;35massert[0m[1;39m([0m[39maction == LZMA_FINISH[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/common/stream_encoder.[0m[1;92mc:150[0m[39m-[0m[1;36m165[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    [0m[39m        [0m[39mstatic const lzma_action convert[0m[1;39m[[0m[39mLZMA_ACTION_MAX + [0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:    [0m[39m        [0m[39m        [0m[39mLZMA_RUN,[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    [0m[39m        [0m[39m        [0m[39mLZMA_SYNC_FLUSH,[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:    [0m[39m        [0m[39m        [0m[39mLZMA_FINISH,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    [0m[39m        [0m[39m        [0m[39mLZMA_FINISH,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[39m        [0m[39m        [0m[39mLZMA_FINISH,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:    [0m[39m        [0m[1;39m}[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    [0m[39m        [0m[39mconst lzma_ret ret = coder->[0m[1;35mblock_encoder.code[0m[1;39m([0m                     [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mcoder->block_encoder.coder, allocator,[0m              [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39min, in_pos, in_size,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mout, out_pos, out_size, convert[0m[1;39m[[0m[39maction[0m[1;39m][0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39mret != LZMA_STREAM_END || action == LZMA_SYNC_FLUSH[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn ret;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:    [0m[39m        [0m[35m/[0m[35m/[0m[39m Add a new Index Record.[0m                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/common/common.[0m[1;92mc:285[0m[39m-[0m[1;36m300[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:    [0m[39mcase ISEQ_ERROR:[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:    [0m[39mdefault:[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:    [0m[39m        [0m[39mreturn LZMA_PROG_ERROR;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:    [0m[39msize_t in_pos = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:    [0m[39msize_t out_pos = [0m[1;36m0[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:    [0m[39mlzma_ret ret = strm->internal->[0m[1;35mnext.code[0m[1;39m([0m                                   [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:    [0m[39m        [0m[39m        [0m[39mstrm->internal->next.coder, strm->allocator,[0m                [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:    [0m[39m        [0m[39m        [0m[39mstrm->next_in, &in_pos, strm->avail_in,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:    [0m[39m        [0m[39m        [0m[39mstrm->next_out, &out_pos, strm->avail_out, action[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:    [0m[35m/[0m[35m/[0m[39m Updating next_in and next_out has to be skipped when they are NULL[0m       [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:    [0m[35m/[0m[35m/[0m[39m to avoid null pointer + [0m[1;36m0[0m[39m [0m[1;39m([0m[39mundefined behavior[0m[1;39m)[0m[39m. Do this by checking[0m      [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:    [0m[35m/[0m[35m/[0m[39m in_pos > [0m[1;36m0[0m[39m and out_pos > [0m[1;36m0[0m[39m because this way NULL + non-zero [0m[1;39m([0m[39ma bug[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/check/treeck.[0m[1;92mc:70[0m[39m-[0m[1;36m92[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    return [0m[1;36m0[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  [0m[35m/[0m[35m/[0m[39m Compute initial checksum from depth and value[0m                               [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint32_t sum = node->value * [0m[1;39m([0m[39mdepth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:  [0m[35m/[0m[35m/[0m[39m Traverse the child nodes if not already visited[0m                             [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:  if [0m[1;39m([0m[39mnode->state == STATE_CLEAR[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    node->state = STATE_VISITED;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    for [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < node->edge_count; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:      TreeNode *child = node->edges[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:      if [0m[1;39m([0m[39mchild[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        sum += [0m[1;35mcompute_tree_checksum[0m[1;39m([0m[39mchild, depth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:      [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    node->state = STATE_HASHED;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:  [0m[35m/[0m[35m/[0m[39m Free the node and edges[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:  [0m[1;35mfree[0m[1;39m([0m[39mnode->edges[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:  [0m[1;35mfree[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:  return sum;[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/check/treeck.[0m[1;92mc:25[0m[39m-[0m[1;36m60[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m[35m/[0m[35m/[0m[39m Create a checksum tree from the input data[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:static TreeNode* [0m[1;35mcreate_tree[0m[1;39m([0m[39mconst uint8_t *data, size_t len, size_t depth, [0m     [2m                [0m
[2;36m                    [0m         [39msize_t max_depth, unsigned long seed, TreeNode* parent[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:  [0m[35m/[0m[35m/[0m[39m Basic checks on remaining data[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:  if [0m[1;39m([0m[39mdepth >= max_depth || len < [0m[1;35msizeof[0m[1;39m([0m[39mtree_field_t[0m[1;39m)[0m[39m*TREE_FIELDS[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:    return NULL;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:  [0m[35m/[0m[35m/[0m[39m Create tree node[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:  TreeNode *node = [0m[1;35mmalloc[0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39mTreeNode[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:  if [0m[1;39m([0m[39m!node[0m[1;39m)[0m[39m [0m[1;35mexit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:  [0m[35m/[0m[35m/[0m[39m Configure the node block[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:  node->value = data[0m[1;39m[[0m[39mdepth % len[0m[1;39m][0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:  node->state = STATE_CLEAR;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:  node->block_width = *[0m[1;39m([0m[39mtree_field_t*[0m[1;39m)[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:  node->block_height = *[0m[1;39m([0m[39mtree_field_t*[0m[1;39m)[0m[1;39m([0m[39mdata+[0m[1;35msizeof[0m[1;39m([0m[39mtree_field_t[0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:  node->block_size = node->block_width * node->block_height;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:  [0m[35m/[0m[35m/[0m[39m Decide edge count[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:  seed = seed * [0m[1;36m31[0m[39m + node->value;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:  node->edge_count = [0m[1;39m([0m[39mseed % [0m[1;39m([0m[39mMAX_EDGES + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:  node->edges = [0m[1;35mmalloc[0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39mTreeNode*[0m[1;39m)[0m[39m * node->edge_count[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:  if [0m[1;39m([0m[39m!node->edges[0m[1;39m)[0m[39m [0m[1;35mexit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  [0m[35m/[0m[35m/[0m[39m Build child nodes[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  for [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < node->edge_count; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    if [0m[1;39m([0m[33mi[0m[39m==node->edge_count-[0m[1;36m1[0m[39m && [0m                                                [2m                [0m
[2;36m                    [0m         [39mnode->[0m[33mblock_size[0m[39m==MAX_BLOCK_WIDTH*MAX_BLOCK_HEIGHT[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:      [0m[35m/[0m[35m/[0m[39m Max-sized sections must maintain a backlink to the parent[0m               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:      node->edges[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = parent;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    else [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:      [0m[35m/[0m[35m/[0m[39m Use offset in seed to choose next depth[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:      size_t next_depth = depth + [0m[1;39m([0m[39mseed % [0m[1;39m([0m[39mmax_depth - depth[0m[1;39m)[0m[1;39m)[0m[39m + [0m[1;36m1[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:      node->edges[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = [0m[1;35mcreate_tree[0m[1;39m([0m[39mdata + node->edge_count, len - [0m               [2m                [0m
[2;36m                    [0m         [39mnode->edge_count, next_depth, max_depth, seed + i * [0m[1;36m13[0m[39m, node[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/check/treeck.[0m[1;92mc:1[0m[39m-[0m[1;36m24[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \file       treeck.c[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \brief      Tree based checksum for the embedded e37vk file type[0m              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:#include [0m[32m"check.h"[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:#include [0m[32m"treeck.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:#include <stdlib.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:#include <stdint.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:#include <string.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:[0m[35m/[0m[35m/[0m[39m Simple deterministic hash function [0m[1;39m([0m[39mdjb2[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:static unsigned long [0m[1;35mhash_data[0m[1;39m([0m[39mconst uint8_t *data, size_t len[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:  unsigned long hash = HASH_SEED;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:  for [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < len; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:    hash = [0m[1;39m([0m[1;39m([0m[39mhash << [0m[1;36m5[0m[1;39m)[0m[39m + hash[0m[1;39m)[0m[39m + data[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m; [0m[35m/[0m[35m/[0m[39m hash * [0m[1;36m33[0m[39m + c[0m                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:  return hash;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/check/treeck.[0m[1;92mc:25[0m[39m-[0m[1;36m60[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m[35m/[0m[35m/[0m[39m Create a checksum tree from the input data[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:static TreeNode* [0m[1;35mcreate_tree[0m[1;39m([0m[39mconst uint8_t *data, size_t len, size_t depth, [0m     [2m                [0m
[2;36m                    [0m         [39msize_t max_depth, unsigned long seed, TreeNode* parent[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:  [0m[35m/[0m[35m/[0m[39m Basic checks on remaining data[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:  if [0m[1;39m([0m[39mdepth >= max_depth || len < [0m[1;35msizeof[0m[1;39m([0m[39mtree_field_t[0m[1;39m)[0m[39m*TREE_FIELDS[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:    return NULL;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:  [0m[35m/[0m[35m/[0m[39m Create tree node[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:  TreeNode *node = [0m[1;35mmalloc[0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39mTreeNode[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:  if [0m[1;39m([0m[39m!node[0m[1;39m)[0m[39m [0m[1;35mexit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:  [0m[35m/[0m[35m/[0m[39m Configure the node block[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:  node->value = data[0m[1;39m[[0m[39mdepth % len[0m[1;39m][0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:  node->state = STATE_CLEAR;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:  node->block_width = *[0m[1;39m([0m[39mtree_field_t*[0m[1;39m)[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:  node->block_height = *[0m[1;39m([0m[39mtree_field_t*[0m[1;39m)[0m[1;39m([0m[39mdata+[0m[1;35msizeof[0m[1;39m([0m[39mtree_field_t[0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:  node->block_size = node->block_width * node->block_height;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:  [0m[35m/[0m[35m/[0m[39m Decide edge count[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:  seed = seed * [0m[1;36m31[0m[39m + node->value;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:  node->edge_count = [0m[1;39m([0m[39mseed % [0m[1;39m([0m[39mMAX_EDGES + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:  node->edges = [0m[1;35mmalloc[0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39mTreeNode*[0m[1;39m)[0m[39m * node->edge_count[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:  if [0m[1;39m([0m[39m!node->edges[0m[1;39m)[0m[39m [0m[1;35mexit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  [0m[35m/[0m[35m/[0m[39m Build child nodes[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  for [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < node->edge_count; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    if [0m[1;39m([0m[33mi[0m[39m==node->edge_count-[0m[1;36m1[0m[39m && [0m                                                [2m                [0m
[2;36m                    [0m         [39mnode->[0m[33mblock_size[0m[39m==MAX_BLOCK_WIDTH*MAX_BLOCK_HEIGHT[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:      [0m[35m/[0m[35m/[0m[39m Max-sized sections must maintain a backlink to the parent[0m               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:      node->edges[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = parent;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    else [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:      [0m[35m/[0m[35m/[0m[39m Use offset in seed to choose next depth[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:      size_t next_depth = depth + [0m[1;39m([0m[39mseed % [0m[1;39m([0m[39mmax_depth - depth[0m[1;39m)[0m[1;39m)[0m[39m + [0m[1;36m1[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:      node->edges[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = [0m[1;35mcreate_tree[0m[1;39m([0m[39mdata + node->edge_count, len - [0m               [2m                [0m
[2;36m                    [0m         [39mnode->edge_count, next_depth, max_depth, seed + i * [0m[1;36m13[0m[39m, node[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/check/treeck.[0m[1;92mc:70[0m[39m-[0m[1;36m92[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    return [0m[1;36m0[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  [0m[35m/[0m[35m/[0m[39m Compute initial checksum from depth and value[0m                               [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint32_t sum = node->value * [0m[1;39m([0m[39mdepth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:  [0m[35m/[0m[35m/[0m[39m Traverse the child nodes if not already visited[0m                             [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:  if [0m[1;39m([0m[39mnode->state == STATE_CLEAR[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    node->state = STATE_VISITED;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    for [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < node->edge_count; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:      TreeNode *child = node->edges[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:      if [0m[1;39m([0m[39mchild[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        sum += [0m[1;35mcompute_tree_checksum[0m[1;39m([0m[39mchild, depth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:      [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    node->state = STATE_HASHED;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:  [0m[35m/[0m[35m/[0m[39m Free the node and edges[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:  [0m[1;35mfree[0m[1;39m([0m[39mnode->edges[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:  [0m[1;35mfree[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:  return sum;[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/check/treeck.[0m[1;92mc:1[0m[39m-[0m[1;36m25[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \file       treeck.c[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \brief      Tree based checksum for the embedded e37vk file type[0m              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:#include [0m[32m"check.h"[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:#include [0m[32m"treeck.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:#include <stdlib.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:#include <stdint.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:#include <string.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:[0m[35m/[0m[35m/[0m[39m Simple deterministic hash function [0m[1;39m([0m[39mdjb2[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:static unsigned long [0m[1;35mhash_data[0m[1;39m([0m[39mconst uint8_t *data, size_t len[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:  unsigned long hash = HASH_SEED;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:  for [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < len; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:    hash = [0m[1;39m([0m[1;39m([0m[39mhash << [0m[1;36m5[0m[1;39m)[0m[39m + hash[0m[1;39m)[0m[39m + data[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m; [0m[35m/[0m[35m/[0m[39m hash * [0m[1;36m33[0m[39m + c[0m                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:  return hash;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m[35m/[0m[35m/[0m[39m Create a checksum tree from the input data[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/check/check.[0m[1;92mc:130[0m[39m-[0m[1;36m155[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:#ifdef HAVE_CHECK_CRC64[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:    [0m[39mcase LZMA_CHECK_CRC64:[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    [0m[39m        [0m[39mcheck->state.crc64 = [0m[1;35mlzma_crc64[0m[1;39m([0m[39mbuf, size, check->state.crc64[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:#ifdef HAVE_CHECK_SHA256[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:    [0m[39mcase LZMA_CHECK_SHA256:[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:    [0m[39m        [0m[1;35mlzma_sha256_update[0m[1;39m([0m[39mbuf, size, check[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:    [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:    [0m[39mcase LZMA_CHECK_TREE:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    [0m[39m        [0m[39mcheck->state.tree = [0m[1;35mlzma_tree[0m[1;39m([0m[39mbuf, size, check->state.tree[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:    [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:    [0m[39mdefault:[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    [0m[39mreturn;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m153:e[0m[39mxtern void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:[0m[1;35mlzma_check_finish[0m[1;39m([0m[39mlzma_check_state *check, lzma_check type[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/check/check.[0m[1;92mc:1[0m[39m-[0m[1;36m50[0m                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[35m/[0m[39m SPDX-License-Identifier: 0BSD[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \file       check.c[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \brief      Single API to access different integrity checks[0m                   [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m[35m/[0m[35m/[0m[39m  Author:     Lasse Collin[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m  [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:#include [0m[32m"check.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m15:e[0m[39mxtern [0m[1;35mLZMA_API[0m[1;39m([0m[39mlzma_bool[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:[0m[1;35mlzma_check_is_supported[0m[1;39m([0m[39mlzma_check type[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:     [0m[39mif [0m[1;39m([0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m > LZMA_CHECK_ID_MAX[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:     [0m[39m        [0m[39mreturn false;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:     [0m[39mstatic const lzma_bool available_checks[0m[1;39m[[0m[39mLZMA_CHECK_ID_MAX + [0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:     [0m[39m        [0m[39mtrue,   [0m[35m/[0m[35m/[0m[39m LZMA_CHECK_NONE[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:#ifdef HAVE_CHECK_CRC32[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:     [0m[39m        [0m[39mtrue,[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:#else[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:     [0m[39m        [0m[39mfalse,[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:     [0m[39m        [0m[39mfalse,  [0m[35m/[0m[35m/[0m[39m Reserved[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:     [0m[39m        [0m[39mfalse,  [0m[35m/[0m[35m/[0m[39m Reserved[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:#ifdef HAVE_CHECK_CRC64[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:     [0m[39m        [0m[39mtrue,[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:#else[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:     [0m[39m        [0m[39mfalse,[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     [0m[39m        [0m[39mfalse,  [0m[35m/[0m[35m/[0m[39m Reserved[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     [0m[39m        [0m[39mfalse,  [0m[35m/[0m[35m/[0m[39m Reserved[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     [0m[39m        [0m[39mfalse,  [0m[35m/[0m[35m/[0m[39m Reserved[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     [0m[39m        [0m[39mfalse,  [0m[35m/[0m[35m/[0m[39m Reserved[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     [0m[39m        [0m[39mfalse,  [0m[35m/[0m[35m/[0m[39m Reserved[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:#ifdef HAVE_CHECK_SHA256[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     [0m[39m        [0m[39mtrue,[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:#else[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     [0m[39m        [0m[39mfalse,[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/check/treeck.[0m[1;92mc:60[0m[39m-[0m[1;36m70[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:  return node;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m[35m/[0m[35m/[0m[39m Walk the tree to calculate the e37vk checksum[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:static uint32_t [0m[1;35mcompute_tree_checksum[0m[1;39m([0m[39mTreeNode *node, unsigned int depth[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:  [0m[35m/[0m[35m/[0m[39m Skip if already hashed[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:  if [0m[1;39m([0m[39m!node || node->state == STATE_HASHED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    return [0m[1;36m0[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/check/treeck.[0m[1;92mc:1[0m[39m-[0m[1;36m103[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \file       treeck.c[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \brief      Tree based checksum for the embedded e37vk file type[0m              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:#include [0m[32m"check.h"[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:#include [0m[32m"treeck.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:#include <stdlib.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:#include <stdint.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:#include <string.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:[0m[35m/[0m[35m/[0m[39m Simple deterministic hash function [0m[1;39m([0m[39mdjb2[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:static unsigned long [0m[1;35mhash_data[0m[1;39m([0m[39mconst uint8_t *data, size_t len[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:  unsigned long hash = HASH_SEED;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:  for [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < len; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:    hash = [0m[1;39m([0m[1;39m([0m[39mhash << [0m[1;36m5[0m[1;39m)[0m[39m + hash[0m[1;39m)[0m[39m + data[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m; [0m[35m/[0m[35m/[0m[39m hash * [0m[1;36m33[0m[39m + c[0m                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:  return hash;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m[35m/[0m[35m/[0m[39m Create a checksum tree from the input data[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:static TreeNode* [0m[1;35mcreate_tree[0m[1;39m([0m[39mconst uint8_t *data, size_t len, size_t depth, [0m     [2m                [0m
[2;36m                    [0m         [39msize_t max_depth, unsigned long seed, TreeNode* parent[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:  [0m[35m/[0m[35m/[0m[39m Basic checks on remaining data[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:  if [0m[1;39m([0m[39mdepth >= max_depth || len < [0m[1;35msizeof[0m[1;39m([0m[39mtree_field_t[0m[1;39m)[0m[39m*TREE_FIELDS[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:    return NULL;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:  [0m[35m/[0m[35m/[0m[39m Create tree node[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:  TreeNode *node = [0m[1;35mmalloc[0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39mTreeNode[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:  if [0m[1;39m([0m[39m!node[0m[1;39m)[0m[39m [0m[1;35mexit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:  [0m[35m/[0m[35m/[0m[39m Configure the node block[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:  node->value = data[0m[1;39m[[0m[39mdepth % len[0m[1;39m][0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:  node->state = STATE_CLEAR;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:  node->block_width = *[0m[1;39m([0m[39mtree_field_t*[0m[1;39m)[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:  node->block_height = *[0m[1;39m([0m[39mtree_field_t*[0m[1;39m)[0m[1;39m([0m[39mdata+[0m[1;35msizeof[0m[1;39m([0m[39mtree_field_t[0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:  node->block_size = node->block_width * node->block_height;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:  [0m[35m/[0m[35m/[0m[39m Decide edge count[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:  seed = seed * [0m[1;36m31[0m[39m + node->value;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:  node->edge_count = [0m[1;39m([0m[39mseed % [0m[1;39m([0m[39mMAX_EDGES + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:  node->edges = [0m[1;35mmalloc[0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39mTreeNode*[0m[1;39m)[0m[39m * node->edge_count[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:  if [0m[1;39m([0m[39m!node->edges[0m[1;39m)[0m[39m [0m[1;35mexit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  [0m[35m/[0m[35m/[0m[39m Build child nodes[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  for [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < node->edge_count; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    if [0m[1;39m([0m[33mi[0m[39m==node->edge_count-[0m[1;36m1[0m[39m && [0m                                                [2m                [0m
[2;36m                    [0m         [39mnode->[0m[33mblock_size[0m[39m==MAX_BLOCK_WIDTH*MAX_BLOCK_HEIGHT[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:      [0m[35m/[0m[35m/[0m[39m Max-sized sections must maintain a backlink to the parent[0m               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:      node->edges[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = parent;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    else [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:      [0m[35m/[0m[35m/[0m[39m Use offset in seed to choose next depth[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:      size_t next_depth = depth + [0m[1;39m([0m[39mseed % [0m[1;39m([0m[39mmax_depth - depth[0m[1;39m)[0m[1;39m)[0m[39m + [0m[1;36m1[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:      node->edges[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = [0m[1;35mcreate_tree[0m[1;39m([0m[39mdata + node->edge_count, len - [0m               [2m                [0m
[2;36m                    [0m         [39mnode->edge_count, next_depth, max_depth, seed + i * [0m[1;36m13[0m[39m, node[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:  return node;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m[35m/[0m[35m/[0m[39m Walk the tree to calculate the e37vk checksum[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:static uint32_t [0m[1;35mcompute_tree_checksum[0m[1;39m([0m[39mTreeNode *node, unsigned int depth[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:  [0m[35m/[0m[35m/[0m[39m Skip if already hashed[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:  if [0m[1;39m([0m[39m!node || node->state == STATE_HASHED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    return [0m[1;36m0[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  [0m[35m/[0m[35m/[0m[39m Compute initial checksum from depth and value[0m                               [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint32_t sum = node->value * [0m[1;39m([0m[39mdepth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:  [0m[35m/[0m[35m/[0m[39m Traverse the child nodes if not already visited[0m                             [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:  if [0m[1;39m([0m[39mnode->state == STATE_CLEAR[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    node->state = STATE_VISITED;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    for [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < node->edge_count; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:      TreeNode *child = node->edges[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:      if [0m[1;39m([0m[39mchild[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        sum += [0m[1;35mcompute_tree_checksum[0m[1;39m([0m[39mchild, depth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:      [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    node->state = STATE_HASHED;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:  [0m[35m/[0m[35m/[0m[39m Free the node and edges[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:  [0m[1;35mfree[0m[1;39m([0m[39mnode->edges[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:  [0m[1;35mfree[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:  return sum;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m95:e[0m[39mxtern [0m[1;35mLZMA_API[0m[1;39m([0m[39muint32_t[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m[1;35mlzma_tree[0m[1;39m([0m[39mconst uint8_t *buf, size_t size, uint32_t checksum[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:  unsigned long seed = [0m[1;35mhash_data[0m[1;39m([0m[39mbuf, size[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:  TreeNode *root = [0m[1;35mcreate_tree[0m[1;39m([0m[39mbuf, size, [0m[1;36m0[0m[39m, [0m[1;36m16[0m[39m, seed, NULL[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:  checksum ^= [0m[1;35mcompute_tree_checksum[0m[1;39m([0m[39mroot, [0m[1;36m0[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:  return checksum;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/check/check.h:[0m[1;36m1[0m[39m-[0m[1;36m150[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[35m/[0m[39m SPDX-License-Identifier: 0BSD[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \file       check.h[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \brief      Internal API to different integrity check functions[0m               [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m[35m/[0m[35m/[0m[39m  Author:     Lasse Collin[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m  [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:#ifndef LZMA_CHECK_H[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:#define LZMA_CHECK_H[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:#include [0m[32m"common.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m[35m/[0m[35m/[0m[39m If the function for external SHA-[0m[1;36m256[0m[39m is missing, use the internal SHA-[0m[1;36m256[0m     [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m[35m/[0m[35m/[0m[39m code. Due to how configure works, these defines can only get defined when[0m     [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m[35m/[0m[35m/[0m[39m both a usable header and a type have already been found.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:#if ![0m[1;39m([0m[1;35mdefined[0m[1;39m([0m[39mHAVE_CC_SHA256_INIT[0m[1;39m)[0m[39m \[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:     [0m[39m        [0m[39m|| [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_SHA256_INIT[0m[1;39m)[0m[39m \[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:     [0m[39m        [0m[39m|| [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_SHA256INIT[0m[1;39m)[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:#    [0m[39mdefine HAVE_INTERNAL_SHA256 [0m[1;36m1[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_INTERNAL_SHA256[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m[35m/[0m[35m/[0m[39m Nothing[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_COMMONCRYPTO_COMMONDIGEST_H[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:#    [0m[39minclude <CommonCrypto/CommonDigest.h>[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_SHA256_H[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:#    [0m[39minclude <sys/types.h>[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:#    [0m[39minclude <sha256.h>[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_SHA2_H[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:#    [0m[39minclude <sys/types.h>[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:#    [0m[39minclude <sha2.h>[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_INTERNAL_SHA256[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m State for the internal SHA-[0m[1;36m256[0m[39m implementation[0m                                [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:typedef struct [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     [0m[35m/[0m[35m/[0m[35m/[0m[39m Internal state[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     [0m[39muint32_t state[0m[1;39m[[0m[1;36m8[0m[1;39m][0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     [0m[35m/[0m[35m/[0m[35m/[0m[39m Size of the message excluding padding[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     [0m[39muint64_t size;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m[1;39m}[0m[39m lzma_sha256_state;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_CC_SHA256_CTX[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:typedef CC_SHA256_CTX lzma_sha256_state;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_SHA256_CTX[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:typedef SHA256_CTX lzma_sha256_state;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_SHA2_CTX[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:typedef SHA2_CTX lzma_sha256_state;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_INTERNAL_SHA256[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m[35m/[0m[35m/[0m[39m Nothing[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_CC_SHA256_INIT[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:#    [0m[39mdefine [0m[1;35mLZMA_SHA256FUNC[0m[1;39m([0m[39mx[0m[1;39m)[0m[39m CC_SHA256_ ## x[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_SHA256_INIT[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:#    [0m[39mdefine [0m[1;35mLZMA_SHA256FUNC[0m[1;39m([0m[39mx[0m[1;39m)[0m[39m SHA256_ ## x[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_SHA256INIT[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:#    [0m[39mdefine [0m[1;35mLZMA_SHA256FUNC[0m[1;39m([0m[39mx[0m[1;39m)[0m[39m SHA256 ## x[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m[35m/[0m[35m/[0m[39m Index hashing needs the best possible hash function [0m[1;39m([0m[39mpreferably[0m               [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m[35m/[0m[35m/[0m[39m a cryptographic hash[0m[1;39m)[0m[39m for maximum reliability.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_CHECK_SHA256[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:#    [0m[39mdefine LZMA_CHECK_BEST LZMA_CHECK_SHA256[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_CHECK_CRC64[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:#    [0m[39mdefine LZMA_CHECK_BEST LZMA_CHECK_CRC64[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:#else[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:#    [0m[39mdefine LZMA_CHECK_BEST LZMA_CHECK_CRC32[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \brief      Structure to hold internal state of the check being calculated[0m   [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \note       This is not in the public API because this structure may[0m         [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m             change in future if new integrity check algorithms are added.[0m    [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:typedef struct [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     [0m[35m/[0m[35m/[0m[35m/[0m[39m Buffer to hold the final result and a temporary buffer for SHA256.[0m      [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     [0m[39munion [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     [0m[39m        [0m[39muint8_t u8[0m[1;39m[[0m[1;36m64[0m[1;39m][0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     [0m[39m        [0m[39muint32_t u32[0m[1;39m[[0m[1;36m16[0m[1;39m][0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     [0m[39m        [0m[39muint64_t u64[0m[1;39m[[0m[1;36m8[0m[1;39m][0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     [0m[1;39m}[0m[39m buffer;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     [0m[35m/[0m[35m/[0m[35m/[0m[39m Check-specific data[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     [0m[39munion [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     [0m[39m        [0m[39muint32_t crc32;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     [0m[39m        [0m[39muint64_t crc64;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     [0m[39m        [0m[39muint32_t tree;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:     [0m[39m        [0m[39mlzma_sha256_state sha256;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:     [0m[1;39m}[0m[39m state;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m[1;39m}[0m[39m lzma_check_state;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \brief      Initialize *check depending on type[0m                              [2m                [0m
[2;36m                    [0m         [1;92m100:e[0m[39mxtern void [0m[1;35mlzma_check_init[0m[1;39m([0m[39mlzma_check_state *check, lzma_check type[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m Update the check state[0m                                                      [2m                [0m
[2;36m                    [0m         [1;92m103:e[0m[39mxtern void [0m[1;35mlzma_check_update[0m[1;39m([0m[39mlzma_check_state *check, lzma_check type,[0m         [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[39m        [0m[39mconst uint8_t *buf, size_t size[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m Finish the check calculation and store the result to check->buffer.u8.[0m      [2m                [0m
[2;36m                    [0m         [1;92m107:e[0m[39mxtern void [0m[1;35mlzma_check_finish[0m[1;39m([0m[39mlzma_check_state *check, lzma_check type[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:#ifndef LZMA_SHA256FUNC[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m Prepare SHA-[0m[1;36m256[0m[39m state for new input.[0m                                        [2m                [0m
[2;36m                    [0m         [1;92m113:e[0m[39mxtern void [0m[1;35mlzma_sha256_init[0m[1;39m([0m[39mlzma_check_state *check[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m Update the SHA-[0m[1;36m256[0m[39m hash state[0m                                               [2m                [0m
[2;36m                    [0m         [1;92m116:e[0m[39mxtern void [0m[1;35mlzma_sha256_update[0m[1;39m([0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    [0m[39m        [0m[39mconst uint8_t *buf, size_t size, lzma_check_state *check[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m Finish the SHA-[0m[1;36m256[0m[39m calculation and store the result to check->buffer.u8.[0m    [2m                [0m
[2;36m                    [0m         [1;92m120:e[0m[39mxtern void [0m[1;35mlzma_sha256_finish[0m[1;39m([0m[39mlzma_check_state *check[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:#else[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:static inline void[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:[0m[1;35mlzma_sha256_init[0m[1;39m([0m[39mlzma_check_state *check[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:    [0m[1;35mLZMA_SHA256FUNC[0m[1;39m([0m[39mInit[0m[1;39m)[0m[1;39m([0m[39m&check->state.sha256[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:static inline void[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:[0m[1;35mlzma_sha256_update[0m[1;39m([0m[39mconst uint8_t *buf, size_t size, lzma_check_state *check[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_CC_SHA256_INIT[0m[1;39m)[0m[39m && SIZE_MAX > UINT32_MAX[0m                       [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    [0m[35m/[0m[35m/[0m[39m Darwin's CC_SHA256_Update takes uint32_t as the buffer size,[0m             [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:    [0m[35m/[0m[35m/[0m[39m so use a loop to support size_t.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:    [0m[39mwhile [0m[1;39m([0m[39msize > UINT32_MAX[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:    [0m[39m        [0m[1;35mLZMA_SHA256FUNC[0m[1;39m([0m[39mUpdate[0m[1;39m)[0m[1;39m([0m[39m&check->state.sha256, buf, UINT32_MAX[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:    [0m[39m        [0m[39mbuf += UINT32_MAX;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    [0m[39m        [0m[39msize -= UINT32_MAX;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    [0m[1;35mLZMA_SHA256FUNC[0m[1;39m([0m[39mUpdate[0m[1;39m)[0m[1;39m([0m[39m&check->state.sha256, buf, size[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static inline void[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:[0m[1;35mlzma_sha256_finish[0m[1;39m([0m[39mlzma_check_state *check[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/api/lzma/check.h:[0m[1;36m1[0m[39m-[0m[1;36m100[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* SPDX-License-Identifier: 0BSD *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m[35m/[0m[39m**[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * \file        lzma/check.h[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * \brief       Integrity checks[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * \note        Never include this file directly. Use <lzma.h> instead.[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: *[0m[35m/[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: * Author: Lasse Collin[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:#ifndef LZMA_H_INTERNAL[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:#    [0m[39merror Never include this file directly. Use <lzma.h> instead.[0m               [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m: * \brief       Type of the integrity check [0m[1;39m([0m[39mCheck ID[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m: * The .xz format supports multiple types of checks that are calculated[0m          [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m: * from the uncompressed data. They vary in both speed and ability to[0m            [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m: * detect errors.[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:typedef enum [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:     [0m[39mLZMA_CHECK_NONE     = [0m[1;36m0[0m[39m,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:     [0m[39m        [0m[35m/[0m[39m**<[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:     [0m[39m        [0m[39m * No Check is calculated.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:     [0m[39m        [0m[39m *[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:     [0m[39m        [0m[39m * Size of the Check field: [0m[1;36m0[0m[39m bytes[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:     [0m[39m        [0m[39m *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:     [0m[39mLZMA_CHECK_CRC32    = [0m[1;36m1[0m[39m,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:     [0m[39m        [0m[35m/[0m[39m**<[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:     [0m[39m        [0m[39m * CRC32 using the polynomial from the IEEE [0m[1;36m802.3[0m[39m standard[0m          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:     [0m[39m        [0m[39m *[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     [0m[39m        [0m[39m * Size of the Check field: [0m[1;36m4[0m[39m bytes[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     [0m[39m        [0m[39m *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     [0m[39mLZMA_CHECK_CRC64    = [0m[1;36m4[0m[39m,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     [0m[39m        [0m[35m/[0m[39m**<[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     [0m[39m        [0m[39m * CRC64 using the polynomial from the ECMA-[0m[1;36m182[0m[39m standard[0m            [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     [0m[39m        [0m[39m *[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     [0m[39m        [0m[39m * Size of the Check field: [0m[1;36m8[0m[39m bytes[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     [0m[39m        [0m[39m *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     [0m[39mLZMA_CHECK_SHA256   = [0m[1;36m10[0m[39m,[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     [0m[39m        [0m[35m/[0m[39m**<[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     [0m[39m        [0m[39m * SHA-[0m[1;36m256[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     [0m[39m        [0m[39m *[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     [0m[39m        [0m[39m * Size of the Check field: [0m[1;36m32[0m[39m bytes[0m                                [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     [0m[39m        [0m[39m *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     [0m[39mLZMA_CHECK_TREE    = [0m[1;36m11[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     [0m[39m        [0m[35m/[0m[39m**<[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     [0m[39m        [0m[39m * Tree-check[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     [0m[39m        [0m[39m *[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     [0m[39m        [0m[39m * Size of the Check field: [0m[1;36m4[0m[39m bytes[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     [0m[39m        [0m[39m *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m lzma_check;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m: * \brief       Maximum valid Check ID[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m: * The .xz file format specification specifies [0m[1;36m16[0m[39m Check IDs [0m[1;39m([0m[1;36m0[0m[39m-[0m[1;36m15[0m[1;39m)[0m[39m. Some[0m         [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m: * of them are only reserved, that is, no actual Check algorithm has been[0m        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m: * assigned. When decoding, liblzma still accepts unknown Check IDs for[0m          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m: * future compatibility. If a valid but unsupported Check ID is detected,[0m        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m: * liblzma can indicate a warning; see the flags LZMA_TELL_NO_CHECK,[0m             [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m: * LZMA_TELL_UNSUPPORTED_CHECK, and LZMA_TELL_ANY_CHECK in container.h.[0m          [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:#define LZMA_CHECK_ID_MAX [0m[1;36m15[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m: * \brief       Test if the given Check ID is supported[0m                          [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m: * LZMA_CHECK_NONE and LZMA_CHECK_CRC32 are always supported [0m[1;39m([0m[39meven if[0m            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m: * liblzma is built with limited features[0m[1;39m)[0m[39m.[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m: * \note        It is safe to call this with a value that is not in the[0m          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m: *              range [0m[1;39m[[0m[1;36m0[0m[39m, [0m[1;36m15[0m[1;39m][0m[39m; in that case the return value is always false.[0m    [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m: * \param       check   Check ID[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m: * \return      lzma_bool:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m: *              - true if Check ID is supported by this liblzma build.[0m           [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m: *              - false otherwise.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;92m91:e[0m[39mxtern [0m[1;35mLZMA_API[0m[1;39m([0m[39mlzma_bool[0m[1;39m)[0m[39m [0m[1;35mlzma_check_is_supported[0m[1;39m([0m[39mlzma_check check[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     [0m[39m        [0m[39mlzma_nothrow lzma_attr_const;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m: * \brief       Get the size of the Check field with the given Check ID[0m          [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m: * Although not all Check IDs have a check algorithm associated, the size of[0m     [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m: * every Check is already frozen. This function returns the size [0m[1;39m([0m[39min bytes[0m[1;39m)[0m[39m of[0m   [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m: * the Check field with the specified Check ID. The values are:[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/check/crc32_fast.[0m[1;92mc:1[0m[39m-[0m[1;36m100[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[35m/[0m[39m SPDX-License-Identifier: 0BSD[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \file       crc32_fast.c[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \brief      CRC32 calculation[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m[35m/[0m[35m/[0m[39m  Authors:    Lasse Collin[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:[0m[35m/[0m[35m/[0m[39m              Ilya Kurdyukov[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m[35m/[0m[35m/[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m  [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:#include [0m[32m"check.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:#include [0m[32m"crc_common.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mCRC_X86_CLMUL[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:#    [0m[39mdefine BUILDING_CRC_CLMUL [0m[1;36m32[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:#    [0m[39minclude [0m[32m"crc_x86_clmul.h"[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mCRC32_ARM64[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:#    [0m[39minclude [0m[32m"crc32_arm64.h"[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mCRC32_LOONGARCH[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:#    [0m[39minclude [0m[32m"crc32_loongarch.h"[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:#ifdef CRC32_GENERIC[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m[35m/[0m[35m/[0m[39m Generic CRC32 [0m[35m/[0m[35m/[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:#ifdef WORDS_BIGENDIAN[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:#    [0m[39minclude [0m[32m"crc32_table_be.h"[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:#else[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:#    [0m[39minclude [0m[32m"crc32_table_le.h"[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:#ifdef HAVE_CRC_X86_ASM[0m                                                          [2m                [0m
[2;36m                    [0m         [1;92m40:e[0m[39mxtern uint32_t [0m[1;35mlzma_crc32_generic[0m[1;39m([0m                                              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     [0m[39m        [0m[39mconst uint8_t *buf, size_t size, uint32_t crc[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:#else[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:static uint32_t[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m[1;35mlzma_crc32_generic[0m[1;39m([0m[39mconst uint8_t *buf, size_t size, uint32_t crc[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     [0m[39mcrc = ~crc;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:#ifdef WORDS_BIGENDIAN[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     [0m[39mcrc = [0m[1;35mbyteswap32[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     [0m[39mif [0m[1;39m([0m[39msize > [0m[1;36m8[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     [0m[39m        [0m[35m/[0m[35m/[0m[39m Fix the alignment, if needed. The if statement above[0m             [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     [0m[39m        [0m[35m/[0m[35m/[0m[39m ensures that this won't read past the end of buf[0m[1;39m[[0m[1;39m][0m[39m.[0m              [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     [0m[39m        [0m[39mwhile [0m[1;39m([0m[1;39m([0m[39muintptr_t[0m[1;39m)[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[39m & [0m[1;36m7[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     [0m[39m        [0m[39m        [0m[39mcrc = lzma_crc32_table[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m[[0m[39m*buf++ ^ [0m[1;35mA[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[1;39m][0m[39m ^ [0m[1;35mS8[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     [0m[39m        [0m[39m        [0m[39m--size;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     [0m[39m        [0m[35m/[0m[35m/[0m[39m Calculate the position where to stop.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     [0m[39m        [0m[39mconst uint8_t *const limit = buf + [0m[1;39m([0m[39msize & ~[0m[1;39m([0m[39msize_t[0m[1;39m)[0m[1;39m([0m[1;36m7[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     [0m[39m        [0m[35m/[0m[35m/[0m[39m Calculate how many bytes must be calculated separately[0m           [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     [0m[39m        [0m[35m/[0m[35m/[0m[39m before returning the result.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     [0m[39m        [0m[39msize &= [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[1;39m([0m[1;36m7[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     [0m[39m        [0m[35m/[0m[35m/[0m[39m Calculate the CRC32 using the slice-by-eight algorithm.[0m          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     [0m[39m        [0m[39mwhile [0m[1;39m([0m[39mbuf < limit[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     [0m[39m        [0m[39m        [0m[39mcrc ^= [0m[1;35maligned_read32ne[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     [0m[39m        [0m[39m        [0m[39mbuf += [0m[1;36m4[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     [0m[39m        [0m[39m        [0m[39mcrc = lzma_crc32_table[0m[1;39m[[0m[1;36m7[0m[1;39m][0m[1;39m[[0m[1;35mA[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[1;39m][0m                           [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     [0m[39m        [0m[39m        [0m[39m    ^ lzma_crc32_table[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[1;39m[[0m[1;35mB[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[1;39m][0m                           [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     [0m[39m        [0m[39m        [0m[39m    ^ lzma_crc32_table[0m[1;39m[[0m[1;36m5[0m[1;39m][0m[1;39m[[0m[1;35mC[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[1;39m][0m                           [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     [0m[39m        [0m[39m        [0m[39m    ^ lzma_crc32_table[0m[1;39m[[0m[1;36m4[0m[1;39m][0m[1;39m[[0m[1;35mD[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[1;39m][0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     [0m[39m        [0m[39m        [0m[39mconst uint32_t tmp = [0m[1;35maligned_read32ne[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     [0m[39m        [0m[39m        [0m[39mbuf += [0m[1;36m4[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     [0m[39m        [0m[39m        [0m[35m/[0m[35m/[0m[39m At least with some compilers, it is critical for[0m         [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     [0m[39m        [0m[39m        [0m[35m/[0m[35m/[0m[39m performance, that the crc variable is XORed[0m              [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     [0m[39m        [0m[39m        [0m[35m/[0m[35m/[0m[39m between the two table-lookup pairs.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     [0m[39m        [0m[39m        [0m[39mcrc = lzma_crc32_table[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[1;39m[[0m[1;35mA[0m[1;39m([0m[39mtmp[0m[1;39m)[0m[1;39m][0m                           [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     [0m[39m        [0m[39m        [0m[39m    ^ lzma_crc32_table[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[1;39m[[0m[1;35mB[0m[1;39m([0m[39mtmp[0m[1;39m)[0m[1;39m][0m                           [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     [0m[39m        [0m[39m        [0m[39m    ^ crc[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     [0m[39m        [0m[39m        [0m[39m    ^ lzma_crc32_table[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[1;39m[[0m[1;35mC[0m[1;39m([0m[39mtmp[0m[1;39m)[0m[1;39m][0m                           [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:     [0m[39m        [0m[39m        [0m[39m    ^ lzma_crc32_table[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m[[0m[1;35mD[0m[1;39m([0m[39mtmp[0m[1;39m)[0m[1;39m][0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     [0m[39mwhile [0m[1;39m([0m[39msize-- != [0m[1;36m0[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     [0m[39m        [0m[39mcrc = lzma_crc32_table[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m[[0m[39m*buf++ ^ [0m[1;35mA[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[1;39m][0m[39m ^ [0m[1;35mS8[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:#ifdef WORDS_BIGENDIAN[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:     [0m[39mcrc = [0m[1;35mbyteswap32[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     [0m[39mreturn ~crc;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:#endif [0m[35m/[0m[35m/[0m[39m HAVE_CRC_X86_ASM[0m                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/api/lzma/check.h:[0m[1;36m54[0m[39m-[0m[1;36m59[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     [0m[39mLZMA_CHECK_TREE    = [0m[1;36m11[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     [0m[39m        [0m[35m/[0m[39m**<[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     [0m[39m        [0m[39m * Tree-check[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     [0m[39m        [0m[39m *[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     [0m[39m        [0m[39m * Size of the Check field: [0m[1;36m4[0m[39m bytes[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     [0m[39m        [0m[39m *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/api/lzma/check.h:[0m[1;36m158[0m[39m-[0m[1;36m175[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m: * \brief       Calculate TREE[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m: * Calculate TREE using the new tree-based checksum routine.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m: * This function is used similarly to [0m[1;35mlzma_crc32[0m[1;39m([0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m: * \param       buf     Pointer to the input buffer[0m                             [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m: * \param       size    Size of the input buffer[0m                                [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m: * \param       checksum   Previously returned checksum value. This is used to[0m  [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m: *                      calculate the checksum of a big buffer in smaller[0m       [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m: *                      chunks.  Set to zero when starting a new calculation.[0m   [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m: * \return      Updated checksum value, which can be passed to this function[0m    [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m: *              again to continue tree-checksum calculation.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;92m173:e[0m[39mxtern [0m[1;35mLZMA_API[0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39m [0m[1;35mlzma_tree[0m[1;39m([0m                                            [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:    [0m[39m        [0m[39mconst uint8_t *buf, size_t size, uint32_t checksum[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[39m        [0m[39mlzma_nothrow lzma_attr_pure;[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/check/crc32_fast.[0m[1;92mc:43[0m[39m-[0m[1;36m99[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:static uint32_t[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m[1;35mlzma_crc32_generic[0m[1;39m([0m[39mconst uint8_t *buf, size_t size, uint32_t crc[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     [0m[39mcrc = ~crc;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:#ifdef WORDS_BIGENDIAN[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     [0m[39mcrc = [0m[1;35mbyteswap32[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     [0m[39mif [0m[1;39m([0m[39msize > [0m[1;36m8[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     [0m[39m        [0m[35m/[0m[35m/[0m[39m Fix the alignment, if needed. The if statement above[0m             [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     [0m[39m        [0m[35m/[0m[35m/[0m[39m ensures that this won't read past the end of buf[0m[1;39m[[0m[1;39m][0m[39m.[0m              [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     [0m[39m        [0m[39mwhile [0m[1;39m([0m[1;39m([0m[39muintptr_t[0m[1;39m)[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[39m & [0m[1;36m7[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     [0m[39m        [0m[39m        [0m[39mcrc = lzma_crc32_table[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m[[0m[39m*buf++ ^ [0m[1;35mA[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[1;39m][0m[39m ^ [0m[1;35mS8[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     [0m[39m        [0m[39m        [0m[39m--size;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     [0m[39m        [0m[35m/[0m[35m/[0m[39m Calculate the position where to stop.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     [0m[39m        [0m[39mconst uint8_t *const limit = buf + [0m[1;39m([0m[39msize & ~[0m[1;39m([0m[39msize_t[0m[1;39m)[0m[1;39m([0m[1;36m7[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     [0m[39m        [0m[35m/[0m[35m/[0m[39m Calculate how many bytes must be calculated separately[0m           [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     [0m[39m        [0m[35m/[0m[35m/[0m[39m before returning the result.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     [0m[39m        [0m[39msize &= [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[1;39m([0m[1;36m7[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     [0m[39m        [0m[35m/[0m[35m/[0m[39m Calculate the CRC32 using the slice-by-eight algorithm.[0m          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     [0m[39m        [0m[39mwhile [0m[1;39m([0m[39mbuf < limit[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     [0m[39m        [0m[39m        [0m[39mcrc ^= [0m[1;35maligned_read32ne[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     [0m[39m        [0m[39m        [0m[39mbuf += [0m[1;36m4[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     [0m[39m        [0m[39m        [0m[39mcrc = lzma_crc32_table[0m[1;39m[[0m[1;36m7[0m[1;39m][0m[1;39m[[0m[1;35mA[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[1;39m][0m                           [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     [0m[39m        [0m[39m        [0m[39m    ^ lzma_crc32_table[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[1;39m[[0m[1;35mB[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[1;39m][0m                           [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     [0m[39m        [0m[39m        [0m[39m    ^ lzma_crc32_table[0m[1;39m[[0m[1;36m5[0m[1;39m][0m[1;39m[[0m[1;35mC[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[1;39m][0m                           [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     [0m[39m        [0m[39m        [0m[39m    ^ lzma_crc32_table[0m[1;39m[[0m[1;36m4[0m[1;39m][0m[1;39m[[0m[1;35mD[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[1;39m][0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     [0m[39m        [0m[39m        [0m[39mconst uint32_t tmp = [0m[1;35maligned_read32ne[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     [0m[39m        [0m[39m        [0m[39mbuf += [0m[1;36m4[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     [0m[39m        [0m[39m        [0m[35m/[0m[35m/[0m[39m At least with some compilers, it is critical for[0m         [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     [0m[39m        [0m[39m        [0m[35m/[0m[35m/[0m[39m performance, that the crc variable is XORed[0m              [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     [0m[39m        [0m[39m        [0m[35m/[0m[35m/[0m[39m between the two table-lookup pairs.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     [0m[39m        [0m[39m        [0m[39mcrc = lzma_crc32_table[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[1;39m[[0m[1;35mA[0m[1;39m([0m[39mtmp[0m[1;39m)[0m[1;39m][0m                           [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     [0m[39m        [0m[39m        [0m[39m    ^ lzma_crc32_table[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[1;39m[[0m[1;35mB[0m[1;39m([0m[39mtmp[0m[1;39m)[0m[1;39m][0m                           [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     [0m[39m        [0m[39m        [0m[39m    ^ crc[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     [0m[39m        [0m[39m        [0m[39m    ^ lzma_crc32_table[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[1;39m[[0m[1;35mC[0m[1;39m([0m[39mtmp[0m[1;39m)[0m[1;39m][0m                           [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:     [0m[39m        [0m[39m        [0m[39m    ^ lzma_crc32_table[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m[[0m[1;35mD[0m[1;39m([0m[39mtmp[0m[1;39m)[0m[1;39m][0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     [0m[39mwhile [0m[1;39m([0m[39msize-- != [0m[1;36m0[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     [0m[39m        [0m[39mcrc = lzma_crc32_table[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m[[0m[39m*buf++ ^ [0m[1;35mA[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[1;39m][0m[39m ^ [0m[1;35mS8[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:#ifdef WORDS_BIGENDIAN[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:     [0m[39mcrc = [0m[1;35mbyteswap32[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     [0m[39mreturn ~crc;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/check/check.[0m[1;92mc:1[0m[39m-[0m[1;36m160[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[35m/[0m[39m SPDX-License-Identifier: 0BSD[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \file       check.c[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \brief      Single API to access different integrity checks[0m                   [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m[35m/[0m[35m/[0m[39m  Author:     Lasse Collin[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m  [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:#include [0m[32m"check.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m15:e[0m[39mxtern [0m[1;35mLZMA_API[0m[1;39m([0m[39mlzma_bool[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:[0m[1;35mlzma_check_is_supported[0m[1;39m([0m[39mlzma_check type[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:     [0m[39mif [0m[1;39m([0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m > LZMA_CHECK_ID_MAX[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:     [0m[39m        [0m[39mreturn false;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:     [0m[39mstatic const lzma_bool available_checks[0m[1;39m[[0m[39mLZMA_CHECK_ID_MAX + [0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:     [0m[39m        [0m[39mtrue,   [0m[35m/[0m[35m/[0m[39m LZMA_CHECK_NONE[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:#ifdef HAVE_CHECK_CRC32[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:     [0m[39m        [0m[39mtrue,[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:#else[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:     [0m[39m        [0m[39mfalse,[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:     [0m[39m        [0m[39mfalse,  [0m[35m/[0m[35m/[0m[39m Reserved[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:     [0m[39m        [0m[39mfalse,  [0m[35m/[0m[35m/[0m[39m Reserved[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:#ifdef HAVE_CHECK_CRC64[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:     [0m[39m        [0m[39mtrue,[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:#else[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:     [0m[39m        [0m[39mfalse,[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     [0m[39m        [0m[39mfalse,  [0m[35m/[0m[35m/[0m[39m Reserved[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     [0m[39m        [0m[39mfalse,  [0m[35m/[0m[35m/[0m[39m Reserved[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     [0m[39m        [0m[39mfalse,  [0m[35m/[0m[35m/[0m[39m Reserved[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     [0m[39m        [0m[39mfalse,  [0m[35m/[0m[35m/[0m[39m Reserved[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     [0m[39m        [0m[39mfalse,  [0m[35m/[0m[35m/[0m[39m Reserved[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:#ifdef HAVE_CHECK_SHA256[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     [0m[39m        [0m[39mtrue,[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:#else[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     [0m[39m        [0m[39mfalse,[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     [0m[39m        [0m[39mtrue,   [0m[35m/[0m[35m/[0m[39m TREE check[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     [0m[39m        [0m[39mfalse,  [0m[35m/[0m[35m/[0m[39m Reserved[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     [0m[39m        [0m[39mfalse,  [0m[35m/[0m[35m/[0m[39m Reserved[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     [0m[39m        [0m[39mfalse,  [0m[35m/[0m[35m/[0m[39m Reserved[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     [0m[39m        [0m[39mfalse,  [0m[35m/[0m[35m/[0m[39m Reserved[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     [0m[1;39m}[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     [0m[39mreturn available_checks[0m[1;39m[[0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[1;39m([0m[39mtype[0m[1;39m)[0m[1;39m][0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m62:e[0m[39mxtern [0m[1;35mLZMA_API[0m[1;39m([0m[39muint32_t[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m[1;35mlzma_check_size[0m[1;39m([0m[39mlzma_check type[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     [0m[39mif [0m[1;39m([0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m > LZMA_CHECK_ID_MAX[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     [0m[39m        [0m[39mreturn UINT32_MAX;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     [0m[35m/[0m[35m/[0m[39m See file-format.txt section [0m[1;92m2.1.1.2[0m[39m.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     [0m[39mstatic const uint8_t check_sizes[0m[1;39m[[0m[39mLZMA_CHECK_ID_MAX + [0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     [0m[39m        [0m[1;36m0[0m[39m,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     [0m[39m        [0m[1;36m4[0m[39m, [0m[1;36m4[0m[39m, [0m[1;36m4[0m[39m,[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     [0m[39m        [0m[1;36m8[0m[39m, [0m[1;36m8[0m[39m, [0m[1;36m8[0m[39m,[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     [0m[39m        [0m[1;36m16[0m[39m, [0m[1;36m16[0m[39m, [0m[1;36m16[0m[39m,[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     [0m[39m        [0m[1;36m32[0m[39m, [0m[1;36m32[0m[39m, [0m[1;36m32[0m[39m,[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     [0m[39m        [0m[1;36m64[0m[39m, [0m[1;36m64[0m[39m, [0m[1;36m64[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     [0m[1;39m}[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     [0m[39mreturn check_sizes[0m[1;39m[[0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[1;39m([0m[39mtype[0m[1;39m)[0m[1;39m][0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m82:e[0m[39mxtern void[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m[1;35mlzma_check_init[0m[1;39m([0m[39mlzma_check_state *check, lzma_check type[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     [0m[39mswitch [0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     [0m[39mcase LZMA_CHECK_NONE:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:     [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:#ifdef HAVE_CHECK_CRC32[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     [0m[39mcase LZMA_CHECK_CRC32:[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     [0m[39m        [0m[39mcheck->state.crc32 = [0m[1;36m0[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:#ifdef HAVE_CHECK_CRC64[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:     [0m[39mcase LZMA_CHECK_CRC64:[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:     [0m[39m        [0m[39mcheck->state.crc64 = [0m[1;36m0[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:#ifdef HAVE_CHECK_SHA256[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    [0m[39mcase LZMA_CHECK_SHA256:[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    [0m[39m        [0m[1;35mlzma_sha256_init[0m[1;39m([0m[39mcheck[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    [0m[39mcase LZMA_CHECK_TREE:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    [0m[39m        [0m[39mcheck->state.tree = [0m[1;36m0[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    [0m[39mdefault:[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    [0m[39mreturn;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m119:e[0m[39mxtern void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:[0m[1;35mlzma_check_update[0m[1;39m([0m[39mlzma_check_state *check, lzma_check type,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39m        [0m[39mconst uint8_t *buf, size_t size[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[39mswitch [0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:#ifdef HAVE_CHECK_CRC32[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[39mcase LZMA_CHECK_CRC32:[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:    [0m[39m        [0m[39mcheck->state.crc32 = [0m[1;35mlzma_crc32[0m[1;39m([0m[39mbuf, size, check->state.crc32[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:    [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:#ifdef HAVE_CHECK_CRC64[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:    [0m[39mcase LZMA_CHECK_CRC64:[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    [0m[39m        [0m[39mcheck->state.crc64 = [0m[1;35mlzma_crc64[0m[1;39m([0m[39mbuf, size, check->state.crc64[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:#ifdef HAVE_CHECK_SHA256[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:    [0m[39mcase LZMA_CHECK_SHA256:[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:    [0m[39m        [0m[1;35mlzma_sha256_update[0m[1;39m([0m[39mbuf, size, check[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:    [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:    [0m[39mcase LZMA_CHECK_TREE:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    [0m[39m        [0m[39mcheck->state.tree = [0m[1;35mlzma_tree[0m[1;39m([0m[39mbuf, size, check->state.tree[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:    [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:    [0m[39mdefault:[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    [0m[39mreturn;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m153:e[0m[39mxtern void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:[0m[1;35mlzma_check_finish[0m[1;39m([0m[39mlzma_check_state *check, lzma_check type[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:    [0m[39mswitch [0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:#ifdef HAVE_CHECK_CRC32[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    [0m[39mcase LZMA_CHECK_CRC32:[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:    [0m[39m        [0m[39mcheck->buffer.u32[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;35mconv32le[0m[1;39m([0m[39mcheck->state.crc32[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:    [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/check/check.h:[0m[1;36m1[0m[39m-[0m[1;36m100[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[35m/[0m[39m SPDX-License-Identifier: 0BSD[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \file       check.h[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \brief      Internal API to different integrity check functions[0m               [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m[35m/[0m[35m/[0m[39m  Author:     Lasse Collin[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m  [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:#ifndef LZMA_CHECK_H[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:#define LZMA_CHECK_H[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:#include [0m[32m"common.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m[35m/[0m[35m/[0m[39m If the function for external SHA-[0m[1;36m256[0m[39m is missing, use the internal SHA-[0m[1;36m256[0m     [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m[35m/[0m[35m/[0m[39m code. Due to how configure works, these defines can only get defined when[0m     [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m[35m/[0m[35m/[0m[39m both a usable header and a type have already been found.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:#if ![0m[1;39m([0m[1;35mdefined[0m[1;39m([0m[39mHAVE_CC_SHA256_INIT[0m[1;39m)[0m[39m \[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:     [0m[39m        [0m[39m|| [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_SHA256_INIT[0m[1;39m)[0m[39m \[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:     [0m[39m        [0m[39m|| [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_SHA256INIT[0m[1;39m)[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:#    [0m[39mdefine HAVE_INTERNAL_SHA256 [0m[1;36m1[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_INTERNAL_SHA256[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m[35m/[0m[35m/[0m[39m Nothing[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_COMMONCRYPTO_COMMONDIGEST_H[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:#    [0m[39minclude <CommonCrypto/CommonDigest.h>[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_SHA256_H[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:#    [0m[39minclude <sys/types.h>[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:#    [0m[39minclude <sha256.h>[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_SHA2_H[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:#    [0m[39minclude <sys/types.h>[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:#    [0m[39minclude <sha2.h>[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_INTERNAL_SHA256[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m State for the internal SHA-[0m[1;36m256[0m[39m implementation[0m                                [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:typedef struct [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     [0m[35m/[0m[35m/[0m[35m/[0m[39m Internal state[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     [0m[39muint32_t state[0m[1;39m[[0m[1;36m8[0m[1;39m][0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     [0m[35m/[0m[35m/[0m[35m/[0m[39m Size of the message excluding padding[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     [0m[39muint64_t size;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m[1;39m}[0m[39m lzma_sha256_state;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_CC_SHA256_CTX[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:typedef CC_SHA256_CTX lzma_sha256_state;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_SHA256_CTX[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:typedef SHA256_CTX lzma_sha256_state;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_SHA2_CTX[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:typedef SHA2_CTX lzma_sha256_state;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_INTERNAL_SHA256[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m[35m/[0m[35m/[0m[39m Nothing[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_CC_SHA256_INIT[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:#    [0m[39mdefine [0m[1;35mLZMA_SHA256FUNC[0m[1;39m([0m[39mx[0m[1;39m)[0m[39m CC_SHA256_ ## x[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_SHA256_INIT[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:#    [0m[39mdefine [0m[1;35mLZMA_SHA256FUNC[0m[1;39m([0m[39mx[0m[1;39m)[0m[39m SHA256_ ## x[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_SHA256INIT[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:#    [0m[39mdefine [0m[1;35mLZMA_SHA256FUNC[0m[1;39m([0m[39mx[0m[1;39m)[0m[39m SHA256 ## x[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m[35m/[0m[35m/[0m[39m Index hashing needs the best possible hash function [0m[1;39m([0m[39mpreferably[0m               [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m[35m/[0m[35m/[0m[39m a cryptographic hash[0m[1;39m)[0m[39m for maximum reliability.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_CHECK_SHA256[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:#    [0m[39mdefine LZMA_CHECK_BEST LZMA_CHECK_SHA256[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39mHAVE_CHECK_CRC64[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:#    [0m[39mdefine LZMA_CHECK_BEST LZMA_CHECK_CRC64[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:#else[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:#    [0m[39mdefine LZMA_CHECK_BEST LZMA_CHECK_CRC32[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \brief      Structure to hold internal state of the check being calculated[0m   [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \note       This is not in the public API because this structure may[0m         [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m             change in future if new integrity check algorithms are added.[0m    [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:typedef struct [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     [0m[35m/[0m[35m/[0m[35m/[0m[39m Buffer to hold the final result and a temporary buffer for SHA256.[0m      [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     [0m[39munion [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     [0m[39m        [0m[39muint8_t u8[0m[1;39m[[0m[1;36m64[0m[1;39m][0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     [0m[39m        [0m[39muint32_t u32[0m[1;39m[[0m[1;36m16[0m[1;39m][0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     [0m[39m        [0m[39muint64_t u64[0m[1;39m[[0m[1;36m8[0m[1;39m][0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     [0m[1;39m}[0m[39m buffer;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     [0m[35m/[0m[35m/[0m[35m/[0m[39m Check-specific data[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     [0m[39munion [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     [0m[39m        [0m[39muint32_t crc32;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     [0m[39m        [0m[39muint64_t crc64;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     [0m[39m        [0m[39muint32_t tree;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:     [0m[39m        [0m[39mlzma_sha256_state sha256;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:     [0m[1;39m}[0m[39m state;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m[1;39m}[0m[39m lzma_check_state;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \brief      Initialize *check depending on type[0m                              [2m                [0m
[2;36m                    [0m         [1;92m100:e[0m[39mxtern void [0m[1;35mlzma_check_init[0m[1;39m([0m[39mlzma_check_state *check, lzma_check type[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/check/treeck.[0m[1;92mc:1[0m[39m-[0m[1;36m30[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \file       treeck.c[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \brief      Tree based checksum for the embedded e37vk file type[0m              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:#include [0m[32m"check.h"[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:#include [0m[32m"treeck.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:#include <stdlib.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:#include <stdint.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:#include <string.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:[0m[35m/[0m[35m/[0m[39m Simple deterministic hash function [0m[1;39m([0m[39mdjb2[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:static unsigned long [0m[1;35mhash_data[0m[1;39m([0m[39mconst uint8_t *data, size_t len[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:  unsigned long hash = HASH_SEED;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:  for [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < len; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:    hash = [0m[1;39m([0m[1;39m([0m[39mhash << [0m[1;36m5[0m[1;39m)[0m[39m + hash[0m[1;39m)[0m[39m + data[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m; [0m[35m/[0m[35m/[0m[39m hash * [0m[1;36m33[0m[39m + c[0m                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:  return hash;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m[35m/[0m[35m/[0m[39m Create a checksum tree from the input data[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:static TreeNode* [0m[1;35mcreate_tree[0m[1;39m([0m[39mconst uint8_t *data, size_t len, size_t depth, [0m     [2m                [0m
[2;36m                    [0m         [39msize_t max_depth, unsigned long seed, TreeNode* parent[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:  [0m[35m/[0m[35m/[0m[39m Basic checks on remaining data[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:  if [0m[1;39m([0m[39mdepth >= max_depth || len < [0m[1;35msizeof[0m[1;39m([0m[39mtree_field_t[0m[1;39m)[0m[39m*TREE_FIELDS[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:    return NULL;[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/check/treeck.[0m[1;92mc:10[0m[39m-[0m[1;36m25[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:#include <stdlib.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:#include <stdint.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:#include <string.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:[0m[35m/[0m[35m/[0m[39m Simple deterministic hash function [0m[1;39m([0m[39mdjb2[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:static unsigned long [0m[1;35mhash_data[0m[1;39m([0m[39mconst uint8_t *data, size_t len[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:  unsigned long hash = HASH_SEED;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:  for [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < len; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:    hash = [0m[1;39m([0m[1;39m([0m[39mhash << [0m[1;36m5[0m[1;39m)[0m[39m + hash[0m[1;39m)[0m[39m + data[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m; [0m[35m/[0m[35m/[0m[39m hash * [0m[1;36m33[0m[39m + c[0m                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:  return hash;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m[35m/[0m[35m/[0m[39m Create a checksum tree from the input data[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/common/block_encoder.[0m[1;92mc:1[0m[39m-[0m[1;36m100[0m                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[35m/[0m[39m SPDX-License-Identifier: 0BSD[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \file       block_encoder.c[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \brief      Encodes .xz Blocks[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m[35m/[0m[35m/[0m[39m  Author:     Lasse Collin[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m  [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:#include [0m[32m"block_encoder.h"[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:#include [0m[32m"filter_encoder.h"[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:#include [0m[32m"check.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:typedef struct [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:     [0m[35m/[0m[35m/[0m[35m/[0m[39m The filters in the chain; initialized with [0m[1;35mlzma_raw_decoder_init[0m[1;39m([0m[1;39m)[0m[39m.[0m     [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:     [0m[39mlzma_next_coder next;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:     [0m[35m/[0m[35m/[0m[35m/[0m[39m Encoding options; we also write Unpadded Size, Compressed Size,[0m         [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:     [0m[35m/[0m[35m/[0m[35m/[0m[39m and Uncompressed Size back to this structure when the encoding[0m          [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:     [0m[35m/[0m[35m/[0m[35m/[0m[39m has been finished.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:     [0m[39mlzma_block *block;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:     [0m[39menum [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:     [0m[39m        [0m[39mSEQ_CODE,[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:     [0m[39m        [0m[39mSEQ_PADDING,[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:     [0m[39m        [0m[39mSEQ_CHECK,[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:     [0m[1;39m}[0m[39m sequence;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:     [0m[35m/[0m[35m/[0m[35m/[0m[39m Compressed Size calculated while encoding[0m                               [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:     [0m[39mlzma_vli compressed_size;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:     [0m[35m/[0m[35m/[0m[35m/[0m[39m Uncompressed Size calculated while encoding[0m                             [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:     [0m[39mlzma_vli uncompressed_size;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     [0m[35m/[0m[35m/[0m[35m/[0m[39m Position in the Check field[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     [0m[39msize_t pos;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     [0m[35m/[0m[35m/[0m[35m/[0m[39m Check of the uncompressed data[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     [0m[39mlzma_check_state check;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m[1;39m}[0m[39m lzma_block_coder;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:static lzma_ret[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;92m47:b[0m[1;35mlock_encode[0m[1;39m([0m[39mvoid *coder_ptr, const lzma_allocator *allocator,[0m                   [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     [0m[39m        [0m[39mconst uint8_t *restrict in, size_t *restrict in_pos,[0m                [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     [0m[39m        [0m[39msize_t in_size, uint8_t *restrict out,[0m                              [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     [0m[39m        [0m[39msize_t *restrict out_pos, size_t out_size, lzma_action action[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     [0m[39mlzma_block_coder *coder = coder_ptr;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     [0m[35m/[0m[35m/[0m[39m Check that our amount of input stays in proper limits.[0m                   [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     [0m[39mif [0m[1;39m([0m[39mLZMA_VLI_MAX - coder->uncompressed_size < in_size - *in_pos[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     [0m[39m        [0m[39mreturn LZMA_DATA_ERROR;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     [0m[39mswitch [0m[1;39m([0m[39mcoder->sequence[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     [0m[39mcase SEQ_CODE: [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     [0m[39m        [0m[39mconst size_t in_start = *in_pos;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     [0m[39m        [0m[39mconst size_t out_start = *out_pos;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     [0m[39m        [0m[39mconst lzma_ret ret = coder->[0m[1;35mnext.code[0m[1;39m([0m[39mcoder->next.coder,[0m            [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     [0m[39m        [0m[39m        [0m[39m        [0m[39mallocator, in, in_pos, in_size,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     [0m[39m        [0m[39m        [0m[39m        [0m[39mout, out_pos, out_size, action[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     [0m[39m        [0m[39mconst size_t in_used = *in_pos - in_start;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     [0m[39m        [0m[39mconst size_t out_used = *out_pos - out_start;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     [0m[39m        [0m[39mif [0m[1;39m([0m[39mCOMPRESSED_SIZE_MAX - coder->compressed_size < out_used[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     [0m[39m        [0m[39m        [0m[39mreturn LZMA_DATA_ERROR;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     [0m[39m        [0m[39mcoder->compressed_size += out_used;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     [0m[39m        [0m[35m/[0m[35m/[0m[39m No need to check for overflow because we have already[0m            [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     [0m[39m        [0m[35m/[0m[35m/[0m[39m checked it at the beginning of this function.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     [0m[39m        [0m[39mcoder->uncompressed_size += in_used;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     [0m[39m        [0m[35m/[0m[35m/[0m[39m Call [0m[1;35mlzma_check_update[0m[1;39m([0m[1;39m)[0m[39m only if input was consumed. This[0m        [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     [0m[39m        [0m[35m/[0m[35m/[0m[39m avoids null pointer + [0m[1;36m0[0m[39m [0m[1;39m([0m[39mundefined behavior[0m[1;39m)[0m[39m when in == [0m[1;36m0[0m[39m.[0m       [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     [0m[39m        [0m[39mif [0m[1;39m([0m[39min_used > [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     [0m[39m        [0m[39m        [0m[1;35mlzma_check_update[0m[1;39m([0m[39m&coder->check, coder->block->check,[0m       [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39min + in_start, in_used[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     [0m[39m        [0m[39mif [0m[1;39m([0m[39mret != LZMA_STREAM_END || action == LZMA_SYNC_FLUSH[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     [0m[39m        [0m[39m        [0m[39mreturn ret;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     [0m[39m        [0m[1;35massert[0m[1;39m([0m[39m*in_pos == in_size[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     [0m[39m        [0m[1;35massert[0m[1;39m([0m[39maction == LZMA_FINISH[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     [0m[39m        [0m[35m/[0m[35m/[0m[39m Copy the values into coder->block. The caller[0m                    [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     [0m[39m        [0m[35m/[0m[35m/[0m[39m may use this information to construct Index.[0m                     [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:     [0m[39m        [0m[39mcoder->block->compressed_size = coder->compressed_size;[0m             [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:     [0m[39m        [0m[39mcoder->block->uncompressed_size = coder->uncompressed_size;[0m         [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:     [0m[39m        [0m[39mcoder->sequence = SEQ_PADDING;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:     [0m[39m        [0m[39mFALLTHROUGH;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    [0m[39mcase SEQ_PADDING:[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/liblzma/check/treeck.[0m[1;92mc:62[0m[39m-[0m[1;36m68[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:  return node;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m[35m/[0m[35m/[0m[39m Walk the tree to calculate the e37vk checksum[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:static uint32_t [0m[1;35mcompute_tree_checksum[0m[1;39m([0m[39mTreeNode *node, unsigned int depth[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:  [0m[35m/[0m[35m/[0m[39m Skip if already hashed[0m                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtests/ossfuzz/fuzz_encode_stream.[0m[1;92mc:1[0m[39m-[0m[1;36m86[0m                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[35m/[0m[39m SPDX-License-Identifier: 0BSD[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \file       fuzz_encode_stream.c[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[39m \brief      Fuzz test program for .xz encoding[0m                                [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:[0m[35m/[0m[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m[35m/[0m[35m/[0m[39m  Authors:    Maksym Vatsyk[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:[0m[35m/[0m[35m/[0m[39m              Lasse Collin[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m[35m/[0m[35m/[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m[35m/[0m  [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:#include <inttypes.h>[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:#include <stdlib.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:#include <stdio.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:#include [0m[32m"lzma.h"[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:#include [0m[32m"fuzz_common.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m20:e[0m[39mxtern int[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m[1;35mLLVMFuzzerTestOneInput[0m[1;39m([0m[39mconst uint8_t *inbuf, size_t inbuf_size[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:     [0m[39mif [0m[1;39m([0m[39minbuf_size == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:     [0m[39m        [0m[1;35mfprintf[0m[1;39m([0m[39mstderr, [0m[32m"no input data provided\n"[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:     [0m[39m        [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:     [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:     [0m[35m/[0m[35m/[0m[39m Set the LZMA options based on the first input byte. The fuzzer[0m           [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:     [0m[35m/[0m[35m/[0m[39m will learn through its mutational genetic algorithm with the[0m             [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:     [0m[35m/[0m[35m/[0m[39m code coverage feedback that the first byte must be one of the[0m            [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:     [0m[35m/[0m[35m/[0m[39m values with a switch case label. This allows us to have one fuzz[0m         [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:     [0m[35m/[0m[35m/[0m[39m target cover many critical code paths so the fuzz resources can[0m          [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:     [0m[35m/[0m[35m/[0m[39m be used efficiently.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:     [0m[39muint32_t preset_level;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:     [0m[39mconst uint8_t decider = inbuf[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     [0m[39mswitch [0m[1;39m([0m[39mdecider[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     [0m[39mcase [0m[1;36m0[0m[39m:[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     [0m[39mcase [0m[1;36m1[0m[39m:[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     [0m[39mcase [0m[1;36m5[0m[39m:[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     [0m[39m        [0m[39mpreset_level = [0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mdecider;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     [0m[39mcase [0m[1;36m6[0m[39m:[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     [0m[39m        [0m[39mpreset_level = [0m[1;36m0[0m[39m | LZMA_PRESET_EXTREME;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     [0m[39mcase [0m[1;36m7[0m[39m:[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     [0m[39m        [0m[39mpreset_level = [0m[1;36m3[0m[39m | LZMA_PRESET_EXTREME;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     [0m[39mdefault:[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     [0m[39m        [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     [0m[35m/[0m[35m/[0m[39m Initialize lzma_options with the above preset level[0m                      [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     [0m[39mlzma_options_lzma opt_lzma;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     [0m[39mif [0m[1;39m([0m[1;35mlzma_lzma_preset[0m[1;39m([0m[39m&opt_lzma, preset_level[0m[1;39m)[0m[1;39m)[0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     [0m[39m        [0m[1;35mfprintf[0m[1;39m([0m[39mstderr, [0m[32m"lzma_lzma_preset[0m[32m([0m[32m)[0m[32m failed\n"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     [0m[39m        [0m[1;35mabort[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     [0m[35m/[0m[35m/[0m[39m Set the filter chain as only LZMA2.[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     [0m[39mlzma_filter filters[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     [0m[39m        [0m[39m        [0m[39m.id = LZMA_FILTER_LZMA2,[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     [0m[39m        [0m[39m        [0m[39m.options = &opt_lzma,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     [0m[39m        [0m[1;39m}[0m[39m, [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     [0m[39m        [0m[39m        [0m[39m.id = LZMA_VLI_UNKNOWN,[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     [0m[1;39m}[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     [0m[35m/[0m[35m/[0m[39m initialize empty LZMA stream[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     [0m[39mlzma_stream strm = LZMA_STREAM_INIT;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     [0m[35m/[0m[35m/[0m[39m Initialize the stream encoder using the above[0m                            [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     [0m[35m/[0m[35m/[0m[39m stream, filter chain and CRC64.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     [0m[39mlzma_ret ret = [0m[1;35mlzma_stream_encoder[0m[1;39m([0m[39m&strm, filters, LZMA_CHECK_TREE[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     [0m[39mif [0m[1;39m([0m[39mret != LZMA_OK[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     [0m[39m        [0m[1;35mfprintf[0m[1;39m([0m[39mstderr, [0m[32m"lzma_stream_encoder[0m[32m([0m[32m)[0m[32m failed [0m[32m([0m[32m%d[0m[32m)[0m[32m\n"[0m[39m, ret[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     [0m[39m        [0m[1;35mabort[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     [0m[1;35mfuzz_code[0m[1;39m([0m[39m&strm, inbuf  + [0m[1;36m1[0m[39m, inbuf_size - [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     [0m[35m/[0m[35m/[0m[39m Free the allocated memory.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     [0m[1;35mlzma_end[0m[1;39m([0m[39m&strm[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis Summary[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter examining the code snippets and evaluation report, I've identified the root [0m  [2m                [0m
[2;36m                    [0m         [39mcause of the heap-use-after-free vulnerability in `src/liblzma/check/treeck.c`:[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Root Cause[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability occurs due to a fundamental design flaw in the [0m                   [2m                [0m
[2;36m                    [0m         [39m`compute_tree_checksum` function that combines:[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Cyclic Graph Structure**: The `create_tree` function creates parent backlinks [0m [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mline [0m[1;36m53[0m[39m in treeck.c[0m[1;39m)[0m[39m, introducing cycles in what should be a tree structure[0m        [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Premature Node Freeing**: The `compute_tree_checksum` function frees nodes [0m    [2m                [0m
[2;36m                    [0m         [39mduring recursive traversal [0m[1;39m([0m[39mlines [0m[1;36m89[0m[39m-[0m[1;36m90[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **State Tracking Inadequacy**: While state tracking [0m[1;39m([0m[39mSTATE_CLEAR, STATE_VISITED,[0m [2m                [0m
[2;36m                    [0m         [39mSTATE_HASHED[0m[1;39m)[0m[39m prevents infinite recursion, it doesn't prevent accessing [0m            [2m                [0m
[2;36m                    [0m         [39malready-freed memory[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### The Bug Sequence[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mWhen processing a node A that has a child B with a backlink to A:[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. `[0m[1;35mcompute_tree_checksum[0m[1;39m([0m[39mA[0m[1;39m)[0m[39m` is called[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. It marks A as STATE_VISITED [0m[1;39m([0m[39mline [0m[1;36m78[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. It iterates through A's edges and calls `[0m[1;35mcompute_tree_checksum[0m[1;39m([0m[39mB[0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m[1;36m82[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. `[0m[1;35mcompute_tree_checksum[0m[1;39m([0m[39mB[0m[1;39m)[0m[39m` processes B's edges, including the backlink to A[0m      [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. When encountering A again [0m[1;39m([0m[39mwhich is STATE_VISITED[0m[1;39m)[0m[39m, the function returns early [0m  [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mline [0m[1;36m69[0m[39m-[0m[1;36m70[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. But then B's processing continues and frees B [0m[1;39m([0m[39mlines [0m[1;36m89[0m[39m-[0m[1;36m90[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. When control returns to the original `[0m[1;35mcompute_tree_checksum[0m[1;39m([0m[39mA[0m[1;39m)[0m[39m`, if there are [0m   [2m                [0m
[2;36m                    [0m         [39mmore edges to process, it accesses `node->edges[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m` which may have been freed if [0m   [2m                [0m
[2;36m                    [0m         [39mthose edges pointed to nodes that had backlinks[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe specific use-after-free at line [0m[1;36m79[0m[39m occurs when the loop tries to access [0m        [2m                [0m
[2;36m                    [0m         [39m`node->edges[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m` after a previous iteration freed a node that had references back [0m  [2m                [0m
[2;36m                    [0m         [39mto the current node.[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix must address the memory management issue without changing the external API [0m [2m                [0m
[2;36m                    [0m         [39mor fuzzing harness. The solution involves **deferring memory deallocation until [0m    [2m                [0m
[2;36m                    [0m         [39mafter complete tree traversal**.[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m1[0m[39m: Modify `compute_tree_checksum` to Separate Traversal from Cleanup[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mChange the function to:[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. First, perform a complete traversal to compute checksums WITHOUT freeing any [0m    [2m                [0m
[2;36m                    [0m         [39mnodes[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Then, perform a separate cleanup pass to free all allocated memory[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis requires splitting the function into two phases:[0m                               [2m                [0m
[2;36m                    [0m         [39m- **Phase [0m[1;36m1[0m[39m [0m[1;39m([0m[39mTraversal[0m[1;39m)[0m[39m**: Compute the checksum by traversing the graph using state[0m [2m                [0m
[2;36m                    [0m         [39mtracking to avoid infinite loops[0m                                                    [2m                [0m
[2;36m                    [0m         [39m- **Phase [0m[1;36m2[0m[39m [0m[1;39m([0m[39mCleanup[0m[1;39m)[0m[39m**: Free all nodes in a safe manner[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m2[0m[39m: Implement Two-Pass Algorithm[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Pass [0m[1;36m1[0m[39m - Checksum Computation**:[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;35mcompute_tree_checksum_internal[0m[1;39m([0m[39mnode, depth[0m[1;39m)[0m[39m:[0m                                        [2m                [0m
[2;36m                    [0m         [39m  - If node is NULL or STATE_HASHED, return [0m[1;36m0[0m                                       [2m                [0m
[2;36m                    [0m         [39m  - Calculate sum from node->value * [0m[1;39m([0m[39mdepth + [0m[1;36m1[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m  - If node->state == STATE_CLEAR:[0m                                                  [2m                [0m
[2;36m                    [0m         [39m    - Mark node as STATE_VISITED[0m                                                    [2m                [0m
[2;36m                    [0m         [39m    - For each child in node->edges:[0m                                                [2m                [0m
[2;36m                    [0m         [39m      - Recursively call [0m[1;35mcompute_tree_checksum_internal[0m[1;39m([0m[39mchild, depth + [0m[1;36m1[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m      - Add result to sum[0m                                                           [2m                [0m
[2;36m                    [0m         [39m    - Mark node as STATE_HASHED[0m                                                     [2m                [0m
[2;36m                    [0m         [39m  - Return sum [0m[1;39m([0m[39mDO NOT free anything here[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Pass [0m[1;36m2[0m[39m - Memory Cleanup**:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;35mfree_tree_nodes[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m:[0m                                                              [2m                [0m
[2;36m                    [0m         [39m  - If node is NULL, return[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  - If node->state != STATE_HASHED, return [0m[1;39m([0m[39malready freed or not processed[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m  - Mark node->state as STATE_FREED [0m[1;39m([0m[39mor set to a special value[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [39m  - For each child in node->edges:[0m                                                  [2m                [0m
[2;36m                    [0m         [39m    - If child is not NULL and child->state == STATE_HASHED:[0m                        [2m                [0m
[2;36m                    [0m         [39m      - Recursively call [0m[1;35mfree_tree_nodes[0m[1;39m([0m[39mchild[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [39m  - Free node->edges[0m                                                                [2m                [0m
[2;36m                    [0m         [39m  - Free node[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m3[0m[39m: Modify the Main `compute_tree_checksum` Function[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mUpdate the function signature and implementation:[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39mstatic uint32_t [0m[1;35mcompute_tree_checksum[0m[1;39m([0m[39mTreeNode *node, unsigned int depth[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m  [0m[35m/[0m[35m/[0m[39m Phase [0m[1;36m1[0m[39m: Compute checksum with traversal only[0m                                  [2m                [0m
[2;36m                    [0m         [39m  uint32_t sum = [0m[1;35mcompute_tree_checksum_internal[0m[1;39m([0m[39mnode, depth[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m  [0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m  [0m[35m/[0m[35m/[0m[39m Phase [0m[1;36m2[0m[39m: Clean up all allocated memory[0m                                         [2m                [0m
[2;36m                    [0m         [39m  [0m[1;35mfree_tree_nodes[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m  [0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m  return sum;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m4[0m[39m: Handle the Cyclic Graph Structure Properly[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe cleanup pass must handle cycles correctly:[0m                                      [2m                [0m
[2;36m                    [0m         [39m- Use the state field to track which nodes have been freed[0m                          [2m                [0m
[2;36m                    [0m         [39m- Before freeing a node, check if it's already been freed[0m                           [2m                [0m
[2;36m                    [0m         [39m- The STATE_HASHED can be reused to indicate [0m[32m"ready to free"[0m                        [2m                [0m
[2;36m                    [0m         [39m- After freeing, the state is no longer accessible [0m[1;39m([0m[39mnode is freed[0m[1;39m)[0m[39m, so we rely on [0m  [2m                [0m
[2;36m                    [0m         [39mchecking state before attempting to free[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m5[0m[39m: Alternative Approach - Maintain a Visited Set[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mIf the above approach has issues with the state tracking, implement a separate [0m     [2m                [0m
[2;36m                    [0m         [39mvisited tracking mechanism:[0m                                                         [2m                [0m
[2;36m                    [0m         [39m- Use a simple linked list or array to track visited nodes during traversal[0m         [2m                [0m
[2;36m                    [0m         [39m- During cleanup, iterate through this list to free nodes[0m                           [2m                [0m
[2;36m                    [0m         [39m- This ensures each node is freed exactly once[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Implementation Details[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**In `src/liblzma/check/treeck.c`**:[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Keep the existing `create_tree` function unchanged [0m[1;39m([0m[39mlines [0m[1;36m26[0m[39m-[0m[1;36m63[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Rename the current `compute_tree_checksum` to `compute_tree_checksum_internal` [0m  [2m                [0m
[2;36m                    [0m         [39mand remove the free calls:[0m                                                          [2m                [0m
[2;36m                    [0m         [39m   - Remove lines [0m[1;36m88[0m[39m-[0m[1;36m90[0m[39m [0m[1;39m([0m[39mthe free calls[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [39m   - Keep all the traversal and checksum computation logic[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Create a new `free_tree_nodes` helper function:[0m                                  [2m                [0m
[2;36m                    [0m         [39m   - Add after the renamed function[0m                                                 [2m                [0m
[2;36m                    [0m         [39m   - Implement safe tree cleanup that handles cycles[0m                                [2m                [0m
[2;36m                    [0m         [39m   - Use state tracking to avoid double-free[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Update the main `compute_tree_checksum` function:[0m                                [2m                [0m
[2;36m                    [0m         [39m   - Call `compute_tree_checksum_internal` to get the checksum[0m                      [2m                [0m
[2;36m                    [0m         [39m   - Call `free_tree_nodes` to cleanup memory[0m                                       [2m                [0m
[2;36m                    [0m         [39m   - Return the checksum[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Ensure the `lzma_tree` function [0m[1;39m([0m[39mlines [0m[1;36m96[0m[39m-[0m[1;36m102[0m[1;39m)[0m[39m remains unchanged as it already [0m  [2m                [0m
[2;36m                    [0m         [39mcorrectly calls `compute_tree_checksum`[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Critical Considerations[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **State Tracking**: The state field can be reused across both passes since:[0m      [2m                [0m
[2;36m                    [0m         [39m   - Pass [0m[1;36m1[0m[39m sets states to STATE_VISITED and STATE_HASHED[0m                           [2m                [0m
[2;36m                    [0m         [39m   - Pass [0m[1;36m2[0m[39m checks STATE_HASHED before freeing[0m                                      [2m                [0m
[2;36m                    [0m         [39m   - Once freed, the node is gone, so state doesn't matter[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Cycle Handling**: The key insight is that with two separate passes:[0m            [2m                [0m
[2;36m                    [0m         [39m   - Pass [0m[1;36m1[0m[39m handles cycles with STATE_VISITED/STATE_HASHED checks [0m[1;39m([0m[39malready working[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m   - Pass [0m[1;36m2[0m[39m must also handle cycles by checking state before freeing[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Memory Safety**: By deferring all frees until after traversal:[0m                 [2m                [0m
[2;36m                    [0m         [39m   - No node is accessed after being freed[0m                                          [2m                [0m
[2;36m                    [0m         [39m   - All references remain valid during traversal[0m                                   [2m                [0m
[2;36m                    [0m         [39m   - Cleanup happens when no references are on the call stack[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Performance**: This approach may traverse the tree twice, but:[0m                 [2m                [0m
[2;36m                    [0m         [39m   - It's still [0m[1;35mO[0m[1;39m([0m[39mn[0m[1;39m)[0m[39m where n is the number of nodes[0m                                 [2m                [0m
[2;36m                    [0m         [39m   - The tree is typically small [0m[1;39m([0m[39mmax_depth = [0m[1;36m16[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m   - Correctness is more important than micro-optimization[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Justification[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis fix strategy is optimal because:[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Preserves Existing Logic**: The checksum computation logic remains unchanged, [0m [2m                [0m
[2;36m                    [0m         [39mensuring correctness[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Minimal Changes**: Only modifies treeck.c, no changes to external interfaces [0m  [2m                [0m
[2;36m                    [0m         [39mor other components[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Handles Cycles Correctly**: The two-pass approach naturally handles cyclic [0m    [2m                [0m
[2;36m                    [0m         [39mgraphs without special cases[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **No API Changes**: The `lzma_tree` function signature remains the same, [0m        [2m                [0m
[2;36m                    [0m         [39mmaintaining compatibility[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Safe Cleanup**: Deferring frees eliminates use-after-free by ensuring no [0m      [2m                [0m
[2;36m                    [0m         [39mreferences exist when freeing[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why Alternative Approaches Are Not Suitable[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Removing Parent Backlinks**: Would change the tree structure and potentially [0m  [2m                [0m
[2;36m                    [0m         [39maffect checksum values[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Reference Counting**: Too complex and requires structural changes to TreeNode[0m  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **No Cleanup**: Would cause memory leaks[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Inline Cleanup During Traversal**: Current approach that causes the bug[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Potential Side Effects[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Slightly increased memory usage**: All nodes remain allocated during traversal [0m [2m                [0m
[2;36m                    [0m         [1;39m([0m[39macceptable trade-off[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m- **Two tree traversals**: May have minor performance impact [0m[1;39m([0m[39mnegligible for small [0m [2m                [0m
[2;36m                    [0m         [39mtrees[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThese side effects are acceptable given that correctness and security are [0m          [2m                [0m
[2;36m                    [0m         [39mparamount, and the tree sizes are bounded by max_depth = [0m[1;36m16[0m[39m.[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/10/26 21:58:29][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=199336;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=336063;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=334415;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=650943;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpschj01hf[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/xz_xz-full-01_xz-001/[0m[95magent-ou[0m [2m               [0m
[2;36m                    [0m         [95mtput-1768082309.0824165[0m                                                              [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc-delta-full/xz_xz-full-01_xz-[1;36m001.[0mtoml    [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-xz[0m               [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/10/26 21:58:31][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mxz[0m             ]8;id=409892;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=618066;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=669939;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=477040;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mxz[0m                    [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=117873;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=960769;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mxz[0m                     [2m               [0m
