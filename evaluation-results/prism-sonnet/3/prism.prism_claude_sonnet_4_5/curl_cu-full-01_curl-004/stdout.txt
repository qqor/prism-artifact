[2;36m[01/10/26 03:20:23][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=82123;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=498914;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpgmss1xuf[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/curl_cu-full-01_curl-004/[0m[95magen[0m [2m               [0m
[2;36m                    [0m         [95mt-output-1768015223.4742157[0m                                                          [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/curl_cu-full-01_curl-[1;36m004.[0mtoml                       [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-curl[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Building Cached for CLEAN environment[1m)[0m Started[33m...[0m   ]8;id=103077;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=655177;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 03:24:02][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Building Cached for CLEAN environment[1m)[0m Took [1;36m218.57[0m ]8;id=334648;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=143152;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Running tests for Cached for CLEAN environment[1m)[0m     ]8;id=350804;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=460372;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Running tests for Cached for CLEAN environment[1m)[0m    ]8;id=307026;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=730264;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=654939;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=440859;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m218[0m[1m)[0m                                                         [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Started[33m...[0m                           ]8;id=141500;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=514487;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 03:24:03][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Took [1;36m0.96[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=908177;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=220097;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/10/26 03:24:04][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=129448;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=670063;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=698536;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=38653;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=301067;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=22968;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Started[33m...[0m                           ]8;id=797280;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=726371;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 03:24:05][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Took [1;36m1.23[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=477067;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=22371;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/10/26 03:24:06][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Started[33m...[0m                           ]8;id=402874;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=118087;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 03:24:07][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Took [1;36m0.90[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=816238;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=613116;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/10/26 03:24:09][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=927043;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=615746;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mcurl_fuzzer[0m                                                                [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer curl_fuzzer -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                        [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mmax_len[0m=[1;36m10000[0m  [2m                [0m
[2;36m                    [0m         -[33mdict[0m=[35mhttp[0m.dict [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m                                                         [2m                [0m
[2;36m                    [0m         [39mDictionary: [0m[1;36m40[0m[39m entries[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m751486488[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m122375[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m122375[0m[39m [0m[1;39m[[0m[1;36m0x561f131ef0c0[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [1;36m0x561f1320cec7[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m122375[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m122375[0m[39m [0m[1;39m[[0m[1;36m0x561f1320cec8[0m[39m,[0m[1;36m0x561f133eaf38[0m[1;39m)[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: stack-buffer-overflow on address [0m[1;36m0x7f8aadc82be0[0m[39m at [0m  [2m                [0m
[2;36m                    [0m         [39mpc [0m[1;36m0x561f11e6afd1[0m[39m bp [0m[1;36m0x7ffcbe720b60[0m[39m sp [0m[1;36m0x7ffcbe720b58[0m                               [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x7f8aadc82be0[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m46[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-stack-buffer-overflow[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561f11e6afd0[0m[39m in addbyter [0m[35m/src/curl/lib/[0m[95mmprintf.c[0m[39m:[0m[1;92m1058:22[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561f11e6940b[0m[39m in formatf [0m[35m/src/curl/lib/[0m[95mmprintf.c[0m[39m:[0m[1;92m909:9[0m                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561f11e667ad[0m[39m in curl_mvsnprintf [0m[35m/src/curl/lib/[0m[95mmprintf.c[0m[39m:[0m[1;92m1075:13[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561f11e6b218[0m[39m in curl_msnprintf [0m[35m/src/curl/lib/[0m[95mmprintf.c[0m[39m:[0m[1;92m1095:13[0m             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561f11feafd8[0m[39m in file_do [0m[35m/src/curl/lib/[0m[95mfile.c[0m[39m:[0m[1;92m495:7[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561f11e92890[0m[39m in multi_do [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m1643:14[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561f11e8f5f2[0m[39m in state_do [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m2314:14[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x561f11e7d4ef[0m[39m in multi_runsingle [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m2768:12[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561f11e7b435[0m[39m in curl_multi_perform [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m3016:16[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x561f11e291a0[0m[39m in [0m[1;35mfuzz_handle_transfer[0m[1;39m([0m[39mfuzz_data*[0m[1;39m)[0m[39m [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m341:3[0m                                               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x561f11e274ed[0m[39m in LLVMFuzzerTestOneInput [0m                                   [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m97:3[0m                                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x561f11cdbaa0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m    [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x561f11cc6d15[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x561f11ccc7af[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x561f11cf7a52[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m15[0m[39m [0m[1;36m0x7f8aae470082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m16[0m[39m [0m[1;36m0x561f11cbeefd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mcurl_fuzzer+0x4edefd[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: addbyter--formatf--curl_mvsnprintf[0m                                     [2m                [0m
[2;36m                    [0m         [39mAddress [0m[1;36m0x7f8aadc82be0[0m[39m is located in stack of thread T0 at offset [0m[1;36m480[0m[39m in frame[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561f11fea5ff[0m[39m in file_do [0m[35m/src/curl/lib/[0m[95mfile.c[0m[39m:[0m[1;36m421[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: file_do[0m                                                                [2m                [0m
[2;36m                    [0m         [39m  This frame has [0m[1;36m5[0m[39m [0m[1;35mobject[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m32[0m[39m, [0m[1;36m176[0m[1;39m)[0m[39m [0m[32m'statbuf'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m428[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m240[0m[39m, [0m[1;36m248[0m[1;39m)[0m[39m [0m[32m'xfer_buf'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m436[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m272[0m[39m, [0m[1;36m280[0m[1;39m)[0m[39m [0m[32m'xfer_blen'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m437[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m304[0m[39m, [0m[1;36m360[0m[1;39m)[0m[39m [0m[32m'buffer'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m464[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m400[0m[39m, [0m[1;36m480[0m[1;39m)[0m[39m [0m[32m'header'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m466[0m[1;39m)[0m[39m <== Memory access at offset [0m[1;36m480[0m[39m overflows this [0m  [2m                [0m
[2;36m                    [0m         [39mvariable[0m                                                                            [2m                [0m
[2;36m                    [0m         [39mHINT: this may be a false positive if your program uses some custom stack unwind [0m   [2m                [0m
[2;36m                    [0m         [39mmechanism, swapcontext or vfork[0m                                                     [2m                [0m
[2;36m                    [0m         [39m      [0m[1;39m([0m[39mlongjmp and C++ exceptions *are* supported[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: stack-buffer-overflow [0m[35m/src/curl/lib/[0m[95mmprintf.c[0m[39m:[0m[1;92m1058:22[0m[39m in[0m [2m                [0m
[2;36m                    [0m         [39maddbyter[0m                                                                            [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82900[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82980[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82a00[0m[39m: f1 f1 f1 f1 [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82a80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m f2 f2 f2 f2 f2 f2 f2 f2 [0m[1;36m00[0m[39m f2[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82b00[0m[39m: f2 f2 [0m[1;36m00[0m[39m f2 f2 f2 [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m f2 f2 f2[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x7f8aadc82b80[0m[39m: f2 f2 [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[39mf3[0m[1;39m][0m[39mf3 f3 f3[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82c00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82c80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82d00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82d80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82e00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39mMS: [0m[1;36m0[0m[39m ; base unit: [0m[1;36m0000000000000000000000000000000000000000[0m                         [2m                [0m
[2;36m                    [0m         [1;36m0x0[0m[39m,[0m[1;36m0x1[0m[39m,[0m[1;36m0x0[0m[39m,[0m[1;36m0x0[0m[39m,[0m[1;36m0x0[0m[39m,[0m[1;36m0x18[0m[39m,[0m[1;36m0x66[0m[39m,[0m[1;36m0x69[0m[39m,[0m[1;36m0x6c[0m[39m,[0m[1;36m0x65[0m[39m,[0m[1;36m0x3a[0m[39m,[0m[1;36m0x2f[0m[39m,[0m[1;36m0x2f[0m[39m,[0m[1;36m0x2f[0m[39m,[0m[1;36m0x70[0m[39m,[0m[1;36m0x72[0m[39m,[0m[1;36m0x6f[0m[39m,[0m[1;36m0x6[0m [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m,[0m[1;36m0x2f[0m[39m,[0m[1;36m0x73[0m[39m,[0m[1;36m0x65[0m[39m,[0m[1;36m0x6c[0m[39m,[0m[1;36m0x66[0m[39m,[0m[1;36m0x2f[0m[39m,[0m[1;36m0x73[0m[39m,[0m[1;36m0x74[0m[39m,[0m[1;36m0x61[0m[39m,[0m[1;36m0x74[0m[39m,[0m[1;36m0x75[0m[39m,[0m[1;36m0x73[0m[39m,[0m[1;36m0x0[0m[39m,[0m[1;36m0x1c[0m[39m,[0m[1;36m0x0[0m[39m,[0m[1;36m0x0[0m[39m,[0m[1;36m0x0[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [1;36m0x4[0m[39m,[0m[1;36m0x0[0m[39m,[0m[1;36m0x0[0m[39m,[0m[1;36m0x0[0m[39m,[0m[1;36m0x1[0m[39m,[0m                                                                [2m                [0m
[2;36m                    [0m         [39m\[0m[1;36m000[0m[39m\[0m[1;36m001[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m000[0m[39m\030[0m[4;94mfile:///proc/self/status[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m034[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m004[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m00[0m [2m                [0m
[2;36m                    [0m         [1;36m0[0m[39m\[0m[1;36m001[0m                                                                               [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m         [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmptedwh0lh[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mcurl_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mcurl_fuzzer[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer curl_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                        [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mmax_len[0m[39m=[0m[1;36m10000[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39m-[0m[33mdict[0m[39m=[0m[35mhttp[0m[39m.dict < [0m[35m/dev/[0m[95mnull[0m                                                         [2m                [0m
[2;36m                    [0m         [39mDictionary: [0m[1;36m40[0m[39m entries[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m751486488[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m122375[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m122375[0m[39m [0m[1;39m[[0m[1;36m0x561f131ef0c0[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [1;36m0x561f1320cec7[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m122375[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m122375[0m[39m [0m[1;39m[[0m[1;36m0x561f1320cec8[0m[39m,[0m[1;36m0x561f133eaf38[0m[1;39m)[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: stack-buffer-overflow on address [0m[1;36m0x7f8aadc82be0[0m[39m at [0m  [2m                [0m
[2;36m                    [0m         [39mpc [0m[1;36m0x561f11e6afd1[0m[39m bp [0m[1;36m0x7ffcbe720b60[0m[39m sp [0m[1;36m0x7ffcbe720b58[0m                               [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x7f8aadc82be0[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m46[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-stack-buffer-overflow[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561f11e6afd0[0m[39m in addbyter [0m[35m/src/curl/lib/[0m[95mmprintf.c[0m[39m:[0m[1;92m1058:22[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561f11e6940b[0m[39m in formatf [0m[35m/src/curl/lib/[0m[95mmprintf.c[0m[39m:[0m[1;92m909:9[0m                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561f11e667ad[0m[39m in curl_mvsnprintf [0m[35m/src/curl/lib/[0m[95mmprintf.c[0m[39m:[0m[1;92m1075:13[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561f11e6b218[0m[39m in curl_msnprintf [0m[35m/src/curl/lib/[0m[95mmprintf.c[0m[39m:[0m[1;92m1095:13[0m             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561f11feafd8[0m[39m in file_do [0m[35m/src/curl/lib/[0m[95mfile.c[0m[39m:[0m[1;92m495:7[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561f11e92890[0m[39m in multi_do [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m1643:14[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561f11e8f5f2[0m[39m in state_do [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m2314:14[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x561f11e7d4ef[0m[39m in multi_runsingle [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m2768:12[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561f11e7b435[0m[39m in curl_multi_perform [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m3016:16[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x561f11e291a0[0m[39m in [0m[1;35mfuzz_handle_transfer[0m[1;39m([0m[39mfuzz_data*[0m[1;39m)[0m[39m [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m341:3[0m                                               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x561f11e274ed[0m[39m in LLVMFuzzerTestOneInput [0m                                   [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m97:3[0m                                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x561f11cdbaa0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m    [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x561f11cc6d15[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x561f11ccc7af[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x561f11cf7a52[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m15[0m[39m [0m[1;36m0x7f8aae470082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m16[0m[39m [0m[1;36m0x561f11cbeefd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mcurl_fuzzer+0x4edefd[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: addbyter--formatf--curl_mvsnprintf[0m                                     [2m                [0m
[2;36m                    [0m         [39mAddress [0m[1;36m0x7f8aadc82be0[0m[39m is located in stack of thread T0 at offset [0m[1;36m480[0m[39m in frame[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561f11fea5ff[0m[39m in file_do [0m[35m/src/curl/lib/[0m[95mfile.c[0m[39m:[0m[1;36m421[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: file_do[0m                                                                [2m                [0m
[2;36m                    [0m         [39m  This frame has [0m[1;36m5[0m[39m [0m[1;35mobject[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m32[0m[39m, [0m[1;36m176[0m[1;39m)[0m[39m [0m[32m'statbuf'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m428[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m240[0m[39m, [0m[1;36m248[0m[1;39m)[0m[39m [0m[32m'xfer_buf'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m436[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m272[0m[39m, [0m[1;36m280[0m[1;39m)[0m[39m [0m[32m'xfer_blen'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m437[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m304[0m[39m, [0m[1;36m360[0m[1;39m)[0m[39m [0m[32m'buffer'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m464[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m400[0m[39m, [0m[1;36m480[0m[1;39m)[0m[39m [0m[32m'header'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m466[0m[1;39m)[0m[39m <== Memory access at offset [0m[1;36m480[0m[39m overflows this [0m  [2m                [0m
[2;36m                    [0m         [39mvariable[0m                                                                            [2m                [0m
[2;36m                    [0m         [39mHINT: this may be a false positive if your program uses some custom stack unwind [0m   [2m                [0m
[2;36m                    [0m         [39mmechanism, swapcontext or vfork[0m                                                     [2m                [0m
[2;36m                    [0m         [39m      [0m[1;39m([0m[39mlongjmp and C++ exceptions *are* supported[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: stack-buffer-overflow [0m[35m/src/curl/lib/[0m[95mmprintf.c[0m[39m:[0m[1;92m1058:22[0m[39m in[0m [2m                [0m
[2;36m                    [0m         [39maddbyter[0m                                                                            [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82900[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82980[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82a00[0m[39m: f1 f1 f1 f1 [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82a80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m f2 f2 f2 f2 f2 f2 f2 f2 [0m[1;36m00[0m[39m f2[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82b00[0m[39m: f2 f2 [0m[1;36m00[0m[39m f2 f2 f2 [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m f2 f2 f2[0m                   [2m                [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x7f8aadc82b80[0m: f2 f2 [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0mf3[1m][0mf3 f3 f3                   [2m                [0m
[2;36m                    [0m           [1;36m0x7f8aadc82c00[0m: [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m                   [2m                [0m
[2;36m                    [0m           [1;36m0x7f8aadc82c80[0m: [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m                   [2m                [0m
[2;36m                    [0m           [1;36m0x7f8aadc82d00[0m: [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m                   [2m                [0m
[2;36m                    [0m           [1;36m0x7f8aadc82d80[0m: [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m                   [2m                [0m
[2;36m                    [0m           [1;36m0x7f8aadc82e00[0m: [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m                   [2m                [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                [2m                [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                       [2m                [0m
[2;36m                    [0m           Heap left redzone:       fa                                                       [2m                [0m
[2;36m                    [0m           Freed heap region:       fd                                                       [2m                [0m
[2;36m                    [0m           Stack left redzone:      f1                                                       [2m                [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                       [2m                [0m
[2;36m                    [0m           Stack right redzone:     f3                                                       [2m                [0m
[2;36m                    [0m           Stack after return:      f5                                                       [2m                [0m
[2;36m                    [0m           Stack use after scope:   f8                                                       [2m                [0m
[2;36m                    [0m           Global redzone:          f9                                                       [2m                [0m
[2;36m                    [0m           Global init order:       f6                                                       [2m                [0m
[2;36m                    [0m           Poisoned by user:        f7                                                       [2m                [0m
[2;36m                    [0m           Container overflow:      fc                                                       [2m                [0m
[2;36m                    [0m           Array cookie:            ac                                                       [2m                [0m
[2;36m                    [0m           Intra object redzone:    bb                                                       [2m                [0m
[2;36m                    [0m           ASan internal:           fe                                                       [2m                [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                       [2m                [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                       [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                      [2m                [0m
[2;36m                    [0m         MS: [1;36m0[0m ; base unit: [1;36m0000000000000000000000000000000000000000[0m                         [2m                [0m
[2;36m                    [0m         [1;36m0x0[0m,[1;36m0x1[0m,[1;36m0x0[0m,[1;36m0x0[0m,[1;36m0x0[0m,[1;36m0x18[0m,[1;36m0x66[0m,[1;36m0x69[0m,[1;36m0x6c[0m,[1;36m0x65[0m,[1;36m0x3a[0m,[1;36m0x2f[0m,[1;36m0x2f[0m,[1;36m0x2f[0m,[1;36m0x70[0m,[1;36m0x72[0m,[1;36m0x6f[0m,[1;36m0x6[0m [2m                [0m
[2;36m                    [0m         [1;36m3[0m,[1;36m0x2f[0m,[1;36m0x73[0m,[1;36m0x65[0m,[1;36m0x6c[0m,[1;36m0x66[0m,[1;36m0x2f[0m,[1;36m0x73[0m,[1;36m0x74[0m,[1;36m0x61[0m,[1;36m0x74[0m,[1;36m0x75[0m,[1;36m0x73[0m,[1;36m0x0[0m,[1;36m0x1c[0m,[1;36m0x0[0m,[1;36m0x0[0m,[1;36m0x0[0m, [2m                [0m
[2;36m                    [0m         [1;36m0x4[0m,[1;36m0x0[0m,[1;36m0x0[0m,[1;36m0x0[0m,[1;36m0x1[0m,                                                                [2m                [0m
[2;36m                    [0m         \[1;36m000[0m\[1;36m001[0m\[1;36m000[0m\[1;36m000[0m\[1;36m000[0m\030[4;94mfile:///proc/self/status[0m\[1;36m000[0m\[1;36m034[0m\[1;36m000[0m\[1;36m000[0m\[1;36m000[0m\[1;36m004[0m\[1;36m000[0m\[1;36m000[0m\[1;36m00[0m [2m                [0m
[2;36m                    [0m         [1;36m0[0m\[1;36m001[0m                                                                               [2m                [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                               [2m                [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64 [2m                [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                    [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m:[35m/[0m[95mout[0m -v          [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmptedwh0lh[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce     [2m                [0m
[2;36m                    [0m         curl_fuzzer -[33mruns[0m=[1;36m100[0m.                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/10/26 03:24:32][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=222487;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=260550;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 03:27:50][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=651386;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=68044;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 03:28:14][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=895977;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=762409;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Started[33m...[0m                           ]8;id=920759;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=485514;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 03:28:15][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Took [1;36m0.92[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=8873;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=795042;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Patching[1m)[0m Started[33m...[0m                                ]8;id=847408;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=516910;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp3osbuk57[0m                                                 ]8;id=939957;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=351996;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/10/26 03:31:23][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Patching[1m)[0m Took [1;36m187.74[0m seconds; [33mexception[0m=[3;91mFalse[0m     ]8;id=603978;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=56948;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Checking build[1m)[0m Started[33m...[0m                          ]8;id=506129;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=177768;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 03:32:01][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Checking build[1m)[0m Took [1;36m38.45[0m seconds;                ]8;id=144848;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=823215;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Running PoV[1m)[0m Started[33m...[0m                             ]8;id=976637;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=970925;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 03:32:04][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Running PoV[1m)[0m Took [1;36m2.15[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=267686;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=181545;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Testing[1m)[0m Started[33m...[0m                                 ]8;id=498381;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=991529;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m        ]8;id=771250;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=257528;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Started[33m...[0m                           ]8;id=743698;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=381254;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 03:32:05][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Took [1;36m0.94[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=57818;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=340140;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/10/26 03:32:06][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Started[33m...[0m                           ]8;id=777600;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=184419;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 03:32:07][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Took [1;36m0.92[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=66690;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=387439;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/10/26 03:32:08][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Started[33m...[0m                           ]8;id=330382;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=857281;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Took [1;36m0.92[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=494848;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=242785;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/10/26 03:32:09][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=54006;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=264527;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/lib/file.c                                                                    [2m                [0m
[2;36m                    [0m         +++ b/lib/file.c                                                                    [2m                [0m
[2;36m                    [0m         @@ [1;36m-492[0m,[1;36m7[0m +[1;36m492[0m,[1;36m7[0m @@                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m              [1;35mif[0m[1m([0mdata->req.no_body[1m)[0m [1m{[0m                                                        [2m                [0m
[2;36m                    [0m                headerlen =                                                                  [2m                [0m
[2;36m                    [0m         -      [1;35mmsnprintf[0m[1m([0mheader, [1;35msizeof[0m[1m([0mno_body[1m)[0m, [32m"%s [0m[32m([0m[32m%ld bytes[0m[32m)[0m[32m \r\n"[0m,                    [2m                [0m
[2;36m                    [0m         +      [1;35mmsnprintf[0m[1m([0mheader, [1;35msizeof[0m[1m([0mheader[1m)[0m, [32m"%s [0m[32m([0m[32m%ld bytes[0m[32m)[0m[32m \r\n"[0m,                     [2m                [0m
[2;36m                    [0m                            no_body, expected_size[1m)[0m;                                         [2m                [0m
[2;36m                    [0m                result = [1;35mCurl_client_write[0m[1m([0mdata, CLIENTWRITE_[1;33mHEAD[0mER, header, headerlen[1m)[0m;     [2m                [0m
[2;36m                    [0m              [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mcurl_fuzzer[0m                                                                [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer curl_fuzzer -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                        [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mmax_len[0m=[1;36m10000[0m  [2m                [0m
[2;36m                    [0m         -[33mdict[0m=[35mhttp[0m.dict [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m                                                         [2m                [0m
[2;36m                    [0m         [39mDictionary: [0m[1;36m40[0m[39m entries[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m751486488[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m122375[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m122375[0m[39m [0m[1;39m[[0m[1;36m0x561f131ef0c0[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [1;36m0x561f1320cec7[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m122375[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m122375[0m[39m [0m[1;39m[[0m[1;36m0x561f1320cec8[0m[39m,[0m[1;36m0x561f133eaf38[0m[1;39m)[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: stack-buffer-overflow on address [0m[1;36m0x7f8aadc82be0[0m[39m at [0m  [2m                [0m
[2;36m                    [0m         [39mpc [0m[1;36m0x561f11e6afd1[0m[39m bp [0m[1;36m0x7ffcbe720b60[0m[39m sp [0m[1;36m0x7ffcbe720b58[0m                               [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x7f8aadc82be0[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m46[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-stack-buffer-overflow[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561f11e6afd0[0m[39m in addbyter [0m[35m/src/curl/lib/[0m[95mmprintf.c[0m[39m:[0m[1;92m1058:22[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561f11e6940b[0m[39m in formatf [0m[35m/src/curl/lib/[0m[95mmprintf.c[0m[39m:[0m[1;92m909:9[0m                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561f11e667ad[0m[39m in curl_mvsnprintf [0m[35m/src/curl/lib/[0m[95mmprintf.c[0m[39m:[0m[1;92m1075:13[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561f11e6b218[0m[39m in curl_msnprintf [0m[35m/src/curl/lib/[0m[95mmprintf.c[0m[39m:[0m[1;92m1095:13[0m             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561f11feafd8[0m[39m in file_do [0m[35m/src/curl/lib/[0m[95mfile.c[0m[39m:[0m[1;92m495:7[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561f11e92890[0m[39m in multi_do [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m1643:14[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561f11e8f5f2[0m[39m in state_do [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m2314:14[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x561f11e7d4ef[0m[39m in multi_runsingle [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m2768:12[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561f11e7b435[0m[39m in curl_multi_perform [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m3016:16[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x561f11e291a0[0m[39m in [0m[1;35mfuzz_handle_transfer[0m[1;39m([0m[39mfuzz_data*[0m[1;39m)[0m[39m [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m341:3[0m                                               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x561f11e274ed[0m[39m in LLVMFuzzerTestOneInput [0m                                   [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m97:3[0m                                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x561f11cdbaa0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m    [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x561f11cc6d15[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x561f11ccc7af[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x561f11cf7a52[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m15[0m[39m [0m[1;36m0x7f8aae470082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m16[0m[39m [0m[1;36m0x561f11cbeefd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mcurl_fuzzer+0x4edefd[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: addbyter--formatf--curl_mvsnprintf[0m                                     [2m                [0m
[2;36m                    [0m         [39mAddress [0m[1;36m0x7f8aadc82be0[0m[39m is located in stack of thread T0 at offset [0m[1;36m480[0m[39m in frame[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561f11fea5ff[0m[39m in file_do [0m[35m/src/curl/lib/[0m[95mfile.c[0m[39m:[0m[1;36m421[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: file_do[0m                                                                [2m                [0m
[2;36m                    [0m         [39m  This frame has [0m[1;36m5[0m[39m [0m[1;35mobject[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m32[0m[39m, [0m[1;36m176[0m[1;39m)[0m[39m [0m[32m'statbuf'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m428[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m240[0m[39m, [0m[1;36m248[0m[1;39m)[0m[39m [0m[32m'xfer_buf'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m436[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m272[0m[39m, [0m[1;36m280[0m[1;39m)[0m[39m [0m[32m'xfer_blen'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m437[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m304[0m[39m, [0m[1;36m360[0m[1;39m)[0m[39m [0m[32m'buffer'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m464[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m400[0m[39m, [0m[1;36m480[0m[1;39m)[0m[39m [0m[32m'header'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m466[0m[1;39m)[0m[39m <== Memory access at offset [0m[1;36m480[0m[39m overflows this [0m  [2m                [0m
[2;36m                    [0m         [39mvariable[0m                                                                            [2m                [0m
[2;36m                    [0m         [39mHINT: this may be a false positive if your program uses some custom stack unwind [0m   [2m                [0m
[2;36m                    [0m         [39mmechanism, swapcontext or vfork[0m                                                     [2m                [0m
[2;36m                    [0m         [39m      [0m[1;39m([0m[39mlongjmp and C++ exceptions *are* supported[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: stack-buffer-overflow [0m[35m/src/curl/lib/[0m[95mmprintf.c[0m[39m:[0m[1;92m1058:22[0m[39m in[0m [2m                [0m
[2;36m                    [0m         [39maddbyter[0m                                                                            [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82900[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82980[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82a00[0m[39m: f1 f1 f1 f1 [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82a80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m f2 f2 f2 f2 f2 f2 f2 f2 [0m[1;36m00[0m[39m f2[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82b00[0m[39m: f2 f2 [0m[1;36m00[0m[39m f2 f2 f2 [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m f2 f2 f2[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x7f8aadc82b80[0m[39m: f2 f2 [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[39mf3[0m[1;39m][0m[39mf3 f3 f3[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82c00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82c80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82d00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82d80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82e00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39mMS: [0m[1;36m0[0m[39m ; base unit: [0m[1;36m0000000000000000000000000000000000000000[0m                         [2m                [0m
[2;36m                    [0m         [1;36m0x0[0m[39m,[0m[1;36m0x1[0m[39m,[0m[1;36m0x0[0m[39m,[0m[1;36m0x0[0m[39m,[0m[1;36m0x0[0m[39m,[0m[1;36m0x18[0m[39m,[0m[1;36m0x66[0m[39m,[0m[1;36m0x69[0m[39m,[0m[1;36m0x6c[0m[39m,[0m[1;36m0x65[0m[39m,[0m[1;36m0x3a[0m[39m,[0m[1;36m0x2f[0m[39m,[0m[1;36m0x2f[0m[39m,[0m[1;36m0x2f[0m[39m,[0m[1;36m0x70[0m[39m,[0m[1;36m0x72[0m[39m,[0m[1;36m0x6f[0m[39m,[0m[1;36m0x6[0m [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m,[0m[1;36m0x2f[0m[39m,[0m[1;36m0x73[0m[39m,[0m[1;36m0x65[0m[39m,[0m[1;36m0x6c[0m[39m,[0m[1;36m0x66[0m[39m,[0m[1;36m0x2f[0m[39m,[0m[1;36m0x73[0m[39m,[0m[1;36m0x74[0m[39m,[0m[1;36m0x61[0m[39m,[0m[1;36m0x74[0m[39m,[0m[1;36m0x75[0m[39m,[0m[1;36m0x73[0m[39m,[0m[1;36m0x0[0m[39m,[0m[1;36m0x1c[0m[39m,[0m[1;36m0x0[0m[39m,[0m[1;36m0x0[0m[39m,[0m[1;36m0x0[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [1;36m0x4[0m[39m,[0m[1;36m0x0[0m[39m,[0m[1;36m0x0[0m[39m,[0m[1;36m0x0[0m[39m,[0m[1;36m0x1[0m[39m,[0m                                                                [2m                [0m
[2;36m                    [0m         [39m\[0m[1;36m000[0m[39m\[0m[1;36m001[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m000[0m[39m\030[0m[4;94mfile:///proc/self/status[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m034[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m004[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m00[0m [2m                [0m
[2;36m                    [0m         [1;36m0[0m[39m\[0m[1;36m001[0m                                                                               [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m         [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmptedwh0lh[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mcurl_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA stack-buffer-overflow vulnerability has been detected in the curl library during [0m [2m                [0m
[2;36m                    [0m         [39mfuzzing. The overflow occurs in the `addbyter` function within [0m                     [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/curl/lib/[0m[95mmprintf.c[0m[39m` at line [0m[1;36m1058[0m[39m, when processing a [0m[4;94mfile://[0m[39m URL pointing to [0m  [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/proc/self/[0m[95mstatus[0m[39m`. The vulnerability involves a [0m[1;36m1[0m[39m-byte write operation that [0m      [2m                [0m
[2;36m                    [0m         [39mexceeds the bounds of an [0m[1;36m80[0m[39m-byte stack-allocated `header` buffer in the `file_do` [0m  [2m                [0m
[2;36m                    [0m         [39mfunction.[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Vulnerability Type[0m                                                              [2m                [0m
[2;36m                    [0m         [39mThis is a **stack-buffer-overflow** vulnerability with a SCARINESS score of [0m[1;36m46[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mclassified as a [0m[1;36m1[0m[39m-byte-write-stack-buffer-overflow. AddressSanitizer detected a [0m    [2m                [0m
[2;36m                    [0m         [39mWRITE operation of size [0m[1;36m1[0m[39m at address `[0m[1;36m0x7f8aadc82be0[0m[39m` that exceeds the bounds of a [0m [2m                [0m
[2;36m                    [0m         [39mstack-allocated buffer.[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Issue Details[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mThe vulnerability manifests when the curl fuzzer processes a specific input [0m        [2m                [0m
[2;36m                    [0m         [39mcontaining a [0m[4;94mfile://[0m[39m URL [0m[1;39m([0m[39m`[0m[4;94mfile:///proc/self/status`[0m[4;94m)[0m[4;94m.[0m[39m The error originates from [0m   [2m                [0m
[2;36m                    [0m         [39mthe following call chain:[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Entry Point**: The fuzzer invokes `LLVMFuzzerTestOneInput` which calls [0m        [2m                [0m
[2;36m                    [0m         [39m`fuzz_handle_transfer`[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Transfer Handling**: `curl_multi_perform` initiates the URL handling process[0m   [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Protocol Handler**: The execution flows through `multi_runsingle` → `state_do`[0m [2m                [0m
[2;36m                    [0m         [39m→ `multi_do` → `file_do`[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Format Operations**: Within `file_do`, a call to `curl_msnprintf` is made at [0m  [2m                [0m
[2;36m                    [0m         [39mline [0m[1;36m495[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Buffer Overflow**: The formatting operation eventually calls `addbyter` at [0m    [2m                [0m
[2;36m                    [0m         [39mline [0m[1;36m1058[0m[39m of `mprintf.c`, which attempts to write [0m[1;36m1[0m[39m byte beyond the allocated [0m      [2m                [0m
[2;36m                    [0m         [39mbuffer[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Memory Layout Analysis[0m                                                          [2m                [0m
[2;36m                    [0m         [39mAccording to the AddressSanitizer report, the `file_do` function frame contains [0m[1;36m5[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mstack objects:[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m- `[0m[1;39m[[0m[1;36m32[0m[39m, [0m[1;36m176[0m[1;39m)[0m[39m` - [0m[32m'statbuf'[0m[39m [0m[1;39m([0m[1;36m144[0m[39m bytes, line [0m[1;36m428[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [39m- `[0m[1;39m[[0m[1;36m240[0m[39m, [0m[1;36m248[0m[1;39m)[0m[39m` - [0m[32m'xfer_buf'[0m[39m [0m[1;39m([0m[1;36m8[0m[39m bytes, line [0m[1;36m436[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [39m- `[0m[1;39m[[0m[1;36m272[0m[39m, [0m[1;36m280[0m[1;39m)[0m[39m` - [0m[32m'xfer_blen'[0m[39m [0m[1;39m([0m[1;36m8[0m[39m bytes, line [0m[1;36m437[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m- `[0m[1;39m[[0m[1;36m304[0m[39m, [0m[1;36m360[0m[1;39m)[0m[39m` - [0m[32m'buffer'[0m[39m [0m[1;39m([0m[1;36m56[0m[39m bytes, line [0m[1;36m464[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [39m- `[0m[1;39m[[0m[1;36m400[0m[39m, [0m[1;36m480[0m[1;39m)[0m[39m` - [0m[32m'header'[0m[39m [0m[1;39m([0m[1;36m80[0m[39m bytes, line [0m[1;36m466[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe memory access at offset [0m[1;36m480[0m[39m overflows the `header` variable, which is allocated[0m [2m                [0m
[2;36m                    [0m         [39mfrom offset [0m[1;36m400[0m[39m to [0m[1;36m480[0m[39m. The write operation attempts to access offset [0m[1;36m480[0m[39m, which is[0m [2m                [0m
[2;36m                    [0m         [39mexactly [0m[1;36m1[0m[39m byte beyond the allocated space.[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Shadow Memory Analysis[0m                                                          [2m                [0m
[2;36m                    [0m         [39mThe shadow bytes indicate:[0m                                                          [2m                [0m
[2;36m                    [0m         [39m- `[0m[1;36m0x7f8aadc82b80[0m[39m: f2 f2 [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[39mf3[0m[1;39m][0m[39mf3 f3 f3`[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe `[0m[1;39m[[0m[39mf3[0m[1;39m][0m[39m` marker at the overflow location indicates a [0m[32m"Stack right redzone"[0m[39m [0m       [2m                [0m
[2;36m                    [0m         [39mviolation, confirming that the write operation exceeded the stack allocation [0m       [2m                [0m
[2;36m                    [0m         [39mboundary.[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Test Case Input[0m                                                                 [2m                [0m
[2;36m                    [0m         [39mThe triggering input is a [0m[1;36m40[0m[39m-byte sequence that constructs a [0m[4;94mfile://[0m[39m URL:[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m\[0m[1;36m000[0m[39m\[0m[1;36m001[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m000[0m[39m\030[0m[4;94mfile:///proc/self/status[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m034[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m004[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m00[0m [2m                [0m
[2;36m                    [0m         [1;36m0[0m[39m\[0m[1;36m001[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis input causes the file handler to process `[0m[35m/proc/self/[0m[95mstatus[0m[39m`, which likely [0m    [2m                [0m
[2;36m                    [0m         [39mcontains content that, when formatted into the header buffer, exceeds the [0m[1;36m80[0m[39m-byte [0m  [2m                [0m
[2;36m                    [0m         [39mallocation.[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Code Areas Requiring Investigation[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo fully understand this vulnerability, the following components should be [0m         [2m                [0m
[2;36m                    [0m         [39mexamined:[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Primary Location - `[0m[35m/src/curl/lib/[0m[95mfile.c[0m[39m`**:[0m                                   [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m466[0m[39m: Declaration and allocation of the `header` buffer[0m                    [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m495[0m[39m: The `curl_msnprintf` call that triggers the overflow[0m                 [2m                [0m
[2;36m                    [0m         [39m   - Lines [0m[1;36m421[0m[39m-[0m[1;36m500[0m[39m: The complete context of the `file_do` function to understand [0m   [2m                [0m
[2;36m                    [0m         [39mwhat data is being formatted[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Format String Handler - `[0m[35m/src/curl/lib/[0m[95mmprintf.c[0m[39m`**:[0m                           [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m1058[0m[39m: The `addbyter` function where the actual overflow write occurs[0m      [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m909[0m[39m: The `formatf` function that calls `addbyter`[0m                         [2m                [0m
[2;36m                    [0m         [39m   - Lines [0m[1;36m1075[0m[39m and [0m[1;36m1095[0m[39m: The `curl_mvsnprintf` and `curl_msnprintf` functions to [0m  [2m                [0m
[2;36m                    [0m         [39munderstand buffer size validation[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Multi-transfer Handling - `[0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m`**:[0m                           [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m1643[0m[39m: The `multi_do` function[0m                                             [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m2314[0m[39m: The `state_do` function[0m                                             [2m                [0m
[2;36m                    [0m         [39m   - Lines [0m[1;36m2768[0m[39m and [0m[1;36m3016[0m[39m: The transfer state management code[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Header Construction Logic**:[0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - Investigate what content from `[0m[35m/proc/self/[0m[95mstatus[0m[39m` is being formatted into the [0m [2m                [0m
[2;36m                    [0m         [39mheader[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   - Determine if there are size checks or length validations before the [0m           [2m                [0m
[2;36m                    [0m         [39m`curl_msnprintf` call[0m                                                               [2m                [0m
[2;36m                    [0m         [39m   - Review whether the [0m[1;36m80[0m[39m-byte header buffer size is adequate for all possible [0m    [2m                [0m
[2;36m                    [0m         [4;94mfile://[0m[39m protocol responses[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mcurl_fuzzer[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer curl_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                        [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mmax_len[0m[39m=[0m[1;36m10000[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39m-[0m[33mdict[0m[39m=[0m[35mhttp[0m[39m.dict < [0m[35m/dev/[0m[95mnull[0m                                                         [2m                [0m
[2;36m                    [0m         [39mDictionary: [0m[1;36m40[0m[39m entries[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m751486488[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m122375[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m122375[0m[39m [0m[1;39m[[0m[1;36m0x561f131ef0c0[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [1;36m0x561f1320cec7[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m122375[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m122375[0m[39m [0m[1;39m[[0m[1;36m0x561f1320cec8[0m[39m,[0m[1;36m0x561f133eaf38[0m[1;39m)[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: stack-buffer-overflow on address [0m[1;36m0x7f8aadc82be0[0m[39m at [0m  [2m                [0m
[2;36m                    [0m         [39mpc [0m[1;36m0x561f11e6afd1[0m[39m bp [0m[1;36m0x7ffcbe720b60[0m[39m sp [0m[1;36m0x7ffcbe720b58[0m                               [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x7f8aadc82be0[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m46[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-stack-buffer-overflow[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561f11e6afd0[0m[39m in addbyter [0m[35m/src/curl/lib/[0m[95mmprintf.c[0m[39m:[0m[1;92m1058:22[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561f11e6940b[0m[39m in formatf [0m[35m/src/curl/lib/[0m[95mmprintf.c[0m[39m:[0m[1;92m909:9[0m                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561f11e667ad[0m[39m in curl_mvsnprintf [0m[35m/src/curl/lib/[0m[95mmprintf.c[0m[39m:[0m[1;92m1075:13[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561f11e6b218[0m[39m in curl_msnprintf [0m[35m/src/curl/lib/[0m[95mmprintf.c[0m[39m:[0m[1;92m1095:13[0m             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561f11feafd8[0m[39m in file_do [0m[35m/src/curl/lib/[0m[95mfile.c[0m[39m:[0m[1;92m495:7[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561f11e92890[0m[39m in multi_do [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m1643:14[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561f11e8f5f2[0m[39m in state_do [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m2314:14[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x561f11e7d4ef[0m[39m in multi_runsingle [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m2768:12[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561f11e7b435[0m[39m in curl_multi_perform [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m3016:16[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x561f11e291a0[0m[39m in [0m[1;35mfuzz_handle_transfer[0m[1;39m([0m[39mfuzz_data*[0m[1;39m)[0m[39m [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m341:3[0m                                               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x561f11e274ed[0m[39m in LLVMFuzzerTestOneInput [0m                                   [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m97:3[0m                                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x561f11cdbaa0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m    [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x561f11cc6d15[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x561f11ccc7af[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x561f11cf7a52[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m15[0m[39m [0m[1;36m0x7f8aae470082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m16[0m[39m [0m[1;36m0x561f11cbeefd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mcurl_fuzzer+0x4edefd[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: addbyter--formatf--curl_mvsnprintf[0m                                     [2m                [0m
[2;36m                    [0m         [39mAddress [0m[1;36m0x7f8aadc82be0[0m[39m is located in stack of thread T0 at offset [0m[1;36m480[0m[39m in frame[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561f11fea5ff[0m[39m in file_do [0m[35m/src/curl/lib/[0m[95mfile.c[0m[39m:[0m[1;36m421[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: file_do[0m                                                                [2m                [0m
[2;36m                    [0m         [39m  This frame has [0m[1;36m5[0m[39m [0m[1;35mobject[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m32[0m[39m, [0m[1;36m176[0m[1;39m)[0m[39m [0m[32m'statbuf'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m428[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m240[0m[39m, [0m[1;36m248[0m[1;39m)[0m[39m [0m[32m'xfer_buf'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m436[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m272[0m[39m, [0m[1;36m280[0m[1;39m)[0m[39m [0m[32m'xfer_blen'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m437[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m304[0m[39m, [0m[1;36m360[0m[1;39m)[0m[39m [0m[32m'buffer'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m464[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m400[0m[39m, [0m[1;36m480[0m[1;39m)[0m[39m [0m[32m'header'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m466[0m[1;39m)[0m[39m <== Memory access at offset [0m[1;36m480[0m[39m overflows this [0m  [2m                [0m
[2;36m                    [0m         [39mvariable[0m                                                                            [2m                [0m
[2;36m                    [0m         [39mHINT: this may be a false positive if your program uses some custom stack unwind [0m   [2m                [0m
[2;36m                    [0m         [39mmechanism, swapcontext or vfork[0m                                                     [2m                [0m
[2;36m                    [0m         [39m      [0m[1;39m([0m[39mlongjmp and C++ exceptions *are* supported[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: stack-buffer-overflow [0m[35m/src/curl/lib/[0m[95mmprintf.c[0m[39m:[0m[1;92m1058:22[0m[39m in[0m [2m                [0m
[2;36m                    [0m         [39maddbyter[0m                                                                            [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82900[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82980[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82a00[0m[39m: f1 f1 f1 f1 [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82a80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m f2 f2 f2 f2 f2 f2 f2 f2 [0m[1;36m00[0m[39m f2[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82b00[0m[39m: f2 f2 [0m[1;36m00[0m[39m f2 f2 f2 [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m f2 f2 f2[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x7f8aadc82b80[0m[39m: f2 f2 [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[39mf3[0m[1;39m][0m[39mf3 f3 f3[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82c00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82c80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82d00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82d80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7f8aadc82e00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39mMS: [0m[1;36m0[0m[39m ; base unit: [0m[1;36m0000000000000000000000000000000000000000[0m                         [2m                [0m
[2;36m                    [0m         [1;36m0x0[0m[39m,[0m[1;36m0x1[0m[39m,[0m[1;36m0x0[0m[39m,[0m[1;36m0x0[0m[39m,[0m[1;36m0x0[0m[39m,[0m[1;36m0x18[0m[39m,[0m[1;36m0x66[0m[39m,[0m[1;36m0x69[0m[39m,[0m[1;36m0x6c[0m[39m,[0m[1;36m0x65[0m[39m,[0m[1;36m0x3a[0m[39m,[0m[1;36m0x2f[0m[39m,[0m[1;36m0x2f[0m[39m,[0m[1;36m0x2f[0m[39m,[0m[1;36m0x70[0m[39m,[0m[1;36m0x72[0m[39m,[0m[1;36m0x6f[0m[39m,[0m[1;36m0x6[0m [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m,[0m[1;36m0x2f[0m[39m,[0m[1;36m0x73[0m[39m,[0m[1;36m0x65[0m[39m,[0m[1;36m0x6c[0m[39m,[0m[1;36m0x66[0m[39m,[0m[1;36m0x2f[0m[39m,[0m[1;36m0x73[0m[39m,[0m[1;36m0x74[0m[39m,[0m[1;36m0x61[0m[39m,[0m[1;36m0x74[0m[39m,[0m[1;36m0x75[0m[39m,[0m[1;36m0x73[0m[39m,[0m[1;36m0x0[0m[39m,[0m[1;36m0x1c[0m[39m,[0m[1;36m0x0[0m[39m,[0m[1;36m0x0[0m[39m,[0m[1;36m0x0[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [1;36m0x4[0m[39m,[0m[1;36m0x0[0m[39m,[0m[1;36m0x0[0m[39m,[0m[1;36m0x0[0m[39m,[0m[1;36m0x1[0m[39m,[0m                                                                [2m                [0m
[2;36m                    [0m         [39m\[0m[1;36m000[0m[39m\[0m[1;36m001[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m000[0m[39m\030[0m[4;94mfile:///proc/self/status[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m034[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m004[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m000[0m[39m\[0m[1;36m00[0m [2m                [0m
[2;36m                    [0m         [1;36m0[0m[39m\[0m[1;36m001[0m                                                                               [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m         [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmptedwh0lh[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mcurl_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/file.[0m[1;92mc:421[0m[39m-[0m[1;36m500[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:  [0m[35m/[0m[39m* This implementation ignores the hostname in conformance with[0m               [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:     RFC [0m[1;36m1738[0m[39m. Only local files [0m[1;39m([0m[39mreachable via the standard file system[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:     are supported. This means that files on remotely mounted directories[0m       [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:     [0m[1;39m([0m[39mvia NFS, Samba, NT sharing[0m[1;39m)[0m[39m can be accessed through a [0m[4;94mfile://[0m[39m URL[0m         [2m                [0m
[2;36m                    [0m         [1;36m426[0m[39m:  *[0m[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m427[0m[39m:  CURLcode result = CURLE_OK;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m428[0m[39m:  struct_stat statbuf; [0m[35m/[0m[39m* struct_stat instead of struct stat just to allow the[0m  [2m                [0m
[2;36m                    [0m         [1;36m429[0m[39m:                          Windows version to have a different struct without[0m    [2m                [0m
[2;36m                    [0m         [1;36m430[0m[39m:                          having to redefine the simple word [0m[32m'stat'[0m[39m *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m431[0m[39m:  curl_off_t expected_size = [0m[1;36m-1[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m432[0m[39m:  bool size_known;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m433[0m[39m:  bool fstated = FALSE;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m434[0m[39m:  int fd;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m435[0m[39m:  struct FILEPROTO *file;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m436[0m[39m:  char *xfer_buf;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m437[0m[39m:  size_t xfer_blen;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m438[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m439[0m[39m:  *done = TRUE; [0m[35m/[0m[39m* unconditionally *[0m[35m/[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m440[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m441[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mdata->state.upload[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m442[0m[39m:    return [0m[1;35mfile_upload[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m443[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m444[0m[39m:  file = data->req.p.file;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m445[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m446[0m[39m:  [0m[35m/[0m[39m* get the fd from the connection phase *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m447[0m[39m:  fd = file->fd;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m448[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m449[0m[39m:  [0m[35m/[0m[39m* VMS: This only works reliable for STREAMLF files *[0m[35m/[0m                        [2m                [0m
[2;36m                    [0m         [1;36m450[0m[39m:  [0m[1;35mif[0m[1;39m([0m[1;36m-1[0m[39m != [0m[1;35mfstat[0m[1;39m([0m[39mfd, &statbuf[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m451[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mS_ISDIR[0m[1;39m([0m[39mstatbuf.st_mode[0m[1;39m)[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m452[0m[39m:      expected_size = statbuf.st_size;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m453[0m[39m:    [0m[35m/[0m[39m* and store the modification time *[0m[35m/[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m454[0m[39m:    data->info.filetime = statbuf.st_mtime;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m455[0m[39m:    fstated = TRUE;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m456[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m457[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m458[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mfstated && !data->state.range && data->set.timecondition &&[0m                [2m                [0m
[2;36m                    [0m         [1;36m459[0m[39m:     ![0m[1;35mCurl_meets_timecondition[0m[1;39m([0m[39mdata, data->info.filetime[0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m460[0m[39m:    return CURLE_OK;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m461[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m462[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mfstated[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m463[0m[39m:    time_t filetime;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m464[0m[39m:    struct tm buffer;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m465[0m[39m:    const struct tm *tm = &buffer;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m466[0m[39m:    char header[0m[1;39m[[0m[1;36m80[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m467[0m[39m:    int headerlen;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m468[0m[39m:    static const char accept_ranges[0m[1;39m[[0m[1;39m][0m[39m= [0m[1;39m{[0m[39m [0m[32m"Accept-ranges: bytes\r\n"[0m[39m [0m[1;39m}[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m469[0m[39m:    static const char no_body[0m[1;39m[[0m[1;39m][0m[39m= [0m[1;39m{[0m[39m [0m[32m"File-body: suppressed.The body of "[0m         [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:      [0m[32m"this file has been supressed. If you would like to include "[0m             [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:      [0m[32m"the contents of this file use the -i option.\r\n"[0m[39m [0m[1;39m}[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m472[0m[39m:    static const char body_msg[0m[1;39m[[0m[1;39m][0m[39m= [0m[1;39m{[0m[39m [0m[32m"File-body: included.\r\n"[0m[1;39m}[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m473[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39mexpected_size >= [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m474[0m[39m:      headerlen =[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m475[0m[39m:        [0m[1;35mmsnprintf[0m[1;39m([0m[39mheader, [0m[1;35msizeof[0m[1;39m([0m[39mheader[0m[1;39m)[0m[39m, [0m[32m"Content-Length: %"[0m[39m FMT_OFF_T [0m[32m"\r\n"[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [1;36m476[0m[39m:                  expected_size[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m477[0m[39m:      result = [0m[1;35mCurl_client_write[0m[1;39m([0m[39mdata, CLIENTWRITE_[0m[1;33mHEAD[0m[39mER,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m478[0m[39m:                                   header, headerlen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m479[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mresult[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m480[0m[39m:        return result;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m481[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m482[0m[39m:      result = [0m[1;35mCurl_client_write[0m[1;39m([0m[39mdata, CLIENTWRITE_[0m[1;33mHEAD[0m[39mER,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m483[0m[39m:                                 accept_ranges, [0m[1;35msizeof[0m[1;39m([0m[39maccept_ranges[0m[1;39m)[0m[39m - [0m[1;36m1[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m484[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mresult != CURLE_OK[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m485[0m[39m:        return result;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m486[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m487[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m488[0m[39m:    filetime = [0m[1;39m([0m[39mtime_t[0m[1;39m)[0m[39mstatbuf.st_mtime;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m489[0m[39m:    result = [0m[1;35mCurl_gmtime[0m[1;39m([0m[39mfiletime, &buffer[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m490[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39mresult[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m491[0m[39m:      return result;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m492[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39mdata->req.no_body[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:      headerlen =[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:      [0m[1;35mmsnprintf[0m[1;39m([0m[39mheader, [0m[1;35msizeof[0m[1;39m([0m[39mno_body[0m[1;39m)[0m[39m, [0m[32m"%s [0m[32m([0m[32m%ld bytes[0m[32m)[0m[32m \r\n"[0m[39m,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:                  no_body, expected_size[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:      result = [0m[1;35mCurl_client_write[0m[1;39m([0m[39mdata, CLIENTWRITE_[0m[1;33mHEAD[0m[39mER, header, headerlen[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:    else [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:      result = [0m[1;35mCurl_client_write[0m[1;39m([0m[39mdata, CLIENTWRITE_[0m[1;33mHEAD[0m[39mER,[0m                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/file.[0m[1;92mc:466[0m[39m-[0m[1;36m500[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m466[0m[39m:    char header[0m[1;39m[[0m[1;36m80[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m467[0m[39m:    int headerlen;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m468[0m[39m:    static const char accept_ranges[0m[1;39m[[0m[1;39m][0m[39m= [0m[1;39m{[0m[39m [0m[32m"Accept-ranges: bytes\r\n"[0m[39m [0m[1;39m}[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m469[0m[39m:    static const char no_body[0m[1;39m[[0m[1;39m][0m[39m= [0m[1;39m{[0m[39m [0m[32m"File-body: suppressed.The body of "[0m         [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:      [0m[32m"this file has been supressed. If you would like to include "[0m             [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:      [0m[32m"the contents of this file use the -i option.\r\n"[0m[39m [0m[1;39m}[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m472[0m[39m:    static const char body_msg[0m[1;39m[[0m[1;39m][0m[39m= [0m[1;39m{[0m[39m [0m[32m"File-body: included.\r\n"[0m[1;39m}[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m473[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39mexpected_size >= [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m474[0m[39m:      headerlen =[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m475[0m[39m:        [0m[1;35mmsnprintf[0m[1;39m([0m[39mheader, [0m[1;35msizeof[0m[1;39m([0m[39mheader[0m[1;39m)[0m[39m, [0m[32m"Content-Length: %"[0m[39m FMT_OFF_T [0m[32m"\r\n"[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [1;36m476[0m[39m:                  expected_size[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m477[0m[39m:      result = [0m[1;35mCurl_client_write[0m[1;39m([0m[39mdata, CLIENTWRITE_[0m[1;33mHEAD[0m[39mER,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m478[0m[39m:                                   header, headerlen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m479[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mresult[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m480[0m[39m:        return result;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m481[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m482[0m[39m:      result = [0m[1;35mCurl_client_write[0m[1;39m([0m[39mdata, CLIENTWRITE_[0m[1;33mHEAD[0m[39mER,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m483[0m[39m:                                 accept_ranges, [0m[1;35msizeof[0m[1;39m([0m[39maccept_ranges[0m[1;39m)[0m[39m - [0m[1;36m1[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m484[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mresult != CURLE_OK[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m485[0m[39m:        return result;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m486[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m487[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m488[0m[39m:    filetime = [0m[1;39m([0m[39mtime_t[0m[1;39m)[0m[39mstatbuf.st_mtime;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m489[0m[39m:    result = [0m[1;35mCurl_gmtime[0m[1;39m([0m[39mfiletime, &buffer[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m490[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39mresult[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m491[0m[39m:      return result;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m492[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39mdata->req.no_body[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:      headerlen =[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:      [0m[1;35mmsnprintf[0m[1;39m([0m[39mheader, [0m[1;35msizeof[0m[1;39m([0m[39mno_body[0m[1;39m)[0m[39m, [0m[32m"%s [0m[32m([0m[32m%ld bytes[0m[32m)[0m[32m \r\n"[0m[39m,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:                  no_body, expected_size[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:      result = [0m[1;35mCurl_client_write[0m[1;39m([0m[39mdata, CLIENTWRITE_[0m[1;33mHEAD[0m[39mER, header, headerlen[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:    else [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:      result = [0m[1;35mCurl_client_write[0m[1;39m([0m[39mdata, CLIENTWRITE_[0m[1;33mHEAD[0m[39mER,[0m                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/curl_printf.h:[0m[1;36m40[0m[39m-[0m[1;36m58[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:#define MERR_TOO_LARGE [0m[1;36m2[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:# undef printf[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:# undef fprintf[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:# undef msnprintf[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:# undef vprintf[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:# undef vfprintf[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:# undef mvsnprintf[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:# undef aprintf[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:# undef vaprintf[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:# define printf curl_mprintf[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:# define fprintf curl_mfprintf[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:# define msnprintf curl_msnprintf[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:# define vprintf curl_mvprintf[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:# define vfprintf curl_mvfprintf[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:# define mvsnprintf curl_mvsnprintf[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:# define aprintf curl_maprintf[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:# define vaprintf curl_mvaprintf[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:#endif [0m[35m/[0m[39m* [0m[1;33mHEAD[0m[39mER_CURL_PRINTF_H *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/file.[0m[1;92mc:25[0m[39m-[0m[1;36m50[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:#include [0m[32m"curl_setup.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:#ifndef CURL_DISABLE_FILE[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:#ifdef HAVE_NETINET_IN_H[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:#include <netinet/in.h>[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:#ifdef HAVE_NETDB_H[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:#include <netdb.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:#ifdef HAVE_ARPA_INET_H[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:#include <arpa/inet.h>[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:#ifdef HAVE_NET_IF_H[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:#include <net/if.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:#ifdef HAVE_SYS_IOCTL_H[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:#include <sys/ioctl.h>[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:#ifdef HAVE_SYS_PARAM_H[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:#include <sys/param.h>[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:#ifdef HAVE_FCNTL_H[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:#include <fcntl.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/mprintf.[0m[1;92mc:1053[0m[39m-[0m[1;36m1063[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1053[0m[39m:static int [0m[1;35maddbyter[0m[1;39m([0m[39munsigned char outc, void *f[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1054[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1055[0m[39m:  struct nsprintf *infop = f;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1056[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39minfop->length < infop->max[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1057[0m[39m:    [0m[35m/[0m[39m* only do this if we have not reached max length yet *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1058[0m[39m:    *infop->buffer++ = [0m[1;39m([0m[39mchar[0m[1;39m)[0m[39moutc; [0m[35m/[0m[39m* store *[0m[35m/[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1059[0m[39m:    infop->length++; [0m[35m/[0m[39m* we are now one byte larger *[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1060[0m[39m:    return [0m[1;36m0[0m[39m;     [0m[35m/[0m[39m* [0m[1;35mfputc[0m[1;39m([0m[1;39m)[0m[39m returns like this on success *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1061[0m[39m:  [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1062[0m[39m:  return [0m[1;36m1[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1063[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/mprintf.[0m[1;92mc:1070[0m[39m-[0m[1;36m1098[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1070[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1071[0m[39m:  info.buffer = buffer;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1072[0m[39m:  info.length = [0m[1;36m0[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1073[0m[39m:  info.max = maxlength;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1074[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1075[0m[39m:  retcode = [0m[1;35mformatf[0m[1;39m([0m[39m&info, addbyter, format, ap_save[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1076[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39minfo.max[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1077[0m[39m:    [0m[35m/[0m[39m* we terminate this with a zero byte *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1078[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39minfo.max == info.length[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1079[0m[39m:      [0m[35m/[0m[39m* we are at maximum, scrap the last letter *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1080[0m[39m:      info.buffer[0m[1;39m[[0m[1;36m-1[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1081[0m[39m:      [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39mretcode[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1082[0m[39m:      retcode--; [0m[35m/[0m[39m* do not count the nul byte *[0m[35m/[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1083[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1084[0m[39m:    else[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m1085[0m[39m:      info.buffer[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1086[0m[39m:  [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1087[0m[39m:  return retcode;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1088[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1089[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1090[0m[39m:int [0m[1;35mcurl_msnprintf[0m[1;39m([0m[39mchar *buffer, size_t maxlength, const char *format, [0m[33m...[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [1;36m1091[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1092[0m[39m:  int retcode;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1093[0m[39m:  va_list ap_save; [0m[35m/[0m[39m* argument pointer *[0m[35m/[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1094[0m[39m:  [0m[1;35mva_start[0m[1;39m([0m[39map_save, format[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1095[0m[39m:  retcode = [0m[1;35mcurl_mvsnprintf[0m[1;39m([0m[39mbuffer, maxlength, format, ap_save[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m1096[0m[39m:  [0m[1;35mva_end[0m[1;39m([0m[39map_save[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1097[0m[39m:  return retcode;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1098[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/file.[0m[1;92mc:468[0m[39m-[0m[1;36m522[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m468[0m[39m:    static const char accept_ranges[0m[1;39m[[0m[1;39m][0m[39m= [0m[1;39m{[0m[39m [0m[32m"Accept-ranges: bytes\r\n"[0m[39m [0m[1;39m}[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m469[0m[39m:    static const char no_body[0m[1;39m[[0m[1;39m][0m[39m= [0m[1;39m{[0m[39m [0m[32m"File-body: suppressed.The body of "[0m         [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:      [0m[32m"this file has been supressed. If you would like to include "[0m             [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:      [0m[32m"the contents of this file use the -i option.\r\n"[0m[39m [0m[1;39m}[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m472[0m[39m:    static const char body_msg[0m[1;39m[[0m[1;39m][0m[39m= [0m[1;39m{[0m[39m [0m[32m"File-body: included.\r\n"[0m[1;39m}[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m473[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39mexpected_size >= [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m474[0m[39m:      headerlen =[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m475[0m[39m:        [0m[1;35mmsnprintf[0m[1;39m([0m[39mheader, [0m[1;35msizeof[0m[1;39m([0m[39mheader[0m[1;39m)[0m[39m, [0m[32m"Content-Length: %"[0m[39m FMT_OFF_T [0m[32m"\r\n"[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [1;36m476[0m[39m:                  expected_size[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m477[0m[39m:      result = [0m[1;35mCurl_client_write[0m[1;39m([0m[39mdata, CLIENTWRITE_[0m[1;33mHEAD[0m[39mER,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m478[0m[39m:                                   header, headerlen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m479[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mresult[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m480[0m[39m:        return result;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m481[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m482[0m[39m:      result = [0m[1;35mCurl_client_write[0m[1;39m([0m[39mdata, CLIENTWRITE_[0m[1;33mHEAD[0m[39mER,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m483[0m[39m:                                 accept_ranges, [0m[1;35msizeof[0m[1;39m([0m[39maccept_ranges[0m[1;39m)[0m[39m - [0m[1;36m1[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m484[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mresult != CURLE_OK[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m485[0m[39m:        return result;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m486[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m487[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m488[0m[39m:    filetime = [0m[1;39m([0m[39mtime_t[0m[1;39m)[0m[39mstatbuf.st_mtime;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m489[0m[39m:    result = [0m[1;35mCurl_gmtime[0m[1;39m([0m[39mfiletime, &buffer[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m490[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39mresult[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m491[0m[39m:      return result;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m492[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39mdata->req.no_body[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:      headerlen =[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:      [0m[1;35mmsnprintf[0m[1;39m([0m[39mheader, [0m[1;35msizeof[0m[1;39m([0m[39mno_body[0m[1;39m)[0m[39m, [0m[32m"%s [0m[32m([0m[32m%ld bytes[0m[32m)[0m[32m \r\n"[0m[39m,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:                  no_body, expected_size[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:      result = [0m[1;35mCurl_client_write[0m[1;39m([0m[39mdata, CLIENTWRITE_[0m[1;33mHEAD[0m[39mER, header, headerlen[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:    else [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:      result = [0m[1;35mCurl_client_write[0m[1;39m([0m[39mdata, CLIENTWRITE_[0m[1;33mHEAD[0m[39mER,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:                                 body_msg, [0m[1;35msizeof[0m[1;39m([0m[39mbody_msg[0m[1;39m)[0m[39m - [0m[1;36m1[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39mresult[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:      return result;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:    [0m[35m/[0m[39m* format: [0m[32m"Tue, 15 Nov 1994 12:45:26 GMT"[0m[39m *[0m[35m/[0m                               [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:    headerlen =[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m507[0m[39m:      [0m[1;35mmsnprintf[0m[1;39m([0m[39mheader, [0m[1;35msizeof[0m[1;39m([0m[39mheader[0m[1;39m)[0m[39m,[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:                [0m[32m"Last-Modified: %s, %02d %s %4d %02d:%02d:%02d GMT\r\n"[0m[39m,[0m        [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:                Curl_wkday[0m[1;39m[[0m[39mtm->tm_wday ? tm->tm_wday-[0m[1;36m1[0m[39m : [0m[1;36m6[0m[1;39m][0m[39m,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:                tm->tm_mday,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:                Curl_month[0m[1;39m[[0m[39mtm->tm_mon[0m[1;39m][0m[39m,[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:                tm->tm_year + [0m[1;36m1900[0m[39m,[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:                tm->tm_hour,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:                tm->tm_min,[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:                tm->tm_sec[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:    result = [0m[1;35mCurl_client_write[0m[1;39m([0m[39mdata, CLIENTWRITE_[0m[1;33mHEAD[0m[39mER, header, headerlen[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m517[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39m!result[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m518[0m[39m:      [0m[35m/[0m[39m* end of headers *[0m[35m/[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m519[0m[39m:      result = [0m[1;35mCurl_client_write[0m[1;39m([0m[39mdata, CLIENTWRITE_[0m[1;33mHEAD[0m[39mER, [0m[32m"\r\n"[0m[39m, [0m[1;36m2[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m520[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39mresult[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m521[0m[39m:      return result;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m522[0m[39m:    [0m[35m/[0m[39m* set the file size to make it available post transfer *[0m[35m/[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/file.[0m[1;92mc:415[0m[39m-[0m[1;36m425[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m: * the do-phase, to have it done in the main transfer loop but since some[0m       [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m: * platforms we support do not allow [0m[1;35mselect[0m[1;39m([0m[1;39m)[0m[39ming etc on file handles [0m[1;39m([0m[39mas[0m        [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m: * opposed to sockets[0m[1;39m)[0m[39m we instead perform the whole do-operation in this[0m        [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m: * function.[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:static CURLcode [0m[1;35mfile_do[0m[1;39m([0m[39mstruct Curl_easy *data, bool *done[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:  [0m[35m/[0m[39m* This implementation ignores the hostname in conformance with[0m               [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:     RFC [0m[1;36m1738[0m[39m. Only local files [0m[1;39m([0m[39mreachable via the standard file system[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:     are supported. This means that files on remotely mounted directories[0m       [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:     [0m[1;39m([0m[39mvia NFS, Samba, NT sharing[0m[1;39m)[0m[39m can be accessed through a [0m[4;94mfile://[0m[39m URL[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/file.[0m[1;92mc:468[0m[39m-[0m[1;36m472[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m468[0m[39m:    static const char accept_ranges[0m[1;39m[[0m[1;39m][0m[39m= [0m[1;39m{[0m[39m [0m[32m"Accept-ranges: bytes\r\n"[0m[39m [0m[1;39m}[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m469[0m[39m:    static const char no_body[0m[1;39m[[0m[1;39m][0m[39m= [0m[1;39m{[0m[39m [0m[32m"File-body: suppressed.The body of "[0m         [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:      [0m[32m"this file has been supressed. If you would like to include "[0m             [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:      [0m[32m"the contents of this file use the -i option.\r\n"[0m[39m [0m[1;39m}[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m472[0m[39m:    static const char body_msg[0m[1;39m[[0m[1;39m][0m[39m= [0m[1;39m{[0m[39m [0m[32m"File-body: included.\r\n"[0m[1;39m}[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/mprintf.[0m[1;92mc:1040[0m[39m-[0m[1;36m1088[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1040[0m[39m:        *[0m[1;39m([0m[39mint *[0m[1;39m)[0m[39m iptr->val.ptr = [0m[1;39m([0m[39mint[0m[1;39m)[0m[39mdone;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1041[0m[39m:      else[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1042[0m[39m:        *[0m[1;39m([0m[39mshort *[0m[1;39m)[0m[39m iptr->val.ptr = [0m[1;39m([0m[39mshort[0m[1;39m)[0m[39mdone;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1043[0m[39m:      break;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1044[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1045[0m[39m:    default:[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1046[0m[39m:      break;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1047[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1048[0m[39m:  [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1049[0m[39m:  return done;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1050[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1051[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1052[0m[39m:[0m[35m/[0m[39m* [0m[1;35mfputc[0m[1;39m([0m[1;39m)[0m[39m look-alike *[0m[35m/[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1053[0m[39m:static int [0m[1;35maddbyter[0m[1;39m([0m[39munsigned char outc, void *f[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1054[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1055[0m[39m:  struct nsprintf *infop = f;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1056[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39minfop->length < infop->max[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1057[0m[39m:    [0m[35m/[0m[39m* only do this if we have not reached max length yet *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1058[0m[39m:    *infop->buffer++ = [0m[1;39m([0m[39mchar[0m[1;39m)[0m[39moutc; [0m[35m/[0m[39m* store *[0m[35m/[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1059[0m[39m:    infop->length++; [0m[35m/[0m[39m* we are now one byte larger *[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1060[0m[39m:    return [0m[1;36m0[0m[39m;     [0m[35m/[0m[39m* [0m[1;35mfputc[0m[1;39m([0m[1;39m)[0m[39m returns like this on success *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1061[0m[39m:  [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1062[0m[39m:  return [0m[1;36m1[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1063[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1064[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1065[0m[39m:int [0m[1;35mcurl_mvsnprintf[0m[1;39m([0m[39mchar *buffer, size_t maxlength, const char *format,[0m        [2m                [0m
[2;36m                    [0m         [1;36m1066[0m[39m:                    va_list ap_save[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1067[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1068[0m[39m:  int retcode;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1069[0m[39m:  struct nsprintf info;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1070[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1071[0m[39m:  info.buffer = buffer;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1072[0m[39m:  info.length = [0m[1;36m0[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1073[0m[39m:  info.max = maxlength;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1074[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1075[0m[39m:  retcode = [0m[1;35mformatf[0m[1;39m([0m[39m&info, addbyter, format, ap_save[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1076[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39minfo.max[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1077[0m[39m:    [0m[35m/[0m[39m* we terminate this with a zero byte *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1078[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39minfo.max == info.length[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1079[0m[39m:      [0m[35m/[0m[39m* we are at maximum, scrap the last letter *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1080[0m[39m:      info.buffer[0m[1;39m[[0m[1;36m-1[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1081[0m[39m:      [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39mretcode[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1082[0m[39m:      retcode--; [0m[35m/[0m[39m* do not count the nul byte *[0m[35m/[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1083[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1084[0m[39m:    else[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m1085[0m[39m:      info.buffer[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1086[0m[39m:  [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1087[0m[39m:  return retcode;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1088[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/mprintf.[0m[1;92mc:159[0m[39m-[0m[1;36m163[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:struct nsprintf [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:  char *buffer;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:  size_t length;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:  size_t max;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/mprintf.[0m[1;92mc:1053[0m[39m-[0m[1;36m1063[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1053[0m[39m:static int [0m[1;35maddbyter[0m[1;39m([0m[39munsigned char outc, void *f[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1054[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1055[0m[39m:  struct nsprintf *infop = f;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1056[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39minfop->length < infop->max[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1057[0m[39m:    [0m[35m/[0m[39m* only do this if we have not reached max length yet *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1058[0m[39m:    *infop->buffer++ = [0m[1;39m([0m[39mchar[0m[1;39m)[0m[39moutc; [0m[35m/[0m[39m* store *[0m[35m/[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1059[0m[39m:    infop->length++; [0m[35m/[0m[39m* we are now one byte larger *[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1060[0m[39m:    return [0m[1;36m0[0m[39m;     [0m[35m/[0m[39m* [0m[1;35mfputc[0m[1;39m([0m[1;39m)[0m[39m returns like this on success *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1061[0m[39m:  [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1062[0m[39m:  return [0m[1;36m1[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1063[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/mprintf.[0m[1;92mc:1065[0m[39m-[0m[1;36m1088[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1065[0m[39m:int [0m[1;35mcurl_mvsnprintf[0m[1;39m([0m[39mchar *buffer, size_t maxlength, const char *format,[0m        [2m                [0m
[2;36m                    [0m         [1;36m1066[0m[39m:                    va_list ap_save[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1067[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1068[0m[39m:  int retcode;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1069[0m[39m:  struct nsprintf info;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1070[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1071[0m[39m:  info.buffer = buffer;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1072[0m[39m:  info.length = [0m[1;36m0[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1073[0m[39m:  info.max = maxlength;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1074[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1075[0m[39m:  retcode = [0m[1;35mformatf[0m[1;39m([0m[39m&info, addbyter, format, ap_save[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1076[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39minfo.max[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1077[0m[39m:    [0m[35m/[0m[39m* we terminate this with a zero byte *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1078[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39minfo.max == info.length[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1079[0m[39m:      [0m[35m/[0m[39m* we are at maximum, scrap the last letter *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1080[0m[39m:      info.buffer[0m[1;39m[[0m[1;36m-1[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1081[0m[39m:      [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39mretcode[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1082[0m[39m:      retcode--; [0m[35m/[0m[39m* do not count the nul byte *[0m[35m/[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1083[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1084[0m[39m:    else[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m1085[0m[39m:      info.buffer[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1086[0m[39m:  [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1087[0m[39m:  return retcode;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1088[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/mprintf.[0m[1;92mc:77[0m[39m-[0m[1;36m82[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:#define [0m[1;35mOUTCHAR[0m[1;39m([0m[39mx[0m[1;39m)[0m[39m                                      \[0m                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:  do [0m[1;39m{[0m[39m                                                  \[0m                        [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mstream[0m[1;39m([0m[1;39m([0m[39munsigned char[0m[1;39m)[0m[39mx, userp[0m[1;39m)[0m[1;39m)[0m[39m                \[0m                        [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:      done++;                                           \[0m                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    else                                                \[0m                        [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:      return done; [0m[35m/[0m[39m* return on failure *[0m[35m/[0m[39m              \[0m                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/mprintf.[0m[1;92mc:908[0m[39m-[0m[1;36m909[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m908[0m[39m:      [0m[1;35mfor[0m[1;39m([0m[39m; len && *str; len--[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m909[0m[39m:        [0m[1;35mOUTCHAR[0m[1;39m([0m[39m*str++[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/file.[0m[1;92mc:466[0m[39m-[0m[1;36m467[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m466[0m[39m:    char header[0m[1;39m[[0m[1;36m80[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m467[0m[39m:    int headerlen;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/file.[0m[1;92mc:474[0m[39m-[0m[1;36m476[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m474[0m[39m:      headerlen =[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m475[0m[39m:        [0m[1;35mmsnprintf[0m[1;39m([0m[39mheader, [0m[1;35msizeof[0m[1;39m([0m[39mheader[0m[1;39m)[0m[39m, [0m[32m"Content-Length: %"[0m[39m FMT_OFF_T [0m[32m"\r\n"[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [1;36m476[0m[39m:                  expected_size[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/file.[0m[1;92mc:494[0m[39m-[0m[1;36m496[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:      headerlen =[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:      [0m[1;35mmsnprintf[0m[1;39m([0m[39mheader, [0m[1;35msizeof[0m[1;39m([0m[39mno_body[0m[1;39m)[0m[39m, [0m[32m"%s [0m[32m([0m[32m%ld bytes[0m[32m)[0m[32m \r\n"[0m[39m,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:                  no_body, expected_size[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/file.[0m[1;92mc:506[0m[39m-[0m[1;36m508[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:    headerlen =[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m507[0m[39m:      [0m[1;35mmsnprintf[0m[1;39m([0m[39mheader, [0m[1;35msizeof[0m[1;39m([0m[39mheader[0m[1;39m)[0m[39m,[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:                [0m[32m"Last-Modified: %s, %02d %s %4d %02d:%02d:%02d GMT\r\n"[0m[39m,[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/ftp.[0m[1;92mc:2081[0m[39m-[0m[1;36m2110[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2081[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2082[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mdata->req.no_body &&[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2083[0m[39m:         ftpc->file &&[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2084[0m[39m:         data->set.get_filetime &&[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2085[0m[39m:         [0m[1;39m([0m[39mdata->info.filetime >= [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2086[0m[39m:        char headerbuf[0m[1;39m[[0m[1;36m128[0m[1;39m][0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m2087[0m[39m:        int headerbuflen;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2088[0m[39m:        time_t filetime = data->info.filetime;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m2089[0m[39m:        struct tm buffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2090[0m[39m:        const struct tm *tm = &buffer;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2091[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2092[0m[39m:        result = [0m[1;35mCurl_gmtime[0m[1;39m([0m[39mfiletime, &buffer[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m2093[0m[39m:        [0m[1;35mif[0m[1;39m([0m[39mresult[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m2094[0m[39m:          return result;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2095[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2096[0m[39m:        [0m[35m/[0m[39m* format: [0m[32m"Tue, 15 Nov 1994 12:45:26"[0m[39m *[0m[35m/[0m                              [2m                [0m
[2;36m                    [0m         [1;36m2097[0m[39m:        headerbuflen =[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2098[0m[39m:          [0m[1;35mmsnprintf[0m[1;39m([0m[39mheaderbuf, [0m[1;35msizeof[0m[1;39m([0m[39mheaderbuf[0m[1;39m)[0m[39m,[0m                              [2m                [0m
[2;36m                    [0m         [1;36m2099[0m[39m:                    [0m[32m"Last-Modified: %s, %02d %s %4d %02d:%02d:%02d GMT\r\n"[0m[39m,[0m   [2m                [0m
[2;36m                    [0m         [1;36m2100[0m[39m:                    Curl_wkday[0m[1;39m[[0m[39mtm->tm_wday ? tm->tm_wday-[0m[1;36m1[0m[39m : [0m[1;36m6[0m[1;39m][0m[39m,[0m               [2m                [0m
[2;36m                    [0m         [1;36m2101[0m[39m:                    tm->tm_mday,[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2102[0m[39m:                    Curl_month[0m[1;39m[[0m[39mtm->tm_mon[0m[1;39m][0m[39m,[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m2103[0m[39m:                    tm->tm_year + [0m[1;36m1900[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2104[0m[39m:                    tm->tm_hour,[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2105[0m[39m:                    tm->tm_min,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2106[0m[39m:                    tm->tm_sec[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2107[0m[39m:        result = [0m[1;35mclient_write_header[0m[1;39m([0m[39mdata, headerbuf, headerbuflen[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m2108[0m[39m:        [0m[1;35mif[0m[1;39m([0m[39mresult[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m2109[0m[39m:          return result;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2110[0m[39m:      [0m[1;39m}[0m[39m [0m[35m/[0m[39m* end of a ridiculous amount of conditionals *[0m[35m/[0m                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/file.[0m[1;92mc:468[0m[39m-[0m[1;36m472[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m468[0m[39m:    static const char accept_ranges[0m[1;39m[[0m[1;39m][0m[39m= [0m[1;39m{[0m[39m [0m[32m"Accept-ranges: bytes\r\n"[0m[39m [0m[1;39m}[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m469[0m[39m:    static const char no_body[0m[1;39m[[0m[1;39m][0m[39m= [0m[1;39m{[0m[39m [0m[32m"File-body: suppressed.The body of "[0m         [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:      [0m[32m"this file has been supressed. If you would like to include "[0m             [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:      [0m[32m"the contents of this file use the -i option.\r\n"[0m[39m [0m[1;39m}[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m472[0m[39m:    static const char body_msg[0m[1;39m[[0m[1;39m][0m[39m= [0m[1;39m{[0m[39m [0m[32m"File-body: included.\r\n"[0m[1;39m}[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/file.[0m[1;92mc:493[0m[39m-[0m[1;36m497[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39mdata->req.no_body[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:      headerlen =[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:      [0m[1;35mmsnprintf[0m[1;39m([0m[39mheader, [0m[1;35msizeof[0m[1;39m([0m[39mno_body[0m[1;39m)[0m[39m, [0m[32m"%s [0m[32m([0m[32m%ld bytes[0m[32m)[0m[32m \r\n"[0m[39m,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:                  no_body, expected_size[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:      result = [0m[1;35mCurl_client_write[0m[1;39m([0m[39mdata, CLIENTWRITE_[0m[1;33mHEAD[0m[39mER, header, headerlen[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/file.[0m[1;92mc:466[0m[39m-[0m[1;36m467[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m466[0m[39m:    char header[0m[1;39m[[0m[1;36m80[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m467[0m[39m:    int headerlen;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/file.[0m[1;92mc:474[0m[39m-[0m[1;36m476[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m474[0m[39m:      headerlen =[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m475[0m[39m:        [0m[1;35mmsnprintf[0m[1;39m([0m[39mheader, [0m[1;35msizeof[0m[1;39m([0m[39mheader[0m[1;39m)[0m[39m, [0m[32m"Content-Length: %"[0m[39m FMT_OFF_T [0m[32m"\r\n"[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [1;36m476[0m[39m:                  expected_size[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/file.[0m[1;92mc:493[0m[39m-[0m[1;36m497[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39mdata->req.no_body[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:      headerlen =[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:      [0m[1;35mmsnprintf[0m[1;39m([0m[39mheader, [0m[1;35msizeof[0m[1;39m([0m[39mno_body[0m[1;39m)[0m[39m, [0m[32m"%s [0m[32m([0m[32m%ld bytes[0m[32m)[0m[32m \r\n"[0m[39m,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:                  no_body, expected_size[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:      result = [0m[1;35mCurl_client_write[0m[1;39m([0m[39mdata, CLIENTWRITE_[0m[1;33mHEAD[0m[39mER, header, headerlen[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/file.[0m[1;92mc:506[0m[39m-[0m[1;36m516[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:    headerlen =[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m507[0m[39m:      [0m[1;35mmsnprintf[0m[1;39m([0m[39mheader, [0m[1;35msizeof[0m[1;39m([0m[39mheader[0m[1;39m)[0m[39m,[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:                [0m[32m"Last-Modified: %s, %02d %s %4d %02d:%02d:%02d GMT\r\n"[0m[39m,[0m        [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:                Curl_wkday[0m[1;39m[[0m[39mtm->tm_wday ? tm->tm_wday-[0m[1;36m1[0m[39m : [0m[1;36m6[0m[1;39m][0m[39m,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:                tm->tm_mday,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:                Curl_month[0m[1;39m[[0m[39mtm->tm_mon[0m[1;39m][0m[39m,[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:                tm->tm_year + [0m[1;36m1900[0m[39m,[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:                tm->tm_hour,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:                tm->tm_min,[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:                tm->tm_sec[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:    result = [0m[1;35mCurl_client_write[0m[1;39m([0m[39mdata, CLIENTWRITE_[0m[1;33mHEAD[0m[39mER, header, headerlen[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter thoroughly examining the code snippets and evaluation report, I have [0m         [2m                [0m
[2;36m                    [0m         [39midentified the root cause of the stack-buffer-overflow vulnerability.[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Root Cause[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability is caused by a critical typo in `[0m[35m/src/curl/lib/[0m[95mfile.c[0m[39m` at line [0m   [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m. The second parameter to `msnprintf` incorrectly uses `[0m[1;35msizeof[0m[1;39m([0m[39mno_body[0m[1;39m)[0m[39m` [0m[1;39m([0m[1;36m147[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mbytes[0m[1;39m)[0m[39m instead of `[0m[1;35msizeof[0m[1;39m([0m[39mheader[0m[1;39m)[0m[39m` [0m[1;39m([0m[1;36m80[0m[39m bytes[0m[1;39m)[0m[39m:[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mchar header[0m[1;39m[[0m[1;36m80[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Only [0m[1;36m80[0m[39m bytes allocated[0m                                        [2m                [0m
[2;36m                    [0m         [39mstatic const char no_body[0m[1;39m[[0m[1;39m][0m[39m = [0m[1;39m{[0m[39m [0m[32m"File-body: suppressed..."[0m[39m [0m[1;39m}[0m[39m;  [0m[35m/[0m[35m/[0m[39m [0m[1;36m147[0m[39m bytes[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m BUG at line [0m[1;36m495[0m[39m:[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;35mmsnprintf[0m[1;39m([0m[39mheader, [0m[1;35msizeof[0m[1;39m([0m[39mno_body[0m[1;39m)[0m[39m, [0m[32m"%s [0m[32m([0m[32m%ld bytes[0m[32m)[0m[32m \r\n"[0m[39m, no_body, expected_size[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [39m                  ^^^^^^^^^^^^^^^[0m                                                   [2m                [0m
[2;36m                    [0m         [39m                  Should be [0m[1;35msizeof[0m[1;39m([0m[39mheader[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis tells the `msnprintf` function that it has [0m[1;36m147[0m[39m bytes available when the actual[0m [2m                [0m
[2;36m                    [0m         [39mbuffer is only [0m[1;36m80[0m[39m bytes. The bounds check in `addbyter` [0m[1;39m([0m[39mmprintf.[0m[1;92mc:1056[0m[1;39m)[0m[39m uses this [0m [2m                [0m
[2;36m                    [0m         [39mincorrect value, allowing writes beyond the [0m[1;36m80[0m[39m-byte boundary.[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Vulnerability Chain[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. `file_do` [0m[1;39m([0m[39mfile.[0m[1;92mc:495[0m[1;39m)[0m[39m calls `msnprintf` with wrong buffer size [0m[1;39m([0m[1;36m147[0m[39m instead of [0m [2m                [0m
[2;36m                    [0m         [1;36m80[0m[1;39m)[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. `curl_msnprintf` [0m[1;39m([0m[39mmprintf.[0m[1;92mc:1095[0m[1;39m)[0m[39m forwards to `curl_mvsnprintf`[0m                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. `curl_mvsnprintf` [0m[1;39m([0m[39mmprintf.[0m[1;92mc:1073[0m[1;39m)[0m[39m sets `info.max = [0m[1;36m147[0m[39m` [0m[1;39m([0m[39mwrong value[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. `formatf` [0m[1;39m([0m[39mmprintf.[0m[1;92mc:1075[0m[1;39m)[0m[39m processes format string[0m                               [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. `OUTCHAR` macro [0m[1;39m([0m[39mmprintf.[0m[1;92mc:909[0m[1;39m)[0m[39m calls `addbyter` for each character[0m              [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. `addbyter` [0m[1;39m([0m[39mmprintf.[0m[1;92mc:1056[0m[1;39m)[0m[39m checks `length < max` using wrong max [0m[1;39m([0m[1;36m147[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. Write at offset [0m[1;36m480[0m[39m overflows the header buffer [0m[1;39m([0m[39mallocated at offset [0m[1;36m400[0m[39m-[0m[1;36m480[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why Other Code is Correct[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mLines [0m[1;36m475[0m[39m and [0m[1;36m507[0m[39m in the same function correctly use `[0m[1;35msizeof[0m[1;39m([0m[39mheader[0m[1;39m)[0m[39m`:[0m              [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m475[0m[39m: `[0m[1;35mmsnprintf[0m[1;39m([0m[39mheader, [0m[1;35msizeof[0m[1;39m([0m[39mheader[0m[1;39m)[0m[39m, [0m[32m"Content-Length: %"[0m[39m FMT_OFF_T [0m       [2m                [0m
[2;36m                    [0m         [32m"\r\n"[0m[39m, [0m[33m...[0m[1;39m)[0m[39m`[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m507[0m[39m: `[0m[1;35mmsnprintf[0m[1;39m([0m[39mheader, [0m[1;35msizeof[0m[1;39m([0m[39mheader[0m[1;39m)[0m[39m, [0m[32m"Last-Modified: %s, %02d %s %4d [0m     [2m                [0m
[2;36m                    [0m         [32m%02d:%02d:%02d GMT\r\n"[0m[39m, [0m[33m...[0m[1;39m)[0m[39m`[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Primary Fix: Correct the Buffer Size Parameter[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**File:** `[0m[35m/src/curl/lib/[0m[95mfile.c[0m[39m`  [0m                                                  [2m                [0m
[2;36m                    [0m         [39m**Line:** [0m[1;36m495[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Change from:**[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;35mmsnprintf[0m[1;39m([0m[39mheader, [0m[1;35msizeof[0m[1;39m([0m[39mno_body[0m[1;39m)[0m[39m, [0m[32m"%s [0m[32m([0m[32m%ld bytes[0m[32m)[0m[32m \r\n"[0m[39m,[0m                           [2m                [0m
[2;36m                    [0m         [39m          no_body, expected_size[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Change to:**[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;35mmsnprintf[0m[1;39m([0m[39mheader, [0m[1;35msizeof[0m[1;39m([0m[39mheader[0m[1;39m)[0m[39m, [0m[32m"%s [0m[32m([0m[32m%ld bytes[0m[32m)[0m[32m \r\n"[0m[39m,[0m                            [2m                [0m
[2;36m                    [0m         [39m          no_body, expected_size[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis single-character fix changes the second parameter from `[0m[1;35msizeof[0m[1;39m([0m[39mno_body[0m[1;39m)[0m[39m` to [0m   [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35msizeof[0m[1;39m([0m[39mheader[0m[1;39m)[0m[39m`, ensuring that `msnprintf` receives the correct buffer size [0m[1;39m([0m[1;36m80[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mbytes[0m[1;39m)[0m[39m.[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How This Fix Works[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Correct Bounds Checking**: When `[0m[1;35msizeof[0m[1;39m([0m[39mheader[0m[1;39m)[0m[39m` is passed, the `info.max` [0m    [2m                [0m
[2;36m                    [0m         [39mfield in `curl_mvsnprintf` will be set to [0m[1;36m80[0m[39m [0m[1;39m([0m[39mthe actual buffer size[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Safe Truncation**: If the formatted output exceeds [0m[1;36m80[0m[39m bytes, `msnprintf` will [0m [2m                [0m
[2;36m                    [0m         [39msafely truncate the output at [0m[1;36m79[0m[39m bytes and add a null terminator[0m                    [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **No Buffer Overflow**: The `addbyter` function will check against the correct [0m  [2m                [0m
[2;36m                    [0m         [39mlimit [0m[1;39m([0m[1;36m80[0m[1;39m)[0m[39m, preventing writes beyond the buffer boundary[0m                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Preserved Functionality**: The header will still be written, just truncated if[0m [2m                [0m
[2;36m                    [0m         [39mtoo long, which is acceptable behavior for HTTP headers[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This is Optimal[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Minimal Change**: Only one word needs to be changed, reducing risk of [0m         [2m                [0m
[2;36m                    [0m         [39mintroducing new bugs[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Follows Existing Pattern**: Lines [0m[1;36m475[0m[39m and [0m[1;36m507[0m[39m already use this correct pattern[0m [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Consistent with msnprintf Design**: The function is designed to receive the [0m   [2m                [0m
[2;36m                    [0m         [39mactual buffer size and handle truncation safely[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **No Functional Regression**: The code will continue to work as intended, with [0m  [2m                [0m
[2;36m                    [0m         [39mthe added benefit of not overflowing[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Preserves All Logic**: No changes to control flow, conditions, or other [0m       [2m                [0m
[2;36m                    [0m         [39mfunctionality[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Compatible with Fuzzing**: The fix supports the same fuzzing logic and API [0m    [2m                [0m
[2;36m                    [0m         [39musage[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Expected Behavior After Fix[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- When processing `[0m[35m/proc/self/[0m[95mstatus[0m[39m` or other large files with `data->req.no_body`[0m [2m                [0m
[2;36m                    [0m         [39mset[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m- The formatted message will be truncated to fit within [0m[1;36m80[0m[39m bytes[0m                    [2m                [0m
[2;36m                    [0m         [39m- No stack-buffer-overflow will occur[0m                                               [2m                [0m
[2;36m                    [0m         [39m- The header will be written safely [0m[1;39m([0m[39mthough potentially truncated[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [39m- All existing tests will continue to pass[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Side Effects and Mitigation[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential Side Effect**: The no_body message [0m[1;39m([0m[1;36m147[0m[39m bytes[0m[1;39m)[0m[39m plus formatting will be [0m [2m                [0m
[2;36m                    [0m         [39mtruncated when written to the [0m[1;36m80[0m[39m-byte header buffer.[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Mitigation**: This is acceptable because:[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. HTTP headers don't require the full message to be functional[0m                     [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. The truncation is safe and controlled by msnprintf[0m                               [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. The alternative [0m[1;39m([0m[39mbuffer overflow[0m[1;39m)[0m[39m is a critical security vulnerability[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. This matches the behavior of other header formatting in the same function[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**No Breaking Changes**: The fix does not:[0m                                          [2m                [0m
[2;36m                    [0m         [39m- Modify any function signatures[0m                                                    [2m                [0m
[2;36m                    [0m         [39m- Change control flow or conditionals[0m                                               [2m                [0m
[2;36m                    [0m         [39m- Remove functionality[0m                                                              [2m                [0m
[2;36m                    [0m         [39m- Affect utility functions[0m                                                          [2m                [0m
[2;36m                    [0m         [39m- Break existing tests[0m                                                              [2m                [0m
[2;36m                    [0m         [39m- Modify fuzzing harness or logic[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Justification[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis fix addresses the exact issue identified in the evaluation report:[0m             [2m                [0m
[2;36m                    [0m         [39m- Fixes the stack-buffer-overflow at mprintf.[0m[1;92mc:1058[0m                                 [2m                [0m
[2;36m                    [0m         [39m- Corrects the wrong buffer size passed at file.[0m[1;92mc:495[0m                               [2m                [0m
[2;36m                    [0m         [39m- Prevents writes beyond the [0m[1;36m80[0m[39m-byte header buffer[0m                                  [2m                [0m
[2;36m                    [0m         [39m- Maintains the existing code structure and logic[0m                                   [2m                [0m
[2;36m                    [0m         [39m- Follows the pattern already established in the same function[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix is a simple typo correction that aligns with the developer's obvious [0m       [2m                [0m
[2;36m                    [0m         [39mintent, as evidenced by the correct usage patterns in the surrounding code.[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=368175;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=105840;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=215620;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=296411;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpgmss1xuf[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/curl_cu-full-01_curl-004/[0m[95magen[0m [2m               [0m
[2;36m                    [0m         [95mt-output-1768015929.490766[0m                                                           [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/curl_cu-full-01_curl-[1;36m004.[0mtoml                       [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-curl[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/10/26 03:32:11][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mcurl[0m           ]8;id=720609;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=296965;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=958170;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=659794;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mcurl[0m                  [2m               [0m
[2;36m[01/10/26 03:32:12][0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=837457;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=978512;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m                   [2m               [0m
