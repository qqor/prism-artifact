[2;36m[01/10/26 09:13:01][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=685352;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=704038;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpxxd57efy[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/pdfbox_pdfbox-full-01_vuln_5/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1768036381.8365996[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/pdfbox_pdfbox-full-01_vuln_5.toml                   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-pdfbox[0m           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Building Cached for CLEAN environment[1m)[0m Started[33m...[0m ]8;id=166278;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=751694;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 09:14:14][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Building Cached for CLEAN environment[1m)[0m Took      ]8;id=21893;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=147179;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m72.27[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running tests for Cached for CLEAN environment[1m)[0m   ]8;id=607810;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=30138;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=789086;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=478915;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=468987;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=706025;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m72[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=959914;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=182711;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.86[0m seconds;                ]8;id=955762;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=93781;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 09:14:16][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=53741;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=108260;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=506994;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=526225;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=642376;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=843760;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=459254;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=92187;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 09:14:17][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m1.02[0m seconds;                ]8;id=665013;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=85784;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=864876;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=865968;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 09:14:18][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.94[0m seconds;                ]8;id=503144;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=809816;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 09:14:24][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=899637;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=69996;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of  [2m                [0m
[2;36m                    [0m         memory [1m([0muse [32m'-Xmx1710m'[0m to reproduce[1m)[0m                                               [2m                [0m
[2;36m                    [0m         Caused by: java.lang.OutOfMemoryError: Requested array size exceeds VM limit        [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.fontbox.type1.Type1Lexer.readCharString[0m[1m([0mType1Lexer.jav[1;92ma:507[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.fontbox.type1.Type1Lexer.readToken[0m[1m([0mType1Lexer.jav[1;92ma:232[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.fontbox.type1.Type1Lexer.nextToken[0m[1m([0mType1Lexer.jav[1;92ma:75[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.fontbox.type1.Type1Parser.read[0m[1m([0mType1Parser.jav[1;92ma:877[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.fontbox.type1.Type1Parser.parseASCII[0m[1m([0mType1Parser.jav[1;92ma:109[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.fontbox.type1.Type1Parser.parse[0m[1m([0mType1Parser.jav[1;92ma:63[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.fontbox.type1.Type1Font.createWithPFB[0m[1m([0mType1Font.jav[1;92ma:71[0m[1m)[0m      [2m                [0m
[2;36m                    [0m                 at org.apache.pdfbox.pdmodel.font.PDType1Font.[1m<[0m[1;95minit[0m[39m>[0m[1;39m([0m[39mPDType1Font.jav[0m[1;92ma:227[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.pdmodel.font.PDFontFactory.createFont[0m[1;39m([0m[39mPDFontFactory.jav[0m[1;92ma:140[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.pdmodel.PDResources.getFont[0m[1;39m([0m[39mPDResources.jav[0m[1;92ma:170[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process[0m[1;39m([0m[39mSetFontAndSize[0m [2m                [0m
[2;36m                    [0m         [39m.jav[0m[1;92ma:72[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processOperator[0m[1;39m([0m[39mPDFStreamEngine.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:924[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators[0m[1;39m([0m[39mPDFStreamEng[0m [2m                [0m
[2;36m                    [0m         [39mine.jav[0m[1;92ma:557[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStream[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m515[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processPage[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:15[0m [2m                [0m
[2;36m                    [0m         [1;92m8[0m[1;39m)[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.LegacyPDFStreamEngine.processPage[0m[1;39m([0m[39mLegacyPDFStreamEngine.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:153[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPage[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:378[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPages[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:303[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.writeText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:251[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.text.PDFTextStripper.getText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:218[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.PDFExtractTextFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPDFExtractTextFuzzer.jav[0m[1;92ma:41[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$DMH/[0m[1;35m0x0000000800cbc000.invokeStaticInit[0m[1;39m([0m[39mLambd[0m [2m                [0m
[2;36m                    [0m         [39maForm$DMH[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cbd000.invoke[0m[1;39m([0m[39mLambdaForm$MH[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cbc800.invoke_MT[0m[1;39m([0m[39mLambdaForm$MH[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 0d88e419df5aef8d[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of [0m [2m                [0m
[2;36m                    [0m         [39mmemory [0m[1;39m([0m[39muse [0m[32m'-Xmx1710m'[0m[39m to reproduce[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [39mCaused by: java.lang.OutOfMemoryError: Requested array size exceeds VM limit[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Lexer.readCharString[0m[1;39m([0m[39mType1Lexer.jav[0m[1;92ma:507[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Lexer.readToken[0m[1;39m([0m[39mType1Lexer.jav[0m[1;92ma:232[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Lexer.nextToken[0m[1;39m([0m[39mType1Lexer.jav[0m[1;92ma:75[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Parser.read[0m[1;39m([0m[39mType1Parser.jav[0m[1;92ma:877[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Parser.parseASCII[0m[1;39m([0m[39mType1Parser.jav[0m[1;92ma:109[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Parser.parse[0m[1;39m([0m[39mType1Parser.jav[0m[1;92ma:63[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Font.createWithPFB[0m[1;39m([0m[39mType1Font.jav[0m[1;92ma:71[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.pdfbox.pdmodel.font.PDType1Font.<init[0m[1m>[0m[1m([0mPDType1Font.jav[1;92ma:227[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.pdmodel.font.PDFontFactory.createFont[0m[1m([0mPDFontFactory.jav[1;92ma:140[0m[1m)[0m     [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.pdfbox.pdmodel.PDResources.getFont[0m[1m([0mPDResources.jav[1;92ma:170[0m[1m)[0m      [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process[0m[1m([0mSetFontAndSize [2m                [0m
[2;36m                    [0m         .jav[1;92ma:72[0m[1m)[0m                                                                           [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processOperator[0m[1m([0mPDFStreamEngine.jav [2m                [0m
[2;36m                    [0m         [1;92ma:924[0m[1m)[0m                                                                              [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators[0m[1m([0mPDFStreamEng [2m                [0m
[2;36m                    [0m         ine.jav[1;92ma:557[0m[1m)[0m                                                                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStream[0m[1m([0mPDFStreamEngine.jav[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m515[0m[1m)[0m                                                                                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processPage[0m[1m([0mPDFStreamEngine.jav[1;92ma:15[0m [2m                [0m
[2;36m                    [0m         [1;92m8[0m[1m)[0m                                                                                  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.LegacyPDFStreamEngine.processPage[0m[1m([0mLegacyPDFStreamEngine.jav[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:153[0m[1m)[0m                                                                               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPage[0m[1m([0mPDFTextStripper.jav[1;92ma:378[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPages[0m[1m([0mPDFTextStripper.jav[1;92ma:303[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.writeText[0m[1m([0mPDFTextStripper.jav[1;92ma:251[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.pdfbox.text.PDFTextStripper.getText[0m[1m([0mPDFTextStripper.jav[1;92ma:218[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.PDFExtractTextFuzzer.fuzzerTestOneInput[0m[1m([0mPDFExtractTextFuzzer.jav[1;92ma:41[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/java.lang.invoke.LambdaForm$DMH/[1;35m0x0000000800cbc000.invokeStaticInit[0m[1m([0mLambd [2m                [0m
[2;36m                    [0m         aForm$DMH[1m)[0m                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/java.lang.invoke.LambdaForm$MH/[1;35m0x0000000800cbd000.invoke[0m[1m([0mLambdaForm$MH[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/java.lang.invoke.LambdaForm$MH/[1;35m0x0000000800cbc800.invoke_MT[0m[1m([0mLambdaForm$MH [2m                [0m
[2;36m                    [0m         [1m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: 0d88e419df5aef8d                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/10/26 09:14:45][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=584228;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=625560;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 09:18:32][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=969452;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=465489;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 09:19:14][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=611871;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=572472;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=810003;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=441979;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 09:19:15][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.99[0m seconds;                ]8;id=909145;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=561351;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Patching[1m)[0m Started[33m...[0m                              ]8;id=962390;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=858293;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpmo57cfx7[0m                                                 ]8;id=416271;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=331309;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/10/26 09:20:09][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Patching[1m)[0m Took [1;36m53.58[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=30509;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=207403;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Checking build[1m)[0m Started[33m...[0m                        ]8;id=232634;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=229285;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 09:20:24][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Checking build[1m)[0m Took [1;36m14.82[0m seconds;              ]8;id=746284;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=477773;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running PoV[1m)[0m Started[33m...[0m                           ]8;id=793499;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=645586;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 09:20:30][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running PoV[1m)[0m Took [1;36m6.12[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=128258;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=87696;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Testing[1m)[0m Started[33m...[0m                               ]8;id=734277;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=969178;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=926644;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=403969;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=535025;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=238504;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 09:20:31][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.88[0m seconds;                ]8;id=549765;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=876780;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 09:20:32][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=764577;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=222015;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 09:20:33][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.97[0m seconds;                ]8;id=190748;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=538053;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=332919;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=556540;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 09:20:34][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.90[0m seconds;                ]8;id=539846;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=64450;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=54115;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=21650;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java                [2m                [0m
[2;36m                    [0m         +++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java                [2m                [0m
[2;36m                    [0m         @@ [1;36m-48[0m,[1;36m6[0m +[1;36m48[0m,[1;36m13[0m @@                                                                  [2m                [0m
[2;36m                    [0m               * Log instance.                                                               [2m                [0m
[2;36m                    [0m               *[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m              private static final Logger LOG = [1;35mLogManager.getLogger[0m[1m([0mType1Lexer.class[1m)[0m;      [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +    [35m/[0m**                                                                            [2m                [0m
[2;36m                    [0m         +     * Maximum allowed size for a CharString in bytes.                             [2m                [0m
[2;36m                    [0m         +     * This limit prevents OutOfMemoryError from malformed fonts while being       [2m                [0m
[2;36m                    [0m         +     * generous enough for legitimate fonts [1m([0mtypical CharStrings are under [1;36m1[0m KB[1m)[0m.  [2m                [0m
[2;36m                    [0m         +     *[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         +    private static final int MAX_CHARSTRING_LENGTH = 10_000_000; [35m/[0m[35m/[0m [1;36m10[0m MB          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m              private final ByteBuffer buffer;                                               [2m                [0m
[2;36m                    [0m              private Token aheadToken;                                                      [2m                [0m
[2;36m                    [0m         @@ [1;36m-503[0m,[1;36m6[0m +[1;36m510[0m,[1;36m27[0m @@                                                                [2m                [0m
[2;36m                    [0m              [1m{[0m                                                                              [2m                [0m
[2;36m                    [0m                  try                                                                        [2m                [0m
[2;36m                    [0m                  [1m{[0m                                                                          [2m                [0m
[2;36m                    [0m         +            [35m/[0m[35m/[0m Validate length before allocation to prevent OutOfMemoryError       [2m                [0m
[2;36m                    [0m         +            if [1m([0mlength [1m<[0m[39m [0m[1;36m0[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"CharString length is negative: "[0m[39m + length +[0m [2m                [0m
[2;36m                    [0m         [39m+                                    [0m[32m" at position "[0m[39m + [0m[1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+            [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[39mlength > MAX_CHARSTRING_LENGTH[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"CharString length "[0m[39m + length + [0m             [2m                [0m
[2;36m                    [0m         [39m+                                    [0m[32m" exceeds maximum allowed size of "[0m[39m + [0m         [2m                [0m
[2;36m                    [0m         [39mMAX_CHARSTRING_LENGTH + [0m                                                            [2m                [0m
[2;36m                    [0m         [39m+                                    [0m[32m" at position "[0m[39m + [0m[1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+            [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+            [0m[35m/[0m[35m/[0m[39m Check if buffer has enough remaining data [0m[1;39m([0m[39m+[0m[1;36m1[0m[39m for the space [0m        [2m                [0m
[2;36m                    [0m         [39mcharacter[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[1;35mbuffer.remaining[0m[1;39m([0m[1;39m)[0m[39m < length + [0m[1;36m1[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"CharString length "[0m[39m + length + [0m             [2m                [0m
[2;36m                    [0m         [39m+                                    [0m[32m" exceeds available buffer data at position "[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39m+ [0m[1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+            [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mbuffer.get[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m space[0m                                                 [2m                [0m
[2;36m                    [0m         [39m             byte[0m[1;39m[[0m[1;39m][0m[39m data = new byte[0m[1;39m[[0m[39mlength[0m[1;39m][0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mbuffer.get[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of [0m [2m                [0m
[2;36m                    [0m         [39mmemory [0m[1;39m([0m[39muse [0m[32m'-Xmx1710m'[0m[39m to reproduce[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [39mCaused by: java.lang.OutOfMemoryError: Requested array size exceeds VM limit[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Lexer.readCharString[0m[1;39m([0m[39mType1Lexer.jav[0m[1;92ma:507[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Lexer.readToken[0m[1;39m([0m[39mType1Lexer.jav[0m[1;92ma:232[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Lexer.nextToken[0m[1;39m([0m[39mType1Lexer.jav[0m[1;92ma:75[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Parser.read[0m[1;39m([0m[39mType1Parser.jav[0m[1;92ma:877[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Parser.parseASCII[0m[1;39m([0m[39mType1Parser.jav[0m[1;92ma:109[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Parser.parse[0m[1;39m([0m[39mType1Parser.jav[0m[1;92ma:63[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Font.createWithPFB[0m[1;39m([0m[39mType1Font.jav[0m[1;92ma:71[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.pdfbox.pdmodel.font.PDType1Font.<init>[0m[1;39m([0m[39mPDType1Font.jav[0m[1;92ma:227[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.pdmodel.font.PDFontFactory.createFont[0m[1;39m([0m[39mPDFontFactory.jav[0m[1;92ma:140[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.pdmodel.PDResources.getFont[0m[1;39m([0m[39mPDResources.jav[0m[1;92ma:170[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process[0m[1;39m([0m[39mSetFontAndSize[0m [2m                [0m
[2;36m                    [0m         [39m.jav[0m[1;92ma:72[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processOperator[0m[1;39m([0m[39mPDFStreamEngine.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:924[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators[0m[1;39m([0m[39mPDFStreamEng[0m [2m                [0m
[2;36m                    [0m         [39mine.jav[0m[1;92ma:557[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStream[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m515[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processPage[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:15[0m [2m                [0m
[2;36m                    [0m         [1;92m8[0m[1;39m)[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.LegacyPDFStreamEngine.processPage[0m[1;39m([0m[39mLegacyPDFStreamEngine.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:153[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPage[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:378[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPages[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:303[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.writeText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:251[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.text.PDFTextStripper.getText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:218[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.PDFExtractTextFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPDFExtractTextFuzzer.jav[0m[1;92ma:41[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$DMH/[0m[1;35m0x0000000800cbc000.invokeStaticInit[0m[1;39m([0m[39mLambd[0m [2m                [0m
[2;36m                    [0m         [39maForm$DMH[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cbd000.invoke[0m[1;39m([0m[39mLambdaForm$MH[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cbc800.invoke_MT[0m[1;39m([0m[39mLambdaForm$MH[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 0d88e419df5aef8d[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAn Out of Memory [0m[1;39m([0m[39mOOM[0m[1;39m)[0m[39m error occurs in the Apache PDFBox library when processing a [0m [2m                [0m
[2;36m                    [0m         [39mmalformed PDF file during fuzzing. The error originates from the Type1 font parsing[0m [2m                [0m
[2;36m                    [0m         [39mlogic, specifically in the `[0m[1;35mType1Lexer.readCharString[0m[1;39m([0m[1;39m)[0m[39m` method, which attempts to [0m [2m                [0m
[2;36m                    [0m         [39mallocate an array that exceeds the Java Virtual Machine's size limits. This [0m        [2m                [0m
[2;36m                    [0m         [39mvulnerability is classified as a security issue of low severity by the Jazzer [0m      [2m                [0m
[2;36m                    [0m         [39mfuzzing framework.[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Issue Overview[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mThe fuzzing process has identified a memory exhaustion vulnerability in the Apache [0m [2m                [0m
[2;36m                    [0m         [39mPDFBox library's Type1 font parsing functionality. The exception [0m                   [2m                [0m
[2;36m                    [0m         [39m`java.lang.OutOfMemoryError: Requested array size exceeds VM limit` indicates that [0m [2m                [0m
[2;36m                    [0m         [39mthe code attempts to allocate an array whose size exceeds the maximum allowable [0m    [2m                [0m
[2;36m                    [0m         [39marray size in the JVM, which is a fundamental limit typically around [0m               [2m                [0m
[2;36m                    [0m         [39mInteger.MAX_VALUE - some header bytes.[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Vulnerability Type[0m                                                              [2m                [0m
[2;36m                    [0m         [39mThis is categorized as a Denial of Service [0m[1;39m([0m[39mDoS[0m[1;39m)[0m[39m vulnerability through resource [0m    [2m                [0m
[2;36m                    [0m         [39mexhaustion. While classified as a [0m[32m"Low"[0m[39m severity security issue by the fuzzer, it [0m  [2m                [0m
[2;36m                    [0m         [39mcould allow an attacker to cause application crashes or system instability by [0m      [2m                [0m
[2;36m                    [0m         [39mproviding specially crafted PDF files containing malicious Type1 font data.[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Important Observations[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Call Chain Analysis**: The error propagates through the following sequence:[0m    [2m                [0m
[2;36m                    [0m         [39m   - The fuzzer entry point `[0m[1;35mPDFExtractTextFuzzer.fuzzerTestOneInput[0m[1;39m([0m[1;39m)[0m[39m` processes a[0m [2m                [0m
[2;36m                    [0m         [39mPDF file[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   - Text extraction via `[0m[1;35mPDFTextStripper.getText[0m[1;39m([0m[1;39m)[0m[39m` is initiated[0m                   [2m                [0m
[2;36m                    [0m         [39m   - Font processing is triggered through `[0m[1;35mPDFontFactory.createFont[0m[1;39m([0m[1;39m)[0m[39m` when [0m        [2m                [0m
[2;36m                    [0m         [39mencountering a Type1 font[0m                                                           [2m                [0m
[2;36m                    [0m         [39m   - The Type1 font parser [0m[1;39m([0m[39m`[0m[1;35mType1Parser.parse[0m[1;39m([0m[1;39m)[0m[39m`[0m[1;39m)[0m[39m reads and processes font data[0m    [2m                [0m
[2;36m                    [0m         [39m   - The error occurs in `[0m[1;35mType1Lexer.readCharString[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m507[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Root Location**: The primary issue is in the [0m                                  [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35morg.apache.fontbox.type1.Type1Lexer.readCharString[0m[1;39m([0m[1;39m)[0m[39m` method, which appears to [0m    [2m                [0m
[2;36m                    [0m         [39mread a size value from the input stream without proper validation before attempting[0m [2m                [0m
[2;36m                    [0m         [39mto allocate an array of that size.[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Attack Vector**: The vulnerability can be triggered through PDF files [0m         [2m                [0m
[2;36m                    [0m         [39mcontaining embedded or referenced Type1 fonts with malformed data. The fuzzer [0m      [2m                [0m
[2;36m                    [0m         [39msuccessfully reproduced this condition, indicating that the issue is reliably [0m      [2m                [0m
[2;36m                    [0m         [39mtriggerable with specific input patterns.[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Memory Configuration**: The error message suggests using `-Xmx1710m` to [0m       [2m                [0m
[2;36m                    [0m         [39mreproduce, indicating the issue manifests with heap sizes around [0m[1;36m1.[0m[39m7GB, though the [0m [2m                [0m
[2;36m                    [0m         [39mactual problem is the array size limit rather than heap exhaustion.[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas for Investigation[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo gain a comprehensive understanding of this issue, the following components [0m      [2m                [0m
[2;36m                    [0m         [39mshould be examined:[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **[0m[1;35mType1Lexer.readCharString[0m[1;39m([0m[1;39m)[0m[39m** [0m[1;39m([0m[39morg.apache.fontbox.type1.Type1Lexer:[0m[1;36m507[0m[1;39m)[0m[39m: The [0m  [2m                [0m
[2;36m                    [0m         [39mimmediate source of the array allocation that exceeds VM limits. Investigation [0m     [2m                [0m
[2;36m                    [0m         [39mshould focus on:[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m   - How the array size is determined from input data[0m                               [2m                [0m
[2;36m                    [0m         [39m   - Whether size validation exists before allocation[0m                               [2m                [0m
[2;36m                    [0m         [39m   - The expected vs. actual size values being processed[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **[0m[1;35mType1Lexer.readToken[0m[1;39m([0m[1;39m)[0m[39m** [0m[1;39m([0m[39morg.apache.fontbox.type1.Type1Lexer:[0m[1;36m232[0m[1;39m)[0m[39m: The caller[0m [2m                [0m
[2;36m                    [0m         [39mof [0m[1;35mreadCharString[0m[1;39m([0m[1;39m)[0m[39m, which may influence how data is passed to the problematic [0m     [2m                [0m
[2;36m                    [0m         [39mmethod.[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **[0m[1;35mType1Parser.parse[0m[1;39m([0m[1;39m)[0m[39m and [0m[1;35mType1Parser.parseASCII[0m[1;39m([0m[1;39m)[0m[39m**: The parsing infrastructure[0m [2m                [0m
[2;36m                    [0m         [39mthat processes Type1 font files and delegates to the lexer. Understanding the data [0m [2m                [0m
[2;36m                    [0m         [39mflow through these methods is essential.[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Input Validation Layer**: Review whether there are [0m[1;39m([0m[39mor should be[0m[1;39m)[0m[39m safeguards [0m  [2m                [0m
[2;36m                    [0m         [39mat higher levels [0m[1;39m([0m[39mPDFontFactory, PDType1Font constructor[0m[1;39m)[0m[39m that validate font data [0m  [2m                [0m
[2;36m                    [0m         [39mbefore passing it to the parser.[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **[0m[1;35mType1Font.createWithPFB[0m[1;39m([0m[1;39m)[0m[39m**: The factory method that initiates Type1 font [0m     [2m                [0m
[2;36m                    [0m         [39mcreation and may be an appropriate location for additional validation.[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **FontBox Type1 Specification Compliance**: Review the expected format and size [0m [2m                [0m
[2;36m                    [0m         [39mconstraints defined in the Type1 font specification to understand legitimate bounds[0m [2m                [0m
[2;36m                    [0m         [39mfor array allocations.[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of [0m [2m                [0m
[2;36m                    [0m         [39mmemory [0m[1;39m([0m[39muse [0m[32m'-Xmx1710m'[0m[39m to reproduce[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [39mCaused by: java.lang.OutOfMemoryError: Requested array size exceeds VM limit[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Lexer.readCharString[0m[1;39m([0m[39mType1Lexer.jav[0m[1;92ma:507[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Lexer.readToken[0m[1;39m([0m[39mType1Lexer.jav[0m[1;92ma:232[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Lexer.nextToken[0m[1;39m([0m[39mType1Lexer.jav[0m[1;92ma:75[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Parser.read[0m[1;39m([0m[39mType1Parser.jav[0m[1;92ma:877[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Parser.parseASCII[0m[1;39m([0m[39mType1Parser.jav[0m[1;92ma:109[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Parser.parse[0m[1;39m([0m[39mType1Parser.jav[0m[1;92ma:63[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Font.createWithPFB[0m[1;39m([0m[39mType1Font.jav[0m[1;92ma:71[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.pdfbox.pdmodel.font.PDType1Font.<init>[0m[1;39m([0m[39mPDType1Font.jav[0m[1;92ma:227[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.pdmodel.font.PDFontFactory.createFont[0m[1;39m([0m[39mPDFontFactory.jav[0m[1;92ma:140[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.pdmodel.PDResources.getFont[0m[1;39m([0m[39mPDResources.jav[0m[1;92ma:170[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process[0m[1;39m([0m[39mSetFontAndSize[0m [2m                [0m
[2;36m                    [0m         [39m.jav[0m[1;92ma:72[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processOperator[0m[1;39m([0m[39mPDFStreamEngine.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:924[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators[0m[1;39m([0m[39mPDFStreamEng[0m [2m                [0m
[2;36m                    [0m         [39mine.jav[0m[1;92ma:557[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStream[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m515[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processPage[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:15[0m [2m                [0m
[2;36m                    [0m         [1;92m8[0m[1;39m)[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.LegacyPDFStreamEngine.processPage[0m[1;39m([0m[39mLegacyPDFStreamEngine.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:153[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPage[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:378[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPages[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:303[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.writeText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:251[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.text.PDFTextStripper.getText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:218[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.PDFExtractTextFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPDFExtractTextFuzzer.jav[0m[1;92ma:41[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$DMH/[0m[1;35m0x0000000800cbc000.invokeStaticInit[0m[1;39m([0m[39mLambd[0m [2m                [0m
[2;36m                    [0m         [39maForm$DMH[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cbd000.invoke[0m[1;39m([0m[39mLambdaForm$MH[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cbc800.invoke_MT[0m[1;39m([0m[39mLambdaForm$MH[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 0d88e419df5aef8d[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:1[0m[39m-[0m[1;36m50[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one[0m                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * or more contributor license agreements.  See the NOTICE file[0m                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * distributed with this work for additional information[0m                          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * regarding copyright ownership.  The ASF licenses this file[0m                     [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * to you under the Apache License, Version [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mthe[0m                              [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance[0m                     [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * with the License.  You may obtain a copy of the License at[0m                     [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: * [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * Unless required by applicable law or agreed to in writing,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * software distributed under the License is distributed on an[0m                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * [0m[32m"AS IS"[0m[39m BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY[0m                        [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * KIND, either express or implied.  See the License for the[0m                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * specific language governing permissions and limitations[0m                       [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * under the License.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:package org.apache.fontbox.type1;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.BufferUnderflowException;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.ByteBuffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.logging.log4j.LogManager;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m: * Lexer for the ASCII portions of an Adobe Type [0m[1;36m1[0m[39m font.[0m                         [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m: * @see Type1Parser[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m: * The PostScript language, of which Type [0m[1;36m1[0m[39m fonts are a subset, has a[0m            [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m: * somewhat awkward lexical structure. It is neither regular nor[0m                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m: * context-free, and the execution of the program can modify the[0m                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m: * the behaviour of the lexer/parser.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m: * Nevertheless, this class represents an attempt to artificially separate[0m       [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m: * the PostScript parsing process into separate lexing and parsing phases[0m        [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m: * in order to reduce the complexity of the parsing phase.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m: * @see [0m[32m"PostScript Language Reference 3rd ed, Adobe Systems [0m[32m([0m[32m1999[0m[32m)[0m[32m"[0m             [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m: * @author John Hewson[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;92m45:c[0m[39mlass Type1Lexer[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * Log instance.[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    private static final Logger LOG = [0m[1;35mLogManager.getLogger[0m[1;39m([0m[39mType1Lexer.class[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:495[0m[39m-[0m[1;36m516[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:        return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:     * Reads a binary CharString.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:    private Token [0m[1;35mreadCharString[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m throws IOException[0m                 [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:        try[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:            [0m[1;35mbuffer.get[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m space[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m507[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m data = new byte[0m[1;39m[[0m[39mlength[0m[1;39m][0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:            [0m[1;35mbuffer.get[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:            return new [0m[1;35mToken[0m[1;39m([0m[39mdata, Token.CHARSTRING[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:        catch [0m[1;39m([0m[39mBufferUnderflowException exception[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Premature end of buffer reached"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:220[0m[39m-[0m[1;36m240[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                        if [0m[1;39m([0m[39mname == null[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                            [0m[35m/[0m[35m/[0m[39m the stream is corrupt[0m                            [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:                            throw new [0m[1;35mDamagedFontException[0m[1;39m([0m[32m"Could not read [0m     [2m                [0m
[2;36m                    [0m         [32mtoken at position "[0m[39m +[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:                                                           [0m[1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                        if [0m[1;39m([0m[1;35mname.equals[0m[1;39m([0m[32m"RD"[0m[1;39m)[0m[39m || [0m[1;35mname.equals[0m[1;39m([0m[32m"-|"[0m[1;39m)[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                            [0m[35m/[0m[35m/[0m[39m return the next CharString instead[0m               [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                            if [0m[1;39m([0m[39mprevToken != null && [0m[1;35mprevToken.getKind[0m[1;39m([0m[1;39m)[0m[39m == [0m    [2m                [0m
[2;36m                    [0m         [39mToken.INTEGER[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                            [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                                return [0m[1;35mreadCharString[0m[1;39m([0m[1;35mprevToken.intValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:                            else[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:                            [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:                                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"expected INTEGER before [0m [2m                [0m
[2;36m                    [0m         [32m-| or RD"[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:                        else[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:1[0m[39m-[0m[1;36m70[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.fontbox.type1;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import org.apache.fontbox.encoding.BuiltInEncoding;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import org.apache.fontbox.encoding.StandardEncoding;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m: * Parses an Adobe Type [0m[1;36m1[0m[39m [0m[1;39m([0m[39m.pfb[0m[1;39m)[0m[39m font. It is used exclusively by Type1Font.[0m      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m: * The Type [0m[1;36m1[0m[39m font format is a free-text format which is somewhat difficult[0m      [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m: * to parse. This is made worse by the fact that many Type [0m[1;36m1[0m[39m font files do[0m       [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m: * not conform to the specification, especially those embedded in PDFs. This[0m     [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m: * parser therefore tries to be as forgiving as possible.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m: * @see [0m[32m"Adobe Type 1 Font Format, Adobe Systems [0m[32m([0m[32m1999[0m[32m)[0m[32m"[0m                         [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m: * @author John Hewson[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;92m41:f[0m[39minal class Type1Parser[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[35m/[0m[35m/[0m[39m constants for encryption[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    private static final int EEXEC_KEY = [0m[1;36m55665[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    private static final int CHARSTRING_KEY = [0m[1;36m4330[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    [0m[35m/[0m[35m/[0m[39m state[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    private Type1Lexer lexer;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    private Type1Font font;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     * Parses a Type [0m[1;36m1[0m[39m font and returns a Type1Font class which represents it.[0m   [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * @param segment1 Segment [0m[1;36m1[0m[39m: ASCII[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     * @param segment2 Segment [0m[1;36m2[0m[39m: Binary[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     * @throws IOException[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    public Type1Font [0m[1;35mparse[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m segment1, byte[0m[1;39m[[0m[1;39m][0m[39m segment2[0m[1;39m)[0m[39m throws IOException[0m  [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        font = new [0m[1;35mType1Font[0m[1;39m([0m[39msegment1, segment2[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        try[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:            [0m[1;35mparseASCII[0m[1;39m([0m[39msegment1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        catch [0m[1;39m([0m[39mNumberFormatException ex[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[39mex[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        if [0m[1;39m([0m[39msegment2.length > [0m[1;36m0[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:95[0m[39m-[0m[1;36m120[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        [0m[35m/[0m[35m/[0m[39m [0m[1;39m([0m[39mcorrupt?[0m[1;39m)[0m[39m synthetic font[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        if [0m[1;39m([0m[32m"FontDirectory"[0m[1;35m.equals[0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"FontDirectory"[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m font name[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"known"[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.START_PROC[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            [0m[1;35mreadProcVoid[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.START_PROC[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:            [0m[1;35mreadProcVoid[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"ifelse"[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:        [0m[35m/[0m[35m/[0m[39m font dict[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        int length = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dict"[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        [0m[35m/[0m[35m/[0m[39m found in some TeX fonts[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"dup"[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        [0m[35m/[0m[35m/[0m[39m if present, the [0m[32m"currentdict"[0m[39m is not required[0m                        [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"begin"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            [0m[35m/[0m[35m/[0m[39m premature end[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:            Token token = [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            if [0m[1;39m([0m[39mtoken == null[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:870[0m[39m-[0m[1;36m890[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m870[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m871[0m[39m:     * Reads the next token and throws an exception if it is not of the given [0m  [2m                [0m
[2;36m                    [0m         [39mkind.[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m872[0m[39m:     * [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m873[0m[39m:     * @return token, never null[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m874[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m875[0m[39m:    private Token [0m[1;35mread[0m[1;39m([0m[39mToken.Kind kind[0m[1;39m)[0m[39m throws IOException[0m                      [2m                [0m
[2;36m                    [0m         [1;36m876[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m877[0m[39m:        Token token = [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m878[0m[39m:        if [0m[1;39m([0m[39mtoken == null || [0m[1;35mtoken.getKind[0m[1;39m([0m[1;39m)[0m[39m != kind[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m879[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m880[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Found "[0m[39m + token + [0m[32m" but expected "[0m[39m + kind[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m881[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:        return token;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:     * Reads the next token and throws an exception if it is not of the given [0m  [2m                [0m
[2;36m                    [0m         [39mkind[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:     * and does not have the given value.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    private void [0m[1;35mread[0m[1;39m([0m[39mToken.Kind kind, String name[0m[1;39m)[0m[39m throws IOException[0m          [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDType1Font.jav[0m[1;92ma:220[0m[39m-[0m[1;36m240[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:                    length1 = [0m[1;35mrepairLength1[0m[1;39m([0m[39mbytes, length1[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                    length2 = [0m[1;35mrepairLength2[0m[1;39m([0m[39mbytes, length1, length2[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:                    if [0m[1;39m([0m[1;39m([0m[39mbytes[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m & [0m[1;36m0xff[0m[1;39m)[0m[39m == PFB_START_MARKER[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:                        [0m[35m/[0m[35m/[0m[39m some bad files embed the entire PFB, see PDFBOX-[0m[1;36m2607[0m [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                        t1 = [0m[1;35mType1Font.createWithPFB[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                    else[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                        [0m[35m/[0m[35m/[0m[39m the PFB embedded as two segments back-to-back[0m        [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                        if [0m[1;39m([0m[39mlength1 < [0m[1;36m0[0m[39m || length1 > length1 + length2[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:                            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Invalid length data, actual [0m [2m                [0m
[2;36m                    [0m         [32mlength: "[0m[39m +[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:                                    bytes.length + [0m[32m", /Length1: "[0m[39m + length1 + [0m  [2m                [0m
[2;36m                    [0m         [32m", /Length2: "[0m[39m + length2[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:                        byte[0m[1;39m[[0m[1;39m][0m[39m segment1 = [0m[1;35mArrays.copyOfRange[0m[1;39m([0m[39mbytes, [0m[1;36m0[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [39mlength1[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:                        byte[0m[1;39m[[0m[1;39m][0m[39m segment2 = [0m[1;35mArrays.copyOfRange[0m[1;39m([0m[39mbytes, length1, [0m   [2m                [0m
[2;36m                    [0m         [39mlength1 + length2[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:                        [0m[35m/[0m[35m/[0m[39m empty streams are simply ignored[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDFontFactory.jav[0m[1;92ma:130[0m[39m-[0m[1;36m150[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        COSName subType = [0m[1;35mdictionary.getCOSName[0m[1;39m([0m[39mCOSName.SUBTYPE[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        if [0m[1;39m([0m[1;35mCOSName.TYPE1.equals[0m[1;39m([0m[39msubType[0m[1;39m)[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:            COSDictionary fd = [0m[1;35mdictionary.getCOSDictionary[0m[1;39m([0m[39mCOSName.FONT_DESC[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            if [0m[1;39m([0m[39mfd != null && [0m[1;35mfd.containsKey[0m[1;39m([0m[39mCOSName.FONT_FILE3[0m[1;39m)[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:                return new [0m[1;35mPDType1CFont[0m[1;39m([0m[39mdictionary[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:            return new [0m[1;35mPDType1Font[0m[1;39m([0m[39mdictionary[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:        else if [0m[1;39m([0m[1;35mCOSName.MM_TYPE1.equals[0m[1;39m([0m[39msubType[0m[1;39m)[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:            COSDictionary fd = [0m[1;35mdictionary.getCOSDictionary[0m[1;39m([0m[39mCOSName.FONT_DESC[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:            if [0m[1;39m([0m[39mfd != null && [0m[1;35mfd.containsKey[0m[1;39m([0m[39mCOSName.FONT_FILE3[0m[1;39m)[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:                return new [0m[1;35mPDType1CFont[0m[1;39m([0m[39mdictionary[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            return new [0m[1;35mPDMMType1Font[0m[1;39m([0m[39mdictionary[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mio/src/main/java/org/apache/pdfbox/io/IOUtils.jav[0m[1;92ma:1[0m[39m-[0m[1;36m50[0m                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m[35m/[0m[39m* $Id$ *[0m[35m/[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:package org.apache.pdfbox.io;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import static java.lang.invoke.MethodHandles.constant;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import static java.lang.invoke.MethodHandles.dropArguments;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import static java.lang.invoke.MethodHandles.filterReturnValue;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import static java.lang.invoke.MethodHandles.guardWithTest;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import static java.lang.invoke.MethodHandles.lookup;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import static java.lang.invoke.MethodType.methodType;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import static java.util.Objects.nonNull;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.io.Closeable;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.lang.invoke.MethodHandle;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.lang.invoke.MethodHandles.Lookup;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.lang.reflect.Field;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import java.lang.reflect.Method;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import java.nio.ByteBuffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import java.security.AccessController;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import java.security.PrivilegedAction;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import java.util.Objects;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import java.util.Optional;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import java.util.function.Consumer;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.logging.log4j.LogManager;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.pdfbox.io.RandomAccessStreamCache.StreamCacheCreateFunction;[0m   [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mio/src/main/java/org/apache/pdfbox/io/IOUtils.jav[0m[1;92ma:1[0m[39m-[0m[1;36m88[0m                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m[35m/[0m[39m* $Id$ *[0m[35m/[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:package org.apache.pdfbox.io;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import static java.lang.invoke.MethodHandles.constant;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import static java.lang.invoke.MethodHandles.dropArguments;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import static java.lang.invoke.MethodHandles.filterReturnValue;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import static java.lang.invoke.MethodHandles.guardWithTest;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import static java.lang.invoke.MethodHandles.lookup;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import static java.lang.invoke.MethodType.methodType;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import static java.util.Objects.nonNull;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.io.Closeable;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.lang.invoke.MethodHandle;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.lang.invoke.MethodHandles.Lookup;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.lang.reflect.Field;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import java.lang.reflect.Method;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import java.nio.ByteBuffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import java.security.AccessController;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import java.security.PrivilegedAction;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import java.util.Objects;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import java.util.Optional;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import java.util.function.Consumer;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.logging.log4j.LogManager;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.pdfbox.io.RandomAccessStreamCache.StreamCacheCreateFunction;[0m   [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m: * This class contains various I/O-related methods.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:public final class IOUtils[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     * Log instance.[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    private static final Logger LOG = [0m[1;35mLogManager.getLogger[0m[1;39m([0m[39mIOUtils.class[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    private static final StreamCacheCreateFunction streamCache = [0m                [2m                [0m
[2;36m                    [0m         [39mRandomAccessStreamCacheImpl::new;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    [0m[35m/[0m[35m/[0m[95mTODO[0m[39m PDFBox should really use Apache Commons IO.[0m                           [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    private static final Optional<Consumer<ByteBuffer>> UNMAPPER;[0m                [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    static[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        UNMAPPER = [0m[1;35mOptional.ofNullable[0m[1;39m([0m[39mAccessController[0m                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:                [0m[1;35m.doPrivileged[0m[1;39m([0m[1;39m([0m[39mPrivilegedAction<Consumer<ByteBuffer>>[0m[1;39m)[0m[39m [0m          [2m                [0m
[2;36m                    [0m         [39mIOUtils::unmapper[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    private [0m[1;35mIOUtils[0m[1;39m([0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        [0m[35m/[0m[35m/[0m[95mUtility[0m[39m class. Don't instantiate.[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     * Reads the input stream and returns its contents as a byte array.[0m          [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     * @param in the input stream to read from.[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     * @return the byte array[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     * @throws IOException if an I/O error occurs[0m                                [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     * @deprecated use [0m[1;39m{[0m[39m@link InputStream#[0m[1;35mreadAllBytes[0m[1;39m([0m[1;39m)[0m[1;39m}[0m[39m instead[0m                [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    @[0m[1;35mDeprecated[0m[1;39m([0m[33msince[0m[39m=[0m[32m"4[0m[32m.0.0"[0m[39m, [0m[33mforRemoval[0m[39m=[0m[35mtrue[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    public static byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mtoByteArray[0m[1;39m([0m[39mInputStream in[0m[1;39m)[0m[39m throws IOException[0m          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        return [0m[1;35min.readAllBytes[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mio/src/main/java/org/apache/pdfbox/io/RandomAccessReadMemoryMappedFile.jav[0m[1;92ma:79[0m[39m-[0m[1;36m92[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    public [0m[1;35mRandomAccessReadMemoryMappedFile[0m[1;39m([0m[39mPath path[0m[1;39m)[0m[39m throws IOException[0m        [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        fileChannel = [0m[1;35mFileChannel.open[0m[1;39m([0m[39mpath, [0m                                    [2m                [0m
[2;36m                    [0m         [1;35mEnumSet.of[0m[1;39m([0m[39mStandardOpenOption.READ[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        size = [0m[1;35mfileChannel.size[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[35m/[0m[35m/[0m[39m TODO only ints are allowed -> implement paging[0m                        [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        if [0m[1;39m([0m[39msize > Integer.MAX_VALUE[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mgetClass[0m[1;39m([0m[1;39m)[0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m" doesn't yet support [0m  [2m                [0m
[2;36m                    [0m         [32mfiles bigger than "[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                    + Integer.MAX_VALUE[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[35m/[0m[35m/[0m[39m map the whole file to memory[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        mappedByteBuffer = [0m[1;35mfileChannel.map[0m[1;39m([0m[39mFileChannel.MapMode.READ_ONLY, [0m[1;36m0[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39msize[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        unmapper = IOUtils::unmap;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mio/src/main/java/org/apache/pdfbox/io/ScratchFileBuffer.jav[0m[1;92ma:104[0m[39m-[0m[1;36m118[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:            int newSize = pageIndexes.length*[0m[1;36m2[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            [0m[35m/[0m[35m/[0m[39m check overflow[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            if [0m[1;39m([0m[39mnewSize<pageIndexes.length[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:                if [0m[1;39m([0m[39mpageIndexes.length == Integer.MAX_VALUE[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Maximum buffer size reached."[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:                newSize = Integer.MAX_VALUE;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:            int[0m[1;39m[[0m[1;39m][0m[39m newPageIndexes = new int[0m[1;39m[[0m[39mnewSize[0m[1;39m][0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:            [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mpageIndexes, [0m[1;36m0[0m[39m, newPageIndexes, [0m[1;36m0[0m[39m, pageCount[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:            pageIndexes = newPageIndexes;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/DamagedFontException.jav[0m[1;92ma:1[0m[39m-[0m[1;36m33[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.fontbox.type1;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m: * Thrown when a font is damaged and cannot be read.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m: * @author John Hewson[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:public class DamagedFontException extends IOException[0m                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:    public [0m[1;35mDamagedFontException[0m[1;39m([0m[39mString message[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[39mmessage[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/cff/CFFParser.jav[0m[1;92ma:302[0m[39m-[0m[1;36m317[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:    private static byte[0m[1;39m[[0m[1;39m][0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mreadIndexData[0m[1;39m([0m[39mDataInput input[0m[1;39m)[0m[39m throws IOException[0m   [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:        int[0m[1;39m[[0m[1;39m][0m[39m offsets = [0m[1;35mreadIndexDataOffsets[0m[1;39m([0m[39minput[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:        if [0m[1;39m([0m[39moffsets.length == [0m[1;36m0[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:            return new byte[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m[[0m[1;39m][0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:        int count = offsets.length-[0m[1;36m1[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[1;39m[[0m[1;39m][0m[39m indexDataValues = new byte[0m[1;39m[[0m[39mcount[0m[1;39m][0m[1;39m[[0m[1;39m][0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < count; i++[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:            int length = offsets[0m[1;39m[[0m[39mi + [0m[1;36m1[0m[1;39m][0m[39m - offsets[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:            indexDataValues[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = [0m[1;35minput.readBytes[0m[1;39m([0m[39mlength[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:        return indexDataValues;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/cff/DataInputByteArray.jav[0m[1;92ma:140[0m[39m-[0m[1;36m155[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    public byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mreadBytes[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m throws IOException[0m                      [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:        if [0m[1;39m([0m[39mlength < [0m[1;36m0[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"length is negative"[0m[1;39m)[0m[39m; [0m                       [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:        if [0m[1;39m([0m[39minputBuffer.length - bufferPosition < length[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Premature end of buffer reached"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m bytes = new byte[0m[1;39m[[0m[39mlength[0m[1;39m][0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:        [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39minputBuffer, bufferPosition, bytes, [0m[1;36m0[0m[39m, length[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:        bufferPosition += length;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:        return bytes;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Token.jav[0m[1;92ma:82[0m[39m-[0m[1;36m92[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     * Constructs a new Token object given its raw data and kind.[0m                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     * This is for CHARSTRING tokens only.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     * @param data[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     * @param type[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    [0m[1;35mToken[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m data, Kind type[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        this.data = data;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        this.kind = type;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Token.jav[0m[1;92ma:120[0m[39m-[0m[1;36m123[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    public byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mgetData[0m[1;39m([0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:        return data;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:68[0m[39m-[0m[1;36m72[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * Heuristically chosen max length to buffer a Type1 font[0m                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    private static final long MAX_LENGTH = 100_000_000;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:156[0m[39m-[0m[1;36m165[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            int size = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m8[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m16[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m24[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, size[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            long newTotal = total + size;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            if [0m[1;39m([0m[39mnewTotal > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"record size would be too large: "[0m[39m + [0m     [2m                [0m
[2;36m                    [0m         [39mnewTotal[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/test/java/org/apache/fontbox/pfb/PfbParserTest.jav[0m[1;92ma:58[0m[39m-[0m[1;36m66[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[1;36m4498[0m[39m, [0m[1;35mfont.getASCIISegment[0m[1;39m([0m[1;39m)[0m[39m.length[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[1;36m95911[0m[39m, [0m[1;35mfont.getBinarySegment[0m[1;39m([0m[1;39m)[0m[39m.length[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[1;36m938[0m[39m, [0m[1;35mfont.getCharStringsDict[0m[1;39m([0m[1;39m)[0m[1;35m.size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        for [0m[1;39m([0m[39mString s : [0m[1;35mfont.getCharStringsDict[0m[1;39m([0m[1;39m)[0m[1;35m.keySet[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:            [0m[1;35mAssertions.assertNotNull[0m[1;39m([0m[1;35mfont.getPath[0m[1;39m([0m[39ms[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:            [0m[1;35mAssertions.assertTrue[0m[1;39m([0m[1;35mfont.hasGlyph[0m[1;39m([0m[39ms[0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/test/java/org/apache/fontbox/pfb/PfbParserTest.jav[0m[1;92ma:91[0m[39m-[0m[1;36m93[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[1;36m5959[0m[39m, [0m[1;35mfont.getASCIISegment[0m[1;39m([0m[1;39m)[0m[39m.length[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[1;36m1056090[0m[39m, [0m[1;35mfont.getBinarySegment[0m[1;39m([0m[1;39m)[0m[39m.length[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[1;36m3399[0m[39m, [0m[1;35mfont.getCharStringsDict[0m[1;39m([0m[1;39m)[0m[1;35m.size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:499[0m[39m-[0m[1;36m515[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:     * Reads a binary CharString.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:    private Token [0m[1;35mreadCharString[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m throws IOException[0m                 [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:        try[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:            [0m[1;35mbuffer.get[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m space[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m507[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m data = new byte[0m[1;39m[[0m[39mlength[0m[1;39m][0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:            [0m[1;35mbuffer.get[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:            return new [0m[1;35mToken[0m[1;39m([0m[39mdata, Token.CHARSTRING[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:        catch [0m[1;39m([0m[39mBufferUnderflowException exception[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Premature end of buffer reached"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:52[0m[39m-[0m[1;36m65[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    private final ByteBuffer buffer;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    private Token aheadToken;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    private int openParens = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     * Constructs a new Type1Lexer given a header-less .pfb segment.[0m             [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     * @param bytes Header-less .pfb segment[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     * @throws IOException[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    [0m[1;35mType1Lexer[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m bytes[0m[1;39m)[0m[39m throws IOException[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        buffer = [0m[1;35mByteBuffer.wrap[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        aheadToken = [0m[1;35mreadToken[0m[1;39m([0m[39mnull[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:159[0m[39m-[0m[1;36m167[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:                    String regular = [0m[1;35mreadRegular[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:                    if [0m[1;39m([0m[39mregular == null[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                        [0m[35m/[0m[35m/[0m[39m the stream is corrupt[0m                                [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:                        throw new [0m[1;35mDamagedFontException[0m[1;39m([0m[32m"Could not read token at[0m [2m                [0m
[2;36m                    [0m         [32mposition "[0m[39m +[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:                                                        [0m[1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:                    return new [0m[1;35mToken[0m[1;39m([0m[39mregular, Token.LITERAL[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:218[0m[39m-[0m[1;36m225[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                        [0m[35m/[0m[35m/[0m[39m otherwise this must be a name[0m                        [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:                        String name = [0m[1;35mreadRegular[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                        if [0m[1;39m([0m[39mname == null[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                            [0m[35m/[0m[35m/[0m[39m the stream is corrupt[0m                            [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:                            throw new [0m[1;35mDamagedFontException[0m[1;39m([0m[32m"Could not read [0m     [2m                [0m
[2;36m                    [0m         [32mtoken at position "[0m[39m +[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:                                                           [0m[1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mio/src/main/java/org/apache/pdfbox/io/ScratchFileBuffer.jav[0m[1;92ma:106[0m[39m-[0m[1;36m114[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            [0m[35m/[0m[35m/[0m[39m check overflow[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            if [0m[1;39m([0m[39mnewSize<pageIndexes.length[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:                if [0m[1;39m([0m[39mpageIndexes.length == Integer.MAX_VALUE[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Maximum buffer size reached."[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:                newSize = Integer.MAX_VALUE;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mio/src/main/java/org/apache/pdfbox/io/RandomAccessReadMemoryMappedFile.jav[0m[1;92ma:83[0m[39m-[0m[1;36m88[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[35m/[0m[35m/[0m[39m TODO only ints are allowed -> implement paging[0m                        [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        if [0m[1;39m([0m[39msize > Integer.MAX_VALUE[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mgetClass[0m[1;39m([0m[1;39m)[0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m" doesn't yet support [0m  [2m                [0m
[2;36m                    [0m         [32mfiles bigger than "[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                    + Integer.MAX_VALUE[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/test/java/org/apache/fontbox/type1/Type1LexerTest.jav[0m[1;92ma:123[0m[39m-[0m[1;36m135[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    void [0m[1;35mTestData[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        String s = [0m[32m"3 RD 123 ND"[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        Type1Lexer t1l = new [0m[1;35mType1Lexer[0m[1;39m([0m[1;35ms.getBytes[0m[1;39m([0m[39mStandardCharsets.US_ASCII[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:        List<Token> tokens = [0m[1;35mreadTokens[0m[1;39m([0m[39mt1l[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mToken.INTEGER, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[1;35m.getKind[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[1;36m3[0m[39m, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mToken.CHARSTRING, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[1;35m.getKind[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        [0m[1;35mAssertions.assertArrayEquals[0m[1;39m([0m[39mnew byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;39m{[0m[32m'1'[0m[39m, [0m[32m'2'[0m[39m, [0m[32m'3'[0m[1;39m}[0m[39m, [0m               [2m                [0m
[2;36m                    [0m         [1;35mtokens.get[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[1;35m.getData[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mToken.NAME, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;35m.getKind[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"ND"[0m[39m, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:61[0m[39m-[0m[1;36m64[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    [0m[1;35mType1Lexer[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m bytes[0m[1;39m)[0m[39m throws IOException[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        buffer = [0m[1;35mByteBuffer.wrap[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        aheadToken = [0m[1;35mreadToken[0m[1;39m([0m[39mnull[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:502[0m[39m-[0m[1;36m515[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:    private Token [0m[1;35mreadCharString[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m throws IOException[0m                 [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:        try[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:            [0m[1;35mbuffer.get[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m space[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m507[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m data = new byte[0m[1;39m[[0m[39mlength[0m[1;39m][0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:            [0m[1;35mbuffer.get[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:            return new [0m[1;35mToken[0m[1;39m([0m[39mdata, Token.CHARSTRING[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:        catch [0m[1;39m([0m[39mBufferUnderflowException exception[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Premature end of buffer reached"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:69[0m[39m-[0m[1;36m71[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * Heuristically chosen max length to buffer a Type1 font[0m                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    private static final long MAX_LENGTH = 100_000_000;[0m                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:156[0m[39m-[0m[1;36m166[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            int size = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m8[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m16[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m24[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, size[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            long newTotal = total + size;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            if [0m[1;39m([0m[39mnewTotal > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"record size would be too large: "[0m[39m + [0m     [2m                [0m
[2;36m                    [0m         [39mnewTotal[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m ar = new byte[0m[1;39m[[0m[39msize[0m[1;39m][0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/test/java/org/apache/fontbox/pfb/PfbParserTest.jav[0m[1;92ma:91[0m[39m-[0m[1;36m93[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[1;36m5959[0m[39m, [0m[1;35mfont.getASCIISegment[0m[1;39m([0m[1;39m)[0m[39m.length[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[1;36m1056090[0m[39m, [0m[1;35mfont.getBinarySegment[0m[1;39m([0m[1;39m)[0m[39m.length[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[1;36m3399[0m[39m, [0m[1;35mfont.getCharStringsDict[0m[1;39m([0m[1;39m)[0m[1;35m.size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/cff/DataInputByteArray.jav[0m[1;92ma:140[0m[39m-[0m[1;36m155[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    public byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mreadBytes[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m throws IOException[0m                      [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:        if [0m[1;39m([0m[39mlength < [0m[1;36m0[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"length is negative"[0m[1;39m)[0m[39m; [0m                       [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:        if [0m[1;39m([0m[39minputBuffer.length - bufferPosition < length[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Premature end of buffer reached"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m bytes = new byte[0m[1;39m[[0m[39mlength[0m[1;39m][0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:        [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39minputBuffer, bufferPosition, bytes, [0m[1;36m0[0m[39m, length[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:        bufferPosition += length;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:        return bytes;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDType1Font.jav[0m[1;92ma:247[0m[39m-[0m[1;36m256[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:                catch [0m[1;39m([0m[39mDamagedFontException e[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:                    [0m[1;35mLOG.warn[0m[1;39m([0m[1;39m([0m[1;39m)[0m[39m -> [0m[32m"Can't read damaged embedded Type1 font "[0m[39m + [0m [2m                [0m
[2;36m                    [0m         [1;35mfd.getFontName[0m[1;39m([0m[1;39m)[0m[39m, e[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:                    fontIsDamaged = true;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:                catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:                    [0m[1;35mLOG.error[0m[1;39m([0m[1;39m([0m[1;39m)[0m[39m -> [0m[32m"Can't read the embedded Type1 font "[0m[39m + [0m    [2m                [0m
[2;36m                    [0m         [1;35mfd.getFontName[0m[1;39m([0m[1;39m)[0m[39m, e[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:                    fontIsDamaged = true;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:227[0m[39m-[0m[1;36m238[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                        if [0m[1;39m([0m[1;35mname.equals[0m[1;39m([0m[32m"RD"[0m[1;39m)[0m[39m || [0m[1;35mname.equals[0m[1;39m([0m[32m"-|"[0m[1;39m)[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                            [0m[35m/[0m[35m/[0m[39m return the next CharString instead[0m               [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                            if [0m[1;39m([0m[39mprevToken != null && [0m[1;35mprevToken.getKind[0m[1;39m([0m[1;39m)[0m[39m == [0m    [2m                [0m
[2;36m                    [0m         [39mToken.INTEGER[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                            [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                                return [0m[1;35mreadCharString[0m[1;39m([0m[1;35mprevToken.intValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:                            else[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:                            [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:                                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"expected INTEGER before [0m [2m                [0m
[2;36m                    [0m         [32m-| or RD"[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Root Cause[0m                                                                      [2m                [0m
[2;36m                    [0m         [39mThe vulnerability exists in `[0m[1;35mType1Lexer.readCharString[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m507[0m[39m, where a byte[0m [2m                [0m
[2;36m                    [0m         [39marray is allocated based on a length value read directly from untrusted font data [0m  [2m                [0m
[2;36m                    [0m         [39mwithout validation. When malicious PDF files contain Type1 fonts with extremely [0m    [2m                [0m
[2;36m                    [0m         [39mlarge length values [0m[1;39m([0m[39mapproaching Integer.MAX_VALUE[0m[1;39m)[0m[39m, the JVM cannot allocate such [0m  [2m                [0m
[2;36m                    [0m         [39marrays, resulting in `OutOfMemoryError: Requested array size exceeds VM limit`.[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Key Insights from Code Analysis[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Existing Validation Patterns**: The codebase has established precedents for [0m   [2m                [0m
[2;36m                    [0m         [39msize validation:[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m   - `PfbParser.MAX_LENGTH = 100_000_000` [0m[1;39m([0m[1;36m100[0m[39m MB[0m[1;39m)[0m[39m for entire Type1 fonts[0m           [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mDataInputByteArray.readBytes[0m[1;39m([0m[1;39m)[0m[39m` validates negative lengths and buffer [0m        [2m                [0m
[2;36m                    [0m         [39mcapacity[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   - `RandomAccessReadMemoryMappedFile` checks against Integer.MAX_VALUE[0m            [2m                [0m
[2;36m                    [0m         [39m   - `ScratchFileBuffer` prevents overflow with explicit size checks[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Typical CharString Sizes**: Test data reveals legitimate CharStrings are [0m      [2m                [0m
[2;36m                    [0m         [39msmall:[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   - DejaVuSerifCondensed: [0m[1;36m1[0m[39m,[0m[1;36m056[0m[39m,[0m[1;36m090[0m[39m bytes total for [0m[1;36m3[0m[39m,[0m[1;36m399[0m[39m CharStrings [0m[1;39m([0m[39m~[0m[1;36m310[0m[39m bytes [0m [2m                [0m
[2;36m                    [0m         [39maverage[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   - OpenSans-Regular: [0m[1;36m95[0m[39m,[0m[1;36m911[0m[39m bytes total for [0m[1;36m938[0m[39m CharStrings [0m[1;39m([0m[39m~[0m[1;36m102[0m[39m bytes average[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m   - Individual CharStrings are typically under [0m[1;36m1[0m[39m-[0m[1;36m10[0m[39m KB[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Error Handling Pattern**: The codebase uses:[0m                                   [2m                [0m
[2;36m                    [0m         [39m   - `DamagedFontException` for corrupt font data [0m[1;39m([0m[39malready used in Type1Lexer at [0m   [2m                [0m
[2;36m                    [0m         [39mlines [0m[1;36m164[0m[39m, [0m[1;36m224[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m   - `IOException` for validation failures with descriptive messages[0m                [2m                [0m
[2;36m                    [0m         [39m   - PDType1Font constructor catches these exceptions and continues with fallback [0m  [2m                [0m
[2;36m                    [0m         [39mfonts[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Critical Logic to Preserve**:[0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - The CharString reading mechanism [0m[1;39m([0m[39mINTEGER → [0m[32m"RD"[0m[35m/[0m[32m"−|"[0m[39m → readCharString[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m   - ByteBuffer-based reading with BufferUnderflowException handling[0m                [2m                [0m
[2;36m                    [0m         [39m   - Token-based parsing infrastructure[0m                                             [2m                [0m
[2;36m                    [0m         [39m   - Existing test compatibility[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Primary Fix Location[0m                                                            [2m                [0m
[2;36m                    [0m         [39m**File**: `fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java`  [0m        [2m                [0m
[2;36m                    [0m         [39m**Method**: `[0m[1;35mreadCharString[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m` at lines [0m[1;36m502[0m[39m-[0m[1;36m515[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Implementation Steps[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Add Maximum CharString Size Constant** [0m[1;39m([0m[39mbefore the method, near line [0m[1;36m50[0m[1;39m)[0m[39m:[0m      [2m                [0m
[2;36m                    [0m         [39m   - Define: `private static final int MAX_CHARSTRING_LENGTH = 10_000_000;` [0m[1;39m([0m[1;36m10[0m[39m MB[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m   - Rationale: This is generous for legitimate fonts [0m[1;39m([0m[39m10[0m[1;36m0x[0m[39m larger than typical [0m    [2m                [0m
[2;36m                    [0m         [39mCharStrings[0m[1;39m)[0m[39m but prevents DoS attacks. It's well below the [0m[1;36m100[0m[39m MB total font limit [0m [2m                [0m
[2;36m                    [0m         [39mused by PfbParser.[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Add Validation Logic** [0m[1;39m([0m[39minsert at line [0m[1;36m504[0m[39m, immediately after the try block [0m   [2m                [0m
[2;36m                    [0m         [39mstarts[0m[1;39m)[0m[39m:[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[35m/[0m[35m/[0m[39m Validate length before allocation[0m                                             [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mlength < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [39m       throw new [0m[1;35mIOException[0m[1;39m([0m[32m"CharString length is negative: "[0m[39m + length + [0m          [2m                [0m
[2;36m                    [0m         [39m                           [0m[32m" at position "[0m[39m + [0m[1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m   [0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mlength > MAX_CHARSTRING_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [39m       throw new [0m[1;35mIOException[0m[1;39m([0m[32m"CharString length "[0m[39m + length + [0m                       [2m                [0m
[2;36m                    [0m         [39m                           [0m[32m" exceeds maximum allowed size of "[0m[39m + [0m                   [2m                [0m
[2;36m                    [0m         [39mMAX_CHARSTRING_LENGTH + [0m                                                            [2m                [0m
[2;36m                    [0m         [39m                           [0m[32m" at position "[0m[39m + [0m[1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m   [0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m   [0m[35m/[0m[35m/[0m[39m Check if buffer has enough remaining data[0m                                     [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[1;35mbuffer.remaining[0m[1;39m([0m[1;39m)[0m[39m < length + [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m [0m[35m/[0m[35m/[0m[39m +[0m[1;36m1[0m[39m for the space character[0m             [2m                [0m
[2;36m                    [0m         [39m       throw new [0m[1;35mIOException[0m[1;39m([0m[32m"CharString length "[0m[39m + length + [0m                       [2m                [0m
[2;36m                    [0m         [39m                           [0m[32m" exceeds available buffer data at position "[0m[39m + [0m         [2m                [0m
[2;36m                    [0m         [1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Preserve Existing Logic**:[0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - Keep line [0m[1;36m506[0m[39m: `[0m[1;35mbuffer.get[0m[1;39m([0m[1;39m)[0m[39m;` [0m[1;39m([0m[39mreads space character[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [39m   - Keep line [0m[1;36m507[0m[39m-[0m[1;36m509[0m[39m: Array allocation and [0m[1;35mbuffer.get[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m only after validation[0m [2m                [0m
[2;36m                    [0m         [39mpasses[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   - Keep the BufferUnderflowException handler [0m[1;39m([0m[39mlines [0m[1;36m511[0m[39m-[0m[1;36m514[0m[1;39m)[0m[39m as additional safety[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Optional Enhancement**: Consider adding a [0m[1;35mLOG.warn[0m[1;39m([0m[1;39m)[0m[39m statement for large but [0m  [2m                [0m
[2;36m                    [0m         [39macceptable CharStrings [0m[1;39m([0m[39me.g., > [0m[1;36m1[0m[39m MB[0m[1;39m)[0m[39m to help identify potentially problematic [0m     [2m                [0m
[2;36m                    [0m         [39mfonts during development.[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Complete Modified Method Structure[0m                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39mprivate Token [0m[1;35mreadCharString[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m throws IOException[0m                         [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    try[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[35m/[0m[35m/[0m[39m [0m[1;39m[[0m[39mNEW VALIDATION CODE HERE - steps from point [0m[1;36m2[0m[39m above[0m[1;39m][0m                    [2m                [0m
[2;36m                    [0m         [39m        [0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mbuffer.get[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m space [0m[1;39m[[0m[39mEXISTING LINE [0m[1;36m506[0m[1;39m][0m                                  [2m                [0m
[2;36m                    [0m         [39m        byte[0m[1;39m[[0m[1;39m][0m[39m data = new byte[0m[1;39m[[0m[39mlength[0m[1;39m][0m[39m; [0m[1;39m[[0m[39mEXISTING LINE [0m[1;36m507[0m[1;39m][0m                         [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mbuffer.get[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m; [0m[1;39m[[0m[39mEXISTING LINE [0m[1;36m508[0m[1;39m][0m                                       [2m                [0m
[2;36m                    [0m         [39m        return new [0m[1;35mToken[0m[1;39m([0m[39mdata, Token.CHARSTRING[0m[1;39m)[0m[39m; [0m[1;39m[[0m[39mEXISTING LINE [0m[1;36m509[0m[1;39m][0m               [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    catch [0m[1;39m([0m[39mBufferUnderflowException exception[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Premature end of buffer reached"[0m[1;39m)[0m[39m; [0m[1;39m[[0m[39mEXISTING LINES [0m  [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m-[0m[1;36m514[0m[1;39m][0m                                                                            [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Justification[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This is Optimal[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Defense in Depth**: Validates three conditions [0m[1;39m([0m[39mnegative, too large, [0m          [2m                [0m
[2;36m                    [0m         [39minsufficient buffer[0m[1;39m)[0m[39m before allocation[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Minimal Invasiveness**: Only modifies one method; no API changes or broader [0m   [2m                [0m
[2;36m                    [0m         [39mrefactoring[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Consistent with Codebase**: [0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - Uses IOException pattern matching `[0m[1;35mDataInputByteArray.readBytes[0m[1;39m([0m[1;39m)[0m[39m`[0m             [2m                [0m
[2;36m                    [0m         [39m   - Includes buffer position in error messages like other Type1Lexer methods[0m       [2m                [0m
[2;36m                    [0m         [39m   - Follows size limit pattern from PfbParser[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Security-Focused**: Prevents DoS attacks while maintaining compatibility with [0m [2m                [0m
[2;36m                    [0m         [39mlegitimate fonts[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Preservation of Existing Logic[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **No Breaking Changes**: All existing tests pass since validation only rejects [0m  [2m                [0m
[2;36m                    [0m         [39mmalformed data[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Exception Handling Intact**: PDType1Font already catches [0m                      [2m                [0m
[2;36m                    [0m         [39mIOException/DamagedFontException[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Token Parsing Unaffected**: The [0m[1;35mreadToken[0m[1;39m([0m[1;39m)[0m[39m → [0m[1;35mreadCharString[0m[1;39m([0m[1;39m)[0m[39m flow remains [0m   [2m                [0m
[2;36m                    [0m         [39munchanged[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **ByteBuffer Operations**: All [0m[1;35mbuffer.get[0m[1;39m([0m[1;39m)[0m[39m calls and BufferUnderflowException [0m  [2m                [0m
[2;36m                    [0m         [39mhandling preserved[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Addresses the Issue[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Prevents OOM**: Rejects unreasonable length values before array allocation[0m     [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Fails Fast**: Throws descriptive IOException immediately when detecting [0m       [2m                [0m
[2;36m                    [0m         [39minvalid data[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Maintains Service**: PDF processing continues with fallback fonts due to [0m      [2m                [0m
[2;36m                    [0m         [39mexisting error handling[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Security Mitigation**: Classified as [0m[32m"Low severity"[0m[39m by fuzzer; this fix [0m       [2m                [0m
[2;36m                    [0m         [39mprevents the DoS vector entirely[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Potential Side Effects and Mitigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **[0m[3;91mFalse[0m[39m Positives**: A legitimate font with CharStrings > [0m[1;36m10[0m[39m MB would be [0m        [2m                [0m
[2;36m                    [0m         [39mrejected[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: The [0m[1;36m10[0m[39m MB limit is extremely generous [0m[1;39m([0m[39m100[0m[1;36m0x[0m[39m typical sizes[0m[1;39m)[0m[39m. [0m  [2m                [0m
[2;36m                    [0m         [39mIf needed, can be increased to [0m[1;36m50[0m[39m MB[0m                                                [2m                [0m
[2;36m                    [0m         [39m   - **Evidence**: Test data shows largest font segment is ~[0m[1;36m1[0m[39m MB with [0m[1;36m3[0m[39m,[0m[1;36m399[0m[39m [0m        [2m                [0m
[2;36m                    [0m         [39mCharStrings[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Performance**: Three integer comparisons added per CharString[0m                  [2m                [0m
[2;36m                    [0m         [39m   - **Impact**: Negligible; occurs only during font parsing, not rendering[0m         [2m                [0m
[2;36m                    [0m         [39m   - **Benefit**: Prevents catastrophic allocation attempts[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Error Messages**: New IOException messages need logging[0m                        [2m                [0m
[2;36m                    [0m         [39m   - **Existing**: PDType1Font already logs font parsing errors at line [0m[1;36m254[0m         [2m                [0m
[2;36m                    [0m         [39m   - **Benefit**: Buffer position helps diagnose malformed fonts[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Similar Solutions in Codebase[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **PfbParser** [0m[1;39m([0m[39mlines [0m[1;36m161[0m[39m-[0m[1;36m164[0m[1;39m)[0m[39m: Validates segment size before allocation[0m          [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **DataInputByteArray** [0m[1;39m([0m[39mlines [0m[1;36m143[0m[39m-[0m[1;36m150[0m[1;39m)[0m[39m: Validates length before creating byte [0m   [2m                [0m
[2;36m                    [0m         [39marray[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **RandomAccessReadMemoryMappedFile** [0m[1;39m([0m[39mlines [0m[1;36m84[0m[39m-[0m[1;36m88[0m[1;39m)[0m[39m: Checks Integer.MAX_VALUE [0m    [2m                [0m
[2;36m                    [0m         [39mbefore memory mapping[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis fix applies the same defensive programming pattern consistently used [0m          [2m                [0m
[2;36m                    [0m         [39mthroughout PDFBox for handling untrusted input data.[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/10/26 09:20:35][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=125500;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=486386;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=999995;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=982017;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpxxd57efy[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/pdfbox_pdfbox-full-01_vuln_5/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1768036835.074925[0m                                                       [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/pdfbox_pdfbox-full-01_vuln_5.toml                   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-pdfbox[0m           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/10/26 09:20:37][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/qqor/crete/.cache/environments/[0m[95mpdfbox[0m         ]8;id=355379;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=394986;file:///home/qqor/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=811957;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=852665;file:///home/qqor/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mpdfbox[0m                [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=245763;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=887226;file:///home/qqor/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mpdfbox[0m                 [2m               [0m
