{
  "project_name": "wireshark",
  "vulnerability_identifier": "wireshark_ws-delta-07_vuln_013",
  "source_directory": "/home/qqor/crete/.cache/official-afc-wireshark",
  "llm_usage": {
    "total_cost": 2.0621370000000003,
    "prompt_tokens": 606959,
    "completion_tokens": 16084
  },
  "variant": "sound",
  "diff": "--- a/epan/dissectors/packet-gvcp.c\n+++ b/epan/dissectors/packet-gvcp.c\n@@ -981,8 +981,12 @@\n \tuint32_t value = 0;\n \t\n \tvalue = tvb_get_letohl(tvb, offset);\n-\tgvcp_register_number[gvcp_register_count] = addr;\n-\tgvcp_register_value[gvcp_register_count++] = value;\n+\t\n+\t/* Check bounds before writing to global arrays */\n+\tif (gvcp_register_count < GVCP_MAX_REGISTER_COUNT) {\n+\t\tgvcp_register_number[gvcp_register_count] = addr;\n+\t\tgvcp_register_value[gvcp_register_count++] = value;\n+\t}\n \n \tswitch (addr)\n \t{\n@@ -1496,8 +1500,12 @@\n \tuint32_t value = 0;\n \t\n \tvalue = tvb_get_letohl(tvb, offset);\n-\tgvcp_register_number[gvcp_register_count] = addr;\n-\tgvcp_register_value[gvcp_register_count++] = value;\n+\t\n+\t/* Check bounds before writing to global arrays */\n+\tif (gvcp_register_count < GVCP_MAX_REGISTER_COUNT) {\n+\t\tgvcp_register_number[gvcp_register_count] = addr;\n+\t\tgvcp_register_value[gvcp_register_count++] = value;\n+\t}\n \n \tswitch (addr)\n \t{\n@@ -2548,6 +2556,9 @@\n \t\treturn 0;\n \t}\n \n+\t/* Reset register counter for this packet */\n+\tgvcp_register_count = 0;\n+\n \t/* Set the protocol column */\n \tcol_set_str(pinfo->cinfo, COL_PROTOCOL, \"GVCP\");\n \n",
  "stdout": "",
  "stderr": ""
}