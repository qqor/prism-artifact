{
  "project_name": "log4j2",
  "vulnerability_identifier": "log4j2_log4j2-delta-01_vuln_0",
  "source_directory": "/home/qqor/crete/.cache/official-afc-logging-log4j2",
  "llm_usage": {
    "total_cost": 1.806336,
    "prompt_tokens": 503257,
    "completion_tokens": 19771
  },
  "variant": "sound",
  "diff": "--- a/core/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.java\n+++ b/core/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.java\n@@ -21,6 +21,7 @@\n \n import org.apache.logging.log4j.core.LogEvent;\n import org.apache.logging.log4j.core.config.plugins.Plugin;\n+import org.apache.logging.log4j.util.PropertiesUtil;\n \n /**\n  * Looks up keys from JNDI resources.\n@@ -28,7 +29,7 @@\n @Plugin(name = \"jndi\", category = \"Lookup\")\n public class JndiLookup implements StrLookup {\n \n-    private static boolean ENABLE_JNDI = true;\n+    private static boolean ENABLE_JNDI = PropertiesUtil.getProperties().getBooleanProperty(\"log4j2.enableJndi\", false);\n \n     /** JNDI resourcce path prefix used in a J2EE container */\n     static final String CONTAINER_JNDI_RESOURCE_PATH_PREFIX = \"java:comp/env/\";\n\n--- a/core/src/main/java/org/apache/logging/log4j/core/lookup/Interpolator.java\n+++ b/core/src/main/java/org/apache/logging/log4j/core/lookup/Interpolator.java\n@@ -49,6 +49,9 @@\n             @SuppressWarnings(\"unchecked\")\n             final Class<StrLookup> clazz = entry.getValue().getPluginClass();\n             try {\n+                if (\"jndi\".equals(entry.getKey()) && !JndiLookup.isEnableJndi()) {\n+                    continue;\n+                }\n                 lookups.put(entry.getKey(), clazz.newInstance());\n             } catch (final Exception ex) {\n                 LOGGER.error(\"Unable to create Lookup for \" + entry.getKey(), ex);\n@@ -63,7 +66,9 @@\n         this.defaultLookup = new MapLookup(new HashMap<String, String>());\n         lookups.put(\"sys\", new SystemPropertiesLookup());\n         lookups.put(\"env\", new EnvironmentLookup());\n-        lookups.put(\"jndi\", new JndiLookup());\n+        if (JndiLookup.isEnableJndi()) {\n+            lookups.put(\"jndi\", new JndiLookup());\n+        }\n     }\n \n      /**\n",
  "stdout": "",
  "stderr": ""
}