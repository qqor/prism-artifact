{
  "project_name": "systemd",
  "vulnerability_identifier": "systemd_systemd-full-001_systemd-004",
  "source_directory": "/home/user/crete/.cache/official-afc-systemd",
  "llm_usage": {
    "total_cost": 2.510547,
    "prompt_tokens": 763714,
    "completion_tokens": 14627
  },
  "variant": "sound",
  "diff": "--- a/src/shared/condition.c\n+++ b/src/shared/condition.c\n@@ -97,12 +97,23 @@\n }\n \n Condition* condition_free_list_type(Condition *head, ConditionType type) {\n-        LIST_FOREACH(conditions, c, head)\n-                if (type < 0 || c->type == type) {\n+        if (type < 0) {\n+                /* Free all conditions */\n+                Condition *c;\n+                while ((c = LIST_POP(conditions, head)))\n                         condition_free(c);\n+                return NULL;\n+        }\n+\n+        /* Free only conditions of specific type */\n+        LIST_FOREACH(conditions, c, head) {\n+                if (c->type == type) {\n+                        Condition *to_free = c;\n+                        LIST_REMOVE(conditions, head, to_free);\n+                        condition_free(to_free);\n                 }\n-\n-        assert(type >= 0 || !head);\n+        }\n+\n         return head;\n }\n \n",
  "stdout": "",
  "stderr": ""
}