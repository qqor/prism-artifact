{
  "project_name": "tika",
  "vulnerability_identifier": "tika_tk-delta-06_vuln_10",
  "source_directory": "/home/qqor/crete/.cache/official-afc-tika",
  "llm_usage": {
    "total_cost": 2.0495669999999997,
    "prompt_tokens": 549964,
    "completion_tokens": 26645
  },
  "variant": "sound",
  "diff": "--- a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/CellFormatter.java\n+++ b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/CellFormatter.java\n@@ -36,6 +36,13 @@\n             Pattern.compile(\"([+-])?(\\\\d{0,20}(?:\\\\.\\\\d{0,20})?) \" +\n             \"&fraction_format=\\\"(?:(#{1,20}) )?(#{1,20})/(#{1,20})\\\"\");\n \n+    // Maximum denominator format length to prevent excessive computation\n+    // The nested loop algorithm has O(nÂ²) complexity where n = 10^MAX_DENOM_LENGTH - 1\n+    // MAX_DENOM_LENGTH=3: ~1M iterations (milliseconds, safe for production)\n+    // MAX_DENOM_LENGTH=4: ~100M iterations (seconds, absolute maximum)\n+    // Pattern allows up to 20 hash symbols but must limit computation for performance\n+    private static final int MAX_DENOM_LENGTH = 3;\n+\n     private final Matcher fractionFormatMatcher = FRACTION_FORMAT.matcher(\"\");\n     String format(String cell) {\n         if (cell == null) {\n@@ -59,7 +66,7 @@\n \n         double wholePart = Math.floor(Math.abs(val));\n         double decPart = Math.abs(val) - wholePart;\n-        int denomLength = denomFormat.length();\n+        int denomLength = Math.min(denomFormat.length(), MAX_DENOM_LENGTH);\n \n         double minVal = 1.0;\n         double currDenom = Math.pow(10, denomLength) - 1d;\n@@ -70,7 +77,13 @@\n                     currDenom = i;\n                     currNum = i2;\n                     minVal = Math.abs((double) i2 / (double) i - decPart);\n+                    if (minVal == 0.0) {\n+                        break;\n+                    }\n                 }\n+            }\n+            if (minVal == 0.0) {\n+                break;\n             }\n         }\n         sign = (sign == null) ? \"\" : sign;\n",
  "stdout": "",
  "stderr": ""
}