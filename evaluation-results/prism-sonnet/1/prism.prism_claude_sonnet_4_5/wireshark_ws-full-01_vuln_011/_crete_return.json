{
  "project_name": "wireshark",
  "vulnerability_identifier": "wireshark_ws-full-01_vuln_011",
  "source_directory": "/home/user/crete/.cache/official-afc-wireshark",
  "llm_usage": {
    "total_cost": 4.586801999999999,
    "prompt_tokens": 1374204,
    "completion_tokens": 30946
  },
  "variant": "sound",
  "diff": "--- a/epan/dissectors/packet-aim.c\n+++ b/epan/dissectors/packet-aim.c\n@@ -587,8 +587,18 @@\n \n \tbuddyname_length = tvb_get_ntohs(tvb, offset);\n \n-\tif (pool)\n-\t\tmemcpy(*name, tvb_get_ptr(tvb,offset,1), buddyname_length);\n+\t/* Validate length doesn't exceed buffer size (255 + 1 for null terminator) */\n+\tif (buddyname_length > 255) {\n+\t\tbuddyname_length = 255;\n+\t}\n+\n+\t/* Use safe tvb_memcpy which validates source bounds, skip 2-byte length field */\n+\tif (buddyname_length > 0) {\n+\t\ttvb_memcpy(tvb, *name, offset + 2, buddyname_length);\n+\t}\n+\n+\t/* Ensure null termination */\n+\t(*name)[buddyname_length] = '\\0';\n \n \treturn buddyname_length;\n }\n",
  "stdout": "",
  "stderr": ""
}