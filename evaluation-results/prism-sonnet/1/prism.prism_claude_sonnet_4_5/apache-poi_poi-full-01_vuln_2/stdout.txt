[2;36m[01/05/26 11:44:06][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=136461;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=941532;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp43h94zgd[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/apache-poi_poi-full-01_vuln_2[0m [2m               [0m
[2;36m                    [0m         [35m/[0m[95magent-output-1767613446.7332315[0m                                                     [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc/apache-poi_poi-full-01_vuln_2.toml      [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-poi[0m              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Building Cached for CLEAN environment[1m)[0m        ]8;id=81811;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=773992;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[01/05/26 11:47:02][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Building Cached for CLEAN environment[1m)[0m Took  ]8;id=220977;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=186283;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m176.13[0m seconds; [33mexception[0m=[3;91mFalse[0m                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running tests for Cached for CLEAN            ]8;id=556325;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=919567;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Started[33m...[0m                                                        [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running tests for Cached for CLEAN           ]8;id=923390;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=59824;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=726077;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=781202;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m176[0m[1m)[0m                                                         [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=358243;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=823444;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 11:47:03][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.97[0m seconds;            ]8;id=920007;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=555927;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/05/26 11:47:05][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=39097;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=398371;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=236917;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=225422;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=938531;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=947949;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=575083;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=470066;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 11:47:06][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m1.22[0m seconds;            ]8;id=905016;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=346162;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/05/26 11:47:07][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=192877;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=36384;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 11:47:08][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.90[0m seconds;            ]8;id=819581;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=327378;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/05/26 11:47:14][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=871670;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=487328;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp3655739195777366471/output/q/r/s/t/input.bin_dump/[0m[95mRoot[0m             [2m                [0m
[2;36m                    [0m         Entry/..[35m/../../../[0m[95mjazzer-traversal[0m                                                  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1m([0mFilePath [2m                [0m
[2;36m                    [0m         Traversal.jav[1;92ma:177[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.poi.poifs.dev.POIFSDump.dump[0m[1m([0mPOIFSDump.jav[1;92ma:108[0m[1m)[0m              [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.poi.poifs.dev.POIFSDump.main[0m[1m([0mPOIFSDump.jav[1;92ma:80[0m[1m)[0m               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.POIPOIFSDumpFuzzer.fuzzerTestOneInput[0m[1m([0mPOIPOIFSDumpFuzzer.jav[1;92ma:74[0m[1m)[0m    [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: ac6e69a60acc10da                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp3655739195777366471/output/q/r/s/t/input.bin_dump/[0m[95mRoot[0m             [2m                [0m
[2;36m                    [0m         Entry/..[35m/../../../[0m[95mjazzer-traversal[0m                                                  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1m([0mFilePath [2m                [0m
[2;36m                    [0m         Traversal.jav[1;92ma:177[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.poi.poifs.dev.POIFSDump.dump[0m[1m([0mPOIFSDump.jav[1;92ma:108[0m[1m)[0m              [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.poi.poifs.dev.POIFSDump.main[0m[1m([0mPOIFSDump.jav[1;92ma:80[0m[1m)[0m               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.POIPOIFSDumpFuzzer.fuzzerTestOneInput[0m[1m([0mPOIPOIFSDumpFuzzer.jav[1;92ma:74[0m[1m)[0m    [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: ac6e69a60acc10da                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/05/26 11:47:32][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=46916;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=471385;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/05/26 11:52:43][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=909712;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=156984;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/05/26 11:53:27][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=356612;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=480924;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=761172;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=156539;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 11:53:28][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.96[0m seconds;            ]8;id=34255;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=450970;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/05/26 11:53:29][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Patching[1m)[0m Started[33m...[0m                          ]8;id=336497;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=368699;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpbfrdjt9u[0m                                                 ]8;id=952597;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=776878;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/05/26 11:55:36][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Patching[1m)[0m Took [1;36m127.31[0m seconds;               ]8;id=530266;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=129523;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Checking build[1m)[0m Started[33m...[0m                    ]8;id=558922;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=254410;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 11:56:13][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Checking build[1m)[0m Took [1;36m37.28[0m seconds;          ]8;id=870401;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=829332;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running PoV[1m)[0m Started[33m...[0m                       ]8;id=307295;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=694786;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 11:56:19][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running PoV[1m)[0m Took [1;36m5.91[0m seconds;              ]8;id=172557;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=17320;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Testing[1m)[0m Started[33m...[0m                           ]8;id=760269;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=307246;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=636441;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=701189;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=380407;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=529711;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 11:56:20][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.94[0m seconds;            ]8;id=495715;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=257085;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/05/26 11:56:21][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=6248;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=265771;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 11:56:22][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.99[0m seconds;            ]8;id=926760;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=200051;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/05/26 11:56:23][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=362324;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=401311;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.96[0m seconds;            ]8;id=17395;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=419087;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/05/26 11:56:24][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=746888;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=249503;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/poi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.java                     [2m                [0m
[2;36m                    [0m         +++ b/poi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.java                     [2m                [0m
[2;36m                    [0m         @@ [1;36m-43[0m,[1;36m6[0m +[1;36m43[0m,[1;36m21[0m @@                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m              private [1;35mPOIFSDump[0m[1m([0m[1m)[0m [1m{[0m[1m}[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         +    [35m/[0m**                                                                            [2m                [0m
[2;36m                    [0m         +     * Sanitizes a filename to prevent path traversal attacks by replacing         [2m                [0m
[2;36m                    [0m         +     * potentially dangerous characters with underscores.                          [2m                [0m
[2;36m                    [0m         +     *                                                                             [2m                [0m
[2;36m                    [0m         +     * @param name the filename to sanitize                                        [2m                [0m
[2;36m                    [0m         +     * @return the sanitized filename, or empty string if input is null/empty      [2m                [0m
[2;36m                    [0m         +     *[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         +    private static String [1;35msanitizeFilename[0m[1m([0mString name[1m)[0m [1m{[0m                          [2m                [0m
[2;36m                    [0m         +        if [1m([0mname == null || [1;35mname.isEmpty[0m[1m([0m[1m)[0m[1m)[0m [1m{[0m                                      [2m                [0m
[2;36m                    [0m         +            return [32m""[0m;                                                             [2m                [0m
[2;36m                    [0m         +        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +        [35m/[0m[35m/[0m Replace path separators and other problematic filename characters       [2m                [0m
[2;36m                    [0m         +        return [1;35mname.trim[0m[1m([0m[1m)[0m[1;35m.replaceAll[0m[1m([0m[32m"[0m[32m[[0m[32m:\\\\/*\"?|[0m[32m<[0m[32m>[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     public static void [0m[1;35mmain[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[39m args[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [39m         if [0m[1;39m([0m[39margs.length == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mSystem.err.println[0m[1;39m([0m[32m"Must specify at least one file to dump"[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-72[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m87[0m[39m,[0m[1;36m7[0m[39m @@[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m                 File dumpDir =[0m                                                     [2m                [0m
[2;36m                    [0m         [39m                         [0m[1;35mPaths.get[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[1;35m.getParent[0m[1;39m([0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [39m                                 [0m[1;35m.resolve[0m[1;39m([0m[39mfilenameWithoutPath + [0m[32m"_dump"[0m[1;39m)[0m[1;35m.toFile[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [39m-                File file = new [0m[1;35mFile[0m[1;39m([0m[39mdumpDir, [0m[1;35mroot.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m+                File file = new [0m[1;35mFile[0m[1;39m([0m[39mdumpDir, [0m[1;35msanitizeFilename[0m[1;39m([0m[1;35mroot.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [39m                 if [0m[1;39m([0m[39m![0m[1;35mfile.exists[0m[1;39m([0m[1;39m)[0m[39m && ![0m[1;35mfile.mkdirs[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [39m                     throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Could not create directory "[0m[39m + file[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-105[0m[39m,[0m[1;36m12[0m[39m +[0m[1;36m120[0m[39m,[0m[1;36m12[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m                 try [0m[1;39m([0m[39mDocumentInputStream is = new [0m[1;35mDocumentInputStream[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [39m                    bytes = [0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m-                try [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m    [2m                [0m
[2;36m                    [0m         [1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [39m+                try [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m    [2m                [0m
[2;36m                    [0m         [1;35msanitizeFilename[0m[1;39m([0m[1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [39m                     [0m[1;35mout.write[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mentry instanceof DirectoryEntry[0m[1;39m)[0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [39m                 DirectoryEntry dir = [0m[1;39m([0m[39mDirectoryEntry[0m[1;39m)[0m[39mentry;[0m                        [2m                [0m
[2;36m                    [0m         [39m-                File file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m+                File file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35msanitizeFilename[0m[1;39m([0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mfile.exists[0m[1;39m([0m[1;39m)[0m[39m && ![0m[1;35mfile.mkdirs[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [39m                     throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Could not create directory "[0m[39m + file[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: [0m   [2m                [0m
[2;36m                    [0m         [39mFile path traversal: [0m                                                               [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp3655739195777366471/output/q/r/s/t/input.bin_dump/[0m[95mRoot[0m[39m [0m            [2m                [0m
[2;36m                    [0m         [39mEntry/..[0m[35m/../../../[0m[95mjazzer-traversal[0m                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1;39m([0m[39mFilePathTraversal.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:346[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1;39m([0m[39mFilePathTravers[0m [2m                [0m
[2;36m                    [0m         [39mal.jav[0m[1;92ma:293[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1;39m([0m[39mFilePath[0m [2m                [0m
[2;36m                    [0m         [39mTraversal.jav[0m[1;92ma:177[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.poifs.dev.POIFSDump.dump[0m[1;39m([0m[39mPOIFSDump.jav[0m[1;92ma:108[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.poifs.dev.POIFSDump.main[0m[1;39m([0m[39mPOIFSDump.jav[0m[1;92ma:80[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.POIPOIFSDumpFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPOIPOIFSDumpFuzzer.jav[0m[1;92ma:74[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: ac6e69a60acc10da[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA file path traversal vulnerability has been detected in Apache POI's POIFSDump [0m    [2m                [0m
[2;36m                    [0m         [39mfunctionality. The fuzzer identified a critical security issue where the [0m           [2m                [0m
[2;36m                    [0m         [39mapplication attempts to access a file path outside the intended directory structure[0m [2m                [0m
[2;36m                    [0m         [39musing path traversal sequences [0m[1;39m([0m[39m`..[0m[35m/../../../[0m[39m`[0m[1;39m)[0m[39m, potentially allowing unauthorized [0m [2m                [0m
[2;36m                    [0m         [39mfile system access.[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis issue represents a **file path traversal vulnerability** [0m[1;39m([0m[39malso known as [0m       [2m                [0m
[2;36m                    [0m         [39mdirectory traversal[0m[1;39m)[0m[39m detected during fuzz testing. The vulnerability manifests when[0m [2m                [0m
[2;36m                    [0m         [39mprocessing a crafted input file that contains malicious directory entries.[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Vulnerability Details[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe security issue occurs in the following execution flow:[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The fuzzer invokes `[0m[1;35mPOIPOIFSDumpFuzzer.fuzzerTestOneInput[0m[1;39m([0m[1;39m)[0m[39m` as the entry point[0m  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. This calls `[0m[1;35mPOIFSDump.main[0m[1;39m([0m[1;39m)[0m[39m` which processes the input file[0m                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. During execution, `[0m[1;35mPOIFSDump.dump[0m[1;39m([0m[1;39m)[0m[39m` attempts to create or access a file path[0m    [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. The Jazzer sanitizer intercepts the path operation at [0m                           [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mFilePathTraversal.pathFirstArgHook[0m[1;39m([0m[1;39m)[0m[39m` and detects a malicious path[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe problematic path demonstrates classic path traversal:[0m                           [2m                [0m
[2;36m                    [0m         [39m- Expected path: [0m                                                                   [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/tmp/expander-tmp3655739195777366471/output/q/r/s/t/input.bin_dump/[0m[95mRoot[0m[39m Entry/`[0m    [2m                [0m
[2;36m                    [0m         [39m- Actual path attempted: [0m                                                           [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/tmp/expander-tmp3655739195777366471/output/q/r/s/t/input.bin_dump/[0m[95mRoot[0m[39m [0m           [2m                [0m
[2;36m                    [0m         [39mEntry/..[0m[35m/../../../[0m[95mjazzer-traversal[0m[39m`[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe `..[0m[35m/../../../[0m[39m` sequence attempts to navigate up four directory levels from the [0m [2m                [0m
[2;36m                    [0m         [39mexpected location, potentially escaping the intended sandbox directory to access or[0m [2m                [0m
[2;36m                    [0m         [39mcreate files in unauthorized locations.[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Key Observations[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Entry Point Structure**: The input appears to be a POIFS [0m[1;39m([0m[39mPoor Obfuscation [0m    [2m                [0m
[2;36m                    [0m         [39mImplementation File System[0m[1;39m)[0m[39m file with embedded directory entries, including one [0m    [2m                [0m
[2;36m                    [0m         [39mnamed [0m[32m"Root Entry"[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Traversal Pattern**: The malicious path uses exactly four parent directory [0m    [2m                [0m
[2;36m                    [0m         [39mreferences [0m[1;39m([0m[39m`..[0m[35m/[0m[39m`[0m[1;39m)[0m[39m to escape the intended output directory[0m                          [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Detection Point**: The vulnerability is caught by Jazzer's FilePathTraversal [0m  [2m                [0m
[2;36m                    [0m         [39msanitizer before actual file system access occurs[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Severity**: Classified as `FuzzerSecurityIssueCritical`, indicating high [0m      [2m                [0m
[2;36m                    [0m         [39mseverity[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Components Requiring Investigation[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo understand the full scope of this vulnerability, the following areas should be [0m  [2m                [0m
[2;36m                    [0m         [39minvestigated:[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **[0m[1;35mPOIFSDump.dump[0m[1;39m([0m[1;39m)[0m[39m method** [0m[1;39m([0m[39mline [0m[1;36m108[0m[1;39m)[0m[39m: Examine how file paths are constructed [0m  [2m                [0m
[2;36m                    [0m         [39mwhen dumping POIFS directory entries and whether input validation is performed on [0m  [2m                [0m
[2;36m                    [0m         [39mentry names[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **[0m[1;35mPOIFSDump.main[0m[1;39m([0m[1;39m)[0m[39m method** [0m[1;39m([0m[39mline [0m[1;36m80[0m[1;39m)[0m[39m: Review how input files are processed and [0m [2m                [0m
[2;36m                    [0m         [39mwhat sanitization occurs before passing data to the dump method[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **POIFS directory entry parsing**: Investigate how directory entry names are [0m    [2m                [0m
[2;36m                    [0m         [39mextracted from the input file and whether malicious characters or sequences are [0m    [2m                [0m
[2;36m                    [0m         [39mfiltered[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **File path construction logic**: Identify all locations where file paths are [0m   [2m                [0m
[2;36m                    [0m         [39mconstructed by concatenating user-controlled data [0m[1;39m([0m[39mdirectory entry names[0m[1;39m)[0m[39m with base[0m [2m                [0m
[2;36m                    [0m         [39mpaths[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Input validation mechanisms**: Determine if there are existing validation or [0m  [2m                [0m
[2;36m                    [0m         [39msanitization measures for directory entry names and why they failed to prevent this[0m [2m                [0m
[2;36m                    [0m         [39mtraversal attempt[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability indicates that user-controlled data from the input file [0m          [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mspecifically, directory entry names[0m[1;39m)[0m[39m is being used to construct file system paths [0m [2m                [0m
[2;36m                    [0m         [39mwithout adequate validation or sanitization, allowing special path sequences to [0m    [2m                [0m
[2;36m                    [0m         [39mescape the intended directory structure.[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: [0m   [2m                [0m
[2;36m                    [0m         [39mFile path traversal: [0m                                                               [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp3655739195777366471/output/q/r/s/t/input.bin_dump/[0m[95mRoot[0m[39m [0m            [2m                [0m
[2;36m                    [0m         [39mEntry/..[0m[35m/../../../[0m[95mjazzer-traversal[0m                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1;39m([0m[39mFilePathTraversal.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:346[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1;39m([0m[39mFilePathTravers[0m [2m                [0m
[2;36m                    [0m         [39mal.jav[0m[1;92ma:293[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1;39m([0m[39mFilePath[0m [2m                [0m
[2;36m                    [0m         [39mTraversal.jav[0m[1;92ma:177[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.poifs.dev.POIFSDump.dump[0m[1;39m([0m[39mPOIFSDump.jav[0m[1;92ma:108[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.poifs.dev.POIFSDump.main[0m[1;39m([0m[39mPOIFSDump.jav[0m[1;92ma:80[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.POIPOIFSDumpFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPOIPOIFSDumpFuzzer.jav[0m[1;92ma:74[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: ac6e69a60acc10da[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:1[0m[39m-[0m[1;36m26[0m                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* ====================================================================[0m           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:   Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:   contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:   this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:   The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:   [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:   the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:   Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:   distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:   See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:   limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:==================================================================== *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.poi.poifs.dev;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.ByteBuffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:99[0m[39m-[0m[1;36m122[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    public static void [0m[1;35mdump[0m[1;39m([0m[39mDirectoryEntry root, File parent[0m[1;39m)[0m[39m throws IOException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        [0m[1;35mfor[0m[1;39m([0m[39mIterator<Entry> it = [0m[1;35mroot.getEntries[0m[1;39m([0m[1;39m)[0m[39m; [0m[1;35mit.hasNext[0m[1;39m([0m[1;39m)[0m[39m;[0m[1;39m)[0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            Entry entry = [0m[1;35mit.next[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39mentry instanceof DocumentNode[0m[1;39m)[0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                final DocumentNode node = [0m[1;39m([0m[39mDocumentNode[0m[1;39m)[0m[39m entry;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                final byte[0m[1;39m[[0m[1;39m][0m[39m bytes;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                try [0m[1;39m([0m[39mDocumentInputStream is = new [0m[1;35mDocumentInputStream[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:                   bytes = [0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:                try [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m [2m                [0m
[2;36m                    [0m         [1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:                    [0m[1;35mout.write[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mentry instanceof DirectoryEntry[0m[1;39m)[0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                DirectoryEntry dir = [0m[1;39m([0m[39mDirectoryEntry[0m[1;39m)[0m[39mentry;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:                File file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:                [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mfile.exists[0m[1;39m([0m[1;39m)[0m[39m && ![0m[1;35mfile.mkdirs[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Could not create directory "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39mfile[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                [0m[1;35mdump[0m[1;39m([0m[39mdir, file[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                [0m[1;35mSystem.err.println[0m[1;39m([0m[32m"Skipping unsupported POIFS entry: "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39mentry[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/Entry.jav[0m[1;92ma:22[0m[39m-[0m[1;36m37[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m: * This interface provides access to an object managed by a Filesystem[0m           [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m: * instance. Entry objects are further divided into DocumentEntry and[0m            [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m: * DirectoryEntry instances.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:public interface Entry[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:     * get the name of the Entry[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:     * @return name[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    public String [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/Entry.jav[0m[1;92ma:79[0m[39m-[0m[1;36m93[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     * Rename this Entry. This operation will fail if:[0m                           [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     * There is a sibling Entry [0m[1;39m([0m[39mi.e., an Entry whose parent is the[0m              [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     * same as this Entry's parent[0m[1;39m)[0m[39m with the same name.[0m                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     * This Entry is the root of the Entry tree. Its name is dictated[0m            [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     * by the Filesystem and many not be changed.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     * @param newName the new name for this Entry[0m                                [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     * @return true if the operation succeeded, else false[0m                       [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    public boolean [0m[1;35mrenameTo[0m[1;39m([0m[39mfinal String newName[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-ooxml/src/test/java/org/apache/poi/poifs/crypt/tests/TestEncryptor.jav[0m[1;92ma:416[0m[39m-[0m[1;36m425[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:    private void [0m[1;35mlistEntry[0m[1;39m([0m[39mDocumentNode de, String ext, String path[0m[1;39m)[0m[39m throws [0m    [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:        path += [0m[32m"\\" + de.getName[0m[32m([0m[32m)[0m[32m.replaceAll[0m[32m([0m[32m"[0m[1;39m[[0m[39m\\p[0m[1;39m{[0m[39mCntrl[0m[1;39m}[0m[1;39m][0m[32m", "[0m[39m_"[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:        [0m[1;35mSystem.out.println[0m[1;39m([0m[39mext+[0m[32m": "[0m[39m+path+[0m[32m" [0m[32m([0m[32m"[0m[39m+[0m[1;35mde.getSize[0m[1;39m([0m[1;39m)[0m[39m+[0m[32m" bytes[0m[32m)[0m[32m"[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:        String name = [0m[1;35mde.getName[0m[1;39m([0m[1;39m)[0m[1;35m.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m\\p[0m[32m{[0m[32mCntrl[0m[32m}[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:        InputStream is = [0m                                                       [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;39m([0m[39mDirectoryNode[0m[1;39m)[0m[1;35mde.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.createDocumentInputStream[0m[1;39m([0m[39mde[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:        FileOutputStream fos = new [0m[1;35mFileOutputStream[0m[1;39m([0m[32m"solr."[0m[39m+name+[0m[32m"."[0m[39m+ext[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:        [0m[1;35mIOUtils.copy[0m[1;39m([0m[39mis, fos[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:        [0m[1;35mfos.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-ooxml/src/main/java/org/apache/poi/xdgf/util/Util.jav[0m[1;92ma:34[0m[39m-[0m[1;36m36[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    public static String [0m[1;35msanitizeFilename[0m[1;39m([0m[39mString name[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        return [0m[1;35mname.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m:\\\\/*\"?|<>[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/EntryUtils.jav[0m[1;92ma:37[0m[39m-[0m[1;36m58[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * Copies an Entry into a target POIFS directory, recursively[0m                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    @Internal[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    public static void [0m[1;35mcopyNodeRecursively[0m[1;39m([0m[39m Entry entry, DirectoryEntry target [0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    throws IOException [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        if [0m[1;39m([0m[39m [0m[1;35mentry.isDirectoryEntry[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:            DirectoryEntry dirEntry = [0m[1;39m([0m[39mDirectoryEntry[0m[1;39m)[0m[39mentry;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:            DirectoryEntry newTarget = [0m[1;35mtarget.createDirectory[0m[1;39m([0m[39m [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [1;39m)[0m[39m;[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:            [0m[1;35mnewTarget.setStorageClsid[0m[1;39m([0m[39m [0m[1;35mdirEntry.getStorageClsid[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:            Iterator<Entry> entries = [0m[1;35mdirEntry.getEntries[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:            while [0m[1;39m([0m[39m [0m[1;35mentries.hasNext[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:                [0m[1;35mcopyNodeRecursively[0m[1;39m([0m[39m [0m[1;35mentries.next[0m[1;39m([0m[1;39m)[0m[39m, newTarget [0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            DocumentEntry dentry = [0m[1;39m([0m[39mDocumentEntry[0m[1;39m)[0m[39m entry;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:            DocumentInputStream dstream = new [0m[1;35mDocumentInputStream[0m[1;39m([0m[39m dentry [0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            [0m[1;35mtarget.createDocument[0m[1;39m([0m[39m [0m[1;35mdentry.getName[0m[1;39m([0m[1;39m)[0m[39m, dstream [0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:            [0m[1;35mdstream.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:46[0m[39m-[0m[1;36m80[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    public static void [0m[1;35mmain[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[39m args[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:        if [0m[1;39m([0m[39margs.length == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:            [0m[1;35mSystem.err.println[0m[1;39m([0m[32m"Must specify at least one file to dump"[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:            [0m[1;35mSystem.exit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        boolean dumpProps = false, dumpMini = false;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        for [0m[1;39m([0m[39mString filename : args[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:            if [0m[1;39m([0m[1;35mfilename.equalsIgnoreCase[0m[1;39m([0m[32m"-dumprops"[0m[1;39m)[0m[39m ||[0m                        [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:                    [0m[1;35mfilename.equalsIgnoreCase[0m[1;39m([0m[32m"-dump-props"[0m[1;39m)[0m[39m ||[0m                  [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:                    [0m[1;35mfilename.equalsIgnoreCase[0m[1;39m([0m[32m"-dump-properties"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:                dumpProps = true;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:                continue;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:            if [0m[1;39m([0m[1;35mfilename.equalsIgnoreCase[0m[1;39m([0m[32m"-dumpmini"[0m[1;39m)[0m[39m ||[0m                        [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:                    [0m[1;35mfilename.equalsIgnoreCase[0m[1;39m([0m[32m"-dump-mini"[0m[1;39m)[0m[39m ||[0m                   [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:                    [0m[1;35mfilename.equalsIgnoreCase[0m[1;39m([0m[32m"-dump-ministream"[0m[1;39m)[0m[39m ||[0m             [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:                    [0m[1;35mfilename.equalsIgnoreCase[0m[1;39m([0m[32m"-dump-mini-stream"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:                dumpMini = true;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:                continue;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            try [0m[1;39m([0m[39mInputStream is = [0m[1;35mFiles.newInputStream[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:                 POIFSFileSystem fs = new [0m[1;35mPOIFSFileSystem[0m[1;39m([0m[39mis[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:                DirectoryEntry root = [0m[1;35mfs.getRoot[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                String filenameWithoutPath = new [0m[1;35mFile[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:                File dumpDir =[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:                        [0m[1;35mPaths.get[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[1;35m.getParent[0m[1;39m([0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                                [0m[1;35m.resolve[0m[1;39m([0m[39mfilenameWithoutPath + [0m                  [2m                [0m
[2;36m                    [0m         [32m"_dump"[0m[1;39m)[0m[1;35m.toFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                File file = new [0m[1;35mFile[0m[1;39m([0m[39mdumpDir, [0m[1;35mroot.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mfile.exists[0m[1;39m([0m[1;39m)[0m[39m && ![0m[1;35mfile.mkdirs[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Could not create directory "[0m[39m + file[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                [0m[1;35mdump[0m[1;39m([0m[39mroot, file[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-ooxml/src/main/java/org/apache/poi/xdgf/util/Util.jav[0m[1;92ma:31[0m[39m-[0m[1;36m36[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    [0m[35m/[0m[35m/[0m[39m this probably isn't [0m[1;36m100[0m[39m% correct, so don't use it in security-sensitive[0m   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    [0m[35m/[0m[35m/[0m[39m applications![0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[35m/[0m[35m/[0m[39m from: [0m[4;94mhttp://www.rgagnon.com/javadetails/java-0662.html[0m                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    public static String [0m[1;35msanitizeFilename[0m[1;39m([0m[39mString name[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        return [0m[1;35mname.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m:\\\\/*\"?|<>[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/test/java/org/apache/poi/poifs/dev/TestPOIFSDump.jav[0m[1;92ma:141[0m[39m-[0m[1;36m161[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    void [0m[1;35mtestMain[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:        Path tmpDir = [0m[1;35mFiles.createTempDirectory[0m[1;39m([0m[32m"poi-dump-tst-"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:            Path tmpFile = [0m[1;35mtmpDir.resolve[0m[1;39m([0m[32m"46515.xls"[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:            [0m[1;35mFiles.copy[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[39mTEST_FILE[0m[1;39m)[0m[39m, tmpFile[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:            [0m[1;35mPOIFSDump.main[0m[1;39m([0m[39mnew String[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[1;35mtmpFile.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m}[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:            File f = [0m[1;35mtmpFile.toFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            File dump = new [0m[1;35mFile[0m[1;39m([0m[1;35mf.getParent[0m[1;39m([0m[1;39m)[0m[39m, [0m[32m"46515.xls_dump"[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            [0m[1;35massertTrue[0m[1;39m([0m[1;35mdump.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            File root = new [0m[1;35mFile[0m[1;39m([0m[39mdump, [0m[32m"Root Entry"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:            [0m[1;35massertTrue[0m[1;39m([0m[1;35mroot.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:            File compObj = new [0m[1;35mFile[0m[1;39m([0m[39mroot, [0m[32m"CompObj"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:            [0m[1;35massertTrue[0m[1;39m([0m[1;35mcompObj.isFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:            for [0m[1;39m([0m[39mString option : DUMP_[0m[1;33mOPTIONS[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:                [0m[1;35massertDoesNotThrow[0m[1;39m([0m[1;39m([0m[1;39m)[0m[39m -> [0m[1;35mPOIFSDump.main[0m[1;39m([0m[39mnew String[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[39moption,[0m    [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:                        [0m[1;35mf.getAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m}[0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:            [0m[1;35mforceDelete[0m[1;39m([0m[1;35mtmpDir.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:99[0m[39m-[0m[1;36m122[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    public static void [0m[1;35mdump[0m[1;39m([0m[39mDirectoryEntry root, File parent[0m[1;39m)[0m[39m throws IOException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        [0m[1;35mfor[0m[1;39m([0m[39mIterator<Entry> it = [0m[1;35mroot.getEntries[0m[1;39m([0m[1;39m)[0m[39m; [0m[1;35mit.hasNext[0m[1;39m([0m[1;39m)[0m[39m;[0m[1;39m)[0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            Entry entry = [0m[1;35mit.next[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39mentry instanceof DocumentNode[0m[1;39m)[0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                final DocumentNode node = [0m[1;39m([0m[39mDocumentNode[0m[1;39m)[0m[39m entry;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                final byte[0m[1;39m[[0m[1;39m][0m[39m bytes;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                try [0m[1;39m([0m[39mDocumentInputStream is = new [0m[1;35mDocumentInputStream[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:                   bytes = [0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:                try [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m [2m                [0m
[2;36m                    [0m         [1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:                    [0m[1;35mout.write[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mentry instanceof DirectoryEntry[0m[1;39m)[0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                DirectoryEntry dir = [0m[1;39m([0m[39mDirectoryEntry[0m[1;39m)[0m[39mentry;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:                File file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:                [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mfile.exists[0m[1;39m([0m[1;39m)[0m[39m && ![0m[1;35mfile.mkdirs[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Could not create directory "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39mfile[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                [0m[1;35mdump[0m[1;39m([0m[39mdir, file[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                [0m[1;35mSystem.err.println[0m[1;39m([0m[32m"Skipping unsupported POIFS entry: "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39mentry[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/property/DirectoryProperty.jav[0m[1;92ma:47[0m[39m-[0m[1;36m55[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    public [0m[1;35mDirectoryProperty[0m[1;39m([0m[39mString name[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        [0m[1;35msetName[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        [0m[1;35msetSize[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        [0m[1;35msetPropertyType[0m[1;39m([0m[39mPropertyConstants.DIRECTORY_TYPE[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        [0m[1;35msetStartBlock[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        [0m[1;35msetNodeColor[0m[1;39m([0m[39m_NODE_BLACK[0m[1;39m)[0m[39m;   [0m[35m/[0m[35m/[0m[39m simplification[0m                           [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/property/DirectoryProperty.jav[0m[1;92ma:268[0m[39m-[0m[1;36m279[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:    public void [0m[1;35maddChild[0m[1;39m([0m[39mfinal Property property[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:        throws IOException[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:        String name = [0m[1;35mproperty.getName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:        if [0m[1;39m([0m[1;35m_children_names.contains[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Duplicate name \""[0m[39m + name + [0m[32m"\""[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:        [0m[1;35m_children_names.add[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:        [0m[1;35m_children.add[0m[1;39m([0m[39mproperty[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:123[0m[39m-[0m[1;36m138[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    public static void [0m[1;35mdump[0m[1;39m([0m[39mPOIFSFileSystem fs, int startBlock, String name, [0m   [2m                [0m
[2;36m                    [0m         [39mFile parent[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:        File file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, name[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;35mFiles.isDirectory[0m[1;39m([0m[1;35mfile.toPath[0m[1;39m([0m[1;39m)[0m[1;35m.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:            [0m[1;35mFiles.createDirectories[0m[1;39m([0m[1;35mfile.toPath[0m[1;39m([0m[1;39m)[0m[1;35m.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:        try [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[1;35mfile.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            POIFSStream stream = new [0m[1;35mPOIFSStream[0m[1;39m([0m[39mfs, startBlock[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m b = [0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[1;35mfs.getBigBlockSize[0m[1;39m([0m[1;39m)[0m[39m, [0m            [2m                [0m
[2;36m                    [0m         [1;35mPOIFSFileSystem.getMaxRecordLength[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:            for [0m[1;39m([0m[39mByteBuffer bb : stream[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:                int len = [0m[1;35mbb.remaining[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:                [0m[1;35mbb.get[0m[1;39m([0m[39mb[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:                [0m[1;35mout.write[0m[1;39m([0m[39mb, [0m[1;36m0[0m[39m, len[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/property/Property.jav[0m[1;92ma:66[0m[39m-[0m[1;36m89[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    private String              _name;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    private ShortField          _name_size;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    private ByteField           _property_type;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    private ByteField           _node_color;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    private IntegerField        _previous_property;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    private IntegerField        _next_property;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    private IntegerField        _child_property;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    private ClassID             _storage_clsid;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    private IntegerField        _user_flags;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    private IntegerField        _seconds_1;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    private IntegerField        _days_1;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    private IntegerField        _seconds_2;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    private IntegerField        _days_2;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    private IntegerField        _start_block;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    private IntegerField        _size;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private byte[0m[1;39m[[0m[1;39m][0m[39m              _raw_data;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    private int                 _index;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    private Child               _next_child;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    private Child               _previous_child;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    protected [0m[1;35mProperty[0m[1;39m([0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        _raw_data = new byte[0m[1;39m[[0m[39m POIFSConstants.PROPERTY_SIZE [0m[1;39m][0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[1;35mArrays.fill[0m[1;39m([0m[39m_raw_data, _default_fill[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/property/Property.jav[0m[1;92ma:233[0m[39m-[0m[1;36m240[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:     * Get the name of this property[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:     * @return property name as String[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:    public String [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:        return _name;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/property/Property.jav[0m[1;92ma:143[0m[39m-[0m[1;36m159[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:        if [0m[1;39m([0m[39mname_length < [0m[1;36m1[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:            _name = [0m[32m""[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:        else[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            char[0m[1;39m[[0m[1;39m][0m[39m char_array  = new char[0m[1;39m[[0m[39m name_length [0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            int    name_offset = [0m[1;36m0[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:            for [0m[1;39m([0m[39mint j = [0m[1;36m0[0m[39m; j < name_length; j++[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:                char_array[0m[1;39m[[0m[39m j [0m[1;39m][0m[39m = [0m[1;39m([0m[39m char [0m[1;39m)[0m[39m new [0m[1;35mShortField[0m[1;39m([0m[39mname_offset,[0m          [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:                                                          _raw_data[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:                name_offset     += LittleEndianConsts.SHORT_SIZE;[0m               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            _name = new [0m[1;35mString[0m[1;39m([0m[39mchar_array, [0m[1;36m0[0m[39m, name_length[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-ooxml/src/main/java/org/apache/poi/openxml4j/util/ZipSecureFile.jav[0m[1;92ma:202[0m[39m-[0m[1;36m222[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:    public static long [0m[1;35mgetMaxTextSize[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:        return MAX_TEXT_SIZE;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:     * @param file the [0m[1;39m{[0m[39m@link File[0m[1;39m}[0m[39m, possibly including path traversal - it is [0m [2m                [0m
[2;36m                    [0m         [39mup to users to validate that the input value is safe[0m                                [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:     * @throws IOException if an error occurs while reading the file.[0m           [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:    public [0m[1;35mZipSecureFile[0m[1;39m([0m[39mFile file[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[39mfile[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:        this.fileName = [0m[1;35mfile.getAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:        [0m[1;35mvalidateEntryNames[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:     * @param name the file name, possibly including path traversal - it is up [0m [2m                [0m
[2;36m                    [0m         [39mto users to validate that the input value is safe[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:     * @throws IOException  if an error occurs while reading the file.[0m          [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:    public [0m[1;35mZipSecureFile[0m[1;39m([0m[39mString name[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:        this.fileName = new [0m[1;35mFile[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.getAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-ooxml/src/main/java/org/apache/poi/openxml4j/util/ZipSecureFile.jav[0m[1;92ma:257[0m[39m-[0m[1;36m272[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:    private void [0m[1;35mvalidateEntryNames[0m[1;39m([0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:        final Enumeration<ZipArchiveEntry> en = [0m[1;35mgetEntries[0m[1;39m([0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:        final Set<String> filenames = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:        while [0m[1;39m([0m[1;35men.hasMoreElements[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:            final ZipArchiveEntry entry = [0m[1;35men.nextElement[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:            String name = [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:            if [0m[1;39m([0m[39mname == null || [0m[1;35mname.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:                throw new [0m[1;35mInvalidZipException[0m[1;39m([0m[32m"Input file contains an entry [0m    [2m                [0m
[2;36m                    [0m         [32mwith an empty name"[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:            name = [0m[1;35mname.toLowerCase[0m[1;39m([0m[39mLocale.ROOT[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:            if [0m[1;39m([0m[1;35mfilenames.contains[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:                throw new [0m[1;35mInvalidZipException[0m[1;39m([0m[32m"Input file contains more than 1 [0m [2m                [0m
[2;36m                    [0m         [32mentry with the name "[0m[39m + [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:            [0m[1;35mfilenames.add[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/property/Property.jav[0m[1;92ma:257[0m[39m-[0m[1;36m286[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:     * Set the name; silently truncates the name if it's too long.[0m              [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:     * @param name the new name[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:    protected void [0m[1;35msetName[0m[1;39m([0m[39mString name[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:        char[0m[1;39m[[0m[1;39m][0m[39m char_array = [0m[1;35mname.toCharArray[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:        int    limit      = [0m[1;35mMath.min[0m[1;39m([0m[39mchar_array.length, _max_name_length[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:        _name = new [0m[1;35mString[0m[1;39m([0m[39mchar_array, [0m[1;36m0[0m[39m, limit[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:        short offset = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:        int   j      = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:        for [0m[1;39m([0m[39m; j < limit; j++[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:            new [0m[1;35mShortField[0m[1;39m([0m[39moffset, [0m[1;39m([0m[39m short [0m[1;39m)[0m[39m char_array[0m[1;39m[[0m[39m j [0m[1;39m][0m[39m, _raw_data[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:            offset += [0m[1;39m([0m[39mshort[0m[1;39m)[0m[39m LittleEndianConsts.SHORT_SIZE;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:        for [0m[1;39m([0m[39m; j < _max_name_length + [0m[1;36m1[0m[39m; j++[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:            new [0m[1;35mShortField[0m[1;39m([0m[39moffset, [0m[1;39m([0m[39m short [0m[1;39m)[0m[39m [0m[1;36m0[0m[39m, _raw_data[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:            offset += [0m[1;39m([0m[39mshort[0m[1;39m)[0m[39m LittleEndianConsts.SHORT_SIZE;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:        [0m[35m/[0m[35m/[0m[39m double the count, and include the null at the end[0m                    [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:        _name_size[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:            [0m[1;35m.set[0m[1;39m([0m[1;39m([0m[39m short [0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mlimit + [0m[1;36m1[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:                            * LittleEndianConsts.SHORT_SIZE[0m[1;39m)[0m[39m, _raw_data[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:17[0m[39m-[0m[1;36m44[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.poi.poifs.dev;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.ByteBuffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.poi.poifs.common.POIFSConstants;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.poi.poifs.filesystem.DirectoryEntry;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.poi.poifs.filesystem.DocumentInputStream;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.poi.poifs.filesystem.DocumentNode;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.poi.poifs.filesystem.Entry;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.poi.poifs.filesystem.POIFSFileSystem;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.poi.poifs.filesystem.POIFSStream;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.poi.poifs.property.PropertyTable;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.poi.poifs.storage.HeaderBlock;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.poi.util.IOUtils;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m: * Dump internal structure of a OLE2 file into file system[0m                       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:public final class POIFSDump [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    private [0m[1;35mPOIFSDump[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-ooxml/src/main/java/org/apache/poi/xdgf/util/Util.jav[0m[1;92ma:31[0m[39m-[0m[1;36m36[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    [0m[35m/[0m[35m/[0m[39m this probably isn't [0m[1;36m100[0m[39m% correct, so don't use it in security-sensitive[0m   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    [0m[35m/[0m[35m/[0m[39m applications![0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[35m/[0m[35m/[0m[39m from: [0m[4;94mhttp://www.rgagnon.com/javadetails/java-0662.html[0m                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    public static String [0m[1;35msanitizeFilename[0m[1;39m([0m[39mString name[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        return [0m[1;35mname.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m:\\\\/*\"?|<>[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-ooxml/src/test/java/org/apache/poi/poifs/crypt/tests/TestEncryptor.jav[0m[1;92ma:416[0m[39m-[0m[1;36m421[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:    private void [0m[1;35mlistEntry[0m[1;39m([0m[39mDocumentNode de, String ext, String path[0m[1;39m)[0m[39m throws [0m    [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:        path += [0m[32m"\\" + de.getName[0m[32m([0m[32m)[0m[32m.replaceAll[0m[32m([0m[32m"[0m[1;39m[[0m[39m\\p[0m[1;39m{[0m[39mCntrl[0m[1;39m}[0m[1;39m][0m[32m", "[0m[39m_"[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:        [0m[1;35mSystem.out.println[0m[1;39m([0m[39mext+[0m[32m": "[0m[39m+path+[0m[32m" [0m[32m([0m[32m"[0m[39m+[0m[1;35mde.getSize[0m[1;39m([0m[1;39m)[0m[39m+[0m[32m" bytes[0m[32m)[0m[32m"[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:        String name = [0m[1;35mde.getName[0m[1;39m([0m[1;39m)[0m[1;35m.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m\\p[0m[32m{[0m[32mCntrl[0m[32m}[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:68[0m[39m-[0m[1;36m80[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            try [0m[1;39m([0m[39mInputStream is = [0m[1;35mFiles.newInputStream[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:                 POIFSFileSystem fs = new [0m[1;35mPOIFSFileSystem[0m[1;39m([0m[39mis[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:                DirectoryEntry root = [0m[1;35mfs.getRoot[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                String filenameWithoutPath = new [0m[1;35mFile[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:                File dumpDir =[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:                        [0m[1;35mPaths.get[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[1;35m.getParent[0m[1;39m([0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                                [0m[1;35m.resolve[0m[1;39m([0m[39mfilenameWithoutPath + [0m                  [2m                [0m
[2;36m                    [0m         [32m"_dump"[0m[1;39m)[0m[1;35m.toFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                File file = new [0m[1;35mFile[0m[1;39m([0m[39mdumpDir, [0m[1;35mroot.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mfile.exists[0m[1;39m([0m[1;39m)[0m[39m && ![0m[1;35mfile.mkdirs[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Could not create directory "[0m[39m + file[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                [0m[1;35mdump[0m[1;39m([0m[39mroot, file[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:99[0m[39m-[0m[1;36m122[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    public static void [0m[1;35mdump[0m[1;39m([0m[39mDirectoryEntry root, File parent[0m[1;39m)[0m[39m throws IOException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        [0m[1;35mfor[0m[1;39m([0m[39mIterator<Entry> it = [0m[1;35mroot.getEntries[0m[1;39m([0m[1;39m)[0m[39m; [0m[1;35mit.hasNext[0m[1;39m([0m[1;39m)[0m[39m;[0m[1;39m)[0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            Entry entry = [0m[1;35mit.next[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39mentry instanceof DocumentNode[0m[1;39m)[0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                final DocumentNode node = [0m[1;39m([0m[39mDocumentNode[0m[1;39m)[0m[39m entry;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                final byte[0m[1;39m[[0m[1;39m][0m[39m bytes;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                try [0m[1;39m([0m[39mDocumentInputStream is = new [0m[1;35mDocumentInputStream[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:                   bytes = [0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:                try [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m [2m                [0m
[2;36m                    [0m         [1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:                    [0m[1;35mout.write[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mentry instanceof DirectoryEntry[0m[1;39m)[0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                DirectoryEntry dir = [0m[1;39m([0m[39mDirectoryEntry[0m[1;39m)[0m[39mentry;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:                File file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:                [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mfile.exists[0m[1;39m([0m[1;39m)[0m[39m && ![0m[1;35mfile.mkdirs[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Could not create directory "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39mfile[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                [0m[1;35mdump[0m[1;39m([0m[39mdir, file[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                [0m[1;35mSystem.err.println[0m[1;39m([0m[32m"Skipping unsupported POIFS entry: "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39mentry[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/EntryUtils.jav[0m[1;92ma:37[0m[39m-[0m[1;36m58[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * Copies an Entry into a target POIFS directory, recursively[0m                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    @Internal[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    public static void [0m[1;35mcopyNodeRecursively[0m[1;39m([0m[39m Entry entry, DirectoryEntry target [0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    throws IOException [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        if [0m[1;39m([0m[39m [0m[1;35mentry.isDirectoryEntry[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:            DirectoryEntry dirEntry = [0m[1;39m([0m[39mDirectoryEntry[0m[1;39m)[0m[39mentry;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:            DirectoryEntry newTarget = [0m[1;35mtarget.createDirectory[0m[1;39m([0m[39m [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [1;39m)[0m[39m;[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:            [0m[1;35mnewTarget.setStorageClsid[0m[1;39m([0m[39m [0m[1;35mdirEntry.getStorageClsid[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:            Iterator<Entry> entries = [0m[1;35mdirEntry.getEntries[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:            while [0m[1;39m([0m[39m [0m[1;35mentries.hasNext[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:                [0m[1;35mcopyNodeRecursively[0m[1;39m([0m[39m [0m[1;35mentries.next[0m[1;39m([0m[1;39m)[0m[39m, newTarget [0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            DocumentEntry dentry = [0m[1;39m([0m[39mDocumentEntry[0m[1;39m)[0m[39m entry;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:            DocumentInputStream dstream = new [0m[1;35mDocumentInputStream[0m[1;39m([0m[39m dentry [0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            [0m[1;35mtarget.createDocument[0m[1;39m([0m[39m [0m[1;35mdentry.getName[0m[1;39m([0m[1;39m)[0m[39m, dstream [0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:            [0m[1;35mdstream.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/test/java/org/apache/poi/poifs/dev/TestPOIFSDump.jav[0m[1;92ma:141[0m[39m-[0m[1;36m161[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    void [0m[1;35mtestMain[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:        Path tmpDir = [0m[1;35mFiles.createTempDirectory[0m[1;39m([0m[32m"poi-dump-tst-"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:            Path tmpFile = [0m[1;35mtmpDir.resolve[0m[1;39m([0m[32m"46515.xls"[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:            [0m[1;35mFiles.copy[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[39mTEST_FILE[0m[1;39m)[0m[39m, tmpFile[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:            [0m[1;35mPOIFSDump.main[0m[1;39m([0m[39mnew String[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[1;35mtmpFile.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m}[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:            File f = [0m[1;35mtmpFile.toFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            File dump = new [0m[1;35mFile[0m[1;39m([0m[1;35mf.getParent[0m[1;39m([0m[1;39m)[0m[39m, [0m[32m"46515.xls_dump"[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            [0m[1;35massertTrue[0m[1;39m([0m[1;35mdump.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            File root = new [0m[1;35mFile[0m[1;39m([0m[39mdump, [0m[32m"Root Entry"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:            [0m[1;35massertTrue[0m[1;39m([0m[1;35mroot.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:            File compObj = new [0m[1;35mFile[0m[1;39m([0m[39mroot, [0m[32m"CompObj"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:            [0m[1;35massertTrue[0m[1;39m([0m[1;35mcompObj.isFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:            for [0m[1;39m([0m[39mString option : DUMP_[0m[1;33mOPTIONS[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:                [0m[1;35massertDoesNotThrow[0m[1;39m([0m[1;39m([0m[1;39m)[0m[39m -> [0m[1;35mPOIFSDump.main[0m[1;39m([0m[39mnew String[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[39moption,[0m    [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:                        [0m[1;35mf.getAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m}[0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:            [0m[1;35mforceDelete[0m[1;39m([0m[1;35mtmpDir.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mBased on the evaluation report and code snippets, I've identified a critical file [0m  [2m                [0m
[2;36m                    [0m         [39mpath traversal vulnerability in Apache POI's POIFSDump functionality. Here's my [0m    [2m                [0m
[2;36m                    [0m         [39manalysis:[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Root Cause[0m                                                                      [2m                [0m
[2;36m                    [0m         [39mThe vulnerability exists because POIFS entry names [0m[1;39m([0m[39mread directly from binary [0m      [2m                [0m
[2;36m                    [0m         [39mfiles[0m[1;39m)[0m[39m are used unsanitized in file system operations. The POIFS layer correctly [0m   [2m                [0m
[2;36m                    [0m         [39mreads and stores entry names as-is [0m[1;39m([0m[39mby design[0m[1;39m)[0m[39m, but POIFSDump fails to validate [0m    [2m                [0m
[2;36m                    [0m         [39mthese names before using them to construct file paths.[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Vulnerable Locations[0m                                                            [2m                [0m
[2;36m                    [0m         [39mThree specific locations in POIFSDump.java use unsanitized entry names:[0m             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Line [0m[1;36m75[0m[39m** in `[0m[1;35mmain[0m[1;39m([0m[1;39m)[0m[39m`: `new [0m[1;35mFile[0m[1;39m([0m[39mdumpDir, [0m[1;35mroot.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m`[0m                     [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Line [0m[1;36m108[0m[39m** in `[0m[1;35mdump[0m[1;39m([0m[1;39m)[0m[39m`: `new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m`[0m              [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Line [0m[1;36m113[0m[39m** in `[0m[1;35mdump[0m[1;39m([0m[1;39m)[0m[39m`: `new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m`[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Critical Logic to Preserve[0m                                                      [2m                [0m
[2;36m                    [0m         [39m- All entries [0m[1;39m([0m[39mdocuments and directories[0m[1;39m)[0m[39m must be dumped[0m                            [2m                [0m
[2;36m                    [0m         [39m- Directory hierarchy must be maintained[0m                                            [2m                [0m
[2;36m                    [0m         [39m- File contents must be written correctly[0m                                           [2m                [0m
[2;36m                    [0m         [39m- The recursive dump logic must continue working[0m                                    [2m                [0m
[2;36m                    [0m         [39m- The overloaded [0m[1;35mdump[0m[1;39m([0m[1;39m)[0m[39m method [0m[1;39m([0m[39mline [0m[1;36m123[0m[1;39m)[0m[39m that uses literal strings is safe and [0m    [2m                [0m
[2;36m                    [0m         [39mshould not be modified[0m                                                              [2m                [0m
[2;36m                    [0m         [39m- Existing tests expect names like [0m[32m"Root Entry"[0m[39m and [0m[32m"CompObj"[0m[39m to remain largely [0m    [2m                [0m
[2;36m                    [0m         [39munchanged[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Existing Patterns in Codebase[0m                                                   [2m                [0m
[2;36m                    [0m         [39mThe codebase already has a sanitization pattern in [0m                                 [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35morg.apache.poi.xdgf.util.Util.sanitizeFilename[0m[1;39m([0m[1;39m)[0m[39m`:[0m                                 [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mreturn [0m[1;35mname.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m:\\\\/*\"?|<>[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39mThis pattern removes path separators and other problematic filename characters. [0m    [2m                [0m
[2;36m                    [0m         [39mHowever, since POIFSDump is in the `poi` module and this utility is in `poi-ooxml`,[0m [2m                [0m
[2;36m                    [0m         [39mwe should implement local sanitization to avoid module dependencies.[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m1[0m[39m: Implement a Local Sanitization Method[0m                                   [2m                [0m
[2;36m                    [0m         [39mAdd a private static method `[0m[1;35msanitizeFilename[0m[1;39m([0m[1;39m)[0m[39m` in the POIFSDump class that [0m       [2m                [0m
[2;36m                    [0m         [39msanitizes entry names before using them in file system operations:[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: Add after line [0m[1;36m44[0m[39m [0m[1;39m([0m[39mafter the private constructor[0m[1;39m)[0m[39m in POIFSDump.java[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation approach**:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m- Create a method signature: `private static String [0m[1;35msanitizeFilename[0m[1;39m([0m[39mString name[0m[1;39m)[0m[39m`[0m  [2m                [0m
[2;36m                    [0m         [39m- Apply the sanitization pattern: `[0m[1;35mname.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m:\\\\/*\"?|<>[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m`[0m         [2m                [0m
[2;36m                    [0m         [39m- This replaces the following characters with underscores:[0m                          [2m                [0m
[2;36m                    [0m         [39m  - `:` - Colon [0m[1;39m([0m[39mWindows drive separator[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m  - `\\` - Backslash [0m[1;39m([0m[39mWindows path separator[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [39m  - `[0m[35m/[0m[39m` - Forward slash [0m[1;39m([0m[39mUnix path separator, also works on Windows[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [39m  - `*` - Asterisk [0m[1;39m([0m[39mwildcard[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  - `"` - Double quote[0m                                                              [2m                [0m
[2;36m                    [0m         [39m  - `?` - Question mark [0m[1;39m([0m[39mwildcard[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39m  - `|` - Pipe[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m  - `<>` - Angle brackets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m- Add null/empty string handling to return an empty string or default name if input[0m [2m                [0m
[2;36m                    [0m         [39mis null/empty[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m- Optionally trim whitespace before applying the regex to ensure consistent [0m        [2m                [0m
[2;36m                    [0m         [39mbehavior[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- Add a descriptive Javadoc comment explaining the method's purpose: preventing [0m    [2m                [0m
[2;36m                    [0m         [39mpath traversal attacks[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why this approach**:[0m                                                              [2m                [0m
[2;36m                    [0m         [39m- Removes both forward and backward slashes, preventing path traversal sequences [0m   [2m                [0m
[2;36m                    [0m         [39mlike `..[0m[35m/../../../[0m[39m`[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- Preserves alphanumeric characters, spaces, and most punctuation, keeping names [0m   [2m                [0m
[2;36m                    [0m         [39mreadable[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- Consistent with existing POI patterns [0m[1;39m([0m[39mUtil.sanitizeFilename[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [39m- Simple regex-based approach with minimal performance impact[0m                       [2m                [0m
[2;36m                    [0m         [39m- No external dependencies required[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m2[0m[39m: Apply Sanitization at Vulnerable Location #[0m[1;36m1[0m[39m [0m[1;39m([0m[39mLine [0m[1;36m75[0m[39m in [0m[1;35mmain[0m[1;39m([0m[1;39m)[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Current code** [0m[1;39m([0m[39mline [0m[1;36m75[0m[1;39m)[0m[39m:[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mFile file = new [0m[1;35mFile[0m[1;39m([0m[39mdumpDir, [0m[1;35mroot.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Patch approach**:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- Replace `[0m[1;35mroot.getName[0m[1;39m([0m[1;39m)[0m[39m` with `[0m[1;35msanitizeFilename[0m[1;39m([0m[1;35mroot.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m`[0m                  [2m                [0m
[2;36m                    [0m         [39m- This prevents the root entry name from causing path traversal[0m                     [2m                [0m
[2;36m                    [0m         [39m- The sanitized name is used for both the directory creation [0m[1;39m([0m[39mline [0m[1;36m76[0m[39m-[0m[1;36m78[0m[1;39m)[0m[39m and the [0m  [2m                [0m
[2;36m                    [0m         [39mrecursive dump call [0m[1;39m([0m[39mline [0m[1;36m80[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Result**:[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mFile file = new [0m[1;35mFile[0m[1;39m([0m[39mdumpDir, [0m[1;35msanitizeFilename[0m[1;39m([0m[1;35mroot.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m3[0m[39m: Apply Sanitization at Vulnerable Location #[0m[1;36m2[0m[39m [0m[1;39m([0m[39mLine [0m[1;36m108[0m[39m in [0m[1;35mdump[0m[1;39m([0m[1;39m)[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Current code** [0m[1;39m([0m[39mline [0m[1;36m108[0m[1;39m)[0m[39m:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mtry [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m                     [2m                [0m
[2;36m                    [0m         [1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Patch approach**:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- Replace `[0m[1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[39m` with `[0m[1;35msanitizeFilename[0m[1;39m([0m[1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m`[0m           [2m                [0m
[2;36m                    [0m         [39m- The sanitizeFilename method should handle trimming internally, so explicit [0m[1;35mtrim[0m[1;39m([0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39mis no longer needed[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- This prevents document node names from causing path traversal[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Result**:[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mtry [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m                     [2m                [0m
[2;36m                    [0m         [1;35msanitizeFilename[0m[1;39m([0m[1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m4[0m[39m: Apply Sanitization at Vulnerable Location #[0m[1;36m3[0m[39m [0m[1;39m([0m[39mLine [0m[1;36m113[0m[39m in [0m[1;35mdump[0m[1;39m([0m[1;39m)[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Current code** [0m[1;39m([0m[39mline [0m[1;36m113[0m[1;39m)[0m[39m:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mFile file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Patch approach**:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- Replace `[0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[39m` with `[0m[1;35msanitizeFilename[0m[1;39m([0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m`[0m                [2m                [0m
[2;36m                    [0m         [39m- This prevents directory entry names from causing path traversal[0m                   [2m                [0m
[2;36m                    [0m         [39m- The sanitized name is used for directory creation [0m[1;39m([0m[39mline [0m[1;36m114[0m[39m-[0m[1;36m116[0m[1;39m)[0m[39m and recursive [0m   [2m                [0m
[2;36m                    [0m         [39mdump call [0m[1;39m([0m[39mline [0m[1;36m117[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Result**:[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mFile file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35msanitizeFilename[0m[1;39m([0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Justification[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This is the Optimal Approach[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Addresses the Root Cause**: The sanitization directly prevents path traversal [0m [2m                [0m
[2;36m                    [0m         [39mby removing path separators before they can be interpreted by the file system[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Preserves Existing Logic**: [0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - No changes to the recursive dump algorithm[0m                                     [2m                [0m
[2;36m                    [0m         [39m   - No changes to file content extraction or writing[0m                               [2m                [0m
[2;36m                    [0m         [39m   - No changes to directory creation logic[0m                                         [2m                [0m
[2;36m                    [0m         [39m   - Only the entry names are sanitized before use[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Minimal Impact**:[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   - Single, focused sanitization method[0m                                            [2m                [0m
[2;36m                    [0m         [39m   - Applied only at the three vulnerable points[0m                                    [2m                [0m
[2;36m                    [0m         [39m   - No changes to POIFS reading/parsing logic[0m                                      [2m                [0m
[2;36m                    [0m         [39m   - No changes to other dump methods that use safe literal strings[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Consistent with Codebase**:[0m                                                    [2m                [0m
[2;36m                    [0m         [39m   - Follows the pattern already established in [0m                                    [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35morg.apache.poi.xdgf.util.Util.sanitizeFilename[0m[1;39m([0m[1;39m)[0m[39m`[0m                                  [2m                [0m
[2;36m                    [0m         [39m   - Demonstrates awareness of similar patterns in the codebase [0m[1;39m([0m[39mTestEncryptor [0m     [2m                [0m
[2;36m                    [0m         [39mcontrol character removal[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m   - Aligns with security-conscious design shown in ZipSecureFile[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Maintains Usability**:[0m                                                         [2m                [0m
[2;36m                    [0m         [39m   - Legitimate names like [0m[32m"Root Entry"[0m[39m and [0m[32m"CompObj"[0m[39m remain unchanged[0m              [2m                [0m
[2;36m                    [0m         [39m   - Only dangerous characters are replaced with underscores[0m                        [2m                [0m
[2;36m                    [0m         [39m   - Names remain human-readable and recognizable[0m                                   [2m                [0m
[2;36m                    [0m         [39m   - File hierarchy is preserved with safe names[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Addresses the Evaluation Report[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe evaluation report identified a path traversal vulnerability where the path [0m     [2m                [0m
[2;36m                    [0m         [39m`..[0m[35m/../../../[0m[95mjazzer-traversal[0m[39m` was able to escape the intended directory structure.[0m [2m                [0m
[2;36m                    [0m         [39mThis fix:[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Prevents the Attack**: The `[0m[35m/[0m[39m` characters in `..[0m[35m/../../../[0m[39m` will be replaced [0m  [2m                [0m
[2;36m                    [0m         [39mwith `_`, resulting in `____..____..____..____jazzer-traversal`, which is [0m          [2m                [0m
[2;36m                    [0m         [39minterpreted as a single filename rather than a directory traversal sequence[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Secures All Entry Points**: By sanitizing at all three vulnerable locations [0m   [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mroot name, document names, directory names[0m[1;39m)[0m[39m, we ensure complete coverage[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Maintains Functionality**: The fuzzer entry point [0m                             [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mPOIPOIFSDumpFuzzer.fuzzerTestOneInput[0m[1;39m)[0m[39m and the [0m[1;35mPOIFSDump.main[0m[1;39m([0m[1;39m)[0m[39m method continue to[0m [2m                [0m
[2;36m                    [0m         [39mwork exactly as before, just with sanitized filenames[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Potential Side Effects and Mitigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Side Effect #[0m[1;36m1[0m[39m**: Entry names containing legitimate slashes or other replaced [0m    [2m                [0m
[2;36m                    [0m         [39mcharacters will be modified[0m                                                         [2m                [0m
[2;36m                    [0m         [39m- **Mitigation**: This is acceptable because file systems don't allow these [0m        [2m                [0m
[2;36m                    [0m         [39mcharacters in filenames anyway. The alternative [0m[1;39m([0m[39musing the original name[0m[1;39m)[0m[39m would [0m    [2m                [0m
[2;36m                    [0m         [39mfail on most file systems[0m                                                           [2m                [0m
[2;36m                    [0m         [39m- **Impact**: Low - legitimate POIFS files rarely use these characters in entry [0m    [2m                [0m
[2;36m                    [0m         [39mnames[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Side Effect #[0m[1;36m2[0m[39m**: Multiple entries with names that differ only in replaced [0m       [2m                [0m
[2;36m                    [0m         [39mcharacters will collide[0m                                                             [2m                [0m
[2;36m                    [0m         [39m- **Example**: `file/name` and `file\name` both become `file_name`[0m                  [2m                [0m
[2;36m                    [0m         [39m- **Mitigation**: The file system would already handle this [0m[1;39m([0m[39mone would overwrite [0m   [2m                [0m
[2;36m                    [0m         [39mthe other, or mkdirs would fail[0m[1;39m)[0m[39m. This is not a new problem, just a consequence of [0m [2m                [0m
[2;36m                    [0m         [39msanitization[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m- **Impact**: Low - such collisions are rare in legitimate files and represent [0m     [2m                [0m
[2;36m                    [0m         [39mmalicious/malformed input[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Side Effect #[0m[1;36m3[0m[39m**: Existing tests or tools expecting specific filenames may break[0m  [2m                [0m
[2;36m                    [0m         [39m- **Mitigation**: Review the test suite [0m[1;39m([0m[39mTestPOIFSDump.java[0m[1;39m)[0m[39m to ensure expectations[0m [2m                [0m
[2;36m                    [0m         [39mmatch sanitized names[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- **Impact**: Very Low - the test uses legitimate entry names like [0m[32m"Root Entry"[0m[39m and[0m [2m                [0m
[2;36m                    [0m         [32m"CompObj"[0m[39m which contain no dangerous characters and will be unchanged[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Similar Solutions in Codebase[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **[0m[1;35mUtil.sanitizeFilename[0m[1;39m([0m[1;39m)[0m[39m** [0m[1;39m([0m[39mpoi-ooxml module[0m[1;39m)[0m[39m: Uses the exact same regex [0m       [2m                [0m
[2;36m                    [0m         [39mpattern for filename sanitization[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **[0m[1;35mTestEncryptor.listEntry[0m[1;39m([0m[1;39m)[0m[39m**: Shows awareness of the need to sanitize entry [0m    [2m                [0m
[2;36m                    [0m         [39mnames [0m[1;39m([0m[39mthough with insufficient pattern[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **ZipSecureFile**: Demonstrates POI's awareness of path traversal risks and [0m     [2m                [0m
[2;36m                    [0m         [39mvalidation patterns[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix strategy implements a single, focused sanitization method that removes path[0m [2m                [0m
[2;36m                    [0m         [39mtraversal sequences and other dangerous characters from POIFS entry names before [0m   [2m                [0m
[2;36m                    [0m         [39musing them in file system operations. This approach:[0m                                [2m                [0m
[2;36m                    [0m         [39m- Directly addresses the security vulnerability[0m                                     [2m                [0m
[2;36m                    [0m         [39m- Preserves all existing functionality[0m                                              [2m                [0m
[2;36m                    [0m         [39m- Follows established patterns in the codebase[0m                                      [2m                [0m
[2;36m                    [0m         [39m- Requires minimal code changes[0m                                                     [2m                [0m
[2;36m                    [0m         [39m- Has negligible performance impact[0m                                                 [2m                [0m
[2;36m                    [0m         [39m- Maintains backward compatibility for legitimate use cases[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe sanitization is applied at exactly the three points where user-controlled entry[0m [2m                [0m
[2;36m                    [0m         [39mnames are used to construct file system paths, providing complete protection [0m       [2m                [0m
[2;36m                    [0m         [39magainst the identified path traversal vulnerability.[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=200621;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=481306;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=556513;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=384026;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp43h94zgd[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/apache-poi_poi-full-01_vuln_2[0m [2m               [0m
[2;36m                    [0m         [35m/[0m[95magent-output-1767614184.5517542[0m                                                     [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc/apache-poi_poi-full-01_vuln_2.toml      [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-poi[0m              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/05/26 11:56:26][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mapache-poi[0m     ]8;id=344619;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=679169;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=259783;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=200707;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mapache-poi[0m            [2m               [0m
[2;36m[01/05/26 11:56:27][0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=562797;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=280345;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mapache-poi[0m             [2m               [0m
