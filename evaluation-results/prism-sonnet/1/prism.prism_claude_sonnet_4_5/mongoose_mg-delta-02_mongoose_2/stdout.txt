[2;36m[01/06/26 17:33:58][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=582257;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=214200;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmprcy52vij[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/mongoose_mg-delta-02_mongoose[0m [2m               [0m
[2;36m                    [0m         [35m_2/[0m[95magent-output-1767720838.5462713[0m                                                   [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/mongoose_mg-delta-02_mongoose_2.toml                  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-mongoose[0m         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Building Cached for CLEAN environment[1m)[0m          ]8;id=634460;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=786134;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[01/06/26 17:34:06][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Building Cached for CLEAN environment[1m)[0m Took    ]8;id=699611;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=20602;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m7.94[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                 [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running tests for Cached for CLEAN environment[1m)[0m ]8;id=66338;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=594393;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running tests for Cached for CLEAN             ]8;id=1525;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=191481;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=898069;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=931772;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m7[0m[1m)[0m                                                           [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=493313;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=417141;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:34:07][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.87[0m seconds;              ]8;id=9934;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=53411;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=783165;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=196386;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=973930;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=213190;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=893464;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=943484;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=92243;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=810275;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:34:08][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.89[0m seconds;              ]8;id=851754;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=985039;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=261737;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=973905;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:34:09][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.82[0m seconds;              ]8;id=288053;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=433531;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/06/26 17:34:12][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=28291;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=906600;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2506875745[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55868688b708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55868688caa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55868688caa8[0m[39m,[0m[1;36m0x5586868a0448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x558686811c02[0m[39m bp [0m[1;36m0x7fffe2852160[0m[39m sp [0m[1;36m0x7fffe2852158[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x558686811c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x5586867f9d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55868680e8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55868667a350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5586866655c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55868666b05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x558686696302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fa4bb2fc082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55868665d7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55868678611f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55868680e79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55868667a350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5586866655c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55868666b05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x558686696302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fa4bb2fc082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpz8kxnkhj[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2506875745[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55868688b708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55868688caa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55868688caa8[0m[39m,[0m[1;36m0x5586868a0448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x558686811c02[0m[39m bp [0m[1;36m0x7fffe2852160[0m[39m sp [0m[1;36m0x7fffe2852158[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x558686811c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x5586867f9d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55868680e8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55868667a350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5586866655c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55868666b05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x558686696302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fa4bb2fc082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55868665d7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55868678611f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55868680e79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55868667a350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5586866655c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55868666b05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x558686696302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fa4bb2fc082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                   [2m                [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                [2m                [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                       [2m                [0m
[2;36m                    [0m           Heap left redzone:       fa                                                       [2m                [0m
[2;36m                    [0m           Freed heap region:       fd                                                       [2m                [0m
[2;36m                    [0m           Stack left redzone:      f1                                                       [2m                [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                       [2m                [0m
[2;36m                    [0m           Stack right redzone:     f3                                                       [2m                [0m
[2;36m                    [0m           Stack after return:      f5                                                       [2m                [0m
[2;36m                    [0m           Stack use after scope:   f8                                                       [2m                [0m
[2;36m                    [0m           Global redzone:          f9                                                       [2m                [0m
[2;36m                    [0m           Global init order:       f6                                                       [2m                [0m
[2;36m                    [0m           Poisoned by user:        f7                                                       [2m                [0m
[2;36m                    [0m           Container overflow:      fc                                                       [2m                [0m
[2;36m                    [0m           Array cookie:            ac                                                       [2m                [0m
[2;36m                    [0m           Intra object redzone:    bb                                                       [2m                [0m
[2;36m                    [0m           ASan internal:           fe                                                       [2m                [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                       [2m                [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                       [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                      [2m                [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                               [2m                [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64 [2m                [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                    [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpz8kxnkhj[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce     [2m                [0m
[2;36m                    [0m         fuzz -[33mruns[0m=[1;36m100[0m.                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/06/26 17:34:30][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=696454;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=284576;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/06/26 17:38:35][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=507815;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=348309;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/06/26 17:39:32][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=244182;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=991807;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=74213;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=994761;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:39:33][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.95[0m seconds;              ]8;id=984835;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=746471;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Started[33m...[0m                            ]8;id=346303;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=517168;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpuup_fkew[0m                                                 ]8;id=456955;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=285482;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/06/26 17:39:40][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Took [1;36m6.87[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=81604;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=452089;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Started[33m...[0m                      ]8;id=858765;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=579372;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:39:44][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Took [1;36m4.27[0m seconds;             ]8;id=843969;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=461493;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Started[33m...[0m                         ]8;id=296589;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=993460;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:39:46][0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=796603;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=201501;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#102\[2m102[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2841624276[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x558d9ebf2708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x558d9ebf3aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x558d9ebf3aa8[0m[39m,[0m[1;36m0x558d9ec07448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x558d9eb78c02[0m[39m bp [0m[1;36m0x7ffd4e631a40[0m[39m sp [0m[1;36m0x7ffd4e631a38[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x558d9eb78c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x558d9eb60d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x558d9eb758b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x558d9e9e1350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x558d9e9cc5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x558d9e9d205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x558d9e9fd302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fac6cdb6082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x558d9e9c47ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x558d9eaed11f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x558d9eb7579d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x558d9e9e1350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x558d9e9cc5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x558d9e9d205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x558d9e9fd302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fac6cdb6082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmplqrpbfsp[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=772713;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=523623;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#103\[2m103[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2841624276[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x558d9ebf2708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x558d9ebf3aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x558d9ebf3aa8[0m[39m,[0m[1;36m0x558d9ec07448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x558d9eb78c02[0m[39m bp [0m[1;36m0x7ffd4e631a40[0m[39m sp [0m[1;36m0x7ffd4e631a38[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x558d9eb78c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x558d9eb60d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x558d9eb758b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x558d9e9e1350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x558d9e9cc5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x558d9e9d205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x558d9e9fd302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fac6cdb6082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x558d9e9c47ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x558d9eaed11f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x558d9eb7579d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x558d9e9e1350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x558d9e9cc5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x558d9e9d205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x558d9e9fd302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fac6cdb6082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmplqrpbfsp[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [31m╭─[0m[31m──────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m───────────────────────[0m[31m─╮[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/evaluator/services/default/[0m[1m__init__.py[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m :97 in _evaluate_internal                                                        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 94 [0m[2m│   │   [0m[94mwith[0m logging_performance(context, header=[33m"[0m[33mRunning PoV[0m[33m"[0m):           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 95 [0m[2m│   │   │   [0m[94mtry[0m:                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 96 [0m[2m│   │   │   │   [0m[94mif[0m [96mlen[0m(detection.blobs) > [94m0[0m:                               [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 97 [2m│   │   │   │   │   [0menvironment.run_pov(context, detection)                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 98 [0m[2m│   │   │   │   [0m[94melse[0m:                                                      [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 99 [0m[2m│   │   │   │   │   [0mcontext[[33m"[0m[33mlogger[0m[33m"[0m].warning([33m"[0m[33mNo blob data found for the [0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m100 [0m                                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mcached.p[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1my[0m:56 in run_pov                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 53 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, detection: Detection            [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 54 [0m[2m│   [0m) -> [96mtuple[0m[[96mstr[0m, [96mstr[0m]:                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 55 [0m[2m│   │   [0m[94massert[0m [96mlen[0m(detection.blobs) > [94m0[0m, [33m"[0m[33mAt least one blob is required[0m[33m"[0m   [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 56 [2m│   │   [0m[94mreturn[0m [1;4;96mself[0m[1;4m.environment.run_pov(context, detection)[0m                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 57 [0m[2m│   [0m                                                                       [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 58 [0m[2m│   [0m[94mdef[0m[90m [0m[92mrun_tests[0m(                                                         [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 59 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, env: [96mdict[0m[[96mstr[0m, [96mstr[0m] = {}        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mdefault.[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1mpy[0m:210 in run_pov                                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m207 [0m[2m│   │   │   │   [0mcontext, blobinfo.blob, blobinfo.harness_name              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m208 [0m[2m│   │   │   [0m)                                                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m209 [0m[2m│   │   │   [0m[94mif[0m [95mnot[0m success:                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m210 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m ChallengePoVFoundError([0m                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m211 [0m[2m│   │   │   │   │   [0m[1;4mstdout=stdout.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m212 [0m[2m│   │   │   │   │   [0m[1;4mstderr=stderr.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m213 [0m[2m│   │   │   │   [0m[1;4m)[0m                                                          [31m│[0m [2m               [0m
[2;36m                    [0m         [31m╰──────────────────────────────────────────────────────────────────────────────────╯[0m [2m               [0m
[2;36m                    [0m         [1;91mChallengePoVFoundError: [0mPoV found:                                                   [2m               [0m
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2841624276[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x558d9ebf2708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x558d9ebf3aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x558d9ebf3aa8[0m[39m,[0m[1;36m0x558d9ec07448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x558d9eb78c02[0m[39m bp [0m[1;36m0x7ffd4e631a40[0m[39m sp [0m[1;36m0x7ffd4e631a38[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x558d9eb78c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x558d9eb60d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x558d9eb758b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x558d9e9e1350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x558d9e9cc5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x558d9e9d205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x558d9e9fd302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fac6cdb6082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x558d9e9c47ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x558d9eaed11f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x558d9eb7579d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x558d9e9e1350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x558d9e9cc5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x558d9e9d205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x558d9e9fd302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fac6cdb6082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmplqrpbfsp[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/06/26 17:39:47][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Took [1;36m2.32[0m seconds;                ]8;id=663672;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=86748;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=456850;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=503254;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.89[0m seconds;              ]8;id=991570;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=588458;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/06/26 17:39:48][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=43040;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=411338;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:39:49][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.92[0m seconds;              ]8;id=341590;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=452299;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=938141;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=833346;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         +++ b/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-794[0m,[1;36m18[0m +[1;36m794[0m,[1;36m20[0m @@                                                               [2m                [0m
[2;36m                    [0m          static void [1;35mrx_ip[0m[1m([0mstruct mg_tcpip_if *ifp, struct pkt *pkt[1m)[0m [1m{[0m                      [2m                [0m
[2;36m                    [0m            uint16_t frag = [1;35mmg_ntohs[0m[1m([0mpkt->ip->frag[1m)[0m;                                         [2m                [0m
[2;36m                    [0m            if [1m([0mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[1m)[0m [1m{[0m                     [2m                [0m
[2;36m                    [0m         -    if [1m([0mpkt->ip->proto == [1;36m17[0m[1m)[0m pkt->udp = [1m([0mstruct udp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;             [2m                [0m
[2;36m                    [0m         -    if [1m([0mpkt->ip->proto == [1;36m6[0m[1m)[0m pkt->tcp = [1m([0mstruct tcp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;              [2m                [0m
[2;36m                    [0m         +    if [1m([0mpkt->ip->proto == [1;36m17[0m && pkt->pay.len >= [1;35msizeof[0m[1m([0mstruct udp[1m)[0m[1m)[0m                [2m                [0m
[2;36m                    [0m         +      pkt->udp = [1m([0mstruct udp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;                                     [2m                [0m
[2;36m                    [0m         +    if [1m([0mpkt->ip->proto == [1;36m6[0m && pkt->pay.len >= [1;35msizeof[0m[1m([0mstruct tcp[1m)[0m[1m)[0m                 [2m                [0m
[2;36m                    [0m         +      pkt->tcp = [1m([0mstruct tcp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;                                     [2m                [0m
[2;36m                    [0m              struct mg_connection *c = [1;35mgetpeer[0m[1m([0mifp->mgr, pkt, false[1m)[0m;                       [2m                [0m
[2;36m                    [0m              if [1m([0mc[1m)[0m [1;35mmg_error[0m[1m([0mc, [32m"Received fragmented packet"[0m[1m)[0m;                              [2m                [0m
[2;36m                    [0m            [1m}[0m else if [1m([0mpkt->ip->proto == [1;36m1[0m[1m)[0m [1m{[0m                                                [2m                [0m
[2;36m                    [0m         +    if [1m([0mpkt->pay.len [1m<[0m[39m [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m     pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m     pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m        [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m            [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-822[0m[39m,[0m[1;36m8[0m[39m +[0m[1;36m824[0m[39m,[0m[1;36m8[0m[39m @@[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m     pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m     uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-838[0m[39m,[0m[1;36m13[0m[39m +[0m[1;36m840[0m[39m,[0m[1;36m13[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m static void [0m[1;35mrx_ip6[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [39m   [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"IP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m1[0m[39m || pkt->ip6->proto == [0m[1;36m58[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m     pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m     pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"  UDP %u %u -> %u"[0m[39m, len, [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->sport[0m[1;39m)[0m[39m,[0m                   [2m                [0m
[2;36m                    [0m         [39m     [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->dport[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2841624276[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x558d9ebf2708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x558d9ebf3aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x558d9ebf3aa8[0m[39m,[0m[1;36m0x558d9ec07448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x558d9eb78c02[0m[39m bp [0m[1;36m0x7ffd4e631a40[0m[39m sp [0m[1;36m0x7ffd4e631a38[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x558d9eb78c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x558d9eb60d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x558d9eb758b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x558d9e9e1350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x558d9e9cc5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x558d9e9d205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x558d9e9fd302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fac6cdb6082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x558d9e9c47ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x558d9eaed11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x558d9eb7579d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x558d9e9e1350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x558d9e9cc5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x558d9e9d205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x558d9e9fd302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fac6cdb6082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmplqrpbfsp[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2506875745[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55868688b708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55868688caa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55868688caa8[0m[39m,[0m[1;36m0x5586868a0448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x558686811c02[0m[39m bp [0m[1;36m0x7fffe2852160[0m[39m sp [0m[1;36m0x7fffe2852158[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x558686811c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x5586867f9d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55868680e8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55868667a350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5586866655c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55868666b05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x558686696302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fa4bb2fc082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55868665d7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55868678611f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55868680e79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55868667a350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5586866655c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55868666b05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x558686696302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fa4bb2fc082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpz8kxnkhj[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA heap-buffer-overflow vulnerability has been detected in the Mongoose codebase [0m    [2m                [0m
[2;36m                    [0m         [39mduring fuzzing. The issue occurs in the `rx_icmp` function in [0m                      [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m` at line [0m[1;36m385[0m[39m, where a [0m[1;36m1[0m[39m-byte read operation [0m       [2m                [0m
[2;36m                    [0m         [39mattempts to access memory beyond the bounds of a [0m[1;36m34[0m[39m-byte heap-allocated buffer. The[0m [2m                [0m
[2;36m                    [0m         [39moverflow is detected by AddressSanitizer with a scariness score of [0m[1;36m12[0m[39m, indicating a[0m [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m-byte-read-heap-buffer-overflow.[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe issue manifests as a heap-buffer-overflow error during fuzzing operations, [0m     [2m                [0m
[2;36m                    [0m         [39mspecifically when processing ICMP packets in the Mongoose network stack. The [0m       [2m                [0m
[2;36m                    [0m         [39mvulnerability is characterized by the following key details:[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Vulnerability Type**: Heap-buffer-overflow [0m[1;39m([0m[39mread operation[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location and Context**:[0m                                                           [2m                [0m
[2;36m                    [0m         [39m- The overflow occurs at address `[0m[1;36m0x504000000172[0m[39m`, which is located [0m[1;36m0[0m[39m bytes after a[0m [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m-byte allocated region spanning from `[0m[1;36m0x504000000150[0m[39m` to `[0m[1;36m0x504000000172[0m[39m`[0m         [2m                [0m
[2;36m                    [0m         [39m- The problematic read operation happens in the `rx_icmp` function at line [0m[1;36m385[0m[39m of [0m  [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m`[0m                                                   [2m                [0m
[2;36m                    [0m         [39m- This function is called during the packet reception flow through `mg_tcpip_rx` in[0m [2m                [0m
[2;36m                    [0m         [39mthe same file at line [0m[1;36m897[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Call Stack**:[0m                                                                     [2m                [0m
[2;36m                    [0m         [39mThe vulnerability is triggered through the following execution path:[0m                [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. `LLVMFuzzerTestOneInput` [0m[1;39m([0m[39mentry point for fuzzing at [0m                            [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;36m106[0m[39m`[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. `mg_tcpip_rx` [0m[1;39m([0m[39mnetwork packet processing at [0m                                     [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;36m897[0m[39m`[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. `rx_icmp` [0m[1;39m([0m[39mICMP packet handling at `[0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;36m385[0m[39m`[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Memory Allocation Details**:[0m                                                      [2m                [0m
[2;36m                    [0m         [39m- The [0m[1;36m34[0m[39m-byte buffer was allocated in `LLVMFuzzerTestOneInput` at line [0m[1;36m95[0m[39m of [0m       [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m`[0m                                                         [2m                [0m
[2;36m                    [0m         [39m- The buffer allocation appears to be directly related to the fuzzer input data [0m    [2m                [0m
[2;36m                    [0m         [39mprocessing[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m- Shadow byte analysis shows that the accessed address is in a [0m[32m"partially [0m          [2m                [0m
[2;36m                    [0m         [32maddressable"[0m[39m region [0m[1;39m([0m[39mmarked as `[0m[1;36m02[0m[39m` in shadow bytes[0m[1;39m)[0m[39m, indicating that the buffer [0m   [2m                [0m
[2;36m                    [0m         [39mends at this location[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Areas for Investigation**:[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Primary Focus - `[0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m`**:[0m                           [2m                [0m
[2;36m                    [0m         [39m   - The `rx_icmp` function at line [0m[1;36m385[0m[39m requires examination to understand what [0m    [2m                [0m
[2;36m                    [0m         [39mread operation is being performed and why bounds checking is insufficient[0m           [2m                [0m
[2;36m                    [0m         [39m   - The `mg_tcpip_rx` function at line [0m[1;36m897[0m[39m should be reviewed to understand how [0m   [2m                [0m
[2;36m                    [0m         [39mpackets are validated and passed to protocol-specific handlers[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Input Processing - `[0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m`**:[0m                              [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m95[0m[39m where the buffer allocation occurs[0m                                     [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m106[0m[39m where `mg_tcpip_rx` is called[0m                                         [2m                [0m
[2;36m                    [0m         [39m   - Understanding how fuzzer input is transformed into packet data structures[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Packet Structure Handling**:[0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - The `pkt` structure definition and its usage in ICMP packet processing[0m         [2m                [0m
[2;36m                    [0m         [39m   - Size calculations and bounds checking mechanisms for ICMP packets[0m              [2m                [0m
[2;36m                    [0m         [39m   - Any length fields or size parameters used in the ICMP processing logic[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Network Protocol Implementation**:[0m                                             [2m                [0m
[2;36m                    [0m         [39m   - ICMP packet format validation logic[0m                                            [2m                [0m
[2;36m                    [0m         [39m   - Length field parsing and validation[0m                                            [2m                [0m
[2;36m                    [0m         [39m   - Buffer size calculations based on packet headers[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe issue indicates that the code attempts to read beyond the allocated buffer when[0m [2m                [0m
[2;36m                    [0m         [39mprocessing ICMP packets, suggesting either inadequate bounds checking, incorrect [0m   [2m                [0m
[2;36m                    [0m         [39msize calculations, or improper handling of malformed or edge-case packet data that [0m [2m                [0m
[2;36m                    [0m         [39mthe fuzzer is designed to uncover.[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2506875745[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55868688b708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55868688caa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55868688caa8[0m[39m,[0m[1;36m0x5586868a0448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x558686811c02[0m[39m bp [0m[1;36m0x7fffe2852160[0m[39m sp [0m[1;36m0x7fffe2852158[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x558686811c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x5586867f9d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55868680e8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55868667a350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5586866655c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55868666b05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x558686696302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fa4bb2fc082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55868665d7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55868678611f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55868680e79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55868667a350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5586866655c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55868666b05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x558686696302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fa4bb2fc082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpz8kxnkhj[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtest/fuzz.[0m[1;92mc:90[0m[39m-[0m[1;36m110[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    struct mg_mgr mgr;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    [0m[1;35mmg_mgr_init[0m[1;39m([0m[39m&mgr[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    [0m[1;35mmg_tcpip_init[0m[1;39m([0m[39m&mgr, &mif[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[35m/[0m[35m/[0m[39m Make a copy of the random data, in order to modify it[0m                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    void *pkt = [0m[1;35mmalloc[0m[1;39m([0m[39msize[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    struct eth *eth = [0m[1;39m([0m[39mstruct eth *[0m[1;39m)[0m[39m pkt;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39mpkt, data, size[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    if [0m[1;39m([0m[39msize > [0m[1;35msizeof[0m[1;39m([0m[39m*eth[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:      static size_t i;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:      uint16_t eth_types[0m[1;39m[[0m[1;39m][0m[39m = [0m[1;39m{[0m[1;36m0x800[0m[39m, [0m[1;36m0x800[0m[39m, [0m[1;36m0x806[0m[39m, [0m[1;36m0x86dd[0m[1;39m}[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39meth->dst, mif.mac, [0m[1;36m6[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Set valid destination MAC[0m               [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:      eth->type = [0m[1;35mmg_htons[0m[1;39m([0m[39meth_types[0m[1;39m[[0m[39mi++[0m[1;39m][0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:      if [0m[1;39m([0m[39mi >= [0m[1;35msizeof[0m[1;39m([0m[39meth_types[0m[1;39m)[0m[39m [0m[35m/[0m[39m [0m[1;35msizeof[0m[1;39m([0m[39meth_types[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[1;39m)[0m[39m i = [0m[1;36m0[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:    [0m[1;35mmg_tcpip_rx[0m[1;39m([0m[39m&mif, pkt, size[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    [0m[35m/[0m[35m/[0m[39m Test HTTP serving[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    const char *url = [0m[32m"http://localhost:12345"[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    struct mg_connection *c = [0m[1;35mmg_http_connect[0m[1;39m([0m[39m&mgr, url, fn, NULL[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:129[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:struct pkt [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:  struct mg_str raw;  [0m[35m/[0m[35m/[0m[39m Raw packet data[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:  struct mg_str pay;  [0m[35m/[0m[35m/[0m[39m Payload data[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:  struct eth *eth;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:  struct llc *llc;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:  struct arp *arp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:  struct ip *ip;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:  struct ip6 *ip6;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:  struct icmp *icmp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:  struct tcp *tcp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:  struct udp *udp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:  struct dhcp *dhcp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:static void [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, int ev, void *ev_data[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:  if [0m[1;39m([0m[39mifp->fn != NULL[0m[1;39m)[0m[39m ifp->[0m[1;35mfn[0m[1;39m([0m[39mifp, ev, ev_data[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:static void [0m[1;35msend_syn[0m[1;39m([0m[39mstruct mg_connection *c[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:72[0m[39m-[0m[1;36m76[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:struct icmp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  uint8_t type;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint8_t code;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  uint16_t csum;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:854[0m[39m-[0m[1;36m901[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m854[0m[39m:void [0m[1;35mmg_tcpip_rx[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, void *buf, size_t len[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m855[0m[39m:  struct pkt pkt;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m856[0m[39m:  [0m[1;35mmemset[0m[1;39m([0m[39m&pkt, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mpkt[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m857[0m[39m:  pkt.raw.buf = [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m buf;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m858[0m[39m:  pkt.raw.len = len;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m859[0m[39m:  pkt.eth = [0m[1;39m([0m[39mstruct eth *[0m[1;39m)[0m[39m buf;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m860[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_hexdump[0m[1;39m([0m[39mbuf, len > [0m[1;36m16[0m[39m ? [0m[1;36m16[0m[39m: len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m861[0m[39m:  if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated - runt?[0m             [2m                [0m
[2;36m                    [0m         [1;36m862[0m[39m:  if [0m[1;39m([0m[39mifp->enable_mac_check &&[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m863[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, ifp->mac, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[39m &&[0m              [2m                [0m
[2;36m                    [0m         [1;36m864[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, broadcast, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m865[0m[39m:    return;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m866[0m[39m:  if [0m[1;39m([0m[39mifp->enable_crc32_check && len > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m867[0m[39m:    len -= [0m[1;36m4[0m[39m;  [0m[35m/[0m[35m/[0m[39m [0m[1;35mTODO[0m[1;39m([0m[39mscaprile[0m[1;39m)[0m[39m: check on bigendian[0m                            [2m                [0m
[2;36m                    [0m         [1;36m868[0m[39m:    uint32_t crc = [0m[1;35mmg_crc32[0m[1;39m([0m[1;36m0[0m[39m, [0m[1;39m([0m[39mconst char *[0m[1;39m)[0m[39m buf, len[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m869[0m[39m:    if [0m[1;39m([0m[1;35mmemcmp[0m[1;39m([0m[1;39m([0m[39mvoid *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m buf + len[0m[1;39m)[0m[39m, &crc, [0m[1;35msizeof[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m return;[0m       [2m                [0m
[2;36m                    [0m         [1;36m870[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m871[0m[39m:  if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x806[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m872[0m[39m:    pkt.arp = [0m[1;39m([0m[39mstruct arp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m873[0m[39m:    if [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.arp[0m[1;39m)[0m[39m > pkt.raw.len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m874[0m[39m:    [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mifp, MG_TCPIP_EV_ARP, &pkt.raw[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m875[0m[39m:    [0m[1;35mrx_arp[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m876[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x86dd[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m877[0m[39m:    pkt.ip6 = [0m[1;39m([0m[39mstruct ip6 *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m878[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip6[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m879[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip6->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m0x6[0m[1;39m)[0m[39m return;                         [0m[35m/[0m[35m/[0m[39m Not IP[0m   [2m                [0m
[2;36m                    [0m         [1;36m880[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m881[0m[39m:    [0m[1;35mrx_ip6[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m897[0m[39m:  [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m898[0m[39m:    [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"Unknown eth type %x"[0m[39m, [0m[1;35mmg_htons[0m[1;39m([0m[39mpkt.eth->type[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m899[0m[39m:    if [0m[1;39m([0m[39mmg_log_level >= MG_LL_VERBOSE[0m[1;39m)[0m[39m [0m[1;35mmg_hexdump[0m[1;39m([0m[39mbuf, len >= [0m[1;36m32[0m[39m ? [0m[1;36m32[0m[39m : len[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m900[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m901[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:838[0m[39m-[0m[1;36m852[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m838[0m[39m:static void [0m[1;35mrx_ip6[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m839[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"IP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m840[0m[39m:  if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m1[0m[39m || pkt->ip6->proto == [0m[1;36m58[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m841[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m842[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m843[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m844[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m845[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m846[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m847[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m848[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"  UDP %u %u -> %u"[0m[39m, len, [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->sport[0m[1;39m)[0m[39m,[0m                [2m                [0m
[2;36m                    [0m         [1;36m849[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->dport[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m850[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m851[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m852[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:871[0m[39m-[0m[1;36m875[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m871[0m[39m:  if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x806[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m872[0m[39m:    pkt.arp = [0m[1;39m([0m[39mstruct arp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m873[0m[39m:    if [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.arp[0m[1;39m)[0m[39m > pkt.raw.len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m874[0m[39m:    [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mifp, MG_TCPIP_EV_ARP, &pkt.raw[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m875[0m[39m:    [0m[1;35mrx_arp[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m835[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:906[0m[39m-[0m[1;36m907[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m906[0m[39m:  ifp->now = now;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m907[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:72[0m[39m-[0m[1;36m76[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:struct icmp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  uint8_t type;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint8_t code;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  uint16_t csum;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:90[0m[39m-[0m[1;36m108[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:struct tcp [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:  uint16_t sport;  [0m[35m/[0m[35m/[0m[39m Source port[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:  uint16_t dport;  [0m[35m/[0m[35m/[0m[39m Destination port[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:  uint32_t seq;    [0m[35m/[0m[35m/[0m[39m Sequence number[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:  uint32_t ack;    [0m[35m/[0m[35m/[0m[39m Acknowledgement number[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:  uint8_t off;     [0m[35m/[0m[35m/[0m[39m Data offset[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:  uint8_t flags;   [0m[35m/[0m[35m/[0m[39m TCP flags[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:#define TH_FIN [0m[1;36m0x01[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:#define TH_SYN [0m[1;36m0x02[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:#define TH_RST [0m[1;36m0x04[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:#define TH_PUSH [0m[1;36m0x08[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:#define TH_ACK [0m[1;36m0x10[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:#define TH_URG [0m[1;36m0x20[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:#define TH_ECE [0m[1;36m0x40[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:#define TH_CWR [0m[1;36m0x80[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:  uint16_t win;   [0m[35m/[0m[35m/[0m[39m Window[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:  uint16_t urp;   [0m[35m/[0m[35m/[0m[39m Urgent pointer[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:110[0m[39m-[0m[1;36m115[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:struct udp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:  uint16_t sport;  [0m[35m/[0m[35m/[0m[39m Source port[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:  uint16_t dport;  [0m[35m/[0m[35m/[0m[39m Destination port[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:  uint16_t len;    [0m[35m/[0m[35m/[0m[39m UDP length[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:  uint16_t csum;   [0m[35m/[0m[35m/[0m[39m UDP checksum[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m820[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:398[0m[39m-[0m[1;36m404[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:static void [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:  uint32_t ip = [0m[1;36m0[0m[39m, gw = [0m[1;36m0[0m[39m, mask = [0m[1;36m0[0m[39m, lease = [0m[1;36m0[0m[39m, dns = [0m[1;36m0[0m[39m, sntp = [0m[1;36m0[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:  uint8_t msgtype = [0m[1;36m0[0m[39m, state = ifp->state;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:  [0m[35m/[0m[35m/[0m[39m perform size check first, then access fields[0m                               [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:  uint8_t *p = pkt->dhcp->options,[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:          *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:  if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:459[0m[39m-[0m[1;36m462[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m459[0m[39m:static void [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m460[0m[39m:  uint8_t op = [0m[1;36m0[0m[39m, *p = pkt->dhcp->options,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m461[0m[39m:          *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m462[0m[39m:  if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:117[0m[39m-[0m[1;36m125[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:struct dhcp [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:  uint8_t op, htype, hlen, hops;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:  uint32_t xid;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:  uint16_t secs, flags;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:  uint32_t ciaddr, yiaddr, siaddr, giaddr;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:  uint8_t hwaddr[0m[1;39m[[0m[1;36m208[0m[1;39m][0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:  uint32_t magic;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:  uint8_t options[0m[1;39m[[0m[1;36m32[0m[1;39m][0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:871[0m[39m-[0m[1;36m875[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m871[0m[39m:  if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x806[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m872[0m[39m:    pkt.arp = [0m[1;39m([0m[39mstruct arp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m873[0m[39m:    if [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.arp[0m[1;39m)[0m[39m > pkt.raw.len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m874[0m[39m:    [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mifp, MG_TCPIP_EV_ARP, &pkt.raw[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m875[0m[39m:    [0m[1;35mrx_arp[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:806[0m[39m-[0m[1;36m809[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:824[0m[39m-[0m[1;36m827[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:871[0m[39m-[0m[1;36m875[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m871[0m[39m:  if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x806[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m872[0m[39m:    pkt.arp = [0m[1;39m([0m[39mstruct arp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m873[0m[39m:    if [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.arp[0m[1;39m)[0m[39m > pkt.raw.len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m874[0m[39m:    [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mifp, MG_TCPIP_EV_ARP, &pkt.raw[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m875[0m[39m:    [0m[1;35mrx_arp[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:838[0m[39m-[0m[1;36m852[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m838[0m[39m:static void [0m[1;35mrx_ip6[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m839[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"IP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m840[0m[39m:  if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m1[0m[39m || pkt->ip6->proto == [0m[1;36m58[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m841[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m842[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m843[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m844[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m845[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m846[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m847[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m848[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"  UDP %u %u -> %u"[0m[39m, len, [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->sport[0m[1;39m)[0m[39m,[0m                [2m                [0m
[2;36m                    [0m         [1;36m849[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->dport[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m850[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m851[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m852[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis of the Vulnerability[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter thorough analysis of the code snippets and evaluation report, I've identified[0m [2m                [0m
[2;36m                    [0m         [39mthe root cause of the heap-buffer-overflow vulnerability:[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Core Issue[0m                                                                      [2m                [0m
[2;36m                    [0m         [39mThe vulnerability occurs in the `rx_ip` and `rx_ip6` functions where [0m               [2m                [0m
[2;36m                    [0m         [39mprotocol-specific header pointers [0m[1;39m([0m[39mICMP, UDP, TCP, DHCP[0m[1;39m)[0m[39m are assigned **before** [0m   [2m                [0m
[2;36m                    [0m         [39mvalidating that sufficient space exists in the raw buffer. The code then attempts [0m  [2m                [0m
[2;36m                    [0m         [39mto access fields from these potentially out-of-bounds pointers, causing the [0m        [2m                [0m
[2;36m                    [0m         [39mheap-buffer-overflow.[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Specific Problem in the Crash Case[0m                                              [2m                [0m
[2;36m                    [0m         [39mIn the reported crash with a [0m[1;36m34[0m[39m-byte buffer:[0m                                        [2m                [0m
[2;36m                    [0m         [39m- Ethernet header: [0m[1;36m14[0m[39m bytes[0m                                                         [2m                [0m
[2;36m                    [0m         [39m- IP header: [0m[1;36m20[0m[39m bytes[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- **Total: [0m[1;36m34[0m[39m bytes [0m[1;39m([0m[39mno space for ICMP header[0m[1;39m)[0m[39m**[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mWhen processing this packet:[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. `rx_ip` line [0m[1;36m802[0m[39m: `pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m` - Sets pointer to [0m [2m                [0m
[2;36m                    [0m         [39mbyte [0m[1;36m34[0m[39m [0m[1;39m([0m[39mbeyond buffer[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. `rx_ip` line [0m[1;36m803[0m[39m: `if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;` - Check [0m      [2m                [0m
[2;36m                    [0m         [39moccurs AFTER pointer assignment[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. `rx_icmp` line [0m[1;36m384[0m[39m: `if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m [0m[33m...[0m[1;39m)[0m[39m` - **CRASH** attempting to [0m   [2m                [0m
[2;36m                    [0m         [39mread from out-of-bounds memory[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Pattern Analysis[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Vulnerable Pattern [0m[1;39m([0m[39mcurrent code[0m[1;39m)[0m[39m:**[0m                                              [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mpkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;     [0m[35m/[0m[35m/[0m[39m Set pointer WITHOUT validation[0m    [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return; [0m[35m/[0m[35m/[0m[39m Check AFTER assignment[0m            [2m                [0m
[2;36m                    [0m         [1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;                      [0m[35m/[0m[35m/[0m[39m Uses potentially invalid pointer[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Correct Pattern [0m[1;39m([0m[39mfrom ARP handling at line [0m[1;36m871[0m[39m-[0m[1;36m875[0m[1;39m)[0m[39m:**[0m                            [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mpkt.arp = [0m[1;39m([0m[39mstruct arp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.arp[0m[1;39m)[0m[39m > pkt.raw.len[0m[1;39m)[0m[39m return; [0m[35m/[0m[35m/[0m[39m Check raw buffer [0m [2m                [0m
[2;36m                    [0m         [39mbounds[0m                                                                              [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Safe to use pkt.arp[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Comprehensive Fix Strategy[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m1[0m[39m: Identify All Vulnerable Locations[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**In `rx_ip` function [0m[1;39m([0m[39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m836[0m[1;39m)[0m[39m:**[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Line [0m[1;36m802[0m[39m [0m[1;39m([0m[39mICMP[0m[1;39m)[0m[39m:** Assignment before validation[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Line [0m[1;36m807[0m[39m [0m[1;39m([0m[39mUDP[0m[1;39m)[0m[39m:** Assignment before validation[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Line [0m[1;36m814[0m[39m [0m[1;39m([0m[39mDHCP client[0m[1;39m)[0m[39m:** Assignment before validation [0m[1;39m([0m[39mwithin UDP branch[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Line [0m[1;36m818[0m[39m [0m[1;39m([0m[39mDHCP server[0m[1;39m)[0m[39m:** Assignment before validation [0m[1;39m([0m[39mwithin UDP branch[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Line [0m[1;36m825[0m[39m [0m[1;39m([0m[39mTCP[0m[1;39m)[0m[39m:** Assignment before validation[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Lines [0m[1;36m797[0m[39m-[0m[1;36m798[0m[39m [0m[1;39m([0m[39mFragmented packets[0m[1;39m)[0m[39m:** UDP and TCP assignments without [0m         [2m                [0m
[2;36m                    [0m         [39mvalidation[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**In `rx_ip6` function [0m[1;39m([0m[39msrc/net_builtin.[0m[1;92mc:838[0m[39m-[0m[1;36m852[0m[1;39m)[0m[39m:**[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Line [0m[1;36m841[0m[39m [0m[1;39m([0m[39mICMP[0m[1;39m)[0m[39m:** Assignment before validation[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Line [0m[1;36m846[0m[39m [0m[1;39m([0m[39mUDP[0m[1;39m)[0m[39m:** Assignment before validation[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m2[0m[39m: Apply Consistent Fix Pattern[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mFor each vulnerable location, **reorder the operations** to validate BEFORE [0m        [2m                [0m
[2;36m                    [0m         [39massigning pointers:[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Fix for ICMP in rx_ip [0m[1;39m([0m[39mlines [0m[1;36m801[0m[39m-[0m[1;36m805[0m[1;39m)[0m[39m:[0m                                         [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Check bounds BEFORE setting pointer[0m                                          [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Fix for UDP in rx_ip [0m[1;39m([0m[39mlines [0m[1;36m806[0m[39m-[0m[1;36m823[0m[1;39m)[0m[39m:[0m                                          [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Check bounds BEFORE setting pointer[0m                                          [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [39m                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m             [2m                [0m
[2;36m                    [0m         [39m                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [39m        [0m[35m/[0m[35m/[0m[39m DHCP handlers have their own validation at lines [0m[1;36m404[0m[39m and [0m[1;36m462[0m             [2m                [0m
[2;36m                    [0m         [39m        pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [39m        pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Fix for TCP in rx_ip [0m[1;39m([0m[39mlines [0m[1;36m824[0m[39m-[0m[1;36m835[0m[1;39m)[0m[39m:[0m                                          [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Check bounds BEFORE setting pointer[0m                                          [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [39m    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [39m                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m             [2m                [0m
[2;36m                    [0m         [39m                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Fix for fragmented packets in rx_ip [0m[1;39m([0m[39mlines [0m[1;36m796[0m[39m-[0m[1;36m800[0m[1;39m)[0m[39m:[0m                           [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Add bounds checking before setting pointers[0m                                  [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[39m && pkt->pay.len >= [0m[1;35msizeof[0m[1;39m([0m[39mstruct udp[0m[1;39m)[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [39m        pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[39m && pkt->pay.len >= [0m[1;35msizeof[0m[1;39m([0m[39mstruct tcp[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [39m        pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Fix for ICMP in rx_ip6 [0m[1;39m([0m[39mlines [0m[1;36m840[0m[39m-[0m[1;36m844[0m[1;39m)[0m[39m:[0m                                        [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m1[0m[39m || pkt->ip6->proto == [0m[1;36m58[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Check bounds BEFORE setting pointer[0m                                          [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Fix for UDP in rx_ip6 [0m[1;39m([0m[39mlines [0m[1;36m845[0m[39m-[0m[1;36m851[0m[1;39m)[0m[39m:[0m                                         [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Check bounds BEFORE setting pointer[0m                                          [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m3[0m[39m: Verification of Correctness[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why `pkt->pay.len` is the correct value to check:**[0m                               [2m                [0m
[2;36m                    [0m         [39m- In `mg_tcpip_rx` [0m[1;39m([0m[39mlines [0m[1;36m891[0m[39m-[0m[1;36m894[0m[1;39m)[0m[39m, `mkpay` is called to set `pkt.pay` after [0m       [2m                [0m
[2;36m                    [0m         [39mvalidating the IP header[0m                                                            [2m                [0m
[2;36m                    [0m         [39m- `mkpay` calculates `pkt->pay.len` as the distance from `[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m` to the end[0m [2m                [0m
[2;36m                    [0m         [39mof `pkt->raw.buf`[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- This represents exactly the remaining space available for protocol headers and [0m   [2m                [0m
[2;36m                    [0m         [39mdata[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m- Checking `pkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct protocol[0m[1;39m)[0m[39m` validates there's enough space [0m [2m                [0m
[2;36m                    [0m         [39mbefore dereferencing[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why this fix preserves existing logic:**[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The bounds checks already exist in the code [0m[1;39m([0m[39mlines [0m[1;36m803[0m[39m, [0m[1;36m808[0m[39m, [0m[1;36m826[0m[39m, [0m[1;36m842[0m[39m, [0m[1;36m847[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. We're only **reordering** them to occur before pointer assignment[0m                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. The `mkpay` and protocol-specific handler calls remain unchanged[0m                 [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. All existing functionality is preserved[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why this addresses the vulnerability:**[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Prevents setting pointers to out-of-bounds memory locations[0m                      [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Ensures `mkpay` never receives an invalid pointer[0m                                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Guarantees protocol handlers only receive validated packet structures[0m            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Follows the established safe pattern used in ARP handling[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m4[0m[39m: Side Effects and Mitigation[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential Side Effects:**[0m                                                         [2m                [0m
[2;36m                    [0m         [39m- [0m[3;35mNone[0m[39m expected - this is a pure reordering of existing validation logic[0m            [2m                [0m
[2;36m                    [0m         [39m- The early return behavior is identical to current code[0m                            [2m                [0m
[2;36m                    [0m         [39m- No changes to external APIs or data structures[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Testing Considerations:**[0m                                                         [2m                [0m
[2;36m                    [0m         [39m- Existing tests should pass unchanged since valid packets are unaffected[0m           [2m                [0m
[2;36m                    [0m         [39m- Malformed packets will be rejected earlier [0m[1;39m([0m[39mat pointer assignment[0m[1;39m)[0m[39m instead of [0m    [2m                [0m
[2;36m                    [0m         [39mlater [0m[1;39m([0m[39min handler functions[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [39m- Fuzzing should no longer trigger the heap-buffer-overflow[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Justification[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis fix strategy is optimal because:[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Minimal Changes:** Only reorders existing code without adding new logic[0m        [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Consistent Pattern:** Applies the same safe pattern used in ARP handling [0m      [2m                [0m
[2;36m                    [0m         [39mthroughout the codebase[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Defense in Depth:** Validates at the earliest possible point before memory [0m    [2m                [0m
[2;36m                    [0m         [39maccess[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Preserves Functionality:** All valid packets are processed identically[0m         [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Comprehensive:** Addresses all vulnerable locations in both IPv4 and IPv6 [0m     [2m                [0m
[2;36m                    [0m         [39mpaths[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **No Breaking Changes:** Doesn't modify external APIs, test harnesses, or [0m       [2m                [0m
[2;36m                    [0m         [39mfuzzing logic[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe root cause is a simple ordering issue: the code validates buffer bounds but [0m    [2m                [0m
[2;36m                    [0m         [39mdoes so after already dereferencing the pointer. Moving the validation before the [0m  [2m                [0m
[2;36m                    [0m         [39mpointer assignment eliminates the vulnerability while maintaining all existing [0m     [2m                [0m
[2;36m                    [0m         [39mfunctionality.[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/06/26 17:40:14][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=451800;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=557605;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/06/26 17:43:06][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=896273;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=60861;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/06/26 17:44:10][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=555139;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=394848;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=238695;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=607118;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:44:11][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.87[0m seconds;              ]8;id=21390;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=642071;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Started[33m...[0m                            ]8;id=889676;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=481574;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpb49qi4k3[0m                                                 ]8;id=969041;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=265232;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/06/26 17:44:18][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Took [1;36m6.83[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=538125;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=765518;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Started[33m...[0m                      ]8;id=634444;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=870447;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:44:22][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Took [1;36m4.30[0m seconds;             ]8;id=391388;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=148808;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Started[33m...[0m                         ]8;id=378464;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=222586;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:44:24][0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=685474;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=782315;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#102\[2m102[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3119659427[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x56050fb00708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x56050fb01aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x56050fb01aa8[0m[39m,[0m[1;36m0x56050fb15448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x56050fa86c02[0m[39m bp [0m[1;36m0x7ffdccc8e2e0[0m[39m sp [0m[1;36m0x7ffdccc8e2d8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x56050fa86c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x56050fa6ed1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x56050fa838b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x56050f8ef350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x56050f8da5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x56050f8e005f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x56050f90b302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fb7da447082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x56050f8d27ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x56050f9fb11f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x56050fa8379d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x56050f8ef350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x56050f8da5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x56050f8e005f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x56050f90b302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fb7da447082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpk2ai_mgq[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/06/26 17:44:25][0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=73715;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=540789;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#103\[2m103[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3119659427[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x56050fb00708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x56050fb01aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x56050fb01aa8[0m[39m,[0m[1;36m0x56050fb15448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x56050fa86c02[0m[39m bp [0m[1;36m0x7ffdccc8e2e0[0m[39m sp [0m[1;36m0x7ffdccc8e2d8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x56050fa86c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x56050fa6ed1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x56050fa838b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x56050f8ef350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x56050f8da5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x56050f8e005f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x56050f90b302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fb7da447082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x56050f8d27ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x56050f9fb11f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x56050fa8379d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x56050f8ef350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x56050f8da5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x56050f8e005f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x56050f90b302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fb7da447082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpk2ai_mgq[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [31m╭─[0m[31m──────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m───────────────────────[0m[31m─╮[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/evaluator/services/default/[0m[1m__init__.py[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m :97 in _evaluate_internal                                                        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 94 [0m[2m│   │   [0m[94mwith[0m logging_performance(context, header=[33m"[0m[33mRunning PoV[0m[33m"[0m):           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 95 [0m[2m│   │   │   [0m[94mtry[0m:                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 96 [0m[2m│   │   │   │   [0m[94mif[0m [96mlen[0m(detection.blobs) > [94m0[0m:                               [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 97 [2m│   │   │   │   │   [0menvironment.run_pov(context, detection)                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 98 [0m[2m│   │   │   │   [0m[94melse[0m:                                                      [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 99 [0m[2m│   │   │   │   │   [0mcontext[[33m"[0m[33mlogger[0m[33m"[0m].warning([33m"[0m[33mNo blob data found for the [0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m100 [0m                                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mcached.p[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1my[0m:56 in run_pov                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 53 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, detection: Detection            [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 54 [0m[2m│   [0m) -> [96mtuple[0m[[96mstr[0m, [96mstr[0m]:                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 55 [0m[2m│   │   [0m[94massert[0m [96mlen[0m(detection.blobs) > [94m0[0m, [33m"[0m[33mAt least one blob is required[0m[33m"[0m   [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 56 [2m│   │   [0m[94mreturn[0m [1;4;96mself[0m[1;4m.environment.run_pov(context, detection)[0m                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 57 [0m[2m│   [0m                                                                       [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 58 [0m[2m│   [0m[94mdef[0m[90m [0m[92mrun_tests[0m(                                                         [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 59 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, env: [96mdict[0m[[96mstr[0m, [96mstr[0m] = {}        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mdefault.[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1mpy[0m:210 in run_pov                                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m207 [0m[2m│   │   │   │   [0mcontext, blobinfo.blob, blobinfo.harness_name              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m208 [0m[2m│   │   │   [0m)                                                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m209 [0m[2m│   │   │   [0m[94mif[0m [95mnot[0m success:                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m210 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m ChallengePoVFoundError([0m                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m211 [0m[2m│   │   │   │   │   [0m[1;4mstdout=stdout.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m212 [0m[2m│   │   │   │   │   [0m[1;4mstderr=stderr.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m213 [0m[2m│   │   │   │   [0m[1;4m)[0m                                                          [31m│[0m [2m               [0m
[2;36m                    [0m         [31m╰──────────────────────────────────────────────────────────────────────────────────╯[0m [2m               [0m
[2;36m                    [0m         [1;91mChallengePoVFoundError: [0mPoV found:                                                   [2m               [0m
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3119659427[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x56050fb00708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x56050fb01aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x56050fb01aa8[0m[39m,[0m[1;36m0x56050fb15448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x56050fa86c02[0m[39m bp [0m[1;36m0x7ffdccc8e2e0[0m[39m sp [0m[1;36m0x7ffdccc8e2d8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x56050fa86c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x56050fa6ed1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x56050fa838b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x56050f8ef350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x56050f8da5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x56050f8e005f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x56050f90b302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fb7da447082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x56050f8d27ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x56050f9fb11f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x56050fa8379d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x56050f8ef350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x56050f8da5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x56050f8e005f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x56050f90b302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fb7da447082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpk2ai_mgq[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Took [1;36m2.24[0m seconds;                ]8;id=330040;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=772633;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=855353;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=20487;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.82[0m seconds;              ]8;id=710444;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=753827;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/06/26 17:44:26][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=873861;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=387035;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:44:27][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.88[0m seconds;              ]8;id=227437;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=840417;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=703301;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=108528;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         +++ b/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-792[0m,[1;36m20[0m +[1;36m792[0m,[1;36m24[0m @@                                                               [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          static void [1;35mrx_ip[0m[1m([0mstruct mg_tcpip_if *ifp, struct pkt *pkt[1m)[0m [1m{[0m                      [2m                [0m
[2;36m                    [0m         +  uint8_t ip_hlen = [1m([0mpkt->ip->ver & [1;36m0xF[0m[1m)[0m * [1;36m4[0m;                                      [2m                [0m
[2;36m                    [0m         +  void *ip_payload = [1m([0mchar *[1m)[0mpkt->ip + ip_hlen;                                    [2m                [0m
[2;36m                    [0m            uint16_t frag = [1;35mmg_ntohs[0m[1m([0mpkt->ip->frag[1m)[0m;                                         [2m                [0m
[2;36m                    [0m            if [1m([0mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[1m)[0m [1m{[0m                     [2m                [0m
[2;36m                    [0m         -    if [1m([0mpkt->ip->proto == [1;36m17[0m[1m)[0m pkt->udp = [1m([0mstruct udp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;             [2m                [0m
[2;36m                    [0m         -    if [1m([0mpkt->ip->proto == [1;36m6[0m[1m)[0m pkt->tcp = [1m([0mstruct tcp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;              [2m                [0m
[2;36m                    [0m         +    if [1m([0mpkt->ip->proto == [1;36m17[0m && pkt->pay.len >= [1;35msizeof[0m[1m([0mstruct udp[1m)[0m[1m)[0m                [2m                [0m
[2;36m                    [0m         +      pkt->udp = [1m([0mstruct udp *[1m)[0m ip_payload;                                        [2m                [0m
[2;36m                    [0m         +    if [1m([0mpkt->ip->proto == [1;36m6[0m && pkt->pay.len >= [1;35msizeof[0m[1m([0mstruct tcp[1m)[0m[1m)[0m                 [2m                [0m
[2;36m                    [0m         +      pkt->tcp = [1m([0mstruct tcp *[1m)[0m ip_payload;                                        [2m                [0m
[2;36m                    [0m              struct mg_connection *c = [1;35mgetpeer[0m[1m([0mifp->mgr, pkt, false[1m)[0m;                       [2m                [0m
[2;36m                    [0m              if [1m([0mc[1m)[0m [1;35mmg_error[0m[1m([0mc, [32m"Received fragmented packet"[0m[1m)[0m;                              [2m                [0m
[2;36m                    [0m            [1m}[0m else if [1m([0mpkt->ip->proto == [1;36m1[0m[1m)[0m [1m{[0m                                                [2m                [0m
[2;36m                    [0m         -    pkt->icmp = [1m([0mstruct icmp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;                                     [2m                [0m
[2;36m                    [0m         -    if [1m([0mpkt->pay.len [1m<[0m[39m [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m+    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m ip_payload;[0m                                        [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [39m-    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m+    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m ip_payload;[0m                                          [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m        [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m            [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-822[0m[39m,[0m[1;36m11[0m[39m +[0m[1;36m826[0m[39m,[0m[1;36m11[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m-    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m+    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m ip_payload;[0m                                          [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m-    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [39m+    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip_hlen + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m        [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m            [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-838[0m[39m,[0m[1;36m13[0m[39m +[0m[1;36m842[0m[39m,[0m[1;36m13[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m static void [0m[1;35mrx_ip6[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [39m   [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"IP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m1[0m[39m || pkt->ip6->proto == [0m[1;36m58[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m     pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m     pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"  UDP %u %u -> %u"[0m[39m, len, [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->sport[0m[1;39m)[0m[39m,[0m                   [2m                [0m
[2;36m                    [0m         [39m     [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->dport[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3119659427[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x56050fb00708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x56050fb01aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x56050fb01aa8[0m[39m,[0m[1;36m0x56050fb15448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x56050fa86c02[0m[39m bp [0m[1;36m0x7ffdccc8e2e0[0m[39m sp [0m[1;36m0x7ffdccc8e2d8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x56050fa86c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x56050fa6ed1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x56050fa838b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x56050f8ef350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x56050f8da5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x56050f8e005f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x56050f90b302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fb7da447082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x56050f8d27ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x56050f9fb11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x56050fa8379d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x56050f8ef350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x56050f8da5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x56050f8e005f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x56050f90b302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fb7da447082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpk2ai_mgq[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2506875745[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55868688b708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55868688caa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55868688caa8[0m[39m,[0m[1;36m0x5586868a0448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x558686811c02[0m[39m bp [0m[1;36m0x7fffe2852160[0m[39m sp [0m[1;36m0x7fffe2852158[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x558686811c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x5586867f9d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55868680e8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55868667a350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5586866655c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55868666b05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x558686696302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fa4bb2fc082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55868665d7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55868678611f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55868680e79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55868667a350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5586866655c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55868666b05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x558686696302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fa4bb2fc082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpz8kxnkhj[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m         [39mThe initial issue is a heap-buffer-overflow vulnerability detected by [0m              [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer in the `rx_icmp` function at line [0m[1;36m385[0m[39m of [0m                          [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m`. The error involves a [0m[1;36m1[0m[39m-byte read access beyond [0m  [2m                [0m
[2;36m                    [0m         [39mthe bounds of a [0m[1;36m34[0m[39m-byte allocated heap region. A patch was attempted that reordered[0m [2m                [0m
[2;36m                    [0m         [39mvalidation checks in the `rx_ip` and `rx_ip6` functions to check buffer sizes [0m      [2m                [0m
[2;36m                    [0m         [39mbefore assigning pointers to protocol structures. However, after applying the [0m      [2m                [0m
[2;36m                    [0m         [39mpatch, the same heap-buffer-overflow error persists at the identical location with [0m [2m                [0m
[2;36m                    [0m         [39mthe same characteristics.[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Initial Issue Analysis[0m                                                          [2m                [0m
[2;36m                    [0m         [39mThe AddressSanitizer report indicates a heap-buffer-overflow occurring in the [0m      [2m                [0m
[2;36m                    [0m         [39m`rx_icmp` function at line [0m[1;36m385[0m[39m of `net_builtin.c`. The stack trace shows:[0m           [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The error originates in `[0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m`[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Called from `mg_tcpip_rx` at line [0m[1;36m897[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Triggered by `LLVMFuzzerTestOneInput` in the fuzz harness at line [0m[1;36m106[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe memory violation details:[0m                                                       [2m                [0m
[2;36m                    [0m         [39m- Attempting to READ [0m[1;36m1[0m[39m byte at address `[0m[1;36m0x504000000172[0m[39m`[0m                             [2m                [0m
[2;36m                    [0m         [39m- This address is [0m[1;36m0[0m[39m bytes after a [0m[1;36m34[0m[39m-byte region `[0m[1;39m[[0m[1;36m0x504000000150[0m[39m, [0m[1;36m0x504000000172[0m[1;39m)[0m[39m`[0m [2m                [0m
[2;36m                    [0m         [39m- The [0m[1;36m34[0m[39m-byte region was allocated in `LLVMFuzzerTestOneInput` at line [0m[1;36m95[0m           [2m                [0m
[2;36m                    [0m         [39m- The overflow occurs when trying to read [0m[1;36m1[0m[39m byte immediately after the allocated [0m   [2m                [0m
[2;36m                    [0m         [39mbuffer[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Patch Attempt Description[0m                                                       [2m                [0m
[2;36m                    [0m         [39mThe patch modifies the `rx_ip` and `rx_ip6` functions in `net_builtin.c` by:[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **For fragmented packets** [0m[1;39m([0m[39mlines [0m[1;36m797[0m[39m-[0m[1;36m800[0m[1;39m)[0m[39m:[0m                                      [2m                [0m
[2;36m                    [0m         [39m   - Added size checks before assigning UDP and TCP pointers[0m                        [2m                [0m
[2;36m                    [0m         [39m   - Changed from: `if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m [2m                [0m
[2;36m                    [0m         [1;36m1[0m[1;39m)[0m[39m;`[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m   - Changed to: `if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[39m && pkt->pay.len >= [0m[1;35msizeof[0m[1;39m([0m[39mstruct udp[0m[1;39m)[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mpkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;`[0m                                           [2m                [0m
[2;36m                    [0m         [39m   - Similar change for TCP [0m[1;39m([0m[39mproto == [0m[1;36m6[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **For ICMP packets** [0m[1;39m([0m[39mlines [0m[1;36m803[0m[39m-[0m[1;36m806[0m[1;39m)[0m[39m:[0m                                            [2m                [0m
[2;36m                    [0m         [39m   - Moved size validation BEFORE pointer assignment[0m                                [2m                [0m
[2;36m                    [0m         [39m   - Changed from: Assign `pkt->icmp` first, then check `if [0m[1;39m([0m[39mpkt->pay.len < [0m        [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;`[0m                                                        [2m                [0m
[2;36m                    [0m         [39m   - Changed to: Check `if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[1;39m)[0m[39m return;` first, [0m    [2m                [0m
[2;36m                    [0m         [39mthen assign `pkt->icmp`[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **For UDP packets** [0m[1;39m([0m[39mlines [0m[1;36m809[0m[39m-[0m[1;36m811[0m[1;39m)[0m[39m:[0m                                             [2m                [0m
[2;36m                    [0m         [39m   - Applied the same reordering as ICMP[0m                                            [2m                [0m
[2;36m                    [0m         [39m   - Validate size before assignment instead of after[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **For TCP packets** [0m[1;39m([0m[39mlines [0m[1;36m827[0m[39m-[0m[1;36m829[0m[1;39m)[0m[39m:[0m                                             [2m                [0m
[2;36m                    [0m         [39m   - Applied the same reordering pattern[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **In rx_ip6 function** [0m[1;39m([0m[39mlines [0m[1;36m843[0m[39m-[0m[1;36m851[0m[1;39m)[0m[39m:[0m                                          [2m                [0m
[2;36m                    [0m         [39m   - Applied similar reordering for ICMP and UDP protocols[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Post-Patch Results[0m                                                              [2m                [0m
[2;36m                    [0m         [39mAfter applying the patch, the fuzzer produces an identical error:[0m                   [2m                [0m
[2;36m                    [0m         [39m- Same error location: `rx_icmp` function at line [0m[1;36m385[0m                               [2m                [0m
[2;36m                    [0m         [39m- Same address violation: `[0m[1;36m0x504000000172[0m[39m` [0m[1;39m([0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m- Same stack trace structure[0m                                                        [2m                [0m
[2;36m                    [0m         [39m- Same SCARINESS score: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m- Same DEDUP_TOKEN indicating identical error signature[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis indicates that the patch did not address the root cause of the buffer overflow[0m [2m                [0m
[2;36m                    [0m         [39min the `rx_icmp` function.[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas Requiring Further Investigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **The `rx_icmp` function at line [0m[1;36m385[0m[39m**: The actual overflow occurs within this [0m  [2m                [0m
[2;36m                    [0m         [39mfunction, not in the validation logic that was patched. The code at this specific [0m  [2m                [0m
[2;36m                    [0m         [39mline needs examination to understand what operation causes the [0m[1;36m1[0m[39m-byte read beyond [0m  [2m                [0m
[2;36m                    [0m         [39mthe buffer.[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **The `mkpay` function**: The patch shows calls to `[0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m` [0m  [2m                [0m
[2;36m                    [0m         [39mafter validation. This function may be involved in setting up the payload pointer [0m  [2m                [0m
[2;36m                    [0m         [39mand could be miscalculating buffer boundaries.[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Buffer size calculation in the harness**: The [0m[1;36m34[0m[39m-byte allocation in [0m           [2m                [0m
[2;36m                    [0m         [39m`LLVMFuzzerTestOneInput` at line [0m[1;36m95[0m[39m may be insufficient for the test case, though [0m  [2m                [0m
[2;36m                    [0m         [39mthis is likely the fuzzer intentionally testing boundary conditions.[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **The relationship between `pkt->pay.len` and actual buffer size**: The [0m         [2m                [0m
[2;36m                    [0m         [39mvalidation checks `pkt->pay.len >= [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m` but the overflow still [0m     [2m                [0m
[2;36m                    [0m         [39moccurs, suggesting that either:[0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - The `pkt->pay.len` field doesn't accurately reflect available buffer space[0m     [2m                [0m
[2;36m                    [0m         [39m   - The validation is being bypassed somehow[0m                                       [2m                [0m
[2;36m                    [0m         [39m   - The overflow occurs during subsequent processing within `rx_icmp` on data that[0m [2m                [0m
[2;36m                    [0m         [39mappears valid[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **The complete call chain**: Understanding how `mg_tcpip_rx` [0m[1;39m([0m[39mline [0m[1;36m897[0m[1;39m)[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mprocesses the packet and what state the `pkt` structure is in when it reaches [0m      [2m                [0m
[2;36m                    [0m         [39m`rx_icmp` would provide context for why the overflow occurs despite the added [0m      [2m                [0m
[2;36m                    [0m         [39mchecks.[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **ICMP packet structure handling**: Since the overflow consistently occurs in [0m   [2m                [0m
[2;36m                    [0m         [39mICMP processing, a detailed examination of how ICMP packets are parsed, validated, [0m [2m                [0m
[2;36m                    [0m         [39mand processed throughout the entire packet handling pipeline is necessary.[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2506875745[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55868688b708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55868688caa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55868688caa8[0m[39m,[0m[1;36m0x5586868a0448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x558686811c02[0m[39m bp [0m[1;36m0x7fffe2852160[0m[39m sp [0m[1;36m0x7fffe2852158[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x558686811c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x5586867f9d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55868680e8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55868667a350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5586866655c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55868666b05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x558686696302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fa4bb2fc082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55868665d7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55868678611f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55868680e79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55868667a350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5586866655c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55868666b05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x558686696302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fa4bb2fc082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpz8kxnkhj[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2841624276[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x558d9ebf2708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x558d9ebf3aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x558d9ebf3aa8[0m[39m,[0m[1;36m0x558d9ec07448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x558d9eb78c02[0m[39m bp [0m[1;36m0x7ffd4e631a40[0m[39m sp [0m[1;36m0x7ffd4e631a38[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x558d9eb78c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x558d9eb60d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x558d9eb758b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x558d9e9e1350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x558d9e9cc5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x558d9e9d205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x558d9e9fd302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fac6cdb6082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x558d9e9c47ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x558d9eaed11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x558d9eb7579d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x558d9e9e1350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x558d9e9cc5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x558d9e9d205f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x558d9e9fd302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fac6cdb6082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmplqrpbfsp[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:854[0m[39m-[0m[1;36m901[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m854[0m[39m:void [0m[1;35mmg_tcpip_rx[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, void *buf, size_t len[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m855[0m[39m:  struct pkt pkt;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m856[0m[39m:  [0m[1;35mmemset[0m[1;39m([0m[39m&pkt, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mpkt[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m857[0m[39m:  pkt.raw.buf = [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m buf;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m858[0m[39m:  pkt.raw.len = len;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m859[0m[39m:  pkt.eth = [0m[1;39m([0m[39mstruct eth *[0m[1;39m)[0m[39m buf;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m860[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_hexdump[0m[1;39m([0m[39mbuf, len > [0m[1;36m16[0m[39m ? [0m[1;36m16[0m[39m: len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m861[0m[39m:  if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated - runt?[0m             [2m                [0m
[2;36m                    [0m         [1;36m862[0m[39m:  if [0m[1;39m([0m[39mifp->enable_mac_check &&[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m863[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, ifp->mac, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[39m &&[0m              [2m                [0m
[2;36m                    [0m         [1;36m864[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, broadcast, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m865[0m[39m:    return;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m866[0m[39m:  if [0m[1;39m([0m[39mifp->enable_crc32_check && len > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m867[0m[39m:    len -= [0m[1;36m4[0m[39m;  [0m[35m/[0m[35m/[0m[39m [0m[1;35mTODO[0m[1;39m([0m[39mscaprile[0m[1;39m)[0m[39m: check on bigendian[0m                            [2m                [0m
[2;36m                    [0m         [1;36m868[0m[39m:    uint32_t crc = [0m[1;35mmg_crc32[0m[1;39m([0m[1;36m0[0m[39m, [0m[1;39m([0m[39mconst char *[0m[1;39m)[0m[39m buf, len[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m869[0m[39m:    if [0m[1;39m([0m[1;35mmemcmp[0m[1;39m([0m[1;39m([0m[39mvoid *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m buf + len[0m[1;39m)[0m[39m, &crc, [0m[1;35msizeof[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m return;[0m       [2m                [0m
[2;36m                    [0m         [1;36m870[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m871[0m[39m:  if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x806[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m872[0m[39m:    pkt.arp = [0m[1;39m([0m[39mstruct arp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m873[0m[39m:    if [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.arp[0m[1;39m)[0m[39m > pkt.raw.len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m874[0m[39m:    [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mifp, MG_TCPIP_EV_ARP, &pkt.raw[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m875[0m[39m:    [0m[1;35mrx_arp[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m876[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x86dd[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m877[0m[39m:    pkt.ip6 = [0m[1;39m([0m[39mstruct ip6 *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m878[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip6[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m879[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip6->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m0x6[0m[1;39m)[0m[39m return;                         [0m[35m/[0m[35m/[0m[39m Not IP[0m   [2m                [0m
[2;36m                    [0m         [1;36m880[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m881[0m[39m:    [0m[1;35mrx_ip6[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m897[0m[39m:  [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m898[0m[39m:    [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"Unknown eth type %x"[0m[39m, [0m[1;35mmg_htons[0m[1;39m([0m[39mpkt.eth->type[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m899[0m[39m:    if [0m[1;39m([0m[39mmg_log_level >= MG_LL_VERBOSE[0m[1;39m)[0m[39m [0m[1;35mmg_hexdump[0m[1;39m([0m[39mbuf, len >= [0m[1;36m32[0m[39m ? [0m[1;36m32[0m[39m : len[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m900[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m901[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:891[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m800[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:838[0m[39m-[0m[1;36m852[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m838[0m[39m:static void [0m[1;35mrx_ip6[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m839[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"IP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m840[0m[39m:  if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m1[0m[39m || pkt->ip6->proto == [0m[1;36m58[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m841[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m842[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m843[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m844[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m845[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m846[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m847[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m848[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"  UDP %u %u -> %u"[0m[39m, len, [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->sport[0m[1;39m)[0m[39m,[0m                [2m                [0m
[2;36m                    [0m         [1;36m849[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->dport[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m850[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m851[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m852[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:72[0m[39m-[0m[1;36m76[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:struct icmp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  uint8_t type;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint8_t code;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  uint16_t csum;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:824[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:891[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:854[0m[39m-[0m[1;36m901[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m854[0m[39m:void [0m[1;35mmg_tcpip_rx[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, void *buf, size_t len[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m855[0m[39m:  struct pkt pkt;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m856[0m[39m:  [0m[1;35mmemset[0m[1;39m([0m[39m&pkt, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mpkt[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m857[0m[39m:  pkt.raw.buf = [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m buf;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m858[0m[39m:  pkt.raw.len = len;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m859[0m[39m:  pkt.eth = [0m[1;39m([0m[39mstruct eth *[0m[1;39m)[0m[39m buf;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m860[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_hexdump[0m[1;39m([0m[39mbuf, len > [0m[1;36m16[0m[39m ? [0m[1;36m16[0m[39m: len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m861[0m[39m:  if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated - runt?[0m             [2m                [0m
[2;36m                    [0m         [1;36m862[0m[39m:  if [0m[1;39m([0m[39mifp->enable_mac_check &&[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m863[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, ifp->mac, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[39m &&[0m              [2m                [0m
[2;36m                    [0m         [1;36m864[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, broadcast, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m865[0m[39m:    return;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m866[0m[39m:  if [0m[1;39m([0m[39mifp->enable_crc32_check && len > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m867[0m[39m:    len -= [0m[1;36m4[0m[39m;  [0m[35m/[0m[35m/[0m[39m [0m[1;35mTODO[0m[1;39m([0m[39mscaprile[0m[1;39m)[0m[39m: check on bigendian[0m                            [2m                [0m
[2;36m                    [0m         [1;36m868[0m[39m:    uint32_t crc = [0m[1;35mmg_crc32[0m[1;39m([0m[1;36m0[0m[39m, [0m[1;39m([0m[39mconst char *[0m[1;39m)[0m[39m buf, len[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m869[0m[39m:    if [0m[1;39m([0m[1;35mmemcmp[0m[1;39m([0m[1;39m([0m[39mvoid *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m buf + len[0m[1;39m)[0m[39m, &crc, [0m[1;35msizeof[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m return;[0m       [2m                [0m
[2;36m                    [0m         [1;36m870[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m871[0m[39m:  if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x806[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m872[0m[39m:    pkt.arp = [0m[1;39m([0m[39mstruct arp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m873[0m[39m:    if [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.arp[0m[1;39m)[0m[39m > pkt.raw.len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m874[0m[39m:    [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mifp, MG_TCPIP_EV_ARP, &pkt.raw[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m875[0m[39m:    [0m[1;35mrx_arp[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m876[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x86dd[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m877[0m[39m:    pkt.ip6 = [0m[1;39m([0m[39mstruct ip6 *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m878[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip6[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m879[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip6->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m0x6[0m[1;39m)[0m[39m return;                         [0m[35m/[0m[35m/[0m[39m Not IP[0m   [2m                [0m
[2;36m                    [0m         [1;36m880[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m881[0m[39m:    [0m[1;35mrx_ip6[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m897[0m[39m:  [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m898[0m[39m:    [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"Unknown eth type %x"[0m[39m, [0m[1;35mmg_htons[0m[1;39m([0m[39mpkt.eth->type[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m899[0m[39m:    if [0m[1;39m([0m[39mmg_log_level >= MG_LL_VERBOSE[0m[1;39m)[0m[39m [0m[1;35mmg_hexdump[0m[1;39m([0m[39mbuf, len >= [0m[1;36m32[0m[39m ? [0m[1;36m32[0m[39m : len[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m900[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m901[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m800[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:129[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:struct pkt [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:  struct mg_str raw;  [0m[35m/[0m[35m/[0m[39m Raw packet data[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:  struct mg_str pay;  [0m[35m/[0m[35m/[0m[39m Payload data[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:  struct eth *eth;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:  struct llc *llc;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:  struct arp *arp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:  struct ip *ip;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:  struct ip6 *ip6;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:  struct icmp *icmp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:  struct tcp *tcp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:  struct udp *udp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:  struct dhcp *dhcp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:static void [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, int ev, void *ev_data[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:  if [0m[1;39m([0m[39mifp->fn != NULL[0m[1;39m)[0m[39m ifp->[0m[1;35mfn[0m[1;39m([0m[39mifp, ev, ev_data[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:static void [0m[1;35msend_syn[0m[1;39m([0m[39mstruct mg_connection *c[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:813[0m[39m-[0m[1;36m820[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:398[0m[39m-[0m[1;36m404[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:static void [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:  uint32_t ip = [0m[1;36m0[0m[39m, gw = [0m[1;36m0[0m[39m, mask = [0m[1;36m0[0m[39m, lease = [0m[1;36m0[0m[39m, dns = [0m[1;36m0[0m[39m, sntp = [0m[1;36m0[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:  uint8_t msgtype = [0m[1;36m0[0m[39m, state = ifp->state;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:  [0m[35m/[0m[35m/[0m[39m perform size check first, then access fields[0m                               [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:  uint8_t *p = pkt->dhcp->options,[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:          *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:  if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:459[0m[39m-[0m[1;36m462[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m459[0m[39m:static void [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m460[0m[39m:  uint8_t op = [0m[1;36m0[0m[39m, *p = pkt->dhcp->options,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m461[0m[39m:          *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m462[0m[39m:  if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:807[0m[39m-[0m[1;36m809[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:891[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:838[0m[39m-[0m[1;36m852[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m838[0m[39m:static void [0m[1;35mrx_ip6[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m839[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"IP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m840[0m[39m:  if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m1[0m[39m || pkt->ip6->proto == [0m[1;36m58[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m841[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m842[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m843[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m844[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m845[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m846[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m847[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m848[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"  UDP %u %u -> %u"[0m[39m, len, [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->sport[0m[1;39m)[0m[39m,[0m                [2m                [0m
[2;36m                    [0m         [1;36m849[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->dport[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m850[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m851[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m852[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe root cause of the heap-buffer-overflow has been identified through careful [0m     [2m                [0m
[2;36m                    [0m         [39manalysis of the code snippets:[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**The Issue:**[0m                                                                      [2m                [0m
[2;36m                    [0m         [39mThe crash occurs because of inconsistent IPv4 header length calculation between [0m    [2m                [0m
[2;36m                    [0m         [39m`mg_tcpip_rx` and `rx_ip` functions. Specifically:[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. In `mg_tcpip_rx` [0m[1;39m([0m[39mlines [0m[1;36m891[0m[39m-[0m[1;36m894[0m[1;39m)[0m[39m, when IPv4 options are present [0m[1;39m([0m[39mIHL > [0m[1;36m5[0m[1;39m)[0m[39m, the [0m  [2m                [0m
[2;36m                    [0m         [39mcode correctly calculates the IP header end position as `[0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m        [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[39m` and calls `mkpay` with this pointer.[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. However, in `rx_ip` [0m[1;39m([0m[39mlines [0m[1;36m802[0m[39m, [0m[1;36m807[0m[39m, [0m[1;36m825[0m[1;39m)[0m[39m, protocol headers [0m[1;39m([0m[39mICMP, UDP, TCP[0m[1;39m)[0m[39m are[0m [2m                [0m
[2;36m                    [0m         [39massigned using `[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m`, which is equivalent to `[0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + [0m          [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m` = `[0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + [0m[1;36m20[0m[39m bytes`. This ignores IPv4 options.[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. When a packet has IPv4 options [0m[1;39m([0m[39me.g., [0m[33mIHL[0m[39m=[0m[1;36m6[0m[39m means [0m[1;36m24[0m[39m-byte header[0m[1;39m)[0m[39m:[0m               [2m                [0m
[2;36m                    [0m         [39m   - `pkt->pay` correctly points after byte [0m[1;36m24[0m[39m [0m[1;39m([0m[1;36m14[0m[39m eth + [0m[1;36m24[0m[39m IP[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [39m   - `pkt->icmp` incorrectly points after byte [0m[1;36m20[0m[39m [0m[1;39m([0m[1;36m14[0m[39m eth + [0m[1;36m20[0m[39m IP[0m[1;39m)[0m[39m - into the [0m      [2m                [0m
[2;36m                    [0m         [39moptions area[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m   - When `rx_icmp` accesses `pkt->icmp->type` at line [0m[1;36m384[0m[39m, it reads from the wrong[0m [2m                [0m
[2;36m                    [0m         [39mmemory location[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m   - With a [0m[1;36m34[0m[39m-byte packet, this can read beyond the buffer boundary[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why Previous Patch Failed:**[0m                                                      [2m                [0m
[2;36m                    [0m         [39mThe previous patch reordered validation checks to occur before pointer assignment, [0m [2m                [0m
[2;36m                    [0m         [39mbut it didn't fix the fundamental pointer calculation error. The validation checked[0m [2m                [0m
[2;36m                    [0m         [39m`pkt->pay.len`, which was correctly calculated, but the protocol header pointers [0m   [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`pkt->icmp`, `pkt->udp`, `pkt->tcp`[0m[1;39m)[0m[39m were still calculated incorrectly.[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m1[0m[39m: Calculate IP Header Length in `rx_ip`[0m                                   [2m                [0m
[2;36m                    [0m         [39mAt the beginning of the `rx_ip` function, calculate the actual IP header length [0m    [2m                [0m
[2;36m                    [0m         [39musing the IHL field:[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39muint8_t ip_hlen = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;  [0m[35m/[0m[35m/[0m[39m IP header length in bytes[0m           [2m                [0m
[2;36m                    [0m         [39mvoid *ip_payload = [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen;  [0m[35m/[0m[35m/[0m[39m Start of protocol data[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m2[0m[39m: Fix All Protocol Header Pointer Assignments[0m                             [2m                [0m
[2;36m                    [0m         [39mReplace all instances of `[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m` with the correctly calculated `ip_payload`[0m [2m                [0m
[2;36m                    [0m         [39mpointer:[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**For fragmented packets [0m[1;39m([0m[39mlines [0m[1;36m797[0m[39m-[0m[1;36m798[0m[1;39m)[0m[39m:**[0m                                         [2m                [0m
[2;36m                    [0m         [39m- Change `pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;` to `pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mip_payload;`[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m- Change `pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;` to `pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mip_payload;`[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**For ICMP packets [0m[1;39m([0m[39mline [0m[1;36m802[0m[1;39m)[0m[39m:**[0m                                                    [2m                [0m
[2;36m                    [0m         [39m- Change `pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;` to `pkt->icmp = [0m[1;39m([0m[39mstruct icmp [0m [2m                [0m
[2;36m                    [0m         [39m*[0m[1;39m)[0m[39m ip_payload;`[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**For UDP packets [0m[1;39m([0m[39mline [0m[1;36m807[0m[1;39m)[0m[39m:**[0m                                                     [2m                [0m
[2;36m                    [0m         [39m- Change `pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;` to `pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mip_payload;`[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**For TCP packets [0m[1;39m([0m[39mline [0m[1;36m825[0m[1;39m)[0m[39m:**[0m                                                     [2m                [0m
[2;36m                    [0m         [39m- Change `pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;` to `pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mip_payload;`[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m3[0m[39m: Maintain Previous Patch's Validation Logic[0m                              [2m                [0m
[2;36m                    [0m         [39mKeep the reordered validation checks from the previous patch to ensure size checks [0m [2m                [0m
[2;36m                    [0m         [39moccur before pointer assignment. This provides defense-in-depth even though the [0m    [2m                [0m
[2;36m                    [0m         [39mroot cause is being fixed.[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m4[0m[39m: Fix TCP Offset Calculation[0m                                              [2m                [0m
[2;36m                    [0m         [39mAt line [0m[1;36m829[0m[39m, the TCP offset calculation uses `[0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m` which is always [0m[1;36m20[0m[39m:[0m [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39muint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mChange this to use the calculated `ip_hlen`:[0m                                        [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39muint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip_hlen + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m5[0m[39m: Ensure Consistency with mkpay Calls[0m                                     [2m                [0m
[2;36m                    [0m         [39mThe `mkpay` calls for protocol payloads remain unchanged since they use `pkt->icmp [0m [2m                [0m
[2;36m                    [0m         [39m+ [0m[1;36m1[0m[39m`, `pkt->udp + [0m[1;36m1[0m[39m`, `pkt->tcp + [0m[1;36m1[0m[39m`, which are correct once the protocol header [0m   [2m                [0m
[2;36m                    [0m         [39mpointers are fixed.[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Justification[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why This Is Optimal:**[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Addresses Root Cause**: Fixes the fundamental pointer calculation error that [0m  [2m                [0m
[2;36m                    [0m         [39mcauses the heap-buffer-overflow[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Maintains Consistency**: Uses the same IP header length calculation as [0m        [2m                [0m
[2;36m                    [0m         [39m`mg_tcpip_rx`[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Preserves Existing Logic**: Doesn't change the overall packet processing flow[0m  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Standards Compliant**: Correctly handles IPv4 packets with options per RFC [0m[1;36m791[0m [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Minimal Changes**: Only modifies the pointer calculations, not the validation [0m [2m                [0m
[2;36m                    [0m         [39mor processing logic[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**How It Preserves Existing Logic:**[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. All validation checks remain intact [0m[1;39m([0m[39mboth original and from previous patch[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Packet processing flow is unchanged[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Protocol-specific handlers [0m[1;39m([0m[39m`rx_icmp`, `rx_udp`, `rx_tcp`[0m[1;39m)[0m[39m receive correctly [0m    [2m                [0m
[2;36m                    [0m         [39minitialized packet structures[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. IPv6 handling is unaffected [0m[1;39m([0m[39malready correct[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**How It Addresses the Evaluation Report:**[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Fixes the crash at line [0m[1;36m385[0m[39m by ensuring `pkt->icmp` points to the actual ICMP [0m   [2m                [0m
[2;36m                    [0m         [39mheader[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Handles the [0m[1;36m34[0m[39m-byte test case correctly by accounting for IPv4 options[0m           [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Makes the validation at line [0m[1;36m803[0m[39m meaningful since the pointer being validated [0m   [2m                [0m
[2;36m                    [0m         [39mmatches the payload[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Eliminates the discrepancy between `pkt->pay` and protocol header pointers[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential Side Effects:**[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **[0m[3;35mNone[0m[39m Expected**: This fix makes the code behave as intended - correctly [0m       [2m                [0m
[2;36m                    [0m         [39mparsing IPv4 packets with options[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **No Breaking Changes**: Standard IPv4 packets without options [0m[1;39m([0m[33mIHL[0m[39m=[0m[1;36m5[0m[1;39m)[0m[39m will work[0m [2m                [0m
[2;36m                    [0m         [39mexactly as before since `ip_hlen` will be [0m[1;36m20[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Improved Robustness**: The code will now handle IPv4 options correctly, which [0m [2m                [0m
[2;36m                    [0m         [39mit should have done all along[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Similar Solutions in Codebase:**[0m                                                  [2m                [0m
[2;36m                    [0m         [39mThe fix follows the exact pattern already implemented in `mg_tcpip_rx` at lines [0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m-[0m[1;36m894[0m[39m, which correctly handles IPv4 options when initializing the payload [0m        [2m                [0m
[2;36m                    [0m         [39mpointer. This fix extends that same logic to the protocol-specific pointer [0m         [2m                [0m
[2;36m                    [0m         [39massignments in `rx_ip`.[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/06/26 17:44:54][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=407368;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=447795;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m3[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/06/26 17:48:46][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=291179;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=470213;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m3[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/06/26 17:50:02][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=679557;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=159542;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m3[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=499344;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=212927;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.81[0m seconds;              ]8;id=992839;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=386459;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/06/26 17:50:03][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Started[33m...[0m                            ]8;id=827292;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=252203;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp791ddbxy[0m                                                 ]8;id=834414;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=35796;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/06/26 17:50:10][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Took [1;36m6.93[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=916003;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=233158;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Started[33m...[0m                      ]8;id=981685;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=561486;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:50:14][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Took [1;36m4.27[0m seconds;             ]8;id=217377;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=952202;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Started[33m...[0m                         ]8;id=836243;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=358423;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:50:16][0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=240914;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=539052;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#102\[2m102[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3471293335[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55ed4bedc708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x55ed4beddaa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55ed4beddaa8[0m[39m,[0m[1;36m0x55ed4bef1448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x55ed4be62c02[0m[39m bp [0m[1;36m0x7ffdcad351c0[0m[39m sp [0m[1;36m0x7ffdcad351b8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55ed4be62c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55ed4be4ad1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55ed4be5f8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55ed4bccb350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55ed4bcb65c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55ed4bcbc05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55ed4bce7302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f4f9d909082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55ed4bcae7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55ed4bdd711f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55ed4be5f79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55ed4bccb350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55ed4bcb65c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55ed4bcbc05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55ed4bce7302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f4f9d909082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpp9asns7b[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=18270;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=649158;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#103\[2m103[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3471293335[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55ed4bedc708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x55ed4beddaa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55ed4beddaa8[0m[39m,[0m[1;36m0x55ed4bef1448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x55ed4be62c02[0m[39m bp [0m[1;36m0x7ffdcad351c0[0m[39m sp [0m[1;36m0x7ffdcad351b8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55ed4be62c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55ed4be4ad1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55ed4be5f8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55ed4bccb350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55ed4bcb65c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55ed4bcbc05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55ed4bce7302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f4f9d909082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55ed4bcae7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55ed4bdd711f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55ed4be5f79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55ed4bccb350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55ed4bcb65c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55ed4bcbc05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55ed4bce7302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f4f9d909082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpp9asns7b[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [31m╭─[0m[31m──────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m───────────────────────[0m[31m─╮[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/evaluator/services/default/[0m[1m__init__.py[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m :97 in _evaluate_internal                                                        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 94 [0m[2m│   │   [0m[94mwith[0m logging_performance(context, header=[33m"[0m[33mRunning PoV[0m[33m"[0m):           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 95 [0m[2m│   │   │   [0m[94mtry[0m:                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 96 [0m[2m│   │   │   │   [0m[94mif[0m [96mlen[0m(detection.blobs) > [94m0[0m:                               [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 97 [2m│   │   │   │   │   [0menvironment.run_pov(context, detection)                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 98 [0m[2m│   │   │   │   [0m[94melse[0m:                                                      [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 99 [0m[2m│   │   │   │   │   [0mcontext[[33m"[0m[33mlogger[0m[33m"[0m].warning([33m"[0m[33mNo blob data found for the [0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m100 [0m                                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mcached.p[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1my[0m:56 in run_pov                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 53 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, detection: Detection            [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 54 [0m[2m│   [0m) -> [96mtuple[0m[[96mstr[0m, [96mstr[0m]:                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 55 [0m[2m│   │   [0m[94massert[0m [96mlen[0m(detection.blobs) > [94m0[0m, [33m"[0m[33mAt least one blob is required[0m[33m"[0m   [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 56 [2m│   │   [0m[94mreturn[0m [1;4;96mself[0m[1;4m.environment.run_pov(context, detection)[0m                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 57 [0m[2m│   [0m                                                                       [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 58 [0m[2m│   [0m[94mdef[0m[90m [0m[92mrun_tests[0m(                                                         [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 59 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, env: [96mdict[0m[[96mstr[0m, [96mstr[0m] = {}        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mdefault.[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1mpy[0m:210 in run_pov                                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m207 [0m[2m│   │   │   │   [0mcontext, blobinfo.blob, blobinfo.harness_name              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m208 [0m[2m│   │   │   [0m)                                                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m209 [0m[2m│   │   │   [0m[94mif[0m [95mnot[0m success:                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m210 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m ChallengePoVFoundError([0m                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m211 [0m[2m│   │   │   │   │   [0m[1;4mstdout=stdout.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m212 [0m[2m│   │   │   │   │   [0m[1;4mstderr=stderr.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m213 [0m[2m│   │   │   │   [0m[1;4m)[0m                                                          [31m│[0m [2m               [0m
[2;36m                    [0m         [31m╰──────────────────────────────────────────────────────────────────────────────────╯[0m [2m               [0m
[2;36m                    [0m         [1;91mChallengePoVFoundError: [0mPoV found:                                                   [2m               [0m
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3471293335[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55ed4bedc708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x55ed4beddaa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55ed4beddaa8[0m[39m,[0m[1;36m0x55ed4bef1448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x55ed4be62c02[0m[39m bp [0m[1;36m0x7ffdcad351c0[0m[39m sp [0m[1;36m0x7ffdcad351b8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55ed4be62c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55ed4be4ad1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55ed4be5f8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55ed4bccb350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55ed4bcb65c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55ed4bcbc05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55ed4bce7302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f4f9d909082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55ed4bcae7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55ed4bdd711f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55ed4be5f79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55ed4bccb350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55ed4bcb65c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55ed4bcbc05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55ed4bce7302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f4f9d909082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpp9asns7b[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Took [1;36m2.29[0m seconds;                ]8;id=383505;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=675313;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=116330;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=8937;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:50:17][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.84[0m seconds;              ]8;id=999003;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=874693;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=846012;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=482997;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:50:18][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.92[0m seconds;              ]8;id=641402;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=10438;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=249354;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=684346;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         +++ b/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-792[0m,[1;36m20[0m +[1;36m792[0m,[1;36m24[0m @@                                                               [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          static void [1;35mrx_ip[0m[1m([0mstruct mg_tcpip_if *ifp, struct pkt *pkt[1m)[0m [1m{[0m                      [2m                [0m
[2;36m                    [0m         +  uint8_t ip_hlen = [1m([0mpkt->ip->ver & [1;36m0xF[0m[1m)[0m * [1;36m4[0m;                                      [2m                [0m
[2;36m                    [0m         +  void *ip_payload = [1m([0mchar *[1m)[0mpkt->ip + ip_hlen;                                    [2m                [0m
[2;36m                    [0m            uint16_t frag = [1;35mmg_ntohs[0m[1m([0mpkt->ip->frag[1m)[0m;                                         [2m                [0m
[2;36m                    [0m            if [1m([0mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[1m)[0m [1m{[0m                     [2m                [0m
[2;36m                    [0m         -    if [1m([0mpkt->ip->proto == [1;36m17[0m[1m)[0m pkt->udp = [1m([0mstruct udp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;             [2m                [0m
[2;36m                    [0m         -    if [1m([0mpkt->ip->proto == [1;36m6[0m[1m)[0m pkt->tcp = [1m([0mstruct tcp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;              [2m                [0m
[2;36m                    [0m         +    if [1m([0mpkt->ip->proto == [1;36m17[0m && pkt->pay.len >= [1;35msizeof[0m[1m([0mstruct udp[1m)[0m[1m)[0m                [2m                [0m
[2;36m                    [0m         +      pkt->udp = [1m([0mstruct udp *[1m)[0m ip_payload;                                        [2m                [0m
[2;36m                    [0m         +    if [1m([0mpkt->ip->proto == [1;36m6[0m && pkt->pay.len >= [1;35msizeof[0m[1m([0mstruct tcp[1m)[0m[1m)[0m                 [2m                [0m
[2;36m                    [0m         +      pkt->tcp = [1m([0mstruct tcp *[1m)[0m ip_payload;                                        [2m                [0m
[2;36m                    [0m              struct mg_connection *c = [1;35mgetpeer[0m[1m([0mifp->mgr, pkt, false[1m)[0m;                       [2m                [0m
[2;36m                    [0m              if [1m([0mc[1m)[0m [1;35mmg_error[0m[1m([0mc, [32m"Received fragmented packet"[0m[1m)[0m;                              [2m                [0m
[2;36m                    [0m            [1m}[0m else if [1m([0mpkt->ip->proto == [1;36m1[0m[1m)[0m [1m{[0m                                                [2m                [0m
[2;36m                    [0m         -    pkt->icmp = [1m([0mstruct icmp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;                                     [2m                [0m
[2;36m                    [0m         -    if [1m([0mpkt->pay.len [1m<[0m[39m [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m+    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m ip_payload;[0m                                        [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [39m-    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m+    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m ip_payload;[0m                                          [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m        [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m            [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-822[0m[39m,[0m[1;36m11[0m[39m +[0m[1;36m826[0m[39m,[0m[1;36m11[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m-    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m+    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m ip_payload;[0m                                          [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m-    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [39m+    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip_hlen + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m        [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m            [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-838[0m[39m,[0m[1;36m13[0m[39m +[0m[1;36m842[0m[39m,[0m[1;36m13[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m static void [0m[1;35mrx_ip6[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [39m   [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"IP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m1[0m[39m || pkt->ip6->proto == [0m[1;36m58[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m     pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m     pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"  UDP %u %u -> %u"[0m[39m, len, [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->sport[0m[1;39m)[0m[39m,[0m                   [2m                [0m
[2;36m                    [0m         [39m     [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->dport[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-888[0m[39m,[0m[1;36m10[0m[39m +[0m[1;36m892[0m[39m,[0m[1;36m11[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m    [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m       [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle IPv4 [0m [2m                [0m
[2;36m                    [0m         [39moptions[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m-    else[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+    uint8_t ihl = pkt.ip->ver & [0m[1;36m0xF[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mihl < [0m[1;36m5[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m IHL must be at least [0m[1;36m5[0m[39m [0m[1;39m([0m[1;36m20[0m[39m bytes minimum[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m+    size_t ip_hlen = ihl * [0m[1;36m4[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hlen[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Buffer must contain [0m [2m                [0m
[2;36m                    [0m         [39mfull IP header[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + ip_hlen[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3471293335[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55ed4bedc708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55ed4beddaa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55ed4beddaa8[0m[39m,[0m[1;36m0x55ed4bef1448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55ed4be62c02[0m[39m bp [0m[1;36m0x7ffdcad351c0[0m[39m sp [0m[1;36m0x7ffdcad351b8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55ed4be62c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55ed4be4ad1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55ed4be5f8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55ed4bccb350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55ed4bcb65c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55ed4bcbc05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55ed4bce7302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f4f9d909082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55ed4bcae7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55ed4bdd711f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55ed4be5f79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55ed4bccb350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55ed4bcb65c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55ed4bcbc05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55ed4bce7302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f4f9d909082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpp9asns7b[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2506875745[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55868688b708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55868688caa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55868688caa8[0m[39m,[0m[1;36m0x5586868a0448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x558686811c02[0m[39m bp [0m[1;36m0x7fffe2852160[0m[39m sp [0m[1;36m0x7fffe2852158[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x558686811c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x5586867f9d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55868680e8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55868667a350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5586866655c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55868666b05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x558686696302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fa4bb2fc082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55868665d7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55868678611f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55868680e79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55868667a350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5586866655c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55868666b05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x558686696302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fa4bb2fc082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpz8kxnkhj[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe initial issue reports a heap-buffer-overflow detected by AddressSanitizer when [0m [2m                [0m
[2;36m                    [0m         [39mfuzzing the mongoose codebase. The error occurs in the `rx_icmp` function at line [0m  [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m of `src/net_builtin.c`, attempting to read [0m[1;36m1[0m[39m byte past the end of a [0m[1;36m34[0m[39m-byte [0m    [2m                [0m
[2;36m                    [0m         [39mallocated buffer. A patch was attempted to address this issue by adding bounds [0m     [2m                [0m
[2;36m                    [0m         [39mchecking and properly calculating IP header lengths before accessing [0m               [2m                [0m
[2;36m                    [0m         [39mprotocol-specific headers. However, after applying the patch, the same [0m             [2m                [0m
[2;36m                    [0m         [39mheap-buffer-overflow error persists at the same location, indicating that the patch[0m [2m                [0m
[2;36m                    [0m         [39mdid not successfully resolve the underlying issue.[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Initial Issue Analysis[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe AddressSanitizer report shows a heap-buffer-overflow occurring during fuzzing [0m  [2m                [0m
[2;36m                    [0m         [39mwith the following characteristics:[0m                                                 [2m                [0m
[2;36m                    [0m         [39m- **Location**: `rx_icmp` function in `[0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m`[0m      [2m                [0m
[2;36m                    [0m         [39m- **Type**: READ of size [0m[1;36m1[0m[39m at address `[0m[1;36m0x504000000172[0m[39m`[0m                              [2m                [0m
[2;36m                    [0m         [39m- **Severity**: SCARINESS level [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39m- **Call Stack**: The error originates from `LLVMFuzzerTestOneInput` → [0m             [2m                [0m
[2;36m                    [0m         [39m`mg_tcpip_rx` → `rx_icmp`[0m                                                           [2m                [0m
[2;36m                    [0m         [39m- **Allocation**: The problematic memory region is a [0m[1;36m34[0m[39m-byte buffer allocated at [0m   [2m                [0m
[2;36m                    [0m         [39mline [0m[1;36m95[0m[39m of `[0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m`[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe shadow bytes around the buggy address show:[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39mWhere `[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39m` indicates a partially addressable byte [0m[1;39m([0m[1;36m2[0m[39m bytes accessible out of [0m[1;36m8[0m[1;39m)[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mand the access attempts to read exactly at the boundary of the allocated region.[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Patch Attempt Details[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe patch attempted to fix the issue by modifying the `rx_ip` and `rx_ip6` [0m         [2m                [0m
[2;36m                    [0m         [39mfunctions in `src/net_builtin.c`. The key changes include:[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **IP Header Length Calculation**: Introduced a variable to calculate the actual [0m [2m                [0m
[2;36m                    [0m         [39mIP header length:[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   uint8_t ip_hlen = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m   void *ip_payload = [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen;[0m                                    [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Bounds Checking Order**: Moved size validation checks before pointer [0m          [2m                [0m
[2;36m                    [0m         [39massignments for all protocol types [0m[1;39m([0m[39mICMP, UDP, TCP[0m[1;39m)[0m[39m:[0m                                [2m                [0m
[2;36m                    [0m         [39m   - For ICMP: Check if `pkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m` before assigning [0m      [2m                [0m
[2;36m                    [0m         [39m`pkt->icmp`[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m   - For UDP: Check if `pkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct udp[0m[1;39m)[0m[39m` before assigning [0m        [2m                [0m
[2;36m                    [0m         [39m`pkt->udp`[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   - For TCP: Check if `pkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct tcp[0m[1;39m)[0m[39m` before assigning [0m        [2m                [0m
[2;36m                    [0m         [39m`pkt->tcp`[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Pointer Calculation**: Changed from using pointer arithmetic with `[0m[1;39m([0m[39mpkt->ip + [0m [2m                [0m
[2;36m                    [0m         [1;36m1[0m[1;39m)[0m[39m` to using the calculated `ip_payload` pointer, accounting for variable IP header[0m [2m                [0m
[2;36m                    [0m         [39mlengths[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Fragmented Packet Handling**: Added bounds checks when handling fragmented [0m    [2m                [0m
[2;36m                    [0m         [39mpackets for UDP and TCP protocols[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **IPv6 Processing**: Similar bounds checking changes applied to the `rx_ip6` [0m    [2m                [0m
[2;36m                    [0m         [39mfunction[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Post-Patch Results[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter applying the patch, the fuzzer still produces the identical error:[0m            [2m                [0m
[2;36m                    [0m         [39m- Same location: `rx_icmp` at line [0m[1;36m385[0m[39m [0m[1;39m([0m[39mthough the line number may have shifted due[0m [2m                [0m
[2;36m                    [0m         [39mto code changes[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m- Same address: `[0m[1;36m0x504000000172[0m[39m`[0m                                                    [2m                [0m
[2;36m                    [0m         [39m- Same allocation size: [0m[1;36m34[0m[39m-byte region[0m                                              [2m                [0m
[2;36m                    [0m         [39m- Same call stack: `LLVMFuzzerTestOneInput` → `mg_tcpip_rx` → `rx_icmp`[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis indicates that while the patch added additional validation logic in the IP [0m    [2m                [0m
[2;36m                    [0m         [39mprocessing functions [0m[1;39m([0m[39m`rx_ip` and `rx_ip6`[0m[1;39m)[0m[39m, it did not address the actual buffer [0m  [2m                [0m
[2;36m                    [0m         [39moverflow occurring within the `rx_icmp` function itself.[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas Requiring Further Investigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo properly resolve this issue, the following areas of the codebase should be [0m      [2m                [0m
[2;36m                    [0m         [39mexamined:[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **The `rx_icmp` function** [0m[1;39m([0m[39mparticularly around line [0m[1;36m385[0m[39m in [0m                     [2m                [0m
[2;36m                    [0m         [39m`src/net_builtin.c`[0m[1;39m)[0m[39m: This is where the actual overflow occurs. The function needs [0m [2m                [0m
[2;36m                    [0m         [39mto be reviewed to understand what operation at line [0m[1;36m385[0m[39m is reading beyond the [0m      [2m                [0m
[2;36m                    [0m         [39mbuffer boundary.[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **The `mkpay` function**: This function is called before `rx_icmp` and may be [0m   [2m                [0m
[2;36m                    [0m         [39msetting up incorrect payload lengths or pointers that lead to the overflow.[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Packet structure and payload length tracking**: The `pkt->pay.len` field and [0m  [2m                [0m
[2;36m                    [0m         [39mhow it's calculated and maintained throughout the packet processing pipeline should[0m [2m                [0m
[2;36m                    [0m         [39mbe verified to ensure it accurately represents the remaining buffer size.[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **ICMP packet structure validation**: The code should verify not just that [0m      [2m                [0m
[2;36m                    [0m         [39mthere's enough space for the ICMP header, but also that subsequent accesses within [0m [2m                [0m
[2;36m                    [0m         [39m`rx_icmp` [0m[1;39m([0m[39mincluding any data following the ICMP header[0m[1;39m)[0m[39m remain within bounds.[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Buffer allocation in the fuzzer**: While the fuzzer harness is not the root [0m   [2m                [0m
[2;36m                    [0m         [39mcause, understanding how the [0m[1;36m34[0m[39m-byte buffer is constructed in [0m                      [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;36m95[0m[39m` may provide insights into what minimum sizes or [0m     [2m                [0m
[2;36m                    [0m         [39mstructures are expected by the parsing code.[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **IP header options handling**: The patch attempts to account for [0m               [2m                [0m
[2;36m                    [0m         [39mvariable-length IP headers, but the interaction between IP header options and the [0m  [2m                [0m
[2;36m                    [0m         [39mpayload boundary calculations should be verified to ensure consistency.[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2506875745[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55868688b708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55868688caa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55868688caa8[0m[39m,[0m[1;36m0x5586868a0448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x558686811c02[0m[39m bp [0m[1;36m0x7fffe2852160[0m[39m sp [0m[1;36m0x7fffe2852158[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x558686811c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x5586867f9d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55868680e8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55868667a350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5586866655c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55868666b05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x558686696302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fa4bb2fc082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55868665d7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55868678611f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55868680e79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55868667a350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5586866655c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55868666b05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x558686696302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fa4bb2fc082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpz8kxnkhj[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3119659427[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x56050fb00708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x56050fb01aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x56050fb01aa8[0m[39m,[0m[1;36m0x56050fb15448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x56050fa86c02[0m[39m bp [0m[1;36m0x7ffdccc8e2e0[0m[39m sp [0m[1;36m0x7ffdccc8e2d8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x56050fa86c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x56050fa6ed1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x56050fa838b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x56050f8ef350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x56050f8da5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x56050f8e005f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x56050f90b302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fb7da447082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x56050f8d27ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x56050f9fb11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x56050fa8379d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x56050f8ef350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x56050f8da5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x56050f8e005f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x56050f90b302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fb7da447082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpk2ai_mgq[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:129[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:struct pkt [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:  struct mg_str raw;  [0m[35m/[0m[35m/[0m[39m Raw packet data[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:  struct mg_str pay;  [0m[35m/[0m[35m/[0m[39m Payload data[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:  struct eth *eth;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:  struct llc *llc;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:  struct arp *arp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:  struct ip *ip;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:  struct ip6 *ip6;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:  struct icmp *icmp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:  struct tcp *tcp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:  struct udp *udp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:  struct dhcp *dhcp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:static void [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, int ev, void *ev_data[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:  if [0m[1;39m([0m[39mifp->fn != NULL[0m[1;39m)[0m[39m ifp->[0m[1;35mfn[0m[1;39m([0m[39mifp, ev, ev_data[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:static void [0m[1;35msend_syn[0m[1;39m([0m[39mstruct mg_connection *c[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:824[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:62[0m[39m-[0m[1;36m70[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:struct ip6 [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:  uint8_t ver;      [0m[35m/[0m[35m/[0m[39m Version[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:  uint8_t opts[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Options[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:  uint16_t len;     [0m[35m/[0m[35m/[0m[39m Length[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:  uint8_t proto;    [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:  uint8_t ttl;      [0m[35m/[0m[35m/[0m[39m Time to live[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:  uint8_t src[0m[1;39m[[0m[1;36m16[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:  uint8_t dst[0m[1;39m[[0m[1;36m16[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:62[0m[39m-[0m[1;36m70[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:struct ip6 [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:  uint8_t ver;      [0m[35m/[0m[35m/[0m[39m Version[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:  uint8_t opts[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Options[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:  uint16_t len;     [0m[35m/[0m[35m/[0m[39m Length[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:  uint8_t proto;    [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:  uint8_t ttl;      [0m[35m/[0m[35m/[0m[39m Time to live[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:  uint8_t src[0m[1;39m[[0m[1;36m16[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:  uint8_t dst[0m[1;39m[[0m[1;36m16[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:78[0m[39m-[0m[1;36m84[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:struct arp [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:  uint16_t fmt;    [0m[35m/[0m[35m/[0m[39m Format of hardware address[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:  uint16_t pro;    [0m[35m/[0m[35m/[0m[39m Format of protocol address[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:  uint8_t hlen;    [0m[35m/[0m[35m/[0m[39m Length of hardware address[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:  uint8_t plen;    [0m[35m/[0m[35m/[0m[39m Length of protocol address[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:  uint16_t op;     [0m[35m/[0m[35m/[0m[39m Operation[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:  uint8_t sha[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Sender hardware address[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:86[0m[39m-[0m[1;36m94[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:  uint8_t tha[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Target hardware address[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:  uint32_t tpa;    [0m[35m/[0m[35m/[0m[39m Target protocol address[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:struct tcp [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:  uint16_t sport;  [0m[35m/[0m[35m/[0m[39m Source port[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:  uint16_t dport;  [0m[35m/[0m[35m/[0m[39m Destination port[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:  uint32_t seq;    [0m[35m/[0m[35m/[0m[39m Sequence number[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:  uint32_t ack;    [0m[35m/[0m[35m/[0m[39m Acknowledgement number[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:838[0m[39m-[0m[1;36m852[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m838[0m[39m:static void [0m[1;35mrx_ip6[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m839[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"IP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m840[0m[39m:  if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m1[0m[39m || pkt->ip6->proto == [0m[1;36m58[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m841[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m842[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m843[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m844[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m845[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m846[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m847[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m848[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"  UDP %u %u -> %u"[0m[39m, len, [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->sport[0m[1;39m)[0m[39m,[0m                [2m                [0m
[2;36m                    [0m         [1;36m849[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->dport[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m850[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m851[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m852[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:96[0m[39m-[0m[1;36m104[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:  uint8_t flags;   [0m[35m/[0m[35m/[0m[39m TCP flags[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:#define TH_FIN [0m[1;36m0x01[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:#define TH_SYN [0m[1;36m0x02[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:#define TH_RST [0m[1;36m0x04[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:#define TH_PUSH [0m[1;36m0x08[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:#define TH_ACK [0m[1;36m0x10[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:#define TH_URG [0m[1;36m0x20[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:#define TH_ECE [0m[1;36m0x40[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:#define TH_CWR [0m[1;36m0x80[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:398[0m[39m-[0m[1;36m420[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:static void [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:  uint32_t ip = [0m[1;36m0[0m[39m, gw = [0m[1;36m0[0m[39m, mask = [0m[1;36m0[0m[39m, lease = [0m[1;36m0[0m[39m, dns = [0m[1;36m0[0m[39m, sntp = [0m[1;36m0[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:  uint8_t msgtype = [0m[1;36m0[0m[39m, state = ifp->state;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:  [0m[35m/[0m[35m/[0m[39m perform size check first, then access fields[0m                               [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:  uint8_t *p = pkt->dhcp->options,[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:          *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:  if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:  if [0m[1;39m([0m[1;35mmemcmp[0m[1;39m([0m[39m&pkt->dhcp->xid, ifp->mac + [0m[1;36m2[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mpkt->dhcp->xid[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m return;[0m    [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:  while [0m[1;39m([0m[39mp + [0m[1;36m1[0m[39m < end && p[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m != [0m[1;36m255[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m  [0m[35m/[0m[35m/[0m[39m Parse options RFC-[0m[1;36m1533[0m[39m #[0m[1;36m9[0m            [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:    if [0m[1;39m([0m[39mp[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[1;36m1[0m[39m && p[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m == [0m[1;35msizeof[0m[1;39m([0m[39mifp->mask[0m[1;39m)[0m[39m && p + [0m[1;36m6[0m[39m < end[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m  [0m[35m/[0m[35m/[0m[39m Mask[0m       [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39m&mask, p + [0m[1;36m2[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mmask[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m409[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mp[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[1;36m3[0m[39m && p[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m == [0m[1;35msizeof[0m[1;39m([0m[39mifp->gw[0m[1;39m)[0m[39m && p + [0m[1;36m6[0m[39m < end[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m  [0m[35m/[0m[35m/[0m[39m GW[0m    [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39m&gw, p + [0m[1;36m2[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mgw[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:      ip = pkt->dhcp->yiaddr;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_req_dns && p[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[1;36m6[0m[39m && p[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m == [0m[1;35msizeof[0m[1;39m([0m[39mdns[0m[1;39m)[0m[39m &&[0m       [2m                [0m
[2;36m                    [0m         [1;36m413[0m[39m:               p + [0m[1;36m6[0m[39m < end[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m  [0m[35m/[0m[35m/[0m[39m DNS[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m414[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39m&dns, p + [0m[1;36m2[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mdns[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_req_sntp && p[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[1;36m42[0m[39m && p[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m == [0m[1;35msizeof[0m[1;39m([0m[39msntp[0m[1;39m)[0m[39m &&[0m    [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:               p + [0m[1;36m6[0m[39m < end[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m  [0m[35m/[0m[35m/[0m[39m SNTP[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39m&sntp, p + [0m[1;36m2[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39msntp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mp[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[1;36m51[0m[39m && p[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m == [0m[1;36m4[0m[39m && p + [0m[1;36m6[0m[39m < end[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m  [0m[35m/[0m[35m/[0m[39m Lease[0m              [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39m&lease, p + [0m[1;36m2[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mlease[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:      lease = [0m[1;35mmg_ntohl[0m[1;39m([0m[39mlease[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:459[0m[39m-[0m[1;36m480[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m459[0m[39m:static void [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m460[0m[39m:  uint8_t op = [0m[1;36m0[0m[39m, *p = pkt->dhcp->options,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m461[0m[39m:          *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m462[0m[39m:  if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m463[0m[39m:  [0m[35m/[0m[35m/[0m[39m struct dhcp *req = pkt->dhcp;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m464[0m[39m:  struct dhcp res = [0m[1;39m{[0m[1;36m2[0m[39m, [0m[1;36m1[0m[39m, [0m[1;36m6[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0[0m[39m, [0m[1;39m{[0m[1;36m0[0m[1;39m}[0m[39m, [0m[1;36m0[0m[39m, [0m[1;39m{[0m[1;36m0[0m[1;39m}[0m[1;39m}[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m465[0m[39m:  res.yiaddr = ifp->ip;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m466[0m[39m:  [0m[1;39m([0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&res.yiaddr[0m[1;39m)[0m[1;39m)[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m++;                [0m[35m/[0m[35m/[0m[39m Offer our IP + [0m[1;36m1[0m          [2m                [0m
[2;36m                    [0m         [1;36m467[0m[39m:  while [0m[1;39m([0m[39mp + [0m[1;36m1[0m[39m < end && p[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m != [0m[1;36m255[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m             [0m[35m/[0m[35m/[0m[39m Parse options[0m             [2m                [0m
[2;36m                    [0m         [1;36m468[0m[39m:    if [0m[1;39m([0m[39mp[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[1;36m53[0m[39m && p[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m == [0m[1;36m1[0m[39m && p + [0m[1;36m2[0m[39m < end[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m  [0m[35m/[0m[35m/[0m[39m Message type[0m              [2m                [0m
[2;36m                    [0m         [1;36m469[0m[39m:      op = p[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:    p += p[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m + [0m[1;36m2[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m472[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m473[0m[39m:  if [0m[1;39m([0m[39mop == [0m[1;36m1[0m[39m || op == [0m[1;36m3[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m         [0m[35m/[0m[35m/[0m[39m DHCP Discover or DHCP Request[0m            [2m                [0m
[2;36m                    [0m         [1;36m474[0m[39m:    uint8_t msg = op == [0m[1;36m1[0m[39m ? [0m[1;36m2[0m[39m : [0m[1;36m5[0m[39m;  [0m[35m/[0m[35m/[0m[39m Message type: DHCP OFFER or DHCP ACK[0m     [2m                [0m
[2;36m                    [0m         [1;36m475[0m[39m:    uint8_t opts[0m[1;39m[[0m[1;39m][0m[39m = [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m476[0m[39m:        [0m[1;36m53[0m[39m, [0m[1;36m1[0m[39m, msg,                 [0m[35m/[0m[35m/[0m[39m Message type[0m                             [2m                [0m
[2;36m                    [0m         [1;36m477[0m[39m:        [0m[1;36m1[0m[39m,  [0m[1;36m4[0m[39m, [0m[1;36m0[0m[39m,   [0m[1;36m0[0m[39m,   [0m[1;36m0[0m[39m,   [0m[1;36m0[0m[39m,    [0m[35m/[0m[35m/[0m[39m Subnet mask[0m                              [2m                [0m
[2;36m                    [0m         [1;36m478[0m[39m:        [0m[1;36m54[0m[39m, [0m[1;36m4[0m[39m, [0m[1;36m0[0m[39m,   [0m[1;36m0[0m[39m,   [0m[1;36m0[0m[39m,   [0m[1;36m0[0m[39m,    [0m[35m/[0m[35m/[0m[39m Server ID[0m                                [2m                [0m
[2;36m                    [0m         [1;36m479[0m[39m:        [0m[1;36m12[0m[39m, [0m[1;36m3[0m[39m, [0m[32m'm'[0m[39m, [0m[32m'i'[0m[39m, [0m[32m'p'[0m[39m,       [0m[35m/[0m[35m/[0m[39m Host name: [0m[32m"mip"[0m                         [2m                [0m
[2;36m                    [0m         [1;36m480[0m[39m:        [0m[1;36m51[0m[39m, [0m[1;36m4[0m[39m, [0m[1;36m255[0m[39m, [0m[1;36m255[0m[39m, [0m[1;36m255[0m[39m, [0m[1;36m255[0m[39m,  [0m[35m/[0m[35m/[0m[39m Lease time[0m                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:200[0m[39m-[0m[1;36m230[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:  [0m[1;35mmemcpy[0m[1;39m([0m[39marp->sha, ifp->mac, [0m[1;35msizeof[0m[1;39m([0m[39marp->sha[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:  if [0m[1;39m([0m[39mmac != NULL[0m[1;39m)[0m[39m [0m[1;35mmemcpy[0m[1;39m([0m[39marp->tha, mac, [0m[1;35msizeof[0m[1;39m([0m[39marp->tha[0m[1;39m)[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:  [0m[1;35mether_output[0m[1;39m([0m[39mifp, [0m[1;35mPDIFF[0m[1;39m([0m[39meth, arp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:static void [0m[1;35monstatechange[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:  if [0m[1;39m([0m[39mifp->state == MG_TCPIP_STATE_READY[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:    [0m[1;35mMG_INFO[0m[1;39m([0m[1;39m([0m[32m"READY, IP: %M"[0m[39m, mg_print_ip4, &ifp->ip[0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:    [0m[1;35mMG_INFO[0m[1;39m([0m[1;39m([0m[32m"       GW: %M"[0m[39m, mg_print_ip4, &ifp->gw[0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    [0m[1;35mMG_INFO[0m[1;39m([0m[1;39m([0m[32m"      MAC: %M"[0m[39m, mg_print_mac, &ifp->mac[0m[1;39m)[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->state == MG_TCPIP_STATE_IP[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:    [0m[1;35mMG_ERROR[0m[1;39m([0m[1;39m([0m[32m"Got IP"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:    [0m[1;35mmg_tcpip_arp_request[0m[1;39m([0m[39mifp, ifp->gw, NULL[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m unsolicited GW ARP request[0m    [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->state == MG_TCPIP_STATE_UP[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:    [0m[1;35mMG_ERROR[0m[1;39m([0m[1;39m([0m[32m"Link up"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    [0m[1;35msrand[0m[1;39m([0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39m [0m[1;35mmg_millis[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->state == MG_TCPIP_STATE_DOWN[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[1;35mMG_ERROR[0m[1;39m([0m[1;39m([0m[32m"Link down"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:  [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mifp, MG_TCPIP_EV_ST_CHG, &ifp->state[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:static struct ip *[0m[1;35mtx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, uint8_t *mac_dst,[0m              [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:                        uint8_t proto, uint32_t ip_src, uint32_t ip_dst,[0m        [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:                        size_t plen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:  struct eth *eth = [0m[1;39m([0m[39mstruct eth *[0m[1;39m)[0m[39m ifp->tx.buf;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:  struct ip *ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39meth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:  [0m[1;35mmemcpy[0m[1;39m([0m[39meth->dst, mac_dst, [0m[1;35msizeof[0m[1;39m([0m[39meth->dst[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:  [0m[1;35mmemcpy[0m[1;39m([0m[39meth->src, ifp->mac, [0m[1;35msizeof[0m[1;39m([0m[39meth->src[0m[1;39m)[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Use our MAC[0m                 [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:  eth->type = [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:  [0m[1;35mmemset[0m[1;39m([0m[39mip, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*ip[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:854[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m854[0m[39m:void [0m[1;35mmg_tcpip_rx[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, void *buf, size_t len[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m855[0m[39m:  struct pkt pkt;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m856[0m[39m:  [0m[1;35mmemset[0m[1;39m([0m[39m&pkt, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mpkt[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m857[0m[39m:  pkt.raw.buf = [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m buf;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m858[0m[39m:  pkt.raw.len = len;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m859[0m[39m:  pkt.eth = [0m[1;39m([0m[39mstruct eth *[0m[1;39m)[0m[39m buf;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m860[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_hexdump[0m[1;39m([0m[39mbuf, len > [0m[1;36m16[0m[39m ? [0m[1;36m16[0m[39m: len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m861[0m[39m:  if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated - runt?[0m             [2m                [0m
[2;36m                    [0m         [1;36m862[0m[39m:  if [0m[1;39m([0m[39mifp->enable_mac_check &&[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m863[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, ifp->mac, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[39m &&[0m              [2m                [0m
[2;36m                    [0m         [1;36m864[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, broadcast, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m865[0m[39m:    return;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m866[0m[39m:  if [0m[1;39m([0m[39mifp->enable_crc32_check && len > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m867[0m[39m:    len -= [0m[1;36m4[0m[39m;  [0m[35m/[0m[35m/[0m[39m [0m[1;35mTODO[0m[1;39m([0m[39mscaprile[0m[1;39m)[0m[39m: check on bigendian[0m                            [2m                [0m
[2;36m                    [0m         [1;36m868[0m[39m:    uint32_t crc = [0m[1;35mmg_crc32[0m[1;39m([0m[1;36m0[0m[39m, [0m[1;39m([0m[39mconst char *[0m[1;39m)[0m[39m buf, len[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m869[0m[39m:    if [0m[1;39m([0m[1;35mmemcmp[0m[1;39m([0m[1;39m([0m[39mvoid *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m buf + len[0m[1;39m)[0m[39m, &crc, [0m[1;35msizeof[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m return;[0m       [2m                [0m
[2;36m                    [0m         [1;36m870[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m871[0m[39m:  if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x806[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m872[0m[39m:    pkt.arp = [0m[1;39m([0m[39mstruct arp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m873[0m[39m:    if [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.arp[0m[1;39m)[0m[39m > pkt.raw.len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m874[0m[39m:    [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mifp, MG_TCPIP_EV_ARP, &pkt.raw[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m875[0m[39m:    [0m[1;35mrx_arp[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m876[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x86dd[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m877[0m[39m:    pkt.ip6 = [0m[1;39m([0m[39mstruct ip6 *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m878[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip6[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m879[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip6->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m0x6[0m[1;39m)[0m[39m return;                         [0m[35m/[0m[35m/[0m[39m Not IP[0m   [2m                [0m
[2;36m                    [0m         [1;36m880[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m881[0m[39m:    [0m[1;35mrx_ip6[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:340[0m[39m-[0m[1;36m380[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m340[0m[39m:static void [0m[1;35mrx_arp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m341[0m[39m:  if [0m[1;39m([0m[39mpkt->arp->op == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m && pkt->arp->tpa == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m342[0m[39m:    [0m[35m/[0m[35m/[0m[39m ARP request. Make a response, then send[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m343[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ARP op %d %M: %M"[0m[39m, [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->arp->op[0m[1;39m)[0m[39m, mg_print_ip4,[0m      [2m                [0m
[2;36m                    [0m         [1;36m344[0m[39m:    [0m[35m/[0m[35m/[0m[39m          &pkt->arp->spa, mg_print_ip4, &pkt->arp->tpa[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m345[0m[39m:    struct eth *eth = [0m[1;39m([0m[39mstruct eth *[0m[1;39m)[0m[39m ifp->tx.buf;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m346[0m[39m:    struct arp *arp = [0m[1;39m([0m[39mstruct arp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39meth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m347[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39meth->dst, pkt->eth->src, [0m[1;35msizeof[0m[1;39m([0m[39meth->dst[0m[1;39m)[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m348[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39meth->src, ifp->mac, [0m[1;35msizeof[0m[1;39m([0m[39meth->src[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m349[0m[39m:    eth->type = [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x806[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:    *arp = *pkt->arp;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m351[0m[39m:    arp->op = [0m[1;35mmg_htons[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m352[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39marp->tha, pkt->arp->sha, [0m[1;35msizeof[0m[1;39m([0m[39mpkt->arp->tha[0m[1;39m)[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m353[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39marp->sha, ifp->mac, [0m[1;35msizeof[0m[1;39m([0m[39mpkt->arp->sha[0m[1;39m)[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:    arp->tpa = pkt->arp->spa;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:    arp->spa = ifp->ip;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:    [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ARP: tell %M we're %M"[0m[39m, mg_print_ip4, &arp->tpa, mg_print_mac,[0m   [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:              &ifp->mac[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, [0m[1;35mPDIFF[0m[1;39m([0m[39meth, arp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->arp->op == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:    if [0m[1;39m([0m[1;35mmemcmp[0m[1;39m([0m[39mpkt->arp->tha, ifp->mac, [0m[1;35msizeof[0m[1;39m([0m[39mpkt->arp->tha[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m return;[0m    [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:    if [0m[1;39m([0m[39mpkt->arp->spa == ifp->gw[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:      [0m[35m/[0m[35m/[0m[39m Got response for the GW ARP request. Set ifp->gwmac and IP -> READY[0m    [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39mifp->gwmac, pkt->arp->sha, [0m[1;35msizeof[0m[1;39m([0m[39mifp->gwmac[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:      if [0m[1;39m([0m[39mifp->state == MG_TCPIP_STATE_IP[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:        ifp->state = MG_TCPIP_STATE_READY;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:        [0m[1;35monstatechange[0m[1;39m([0m[39mifp[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:      struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:      if [0m[1;39m([0m[39mc != NULL && c->is_arplooking[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:        struct connstate *s = [0m[1;39m([0m[39mstruct connstate *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mc + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:        [0m[1;35mmemcpy[0m[1;39m([0m[39ms->mac, pkt->arp->sha, [0m[1;35msizeof[0m[1;39m([0m[39ms->mac[0m[1;39m)[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:        [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"%lu ARP resolved %M -> %M"[0m[39m, c->id, mg_print_ip4, c->rem.ip,[0m  [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:                  mg_print_mac, s->mac[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:        c->is_arplooking = [0m[1;36m0[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:        [0m[1;35mmac_resolved[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:871[0m[39m-[0m[1;36m875[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m871[0m[39m:  if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x806[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m872[0m[39m:    pkt.arp = [0m[1;39m([0m[39mstruct arp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m873[0m[39m:    if [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.arp[0m[1;39m)[0m[39m > pkt.raw.len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m874[0m[39m:    [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mifp, MG_TCPIP_EV_ARP, &pkt.raw[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m875[0m[39m:    [0m[1;35mrx_arp[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:838[0m[39m-[0m[1;36m852[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m838[0m[39m:static void [0m[1;35mrx_ip6[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m839[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"IP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m840[0m[39m:  if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m1[0m[39m || pkt->ip6->proto == [0m[1;36m58[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m841[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m842[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m843[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m844[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m845[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m846[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m847[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m848[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"  UDP %u %u -> %u"[0m[39m, len, [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->sport[0m[1;39m)[0m[39m,[0m                [2m                [0m
[2;36m                    [0m         [1;36m849[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->dport[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m850[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m851[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m852[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:1[0m[39m-[0m[1;36m30[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:#include [0m[32m"net_builtin.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mMG_ENABLE_TCPIP[0m[1;39m)[0m[39m && MG_ENABLE_TCPIP[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:#define MG_EPHEMERAL_PORT_BASE [0m[1;36m32768[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:#define [0m[1;35mPDIFF[0m[1;39m([0m[39ma, b[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mb[0m[1;39m)[0m[1;39m)[0m[39m - [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m[1;39m([0m[39ma[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:#ifndef MIP_TCP_KEEPALIVE_MS[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:#define MIP_TCP_KEEPALIVE_MS [0m[1;36m45000[0m[39m  [0m[35m/[0m[35m/[0m[39m TCP keep-alive period, ms[0m                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:#endif[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:#define MIP_TCP_ACK_MS [0m[1;36m150[0m[39m    [0m[35m/[0m[35m/[0m[39m Timeout for ACKing[0m                              [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:#define MIP_ARP_RESP_MS [0m[1;36m100[0m[39m   [0m[35m/[0m[35m/[0m[39m Timeout for ARP response[0m                        [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:#define MIP_TCP_SYN_MS [0m[1;36m15000[0m[39m  [0m[35m/[0m[35m/[0m[39m Timeout for connection establishment[0m            [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:#define MIP_TCP_FIN_MS [0m[1;36m1000[0m[39m   [0m[35m/[0m[35m/[0m[39m Timeout for closing connection[0m                  [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:#define MIP_TCP_WIN [0m[1;36m6000[0m[39m      [0m[35m/[0m[35m/[0m[39m TCP window size[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:struct connstate [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:  uint32_t seq, ack;           [0m[35m/[0m[35m/[0m[39m TCP seq/ack counters[0m                           [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:  uint64_t timer;              [0m[35m/[0m[35m/[0m[39m TCP keep-alive [0m[35m/[0m[39m ACK timer[0m                     [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:  uint32_t acked;              [0m[35m/[0m[35m/[0m[39m Last ACK-ed number[0m                             [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:  size_t unacked;              [0m[35m/[0m[35m/[0m[39m Not acked bytes[0m                                [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:  uint8_t mac[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;              [0m[35m/[0m[35m/[0m[39m Peer MAC address[0m                               [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:  uint8_t ttype;               [0m[35m/[0m[35m/[0m[39m Timer type. [0m[1;36m0[0m[39m: ack, [0m[1;36m1[0m[39m: keep-alive[0m              [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:#define MIP_TTYPE_KEEPALIVE [0m[1;36m0[0m[39m  [0m[35m/[0m[35m/[0m[39m Connection is idle for long, send keepalive[0m    [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:#define MIP_TTYPE_ACK [0m[1;36m1[0m[39m        [0m[35m/[0m[35m/[0m[39m Peer sent us data, we have to ack it soon[0m      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:#define MIP_TTYPE_ARP [0m[1;36m2[0m[39m        [0m[35m/[0m[35m/[0m[39m ARP resolve sent, waiting for response[0m         [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:#define MIP_TTYPE_SYN [0m[1;36m3[0m[39m        [0m[35m/[0m[35m/[0m[39m SYN sent, waiting for response[0m                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:#define MIP_TTYPE_FIN [0m[1;36m4[0m[39m  [0m[35m/[0m[35m/[0m[39m FIN sent, waiting until terminating the connection[0m   [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:  uint8_t tmiss;         [0m[35m/[0m[35m/[0m[39m Number of keep-alive misses[0m                          [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:  struct mg_iobuf raw;   [0m[35m/[0m[35m/[0m[39m For TLS only. Incoming raw data[0m                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:806[0m[39m-[0m[1;36m809[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis of Root Causes[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter analyzing the code snippets and evaluation report, I've identified the [0m       [2m                [0m
[2;36m                    [0m         [39mfundamental issues causing the heap-buffer-overflow:[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Primary Root Cause[0m                                                              [2m                [0m
[2;36m                    [0m         [39mThe buffer overflow occurs due to **insufficient validation of IP header length** [0m  [2m                [0m
[2;36m                    [0m         [39min `mg_tcpip_rx` before calculating the payload pointer. When an IP packet with IHL[0m [2m                [0m
[2;36m                    [0m         [39m> [0m[1;36m5[0m[39m [0m[1;39m([0m[39mindicating IP options[0m[1;39m)[0m[39m arrives in a buffer that doesn't actually contain [0m      [2m                [0m
[2;36m                    [0m         [39menough bytes for the claimed header length, the code calculates a `pkt.pay.buf` [0m    [2m                [0m
[2;36m                    [0m         [39mpointer beyond the buffer boundary.[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Secondary Root Cause  [0m                                                          [2m                [0m
[2;36m                    [0m         [39mIn `rx_ip`, all protocol header pointers [0m[1;39m([0m[39mICMP, UDP, TCP[0m[1;39m)[0m[39m are calculated using [0m     [2m                [0m
[2;36m                    [0m         [39m`[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m`, which assumes a fixed [0m[1;36m20[0m[39m-byte IP header. This is incorrect when IP[0m [2m                [0m
[2;36m                    [0m         [39moptions are present [0m[1;39m([0m[39mIHL > [0m[1;36m5[0m[1;39m)[0m[39m, causing protocol headers to be misaligned.[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why the Previous Patch Failed[0m                                                   [2m                [0m
[2;36m                    [0m         [39mThe previous patch only addressed the secondary issue in `rx_ip` by calculating [0m    [2m                [0m
[2;36m                    [0m         [39m`ip_hlen` and using it for pointer arithmetic. However, it **did not fix the [0m       [2m                [0m
[2;36m                    [0m         [39mvalidation gap in `mg_tcpip_rx`**. When a malformed [0m[1;36m34[0m[39m-byte packet with [0m[33mIHL[0m[39m=[0m[1;36m6[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39marrives:[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. `mg_tcpip_rx` line [0m[1;36m889[0m[39m checks: `[0m[1;36m34[0m[39m >= [0m[1;36m14[0m[39m + [0m[1;36m20[0m[39m` ✓ [0m[1;39m([0m[39mpasses[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. `mg_tcpip_rx` line [0m[1;36m892[0m[39m calculates: `[0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, byte_14 + [0m[1;36m24[0m[1;39m)[0m[39m` = pointer to byte[0m [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m [0m[1;39m([0m[39mBEYOND buffer![0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. `mkpay` sets `pkt->pay.len = &buf[0m[1;39m[[0m[1;36m34[0m[1;39m][0m[39m - byte_38` = [0m[1;36m-4[0m[39m [0m[1;39m([0m[39mwraps to huge positive[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Even with the fixed `rx_ip`, the bounds check `if [0m[1;39m([0m[39mpkt->pay.len < [0m               [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m` passes due to wrapped length[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Subsequent access to `pkt->icmp->type` or `pkt->pay.buf` triggers the overflow[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Comprehensive Fix Strategy[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m1[0m[39m: Add IP Header Length Validation in `mg_tcpip_rx` [0m[1;39m([0m[39mPrimary Fix[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mIn the IPv4 processing block [0m[1;39m([0m[39mafter line [0m[1;36m890[0m[1;39m)[0m[39m, add comprehensive validation:[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m After line [0m[1;36m890[0m[39m: if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;[0m                             [2m                [0m
[2;36m                    [0m         [39muint8_t ihl = pkt.ip->ver & [0m[1;36m0xF[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mihl < [0m[1;36m5[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m IHL must be at least [0m[1;36m5[0m[39m [0m[1;39m([0m[1;36m20[0m[39m bytes minimum[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [39msize_t ip_hlen = ihl * [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hlen[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Buffer must contain full [0m [2m                [0m
[2;36m                    [0m         [39mIP header[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThen replace lines [0m[1;36m891[0m[39m-[0m[1;36m894[0m[39m with a single unified calculation:[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + ip_hlen[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis ensures:[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m- IHL is validated to be >= [0m[1;36m5[0m[39m [0m[1;39m([0m[39mminimum valid value[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [39m- Buffer actually contains the full IP header [0m[1;39m([0m[39mincluding options[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m- Payload pointer is calculated only after validation[0m                               [2m                [0m
[2;36m                    [0m         [39m- No integer underflow can occur in `mkpay`[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m2[0m[39m: Fix Protocol Header Calculations in `rx_ip` [0m[1;39m([0m[39mSecondary Fix[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAt the beginning of `rx_ip` function [0m[1;39m([0m[39mafter line [0m[1;36m794[0m[1;39m)[0m[39m, calculate IP header length:[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39muint8_t ihl = pkt->ip->ver & [0m[1;36m0xF[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39msize_t ip_hlen = ihl * [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39mvoid *ip_payload = [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen;[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mReplace all occurrences of `[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m` with `ip_payload`:[0m                       [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m797[0m[39m: `pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m ip_payload;` [0m[1;39m([0m[39mfragmented UDP[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m798[0m[39m: `pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m ip_payload;` [0m[1;39m([0m[39mfragmented TCP[0m[1;39m)[0m[39m  [0m              [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m802[0m[39m: `pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m ip_payload;` [0m[1;39m([0m[39mICMP[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m807[0m[39m: `pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m ip_payload;` [0m[1;39m([0m[39mUDP[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m825[0m[39m: `pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m ip_payload;` [0m[1;39m([0m[39mTCP[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mUpdate TCP payload length calculation at line [0m[1;36m829[0m[39m:[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39muint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip_hlen + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m3[0m[39m: Maintain Existing Bounds Checks[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mKeep the existing bounds checks [0m[1;39m([0m[39mlines [0m[1;36m803[0m[39m, [0m[1;36m808[0m[39m, [0m[1;36m826[0m[1;39m)[0m[39m as they are:[0m                  [2m                [0m
[2;36m                    [0m         [39m- `if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;`[0m                                  [2m                [0m
[2;36m                    [0m         [39m- `if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;`[0m                                   [2m                [0m
[2;36m                    [0m         [39m- `if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;`[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThese checks remain valid because after fixing Step [0m[1;36m1[0m[39m, `pkt->pay.len` will be [0m      [2m                [0m
[2;36m                    [0m         [39mcorrectly calculated and won't wrap to huge values.[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m4[0m[39m: Preserve Fragmented Packet Bounds Checking[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mFor fragmented packets [0m[1;39m([0m[39mlines [0m[1;36m796[0m[39m-[0m[1;36m800[0m[1;39m)[0m[39m, add bounds checking before pointer [0m         [2m                [0m
[2;36m                    [0m         [39massignment:[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [39m  if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[39m && pkt->pay.len >= [0m[1;35msizeof[0m[1;39m([0m[39mstruct udp[0m[1;39m)[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m ip_payload;[0m                                           [2m                [0m
[2;36m                    [0m         [39m  if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[39m && pkt->pay.len >= [0m[1;35msizeof[0m[1;39m([0m[39mstruct tcp[0m[1;39m)[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [39m    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m ip_payload;[0m                                           [2m                [0m
[2;36m                    [0m         [39m  struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [39m  if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Justification and Correctness[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This Approach is Optimal[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Defense in Depth**: Validates at the earliest point [0m[1;39m([0m[39mmg_tcpip_rx[0m[1;39m)[0m[39m before any [0m  [2m                [0m
[2;36m                    [0m         [39mpointer arithmetic[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Prevents Integer Underflow**: Ensures buffer size checks happen before [0m        [2m                [0m
[2;36m                    [0m         [39mcalculations[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Consistent with Existing Code**: Uses same IHL calculation pattern already [0m    [2m                [0m
[2;36m                    [0m         [39mpresent in lines [0m[1;36m891[0m[39m-[0m[1;36m892[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Minimal Changes**: Fixes root causes without restructuring the codebase[0m        [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Preserves Existing Logic**: All downstream protocol handlers continue to work [0m [2m                [0m
[2;36m                    [0m         [39mcorrectly[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Preservation of Existing Functionality[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **ARP and IPv6 handling**: Unchanged, as they don't have variable header lengths[0m  [2m                [0m
[2;36m                    [0m         [39m- **DHCP, TCP, UDP handlers**: Continue to work correctly with properly aligned [0m    [2m                [0m
[2;36m                    [0m         [39mprotocol headers[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m- **Fragmentation handling**: Enhanced with proper bounds checking[0m                  [2m                [0m
[2;36m                    [0m         [39m- **All existing bounds checks**: Remain in place and become effective with [0m        [2m                [0m
[2;36m                    [0m         [39mcorrected payload calculations[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How This Addresses the Evaluation Report[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Initial Issue**: Heap-buffer-overflow at `rx_icmp:[0m[1;36m385[0m[39m` [0m                        [2m                [0m
[2;36m                    [0m         [39m   - Fixed by preventing `pkt->pay.buf` from pointing beyond buffer[0m                 [2m                [0m
[2;36m                    [0m         [39m   - Fixed by correctly positioning `pkt->icmp` after IP options[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Why Previous Patch Failed**: Only fixed secondary issue in `rx_ip`[0m             [2m                [0m
[2;36m                    [0m         [39m   - New fix addresses primary validation gap in `mg_tcpip_rx`[0m                      [2m                [0m
[2;36m                    [0m         [39m   - Prevents corrupted `pkt->pay.len` from reaching protocol handlers[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **[0m[1;36m34[0m[39m-byte Buffer Test Case**: Will now correctly reject invalid packets[0m          [2m                [0m
[2;36m                    [0m         [39m   - IHL validation prevents accepting headers claiming to be longer than buffer[0m    [2m                [0m
[2;36m                    [0m         [39m   - Buffer size check prevents pointer arithmetic beyond bounds[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Potential Side Effects and Mitigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Side Effect [0m[1;36m1[0m[39m**: Packets with invalid IHL < [0m[1;36m5[0m[39m will be dropped[0m                     [2m                [0m
[2;36m                    [0m         [39m- **Mitigation**: This is correct behavior per RFC [0m[1;36m791[0m[39m [0m[1;39m([0m[39mIHL must be >= [0m[1;36m5[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m- **Impact**: [0m[3;35mNone[0m[39m on legitimate traffic[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Side Effect [0m[1;36m2[0m[39m**: Packets with IHL > buffer size will be dropped  [0m                 [2m                [0m
[2;36m                    [0m         [39m- **Mitigation**: These are truncated/malformed packets that should be rejected[0m     [2m                [0m
[2;36m                    [0m         [39m- **Impact**: Prevents processing of incomplete packets[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Side Effect [0m[1;36m3[0m[39m**: Fragmented packets with insufficient payload will not set [0m       [2m                [0m
[2;36m                    [0m         [39mprotocol pointers[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- **Mitigation**: Error message is still logged via `mg_error`[0m                      [2m                [0m
[2;36m                    [0m         [39m- **Impact**: Prevents crashes from accessing uninitialized pointers[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Similar Solutions in Codebase[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe ARP and IPv6 handling already demonstrate the correct pattern:[0m                  [2m                [0m
[2;36m                    [0m         [39m- **ARP [0m[1;39m([0m[39mline [0m[1;36m873[0m[1;39m)[0m[39m**: Validates buffer size immediately after setting pointer[0m       [2m                [0m
[2;36m                    [0m         [39m- **IPv6 [0m[1;39m([0m[39mline [0m[1;36m878[0m[1;39m)[0m[39m**: Same pattern, validates before use[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix applies this same defensive pattern to IPv4 with variable header length [0m    [2m                [0m
[2;36m                    [0m         [39msupport.[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/06/26 17:50:49][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=881435;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=581098;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m4[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/06/26 17:55:00][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=361470;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=993396;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m4[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/06/26 17:56:12][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=665641;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=3684;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m4[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=801161;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=895387;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:56:13][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.98[0m seconds;              ]8;id=35275;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=96167;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Started[33m...[0m                            ]8;id=304247;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=77640;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpro87ooja[0m                                                 ]8;id=391468;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=766464;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/06/26 17:56:20][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Took [1;36m6.70[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=322797;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=908808;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Started[33m...[0m                      ]8;id=217713;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=604523;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:56:24][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Took [1;36m4.33[0m seconds;             ]8;id=832773;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=676711;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Started[33m...[0m                         ]8;id=933796;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=95884;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:56:26][0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=945846;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=318007;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#102\[2m102[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3841705035[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x562aaa1fa708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x562aaa1fbaa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x562aaa1fbaa8[0m[39m,[0m[1;36m0x562aaa20f448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x562aaa180c02[0m[39m bp [0m[1;36m0x7fffed52d880[0m[39m sp [0m[1;36m0x7fffed52d878[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x562aaa180c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x562aaa168d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x562aaa17d8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x562aa9fe9350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x562aa9fd45c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x562aa9fda05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x562aaa005302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fc63b94d082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x562aa9fcc7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x562aaa0f511f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x562aaa17d79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x562aa9fe9350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x562aa9fd45c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x562aa9fda05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x562aaa005302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fc63b94d082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp99vtwqw5[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=776417;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=210044;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#103\[2m103[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3841705035[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x562aaa1fa708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x562aaa1fbaa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x562aaa1fbaa8[0m[39m,[0m[1;36m0x562aaa20f448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x562aaa180c02[0m[39m bp [0m[1;36m0x7fffed52d880[0m[39m sp [0m[1;36m0x7fffed52d878[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x562aaa180c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x562aaa168d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x562aaa17d8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x562aa9fe9350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x562aa9fd45c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x562aa9fda05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x562aaa005302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fc63b94d082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x562aa9fcc7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x562aaa0f511f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x562aaa17d79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x562aa9fe9350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x562aa9fd45c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x562aa9fda05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x562aaa005302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fc63b94d082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp99vtwqw5[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [31m╭─[0m[31m──────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m───────────────────────[0m[31m─╮[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/evaluator/services/default/[0m[1m__init__.py[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m :97 in _evaluate_internal                                                        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 94 [0m[2m│   │   [0m[94mwith[0m logging_performance(context, header=[33m"[0m[33mRunning PoV[0m[33m"[0m):           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 95 [0m[2m│   │   │   [0m[94mtry[0m:                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 96 [0m[2m│   │   │   │   [0m[94mif[0m [96mlen[0m(detection.blobs) > [94m0[0m:                               [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 97 [2m│   │   │   │   │   [0menvironment.run_pov(context, detection)                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 98 [0m[2m│   │   │   │   [0m[94melse[0m:                                                      [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 99 [0m[2m│   │   │   │   │   [0mcontext[[33m"[0m[33mlogger[0m[33m"[0m].warning([33m"[0m[33mNo blob data found for the [0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m100 [0m                                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mcached.p[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1my[0m:56 in run_pov                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 53 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, detection: Detection            [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 54 [0m[2m│   [0m) -> [96mtuple[0m[[96mstr[0m, [96mstr[0m]:                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 55 [0m[2m│   │   [0m[94massert[0m [96mlen[0m(detection.blobs) > [94m0[0m, [33m"[0m[33mAt least one blob is required[0m[33m"[0m   [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 56 [2m│   │   [0m[94mreturn[0m [1;4;96mself[0m[1;4m.environment.run_pov(context, detection)[0m                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 57 [0m[2m│   [0m                                                                       [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 58 [0m[2m│   [0m[94mdef[0m[90m [0m[92mrun_tests[0m(                                                         [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 59 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, env: [96mdict[0m[[96mstr[0m, [96mstr[0m] = {}        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mdefault.[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1mpy[0m:210 in run_pov                                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m207 [0m[2m│   │   │   │   [0mcontext, blobinfo.blob, blobinfo.harness_name              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m208 [0m[2m│   │   │   [0m)                                                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m209 [0m[2m│   │   │   [0m[94mif[0m [95mnot[0m success:                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m210 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m ChallengePoVFoundError([0m                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m211 [0m[2m│   │   │   │   │   [0m[1;4mstdout=stdout.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m212 [0m[2m│   │   │   │   │   [0m[1;4mstderr=stderr.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m213 [0m[2m│   │   │   │   [0m[1;4m)[0m                                                          [31m│[0m [2m               [0m
[2;36m                    [0m         [31m╰──────────────────────────────────────────────────────────────────────────────────╯[0m [2m               [0m
[2;36m                    [0m         [1;91mChallengePoVFoundError: [0mPoV found:                                                   [2m               [0m
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3841705035[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x562aaa1fa708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x562aaa1fbaa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x562aaa1fbaa8[0m[39m,[0m[1;36m0x562aaa20f448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x562aaa180c02[0m[39m bp [0m[1;36m0x7fffed52d880[0m[39m sp [0m[1;36m0x7fffed52d878[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x562aaa180c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x562aaa168d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x562aaa17d8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x562aa9fe9350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x562aa9fd45c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x562aa9fda05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x562aaa005302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fc63b94d082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x562aa9fcc7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x562aaa0f511f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x562aaa17d79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x562aa9fe9350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x562aa9fd45c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x562aa9fda05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x562aaa005302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fc63b94d082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp99vtwqw5[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/06/26 17:56:27][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Took [1;36m2.22[0m seconds;                ]8;id=167123;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=22655;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=15985;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=162671;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.84[0m seconds;              ]8;id=40856;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=249820;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/06/26 17:56:28][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=426366;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=78234;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:56:29][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.97[0m seconds;              ]8;id=552701;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=550435;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=883677;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=861502;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         +++ b/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-382[0m,[1;36m7[0m +[1;36m382[0m,[1;36m8[0m @@                                                                 [2m                [0m
[2;36m                    [0m          static void [1;35mrx_icmp[0m[1m([0mstruct mg_tcpip_if *ifp, struct pkt *pkt[1m)[0m [1m{[0m                    [2m                [0m
[2;36m                    [0m            [35m/[0m[35m/[0m [1;35mMG_DEBUG[0m[1m([0m[1m([0m[32m"ICMP %d"[0m, [1m([0mint[1m)[0m len[1m)[0m[1m)[0m;                                             [2m                [0m
[2;36m                    [0m            if [1m([0mpkt->icmp->type == [1;36m8[0m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[1m)[0m [1m{[0m        [2m                [0m
[2;36m                    [0m         -    size_t hlen = [1;35msizeof[0m[1m([0mstruct eth[1m)[0m + [1;35msizeof[0m[1m([0mstruct ip[1m)[0m + [1;35msizeof[0m[1m([0mstruct icmp[1m)[0m;    [2m                [0m
[2;36m                    [0m         +    uint8_t ip_hlen = [1m([0mpkt->ip->ver & [1;36m0xF[0m[1m)[0m * [1;36m4[0m;                                    [2m                [0m
[2;36m                    [0m         +    size_t hlen = [1;35msizeof[0m[1m([0mstruct eth[1m)[0m + ip_hlen + [1;35msizeof[0m[1m([0mstruct icmp[1m)[0m;              [2m                [0m
[2;36m                    [0m              size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;                        [2m                [0m
[2;36m                    [0m              if [1m([0mplen > space[1m)[0m plen = space;                                                [2m                [0m
[2;36m                    [0m              struct ip *ip = [1;35mtx_ip[0m[1m([0mifp, pkt->eth->src, [1;36m1[0m, ifp->ip, pkt->ip->src,            [2m                [0m
[2;36m                    [0m         @@ [1;36m-792[0m,[1;36m20[0m +[1;36m793[0m,[1;36m24[0m @@                                                               [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          static void [1;35mrx_ip[0m[1m([0mstruct mg_tcpip_if *ifp, struct pkt *pkt[1m)[0m [1m{[0m                      [2m                [0m
[2;36m                    [0m         +  uint8_t ip_hlen = [1m([0mpkt->ip->ver & [1;36m0xF[0m[1m)[0m * [1;36m4[0m;                                      [2m                [0m
[2;36m                    [0m         +  void *ip_payload = [1m([0mchar *[1m)[0mpkt->ip + ip_hlen;                                    [2m                [0m
[2;36m                    [0m            uint16_t frag = [1;35mmg_ntohs[0m[1m([0mpkt->ip->frag[1m)[0m;                                         [2m                [0m
[2;36m                    [0m            if [1m([0mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[1m)[0m [1m{[0m                     [2m                [0m
[2;36m                    [0m         -    if [1m([0mpkt->ip->proto == [1;36m17[0m[1m)[0m pkt->udp = [1m([0mstruct udp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;             [2m                [0m
[2;36m                    [0m         -    if [1m([0mpkt->ip->proto == [1;36m6[0m[1m)[0m pkt->tcp = [1m([0mstruct tcp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;              [2m                [0m
[2;36m                    [0m         +    if [1m([0mpkt->ip->proto == [1;36m17[0m && pkt->pay.len >= [1;35msizeof[0m[1m([0mstruct udp[1m)[0m[1m)[0m                [2m                [0m
[2;36m                    [0m         +      pkt->udp = [1m([0mstruct udp *[1m)[0m ip_payload;                                        [2m                [0m
[2;36m                    [0m         +    if [1m([0mpkt->ip->proto == [1;36m6[0m && pkt->pay.len >= [1;35msizeof[0m[1m([0mstruct tcp[1m)[0m[1m)[0m                 [2m                [0m
[2;36m                    [0m         +      pkt->tcp = [1m([0mstruct tcp *[1m)[0m ip_payload;                                        [2m                [0m
[2;36m                    [0m              struct mg_connection *c = [1;35mgetpeer[0m[1m([0mifp->mgr, pkt, false[1m)[0m;                       [2m                [0m
[2;36m                    [0m              if [1m([0mc[1m)[0m [1;35mmg_error[0m[1m([0mc, [32m"Received fragmented packet"[0m[1m)[0m;                              [2m                [0m
[2;36m                    [0m            [1m}[0m else if [1m([0mpkt->ip->proto == [1;36m1[0m[1m)[0m [1m{[0m                                                [2m                [0m
[2;36m                    [0m         -    pkt->icmp = [1m([0mstruct icmp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;                                     [2m                [0m
[2;36m                    [0m         -    if [1m([0mpkt->pay.len [1m<[0m[39m [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m+    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m ip_payload;[0m                                        [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [39m-    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m+    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m ip_payload;[0m                                          [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m        [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m            [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-822[0m[39m,[0m[1;36m11[0m[39m +[0m[1;36m827[0m[39m,[0m[1;36m11[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m-    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m+    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m ip_payload;[0m                                          [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m-    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [39m+    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip_hlen + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m        [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m            [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-888[0m[39m,[0m[1;36m10[0m[39m +[0m[1;36m893[0m[39m,[0m[1;36m11[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m    [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m       [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle IPv4 [0m [2m                [0m
[2;36m                    [0m         [39moptions[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m-    else[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+    uint8_t ihl = pkt.ip->ver & [0m[1;36m0xF[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mihl < [0m[1;36m5[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m IHL must be at least [0m[1;36m5[0m[39m [0m[1;39m([0m[1;36m20[0m[39m bytes minimum[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m+    size_t ip_hlen = ihl * [0m[1;36m4[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hlen[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Buffer must contain [0m [2m                [0m
[2;36m                    [0m         [39mfull IP header[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + ip_hlen[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3841705035[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x562aaa1fa708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x562aaa1fbaa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x562aaa1fbaa8[0m[39m,[0m[1;36m0x562aaa20f448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x562aaa180c02[0m[39m bp [0m[1;36m0x7fffed52d880[0m[39m sp [0m[1;36m0x7fffed52d878[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x562aaa180c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x562aaa168d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x562aaa17d8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x562aa9fe9350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x562aa9fd45c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x562aa9fda05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x562aaa005302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fc63b94d082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x562aa9fcc7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x562aaa0f511f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x562aaa17d79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x562aa9fe9350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x562aa9fd45c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x562aa9fda05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x562aaa005302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fc63b94d082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp99vtwqw5[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2506875745[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55868688b708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55868688caa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55868688caa8[0m[39m,[0m[1;36m0x5586868a0448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x558686811c02[0m[39m bp [0m[1;36m0x7fffe2852160[0m[39m sp [0m[1;36m0x7fffe2852158[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x558686811c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x5586867f9d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55868680e8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55868667a350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5586866655c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55868666b05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x558686696302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fa4bb2fc082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55868665d7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55868678611f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55868680e79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55868667a350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5586866655c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55868666b05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x558686696302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fa4bb2fc082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpz8kxnkhj[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe initial issue reveals a heap-buffer-overflow vulnerability in the Mongoose [0m     [2m                [0m
[2;36m                    [0m         [39mnetworking library, specifically in the `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` function at line [0m[1;36m385[0m[39m of [0m        [2m                [0m
[2;36m                    [0m         [39m`src/net_builtin.c`. The AddressSanitizer detected a [0m[1;36m1[0m[39m-byte read beyond the bounds [0m [2m                [0m
[2;36m                    [0m         [39mof a [0m[1;36m34[0m[39m-byte heap-allocated buffer. A patch was applied that attempted to add [0m      [2m                [0m
[2;36m                    [0m         [39madditional length validation checks and properly calculate IP header offsets before[0m [2m                [0m
[2;36m                    [0m         [39maccessing protocol-specific structures. However, after applying the patch, the [0m     [2m                [0m
[2;36m                    [0m         [39midentical heap-buffer-overflow error persists at the same location [0m[1;39m([0m[39m`[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` at [0m [2m                [0m
[2;36m                    [0m         [39mline [0m[1;36m385[0m[1;39m)[0m[39m, indicating that the patch did not successfully resolve the root cause of[0m [2m                [0m
[2;36m                    [0m         [39mthe vulnerability.[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Initial Issue Analysis[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe initial issue presents a heap-buffer-overflow error with the following key [0m     [2m                [0m
[2;36m                    [0m         [39mcharacteristics:[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Location**: The overflow occurs in the `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` function at [0m                [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m`[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Operation**: A READ operation of size [0m[1;36m1[0m[39m byte at address `[0m[1;36m0x504000000172[0m[39m`[0m       [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Buffer Details**: The address is located exactly [0m[1;36m0[0m[39m bytes after a [0m[1;36m34[0m[39m-byte [0m      [2m                [0m
[2;36m                    [0m         [39mregion `[0m[1;39m[[0m[1;36m0x504000000150[0m[39m, [0m[1;36m0x504000000172[0m[1;39m)[0m[39m`[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Call Stack**: The error is triggered through the following sequence:[0m           [2m                [0m
[2;36m                    [0m         [39m   - `LLVMFuzzerTestOneInput` [0m[1;39m([0m[39mfuzz.[0m[1;92mc:106[0m[1;39m)[0m[39m - Entry point[0m                            [2m                [0m
[2;36m                    [0m         [39m   - `mg_tcpip_rx` [0m[1;39m([0m[39mnet_builtin.[0m[1;92mc:897[0m[1;39m)[0m[39m - TCP/IP packet processing[0m                   [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mnet_builtin.[0m[1;92mc:385[0m[1;39m)[0m[39m - ICMP packet handling[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe scariness score of [0m[1;36m12[0m[39m indicates a significant severity level for this [0m          [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m-byte-read-heap-buffer-overflow.[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Patch Attempt Description[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe patch introduces several modifications to the `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m`, `[0m[1;35mrx_ip6[0m[1;39m([0m[1;39m)[0m[39m`, and [0m       [2m                [0m
[2;36m                    [0m         [39mrelated functions in `src/net_builtin.c`:[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **IP Header Length Calculation**: [0m                                               [2m                [0m
[2;36m                    [0m         [39m   - Adds explicit calculation of IP header length: `uint8_t ip_hlen = [0m             [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;`[0m                                                          [2m                [0m
[2;36m                    [0m         [39m   - Creates a pointer to IP payload: `void *ip_payload = [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + [0m        [2m                [0m
[2;36m                    [0m         [39mip_hlen;`[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Enhanced Validation for Fragmented Packets**:[0m                                  [2m                [0m
[2;36m                    [0m         [39m   - Adds length checks before assigning UDP/TCP structures in fragmented packet [0m   [2m                [0m
[2;36m                    [0m         [39mhandling[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   - Changes from `[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m` to `ip_payload` for accessing protocol structures[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Protocol-Specific Structure Access**:[0m                                          [2m                [0m
[2;36m                    [0m         [39m   - For ICMP [0m[1;39m([0m[39mproto == [0m[1;36m1[0m[1;39m)[0m[39m: Validates `pkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m` before [0m  [2m                [0m
[2;36m                    [0m         [39massignment[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   - For UDP [0m[1;39m([0m[39mproto == [0m[1;36m17[0m[1;39m)[0m[39m: Validates `pkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct udp[0m[1;39m)[0m[39m` before [0m   [2m                [0m
[2;36m                    [0m         [39massignment  [0m                                                                        [2m                [0m
[2;36m                    [0m         [39m   - For TCP [0m[1;39m([0m[39mproto == [0m[1;36m6[0m[1;39m)[0m[39m: Validates `pkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct tcp[0m[1;39m)[0m[39m` before [0m    [2m                [0m
[2;36m                    [0m         [39massignment[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   - All protocol structure assignments now use `ip_payload` instead of `[0m[1;39m([0m[39mpkt->ip +[0m [2m                [0m
[2;36m                    [0m         [1;36m1[0m[1;39m)[0m[39m`[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **IP Header Length Validation in [0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m**:[0m                                [2m                [0m
[2;36m                    [0m         [39m   - Adds validation: `if [0m[1;39m([0m[39mihl < [0m[1;36m5[0m[1;39m)[0m[39m return;` to ensure minimum valid IHL value[0m      [2m                [0m
[2;36m                    [0m         [39m   - Adds check: `if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hlen[0m[1;39m)[0m[39m return;` to [0m        [2m                [0m
[2;36m                    [0m         [39mvalidate buffer contains full IP header[0m                                             [2m                [0m
[2;36m                    [0m         [39m   - Updates payload calculation to use computed `ip_hlen` instead of conditional [0m  [2m                [0m
[2;36m                    [0m         [39mlogic[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **IPv6 Handling**:[0m                                                               [2m                [0m
[2;36m                    [0m         [39m   - Reorders length checks to occur before structure assignment for both ICMP and [0m [2m                [0m
[2;36m                    [0m         [39mUDP in `[0m[1;35mrx_ip6[0m[1;39m([0m[1;39m)[0m[39m`[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Post-Patch Results[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter applying the patch, the identical error persists:[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Same Error Location**: `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m385[0m[39m [0m[1;39m([0m[39mnote: line number unchanged [0m    [2m                [0m
[2;36m                    [0m         [39mdespite patch modifications[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [39m- **Same Memory Address**: Read at `[0m[1;36m0x504000000172[0m[39m`, which is [0m[1;36m0[0m[39m bytes after the [0m    [2m                [0m
[2;36m                    [0m         [39msame [0m[1;36m34[0m[39m-byte region[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- **Same Call Stack**: The execution path remains identical through [0m                [2m                [0m
[2;36m                    [0m         [39m`LLVMFuzzerTestOneInput` → `mg_tcpip_rx` → `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m`[0m                              [2m                [0m
[2;36m                    [0m         [39m- **Same Scariness Score**: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis indicates that while the patch added validation logic in the packet processing[0m [2m                [0m
[2;36m                    [0m         [39mpath, it did not prevent the buffer overflow from occurring within the `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` [0m [2m                [0m
[2;36m                    [0m         [39mfunction itself.[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas Requiring Further Investigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo obtain a holistic view of the issue, the following areas should be examined:[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **The `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` Function Implementation**: Line [0m[1;36m385[0m[39m specifically needs [0m        [2m                [0m
[2;36m                    [0m         [39mscrutiny to understand what read operation is occurring and what bounds checking is[0m [2m                [0m
[2;36m                    [0m         [39mmissing within this function itself.[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **The `[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m` Function**: This function is called before `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` with [0m     [2m                [0m
[2;36m                    [0m         [39m`pkt->icmp + [0m[1;36m1[0m[39m` as an argument. Understanding how it calculates and sets payload [0m   [2m                [0m
[2;36m                    [0m         [39mboundaries is crucial.[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Packet Structure Definition**: The `struct pkt` and its `pay` member need [0m     [2m                [0m
[2;36m                    [0m         [39mexamination to understand how payload length tracking works and whether it's [0m       [2m                [0m
[2;36m                    [0m         [39mcorrectly maintained throughout the parsing chain.[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Buffer Allocation in Fuzzer**: The [0m[1;36m34[0m[39m-byte allocation in `fuzz.[0m[1;92mc:95[0m[39m` suggests [0m [2m                [0m
[2;36m                    [0m         [39mthe test input is very small. Understanding the minimum required packet size versus[0m [2m                [0m
[2;36m                    [0m         [39mactual input size may reveal inadequate early validation.[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **ICMP Structure Definition**: The layout and size of `struct icmp` and what [0m    [2m                [0m
[2;36m                    [0m         [39mfields are accessed at line [0m[1;36m385[0m[39m would clarify why the read extends beyond the [0m      [2m                [0m
[2;36m                    [0m         [39mbuffer.[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Payload Length Propagation**: Tracking how `pkt->pay.len` is set and updated [0m  [2m                [0m
[2;36m                    [0m         [39mthrough the call chain from `mg_tcpip_rx` → `rx_ip` → `rx_icmp` to ensure length [0m   [2m                [0m
[2;36m                    [0m         [39mchecks are based on accurate values.[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. **The Relationship Between IP Header Options and Payload**: The patch addresses [0m [2m                [0m
[2;36m                    [0m         [39mIP header length calculation, but the persistent error suggests the payload length [0m [2m                [0m
[2;36m                    [0m         [39madjustments may not be correctly accounting for the actual available buffer space [0m  [2m                [0m
[2;36m                    [0m         [39mafter accounting for all headers.[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2506875745[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55868688b708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55868688caa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55868688caa8[0m[39m,[0m[1;36m0x5586868a0448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x558686811c02[0m[39m bp [0m[1;36m0x7fffe2852160[0m[39m sp [0m[1;36m0x7fffe2852158[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x558686811c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x5586867f9d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55868680e8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55868667a350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5586866655c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55868666b05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x558686696302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fa4bb2fc082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55868665d7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55868678611f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55868680e79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55868667a350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5586866655c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55868666b05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x558686696302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fa4bb2fc082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpz8kxnkhj[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3471293335[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55ed4bedc708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55ed4beddaa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55ed4beddaa8[0m[39m,[0m[1;36m0x55ed4bef1448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55ed4be62c02[0m[39m bp [0m[1;36m0x7ffdcad351c0[0m[39m sp [0m[1;36m0x7ffdcad351b8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55ed4be62c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55ed4be4ad1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55ed4be5f8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55ed4bccb350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55ed4bcb65c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55ed4bcbc05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55ed4bce7302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f4f9d909082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55ed4bcae7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55ed4bdd711f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55ed4be5f79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55ed4bccb350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55ed4bcb65c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55ed4bcbc05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55ed4bce7302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f4f9d909082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpp9asns7b[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:72[0m[39m-[0m[1;36m77[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:struct icmp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  uint8_t type;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint8_t code;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  uint16_t csum;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:72[0m[39m-[0m[1;36m77[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:struct icmp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  uint8_t type;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint8_t code;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  uint16_t csum;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtest/fuzz.[0m[1;92mc:85[0m[39m-[0m[1;36m110[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:  if [0m[1;39m([0m[39msize > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    struct mg_tcpip_if mif = [0m[1;39m{[0m[39m.ip = [0m[1;36m0x01020304[0m[39m,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                              .mask = [0m[1;36m255[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                              .gw = [0m[1;36m0x01010101[0m[39m,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                              .driver = &mg_tcpip_driver_mock[0m[1;39m}[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    struct mg_mgr mgr;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    [0m[1;35mmg_mgr_init[0m[1;39m([0m[39m&mgr[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    [0m[1;35mmg_tcpip_init[0m[1;39m([0m[39m&mgr, &mif[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[35m/[0m[35m/[0m[39m Make a copy of the random data, in order to modify it[0m                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    void *pkt = [0m[1;35mmalloc[0m[1;39m([0m[39msize[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    struct eth *eth = [0m[1;39m([0m[39mstruct eth *[0m[1;39m)[0m[39m pkt;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39mpkt, data, size[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    if [0m[1;39m([0m[39msize > [0m[1;35msizeof[0m[1;39m([0m[39m*eth[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:      static size_t i;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:      uint16_t eth_types[0m[1;39m[[0m[1;39m][0m[39m = [0m[1;39m{[0m[1;36m0x800[0m[39m, [0m[1;36m0x800[0m[39m, [0m[1;36m0x806[0m[39m, [0m[1;36m0x86dd[0m[1;39m}[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39meth->dst, mif.mac, [0m[1;36m6[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Set valid destination MAC[0m               [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:      eth->type = [0m[1;35mmg_htons[0m[1;39m([0m[39meth_types[0m[1;39m[[0m[39mi++[0m[1;39m][0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:      if [0m[1;39m([0m[39mi >= [0m[1;35msizeof[0m[1;39m([0m[39meth_types[0m[1;39m)[0m[39m [0m[35m/[0m[39m [0m[1;35msizeof[0m[1;39m([0m[39meth_types[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[1;39m)[0m[39m i = [0m[1;36m0[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:    [0m[1;35mmg_tcpip_rx[0m[1;39m([0m[39m&mif, pkt, size[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    [0m[35m/[0m[35m/[0m[39m Test HTTP serving[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    const char *url = [0m[32m"http://localhost:12345"[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    struct mg_connection *c = [0m[1;35mmg_http_connect[0m[1;39m([0m[39m&mgr, url, fn, NULL[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m800[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:806[0m[39m-[0m[1;36m823[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:824[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:838[0m[39m-[0m[1;36m852[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m838[0m[39m:static void [0m[1;35mrx_ip6[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m839[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"IP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m840[0m[39m:  if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m1[0m[39m || pkt->ip6->proto == [0m[1;36m58[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m841[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m842[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m843[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m844[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m845[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m846[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m847[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m848[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"  UDP %u %u -> %u"[0m[39m, len, [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->sport[0m[1;39m)[0m[39m,[0m                [2m                [0m
[2;36m                    [0m         [1;36m849[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->dport[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m850[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m851[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m852[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:62[0m[39m-[0m[1;36m70[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:struct ip6 [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:  uint8_t ver;      [0m[35m/[0m[35m/[0m[39m Version[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:  uint8_t opts[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Options[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:  uint16_t len;     [0m[35m/[0m[35m/[0m[39m Length[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:  uint8_t proto;    [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:  uint8_t ttl;      [0m[35m/[0m[35m/[0m[39m Time to live[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:  uint8_t src[0m[1;39m[[0m[1;36m16[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:  uint8_t dst[0m[1;39m[[0m[1;36m16[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:106[0m[39m-[0m[1;36m115[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:  uint16_t urp;   [0m[35m/[0m[35m/[0m[39m Urgent pointer[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:struct udp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:  uint16_t sport;  [0m[35m/[0m[35m/[0m[39m Source port[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:  uint16_t dport;  [0m[35m/[0m[35m/[0m[39m Destination port[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:  uint16_t len;    [0m[35m/[0m[35m/[0m[39m UDP length[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:  uint16_t csum;   [0m[35m/[0m[35m/[0m[39m UDP checksum[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:90[0m[39m-[0m[1;36m104[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:struct tcp [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:  uint16_t sport;  [0m[35m/[0m[35m/[0m[39m Source port[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:  uint16_t dport;  [0m[35m/[0m[35m/[0m[39m Destination port[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:  uint32_t seq;    [0m[35m/[0m[35m/[0m[39m Sequence number[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:  uint32_t ack;    [0m[35m/[0m[35m/[0m[39m Acknowledgement number[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:  uint8_t off;     [0m[35m/[0m[35m/[0m[39m Data offset[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:  uint8_t flags;   [0m[35m/[0m[35m/[0m[39m TCP flags[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:#define TH_FIN [0m[1;36m0x01[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:#define TH_SYN [0m[1;36m0x02[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:#define TH_RST [0m[1;36m0x04[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:#define TH_PUSH [0m[1;36m0x08[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:#define TH_ACK [0m[1;36m0x10[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:#define TH_URG [0m[1;36m0x20[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:#define TH_ECE [0m[1;36m0x40[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:#define TH_CWR [0m[1;36m0x80[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:129[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:struct pkt [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:  struct mg_str raw;  [0m[35m/[0m[35m/[0m[39m Raw packet data[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:  struct mg_str pay;  [0m[35m/[0m[35m/[0m[39m Payload data[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:  struct eth *eth;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:  struct llc *llc;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:  struct arp *arp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:  struct ip *ip;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:  struct ip6 *ip6;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:  struct icmp *icmp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:  struct tcp *tcp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:  struct udp *udp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:  struct dhcp *dhcp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:static void [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, int ev, void *ev_data[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:  if [0m[1;39m([0m[39mifp->fn != NULL[0m[1;39m)[0m[39m ifp->[0m[1;35mfn[0m[1;39m([0m[39mifp, ev, ev_data[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:static void [0m[1;35msend_syn[0m[1;39m([0m[39mstruct mg_connection *c[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:824[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m809[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:854[0m[39m-[0m[1;36m880[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m854[0m[39m:void [0m[1;35mmg_tcpip_rx[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, void *buf, size_t len[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m855[0m[39m:  struct pkt pkt;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m856[0m[39m:  [0m[1;35mmemset[0m[1;39m([0m[39m&pkt, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mpkt[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m857[0m[39m:  pkt.raw.buf = [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m buf;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m858[0m[39m:  pkt.raw.len = len;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m859[0m[39m:  pkt.eth = [0m[1;39m([0m[39mstruct eth *[0m[1;39m)[0m[39m buf;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m860[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_hexdump[0m[1;39m([0m[39mbuf, len > [0m[1;36m16[0m[39m ? [0m[1;36m16[0m[39m: len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m861[0m[39m:  if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated - runt?[0m             [2m                [0m
[2;36m                    [0m         [1;36m862[0m[39m:  if [0m[1;39m([0m[39mifp->enable_mac_check &&[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m863[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, ifp->mac, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[39m &&[0m              [2m                [0m
[2;36m                    [0m         [1;36m864[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, broadcast, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m865[0m[39m:    return;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m866[0m[39m:  if [0m[1;39m([0m[39mifp->enable_crc32_check && len > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m867[0m[39m:    len -= [0m[1;36m4[0m[39m;  [0m[35m/[0m[35m/[0m[39m [0m[1;35mTODO[0m[1;39m([0m[39mscaprile[0m[1;39m)[0m[39m: check on bigendian[0m                            [2m                [0m
[2;36m                    [0m         [1;36m868[0m[39m:    uint32_t crc = [0m[1;35mmg_crc32[0m[1;39m([0m[1;36m0[0m[39m, [0m[1;39m([0m[39mconst char *[0m[1;39m)[0m[39m buf, len[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m869[0m[39m:    if [0m[1;39m([0m[1;35mmemcmp[0m[1;39m([0m[1;39m([0m[39mvoid *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m buf + len[0m[1;39m)[0m[39m, &crc, [0m[1;35msizeof[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m return;[0m       [2m                [0m
[2;36m                    [0m         [1;36m870[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m871[0m[39m:  if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x806[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m872[0m[39m:    pkt.arp = [0m[1;39m([0m[39mstruct arp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m873[0m[39m:    if [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.arp[0m[1;39m)[0m[39m > pkt.raw.len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m874[0m[39m:    [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mifp, MG_TCPIP_EV_ARP, &pkt.raw[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m875[0m[39m:    [0m[1;35mrx_arp[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m876[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x86dd[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m877[0m[39m:    pkt.ip6 = [0m[1;39m([0m[39mstruct ip6 *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m878[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip6[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m879[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip6->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m0x6[0m[1;39m)[0m[39m return;                         [0m[35m/[0m[35m/[0m[39m Not IP[0m   [2m                [0m
[2;36m                    [0m         [1;36m880[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:129[0m[39m-[0m[1;36m141[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:struct pkt [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:  struct mg_str raw;  [0m[35m/[0m[35m/[0m[39m Raw packet data[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:  struct mg_str pay;  [0m[35m/[0m[35m/[0m[39m Payload data[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:  struct eth *eth;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:  struct llc *llc;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:  struct arp *arp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:  struct ip *ip;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:  struct ip6 *ip6;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:  struct icmp *icmp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:  struct tcp *tcp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:  struct udp *udp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:  struct dhcp *dhcp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:398[0m[39m-[0m[1;36m420[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:static void [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:  uint32_t ip = [0m[1;36m0[0m[39m, gw = [0m[1;36m0[0m[39m, mask = [0m[1;36m0[0m[39m, lease = [0m[1;36m0[0m[39m, dns = [0m[1;36m0[0m[39m, sntp = [0m[1;36m0[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:  uint8_t msgtype = [0m[1;36m0[0m[39m, state = ifp->state;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:  [0m[35m/[0m[35m/[0m[39m perform size check first, then access fields[0m                               [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:  uint8_t *p = pkt->dhcp->options,[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:          *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:  if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:  if [0m[1;39m([0m[1;35mmemcmp[0m[1;39m([0m[39m&pkt->dhcp->xid, ifp->mac + [0m[1;36m2[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mpkt->dhcp->xid[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m return;[0m    [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:  while [0m[1;39m([0m[39mp + [0m[1;36m1[0m[39m < end && p[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m != [0m[1;36m255[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m  [0m[35m/[0m[35m/[0m[39m Parse options RFC-[0m[1;36m1533[0m[39m #[0m[1;36m9[0m            [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:    if [0m[1;39m([0m[39mp[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[1;36m1[0m[39m && p[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m == [0m[1;35msizeof[0m[1;39m([0m[39mifp->mask[0m[1;39m)[0m[39m && p + [0m[1;36m6[0m[39m < end[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m  [0m[35m/[0m[35m/[0m[39m Mask[0m       [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39m&mask, p + [0m[1;36m2[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mmask[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m409[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mp[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[1;36m3[0m[39m && p[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m == [0m[1;35msizeof[0m[1;39m([0m[39mifp->gw[0m[1;39m)[0m[39m && p + [0m[1;36m6[0m[39m < end[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m  [0m[35m/[0m[35m/[0m[39m GW[0m    [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39m&gw, p + [0m[1;36m2[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mgw[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:      ip = pkt->dhcp->yiaddr;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_req_dns && p[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[1;36m6[0m[39m && p[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m == [0m[1;35msizeof[0m[1;39m([0m[39mdns[0m[1;39m)[0m[39m &&[0m       [2m                [0m
[2;36m                    [0m         [1;36m413[0m[39m:               p + [0m[1;36m6[0m[39m < end[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m  [0m[35m/[0m[35m/[0m[39m DNS[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m414[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39m&dns, p + [0m[1;36m2[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mdns[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_req_sntp && p[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[1;36m42[0m[39m && p[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m == [0m[1;35msizeof[0m[1;39m([0m[39msntp[0m[1;39m)[0m[39m &&[0m    [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:               p + [0m[1;36m6[0m[39m < end[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m  [0m[35m/[0m[35m/[0m[39m SNTP[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39m&sntp, p + [0m[1;36m2[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39msntp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mp[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[1;36m51[0m[39m && p[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m == [0m[1;36m4[0m[39m && p + [0m[1;36m6[0m[39m < end[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m  [0m[35m/[0m[35m/[0m[39m Lease[0m              [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39m&lease, p + [0m[1;36m2[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mlease[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:      lease = [0m[1;35mmg_ntohl[0m[1;39m([0m[39mlease[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m800[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:240[0m[39m-[0m[1;36m280[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:static void [0m[1;35mtx_udp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, uint8_t *mac_dst, uint32_t ip_src,[0m  [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:                   uint16_t sport, uint32_t ip_dst, uint16_t dport,[0m             [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:                   const void *buf, size_t len[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:  struct ip *ip =[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:      [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, mac_dst, [0m[1;36m17[0m[39m, ip_src, ip_dst, len + [0m[1;35msizeof[0m[1;39m([0m[39mstruct udp[0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:  struct udp *udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"UDP XX LEN %d %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m ifp->tx.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:  udp->sport = sport;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:  udp->dport = dport;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:  udp->len = [0m[1;35mmg_htons[0m[1;39m([0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*udp[0m[1;39m)[0m[39m + len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:  udp->csum = [0m[1;36m0[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:  uint32_t cs = [0m[1;35mcsumup[0m[1;39m([0m[1;36m0[0m[39m, udp, [0m[1;35msizeof[0m[1;39m([0m[39m*udp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:  cs = [0m[1;35mcsumup[0m[1;39m([0m[39mcs, buf, len[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:  cs = [0m[1;35mcsumup[0m[1;39m([0m[39mcs, &ip->src, [0m[1;35msizeof[0m[1;39m([0m[39mip->src[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:  cs = [0m[1;35mcsumup[0m[1;39m([0m[39mcs, &ip->dst, [0m[1;35msizeof[0m[1;39m([0m[39mip->dst[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:  cs += [0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip->proto + [0m[1;35msizeof[0m[1;39m([0m[39m*udp[0m[1;39m)[0m[39m + len[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:  udp->csum = [0m[1;35mcsumfin[0m[1;39m([0m[39mcs[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:  [0m[1;35mmemmove[0m[1;39m([0m[39mudp + [0m[1;36m1[0m[39m, buf, len[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"UDP LEN %d %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m ifp->frame_len[0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:  [0m[1;35mether_output[0m[1;39m([0m[39mifp, [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*udp[0m[1;39m)[0m[39m + len[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:static void [0m[1;35mtx_dhcp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, uint8_t *mac_dst, uint32_t ip_src,[0m [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:                    uint32_t ip_dst, uint8_t *opts, size_t optslen,[0m             [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:                    bool ciaddr[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[4;94mhttps://datatracker.ietf.org/doc/html/rfc2132#section-9.6[0m                  [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:  struct dhcp dhcp = [0m[1;39m{[0m[1;36m1[0m[39m, [0m[1;36m1[0m[39m, [0m[1;36m6[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0[0m[39m, [0m[1;39m{[0m[1;36m0[0m[1;39m}[0m[39m, [0m[1;36m0[0m[39m, [0m[1;39m{[0m[1;36m0[0m[1;39m}[0m[1;39m}[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:  dhcp.magic = [0m[1;35mmg_htonl[0m[1;39m([0m[1;36m0x63825363[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:  [0m[1;35mmemcpy[0m[1;39m([0m[39m&dhcp.hwaddr, ifp->mac, [0m[1;35msizeof[0m[1;39m([0m[39mifp->mac[0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:  [0m[1;35mmemcpy[0m[1;39m([0m[39m&dhcp.xid, ifp->mac + [0m[1;36m2[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mdhcp.xid[0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:  [0m[1;35mmemcpy[0m[1;39m([0m[39m&dhcp.options, opts, optslen[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:  if [0m[1;39m([0m[39mciaddr[0m[1;39m)[0m[39m dhcp.ciaddr = ip_src;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:  [0m[1;35mtx_udp[0m[1;39m([0m[39mifp, mac_dst, ip_src, [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[39m, ip_dst, [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[39m, &dhcp,[0m       [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:         [0m[1;35msizeof[0m[1;39m([0m[39mdhcp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:static const uint8_t broadcast[0m[1;39m[[0m[1;39m][0m[39m = [0m[1;39m{[0m[1;36m255[0m[39m, [0m[1;36m255[0m[39m, [0m[1;36m255[0m[39m, [0m[1;36m255[0m[39m, [0m[1;36m255[0m[39m, [0m[1;36m255[0m[1;39m}[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:[0m[35m/[0m[35m/[0m[39m RFC-[0m[1;36m2131[0m[39m #[0m[1;36m4.3[0m[39m.[0m[1;36m6[0m[39m, #[0m[1;36m4.4[0m[39m.[0m[1;36m1[0m[39m; RFC-[0m[1;36m2132[0m[39m #[0m[1;36m9.8[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:490[0m[39m-[0m[1;36m518[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m490[0m[39m:      ifp->gw = res.yiaddr;  [0m[35m/[0m[35m/[0m[39m set gw IP, best-effort gwmac as DHCP server's[0m   [2m                [0m
[2;36m                    [0m         [1;36m491[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39mifp->gwmac, pkt->eth->src, [0m[1;35msizeof[0m[1;39m([0m[39mifp->gwmac[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m492[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:    [0m[1;35mtx_udp[0m[1;39m([0m[39mifp, pkt->eth->src, ifp->ip, [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[39m,[0m                           [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:           op == [0m[1;36m1[0m[39m ? ~0U : res.yiaddr, [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[39m, &res, [0m[1;35msizeof[0m[1;39m([0m[39mres[0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:static void [0m[1;35mrx_udp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:  struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, true[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:  if [0m[1;39m([0m[39mc == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:    [0m[35m/[0m[35m/[0m[39m No UDP listener on this port. Should send ICMP, but keep silent.[0m         [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:  [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:    c->rem.port = pkt->udp->sport;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39mc->rem.ip, &pkt->ip->src, [0m[1;35msizeof[0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:    struct connstate *s = [0m[1;39m([0m[39mstruct connstate *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mc + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39ms->mac, pkt->eth->src, [0m[1;35msizeof[0m[1;39m([0m[39ms->mac[0m[1;39m)[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m507[0m[39m:    if [0m[1;39m([0m[39mc->recv.len >= MG_MAX_RECV_SIZE[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:      [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"max_recv_buf_size reached"[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc->recv.size - c->recv.len < pkt->pay.len &&[0m                     [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:               ![0m[1;35mmg_iobuf_resize[0m[1;39m([0m[39m&c->recv, c->recv.len + pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:      [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"oom"[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39m&c->recv.buf[0m[1;39m[[0m[39mc->recv.len[0m[1;39m][0m[39m, pkt->pay.buf, pkt->pay.len[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:      c->recv.len += pkt->pay.len;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:      [0m[1;35mmg_call[0m[1;39m([0m[39mc, MG_EV_READ, &pkt->pay.len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m517[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m518[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:32[0m[39m-[0m[1;36m45[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:  bool twclosure;        [0m[35m/[0m[35m/[0m[39m [0m[1;36m3[0m[39m-way closure done[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:#pragma [0m[1;35mpack[0m[1;39m([0m[39mpush, [0m[1;36m1[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:struct lcp [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:  uint8_t addr, ctrl, proto[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m, code, id, len[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:struct eth [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:  uint8_t dst[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Destination MAC address[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:  uint8_t src[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Source MAC address[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:  uint16_t type;   [0m[35m/[0m[35m/[0m[39m Ethernet type[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:72[0m[39m-[0m[1;36m77[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:struct icmp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  uint8_t type;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint8_t code;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  uint16_t csum;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:106[0m[39m-[0m[1;36m115[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:  uint16_t urp;   [0m[35m/[0m[35m/[0m[39m Urgent pointer[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:struct udp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:  uint16_t sport;  [0m[35m/[0m[35m/[0m[39m Source port[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:  uint16_t dport;  [0m[35m/[0m[35m/[0m[39m Destination port[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:  uint16_t len;    [0m[35m/[0m[35m/[0m[39m UDP length[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:  uint16_t csum;   [0m[35m/[0m[35m/[0m[39m UDP checksum[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:90[0m[39m-[0m[1;36m104[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:struct tcp [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:  uint16_t sport;  [0m[35m/[0m[35m/[0m[39m Source port[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:  uint16_t dport;  [0m[35m/[0m[35m/[0m[39m Destination port[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:  uint32_t seq;    [0m[35m/[0m[35m/[0m[39m Sequence number[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:  uint32_t ack;    [0m[35m/[0m[35m/[0m[39m Acknowledgement number[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:  uint8_t off;     [0m[35m/[0m[35m/[0m[39m Data offset[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:  uint8_t flags;   [0m[35m/[0m[35m/[0m[39m TCP flags[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:#define TH_FIN [0m[1;36m0x01[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:#define TH_SYN [0m[1;36m0x02[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:#define TH_RST [0m[1;36m0x04[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:#define TH_PUSH [0m[1;36m0x08[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:#define TH_ACK [0m[1;36m0x10[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:#define TH_URG [0m[1;36m0x20[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:#define TH_ECE [0m[1;36m0x40[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:#define TH_CWR [0m[1;36m0x80[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:154[0m[39m-[0m[1;36m180[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:static uint32_t [0m[1;35mcsumup[0m[1;39m([0m[39muint32_t sum, const void *buf, size_t len[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:  size_t i;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:  const uint8_t *p = [0m[1;39m([0m[39mconst uint8_t *[0m[1;39m)[0m[39m buf;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:  for [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < len; i++[0m[1;39m)[0m[39m sum += i & [0m[1;36m1[0m[39m ? p[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m : [0m[1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39m p[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;39m)[0m[39m << [0m[1;36m8[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:  return sum;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:static uint16_t [0m[1;35mcsumfin[0m[1;39m([0m[39muint32_t sum[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:  while [0m[1;39m([0m[39msum >> [0m[1;36m16[0m[1;39m)[0m[39m sum = [0m[1;39m([0m[39msum & [0m[1;36m0xffff[0m[1;39m)[0m[39m + [0m[1;39m([0m[39msum >> [0m[1;36m16[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:  return [0m[1;35mmg_htons[0m[1;39m([0m[39m~sum & [0m[1;36m0xffff[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:static uint16_t [0m[1;35mipcsum[0m[1;39m([0m[39mconst void *buf, size_t len[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:  uint32_t sum = [0m[1;35mcsumup[0m[1;39m([0m[1;36m0[0m[39m, buf, len[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:  return [0m[1;35mcsumfin[0m[1;39m([0m[39msum[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:static void [0m[1;35msettmout[0m[1;39m([0m[39mstruct mg_connection *c, uint8_t type[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:  struct mg_tcpip_if *ifp = c->mgr->ifp;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:  struct connstate *s = [0m[1;39m([0m[39mstruct connstate *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mc + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:  unsigned n = type == MIP_TTYPE_ACK   ? MIP_TCP_ACK_MS[0m                         [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:               : type == MIP_TTYPE_ARP ? MIP_ARP_RESP_MS[0m                        [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:               : type == MIP_TTYPE_SYN ? MIP_TCP_SYN_MS[0m                         [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:               : type == MIP_TTYPE_FIN ? MIP_TCP_FIN_MS[0m                         [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:                                       : MIP_TCP_KEEPALIVE_MS;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:  s->timer = ifp->now + n;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:  s->ttype = type;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtest/fuzz.[0m[1;92mc:95[0m[39m-[0m[1;36m106[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    void *pkt = [0m[1;35mmalloc[0m[1;39m([0m[39msize[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    struct eth *eth = [0m[1;39m([0m[39mstruct eth *[0m[1;39m)[0m[39m pkt;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39mpkt, data, size[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    if [0m[1;39m([0m[39msize > [0m[1;35msizeof[0m[1;39m([0m[39m*eth[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:      static size_t i;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:      uint16_t eth_types[0m[1;39m[[0m[1;39m][0m[39m = [0m[1;39m{[0m[1;36m0x800[0m[39m, [0m[1;36m0x800[0m[39m, [0m[1;36m0x806[0m[39m, [0m[1;36m0x86dd[0m[1;39m}[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39meth->dst, mif.mac, [0m[1;36m6[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Set valid destination MAC[0m               [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:      eth->type = [0m[1;35mmg_htons[0m[1;39m([0m[39meth_types[0m[1;39m[[0m[39mi++[0m[1;39m][0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:      if [0m[1;39m([0m[39mi >= [0m[1;35msizeof[0m[1;39m([0m[39meth_types[0m[1;39m)[0m[39m [0m[35m/[0m[39m [0m[1;35msizeof[0m[1;39m([0m[39meth_types[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[1;39m)[0m[39m i = [0m[1;36m0[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:    [0m[1;35mmg_tcpip_rx[0m[1;39m([0m[39m&mif, pkt, size[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:854[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m854[0m[39m:void [0m[1;35mmg_tcpip_rx[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, void *buf, size_t len[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m855[0m[39m:  struct pkt pkt;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m856[0m[39m:  [0m[1;35mmemset[0m[1;39m([0m[39m&pkt, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mpkt[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m857[0m[39m:  pkt.raw.buf = [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m buf;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m858[0m[39m:  pkt.raw.len = len;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m859[0m[39m:  pkt.eth = [0m[1;39m([0m[39mstruct eth *[0m[1;39m)[0m[39m buf;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m860[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_hexdump[0m[1;39m([0m[39mbuf, len > [0m[1;36m16[0m[39m ? [0m[1;36m16[0m[39m: len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m861[0m[39m:  if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated - runt?[0m             [2m                [0m
[2;36m                    [0m         [1;36m862[0m[39m:  if [0m[1;39m([0m[39mifp->enable_mac_check &&[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m863[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, ifp->mac, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[39m &&[0m              [2m                [0m
[2;36m                    [0m         [1;36m864[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, broadcast, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m865[0m[39m:    return;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m866[0m[39m:  if [0m[1;39m([0m[39mifp->enable_crc32_check && len > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m867[0m[39m:    len -= [0m[1;36m4[0m[39m;  [0m[35m/[0m[35m/[0m[39m [0m[1;35mTODO[0m[1;39m([0m[39mscaprile[0m[1;39m)[0m[39m: check on bigendian[0m                            [2m                [0m
[2;36m                    [0m         [1;36m868[0m[39m:    uint32_t crc = [0m[1;35mmg_crc32[0m[1;39m([0m[1;36m0[0m[39m, [0m[1;39m([0m[39mconst char *[0m[1;39m)[0m[39m buf, len[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m869[0m[39m:    if [0m[1;39m([0m[1;35mmemcmp[0m[1;39m([0m[1;39m([0m[39mvoid *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m buf + len[0m[1;39m)[0m[39m, &crc, [0m[1;35msizeof[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m return;[0m       [2m                [0m
[2;36m                    [0m         [1;36m870[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m871[0m[39m:  if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x806[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m872[0m[39m:    pkt.arp = [0m[1;39m([0m[39mstruct arp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m873[0m[39m:    if [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.arp[0m[1;39m)[0m[39m > pkt.raw.len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m874[0m[39m:    [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mifp, MG_TCPIP_EV_ARP, &pkt.raw[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m875[0m[39m:    [0m[1;35mrx_arp[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m876[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x86dd[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m877[0m[39m:    pkt.ip6 = [0m[1;39m([0m[39mstruct ip6 *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m878[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip6[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m879[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip6->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m0x6[0m[1;39m)[0m[39m return;                         [0m[35m/[0m[35m/[0m[39m Not IP[0m   [2m                [0m
[2;36m                    [0m         [1;36m880[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m881[0m[39m:    [0m[1;35mrx_ip6[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m384[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:398[0m[39m-[0m[1;36m404[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:static void [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:  uint32_t ip = [0m[1;36m0[0m[39m, gw = [0m[1;36m0[0m[39m, mask = [0m[1;36m0[0m[39m, lease = [0m[1;36m0[0m[39m, dns = [0m[1;36m0[0m[39m, sntp = [0m[1;36m0[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:  uint8_t msgtype = [0m[1;36m0[0m[39m, state = ifp->state;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:  [0m[35m/[0m[35m/[0m[39m perform size check first, then access fields[0m                               [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:  uint8_t *p = pkt->dhcp->options,[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:          *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:  if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis of the Issue[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter analyzing the evaluation report and code snippets, I can now identify why the[0m [2m                [0m
[2;36m                    [0m         [39mprevious patch failed and what the root cause actually is:[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why the Previous Patch Failed[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe previous patch attempted to:[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Calculate `ip_hlen` and `ip_payload` at the start of `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m`[0m                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Use `ip_payload` for protocol structure assignments[0m                              [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Check `pkt->pay.len` before assignments[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mHowever, **the patch still failed because it checked the assignment AFTER using the[0m [2m                [0m
[2;36m                    [0m         [39mincorrect pointer for validation**. The critical flaw in the previous patch was at [0m [2m                [0m
[2;36m                    [0m         [39mthese lines:[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Checks FIRST[0m                [2m                [0m
[2;36m                    [0m         [39m    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m ip_payload;         [0m[35m/[0m[35m/[0m[39m Assigns SECOND[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe issue is that `pkt->pay.len` was set by `[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m` in `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m` based on [0m  [2m                [0m
[2;36m                    [0m         [39mthe correct IP header length calculation. However, when we reach `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` at [0m    [2m                [0m
[2;36m                    [0m         [39mline [0m[1;36m384[0m[39m, it dereferences `pkt->icmp->type` **immediately** without any buffer [0m     [2m                [0m
[2;36m                    [0m         [39mboundary validation within `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` itself.[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### The Real Root Cause[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mLooking at the complete data flow:[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **In `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mlines [0m[1;36m891[0m[39m-[0m[1;36m894[0m[1;39m)[0m[39m**: The code correctly calculates the IP [0m    [2m                [0m
[2;36m                    [0m         [39mpayload start position accounting for IP options[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **In `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m[1;36m802[0m[1;39m)[0m[39m**: Even with the patch using `ip_payload`, the [0m        [2m                [0m
[2;36m                    [0m         [39massignment happens AFTER the length check[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **In `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m[1;36m384[0m[1;39m)[0m[39m**: The function **immediately dereferences** [0m        [2m                [0m
[2;36m                    [0m         [39m`pkt->icmp->type` without validating that `pkt->icmp` actually points to valid [0m     [2m                [0m
[2;36m                    [0m         [39mmemory within the buffer[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe [0m[1;36m34[0m[39m-byte buffer scenario with [0m[33mIHL[0m[39m=[0m[1;36m6[0m[39m [0m[1;39m([0m[1;36m24[0m[39m-byte IP header[0m[1;39m)[0m[39m:[0m                         [2m                [0m
[2;36m                    [0m         [39m- Ethernet: [0m[1;36m14[0m[39m bytes [0m[1;39m([0m[39mbytes [0m[1;36m0[0m[39m-[0m[1;36m13[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [39m- IP with options: [0m[1;36m24[0m[39m bytes [0m[1;39m([0m[39mbytes [0m[1;36m14[0m[39m-[0m[1;36m37[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m- ICMP header needed: [0m[1;36m4[0m[39m bytes [0m[1;39m([0m[39mwould be bytes [0m[1;36m38[0m[39m-[0m[1;36m41[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [39m- **Total needed: [0m[1;36m42[0m[39m bytes, but only [0m[1;36m34[0m[39m bytes available**[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mEven though `pkt->pay.len` check in line [0m[1;36m803[0m[39m should catch this, the actual [0m         [2m                [0m
[2;36m                    [0m         [39mvalidation logic is flawed because:[0m                                                 [2m                [0m
[2;36m                    [0m         [39m- `pkt->pay.len` is calculated as: `&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mp`[0m        [2m                [0m
[2;36m                    [0m         [39m- When `p` points beyond the buffer [0m[1;39m([0m[39mbyte [0m[1;36m38[0m[39m when buffer ends at byte [0m[1;36m33[0m[1;39m)[0m[39m, this [0m    [2m                [0m
[2;36m                    [0m         [39mcalculation produces a negative number that wraps around to a large positive value [0m [2m                [0m
[2;36m                    [0m         [39mdue to unsigned arithmetic[0m                                                          [2m                [0m
[2;36m                    [0m         [39m- The check `pkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[39m` then passes incorrectly[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Additional Critical Issue[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mLooking more carefully at `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m` lines [0m[1;36m891[0m[39m-[0m[1;36m894[0m[39m, there's another problem: [0m  [2m                [0m
[2;36m                    [0m         [39mthe code validates that the buffer contains at least [0m[1;36m20[0m[39m bytes of IP header [0m[1;39m([0m[39mline [0m   [2m                [0m
[2;36m                    [0m         [1;36m884[0m[1;39m)[0m[39m, but **never validates that the buffer contains the full IP header including [0m  [2m                [0m
[2;36m                    [0m         [39moptions**.[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mWith [0m[33mIHL[0m[39m=[0m[1;36m6[0m[39m [0m[1;39m([0m[1;36m24[0m[39m-byte IP header[0m[1;39m)[0m[39m and a [0m[1;36m34[0m[39m-byte buffer:[0m                                [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m884[0m[39m check: `[0m[1;36m34[0m[39m < [0m[1;36m14[0m[39m + [0m[1;36m20[0m[39m` = `[0m[1;36m34[0m[39m < [0m[1;36m34[0m[39m` → PASSES [0m[1;39m([0m[39mboundary case[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39m- But actual IP header is [0m[1;36m24[0m[39m bytes, requiring at least [0m[1;36m38[0m[39m bytes total[0m               [2m                [0m
[2;36m                    [0m         [39m- No check exists for: `pkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hlen`[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Comprehensive Fix Strategy[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Primary Fix: Add IP Header Length Validation in `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m`[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter line [0m[1;36m890[0m[39m in `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m`, add validation that the buffer contains the full[0m [2m                [0m
[2;36m                    [0m         [39mIP header including options:[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m            [2m                [0m
[2;36m                    [0m         [39muint8_t ihl = pkt.ip->ver & [0m[1;36m0xF[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mihl < [0m[1;36m5[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m IHL must be at least [0m[1;36m5[0m[39m [0m[1;39m([0m[1;36m20[0m[39m bytes minimum[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [39msize_t ip_hlen = ihl * [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hlen[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Buffer must contain full [0m [2m                [0m
[2;36m                    [0m         [39mIP header[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis prevents `[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m` from being called with a pointer beyond the buffer, which [0m  [2m                [0m
[2;36m                    [0m         [39mis the actual root cause of the wraparound issue.[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Secondary Fix: Validate Protocol Structure Boundaries in `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m`[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe previous patch's approach was correct but incomplete. We need to ensure that [0m   [2m                [0m
[2;36m                    [0m         [39mnot only does the payload calculation use the correct IP header length, but also [0m   [2m                [0m
[2;36m                    [0m         [39mthat the buffer actually contains enough space for the protocol headers.[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAt the start of `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m`, calculate the IP header length and validate protocol [0m    [2m                [0m
[2;36m                    [0m         [39mstructure boundaries:[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mstatic void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [39m  uint8_t ip_hlen = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m  void *ip_payload = [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen;[0m                                     [2m                [0m
[2;36m                    [0m         [39m  [0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m  [0m[35m/[0m[35m/[0m[39m Validate buffer contains IP header + minimum protocol header[0m                   [2m                [0m
[2;36m                    [0m         [39m  size_t ip_start = [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip - pkt->raw.buf;[0m                                 [2m                [0m
[2;36m                    [0m         [39m  [0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [39m  [0m[35m/[0m[35m/[0m[39m [0m[33m...[0m[39m rest of the function[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mFor each protocol, validate before assignment:[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**For ICMP [0m[1;39m([0m[39mproto == [0m[1;36m1[0m[1;39m)[0m[39m**:[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Validate buffer contains ICMP header[0m                                         [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mip_payload + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m > pkt->raw.buf + pkt->raw.len[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mreturn;[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m ip_payload;[0m                                         [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**For UDP [0m[1;39m([0m[39mproto == [0m[1;36m17[0m[1;39m)[0m[39m**:[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Validate buffer contains UDP header[0m                                          [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mip_payload + [0m[1;35msizeof[0m[1;39m([0m[39mstruct udp[0m[1;39m)[0m[39m > pkt->raw.buf + pkt->raw.len[0m[1;39m)[0m[39m [0m     [2m                [0m
[2;36m                    [0m         [39mreturn;[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m ip_payload;[0m                                           [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m [0m[33m...[0m[39m rest of UDP handling[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**For TCP [0m[1;39m([0m[39mproto == [0m[1;36m6[0m[1;39m)[0m[39m**:[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Validate buffer contains TCP header[0m                                          [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mip_payload + [0m[1;35msizeof[0m[1;39m([0m[39mstruct tcp[0m[1;39m)[0m[39m > pkt->raw.buf + pkt->raw.len[0m[1;39m)[0m[39m [0m     [2m                [0m
[2;36m                    [0m         [39mreturn;[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m ip_payload;[0m                                           [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [39m    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip_hlen + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Use [0m     [2m                [0m
[2;36m                    [0m         [39mip_hlen[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m [0m[33m...[0m[39m rest of TCP handling[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**For fragmented packets**:[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [39m      if [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mip_payload + [0m[1;35msizeof[0m[1;39m([0m[39mstruct udp[0m[1;39m)[0m[39m > pkt->raw.buf + pkt->raw.len[0m[1;39m)[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mreturn;[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m      pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m ip_payload;[0m                                         [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [39m      if [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mip_payload + [0m[1;35msizeof[0m[1;39m([0m[39mstruct tcp[0m[1;39m)[0m[39m > pkt->raw.buf + pkt->raw.len[0m[1;39m)[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mreturn;[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m      pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m ip_payload;[0m                                         [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Tertiary Fix: Update `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` Header Length Calculation[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mIn `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m385[0m[39m, the header length calculation assumes a fixed [0m[1;36m20[0m[39m-byte [0m  [2m                [0m
[2;36m                    [0m         [39mIP header. This should be updated to use the actual IP header length:[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mstatic void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [39m  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [39m    uint8_t ip_hlen = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [39m    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + ip_hlen + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m [0m[33m...[0m[39m rest of the function[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This Strategy Will Work[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Prevents pointer arithmetic beyond buffer**: By validating in `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m` [0m [2m                [0m
[2;36m                    [0m         [39mthat the buffer contains the full IP header including options, we prevent `[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m`[0m [2m                [0m
[2;36m                    [0m         [39mfrom being called with an out-of-bounds pointer, eliminating the wraparound issue.[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Explicit boundary validation**: Before assigning any protocol structure [0m       [2m                [0m
[2;36m                    [0m         [39mpointer, we explicitly check that the pointer + structure size is within the buffer[0m [2m                [0m
[2;36m                    [0m         [39mbounds using direct pointer comparison.[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Uses correct IP header length consistently**: All calculations use the actual [0m [2m                [0m
[2;36m                    [0m         [39mIP header length from the IHL field, not the fixed `[0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m`.[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Preserves existing logic**: The patch maintains the same control flow and [0m     [2m                [0m
[2;36m                    [0m         [39merror handling, only adding validation checks and fixing pointer arithmetic.[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Defense in depth**: Multiple layers of validation ensure that even if one [0m     [2m                [0m
[2;36m                    [0m         [39mcheck is bypassed, others will catch the issue.[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Side Effects and Mitigation[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Additional validation overhead**: The extra checks add minimal computational [0m   [2m                [0m
[2;36m                    [0m         [39moverhead but significantly improve security.[0m                                        [2m                [0m
[2;36m                    [0m         [39m- **More early returns**: Malformed packets will be rejected earlier, which is the [0m [2m                [0m
[2;36m                    [0m         [39mdesired behavior.[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- **No functional changes**: Valid packets with or without IP options will be [0m      [2m                [0m
[2;36m                    [0m         [39mprocessed correctly.[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Relevant Code Patterns[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix uses patterns already present in the codebase:[0m                              [2m                [0m
[2;36m                    [0m         [39m- Buffer boundary validation pattern from `[0m[1;35mrx_dhcp_client[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mlines [0m[1;36m403[0m[39m-[0m[1;36m404[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m- IP header length calculation from `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mlines [0m[1;36m891[0m[39m-[0m[1;36m894[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [39m- Structure validation pattern from `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m[1;36m873[0m[39m, [0m[1;36m878[0m[39m, [0m[1;36m884[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/06/26 17:56:59][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=776858;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=887012;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m5[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/06/26 18:01:08][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=137380;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=659511;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m5[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/06/26 18:02:15][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=938523;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=251499;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m5[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=182585;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=444183;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 18:02:16][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.86[0m seconds;              ]8;id=923885;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=866309;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Started[33m...[0m                            ]8;id=336673;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=662132;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpgc8nlgi8[0m                                                 ]8;id=52271;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=904894;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/06/26 18:02:23][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Took [1;36m6.94[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=399560;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=442472;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Started[33m...[0m                      ]8;id=692688;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=419300;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 18:02:27][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Took [1;36m4.27[0m seconds;             ]8;id=175461;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=417308;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Started[33m...[0m                         ]8;id=111747;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=214661;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 18:02:30][0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=153537;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=440634;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#102\[2m102[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m4204724374[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55c044b2e708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x55c044b2faa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55c044b2faa8[0m[39m,[0m[1;36m0x55c044b43448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x55c044ab4c02[0m[39m bp [0m[1;36m0x7ffea3e7fd00[0m[39m sp [0m[1;36m0x7ffea3e7fcf8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55c044ab4c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55c044a9cd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55c044ab18b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55c04491d350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55c0449085c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55c04490e05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55c044939302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f3ffc2f4082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55c0449007ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55c044a2911f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55c044ab179d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55c04491d350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55c0449085c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55c04490e05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55c044939302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f3ffc2f4082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpeaed5zlz[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=432292;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=654240;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#103\[2m103[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m4204724374[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55c044b2e708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x55c044b2faa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55c044b2faa8[0m[39m,[0m[1;36m0x55c044b43448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x55c044ab4c02[0m[39m bp [0m[1;36m0x7ffea3e7fd00[0m[39m sp [0m[1;36m0x7ffea3e7fcf8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55c044ab4c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55c044a9cd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55c044ab18b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55c04491d350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55c0449085c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55c04490e05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55c044939302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f3ffc2f4082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55c0449007ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55c044a2911f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55c044ab179d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55c04491d350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55c0449085c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55c04490e05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55c044939302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f3ffc2f4082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpeaed5zlz[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [31m╭─[0m[31m──────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m───────────────────────[0m[31m─╮[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/evaluator/services/default/[0m[1m__init__.py[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m :97 in _evaluate_internal                                                        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 94 [0m[2m│   │   [0m[94mwith[0m logging_performance(context, header=[33m"[0m[33mRunning PoV[0m[33m"[0m):           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 95 [0m[2m│   │   │   [0m[94mtry[0m:                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 96 [0m[2m│   │   │   │   [0m[94mif[0m [96mlen[0m(detection.blobs) > [94m0[0m:                               [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 97 [2m│   │   │   │   │   [0menvironment.run_pov(context, detection)                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 98 [0m[2m│   │   │   │   [0m[94melse[0m:                                                      [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 99 [0m[2m│   │   │   │   │   [0mcontext[[33m"[0m[33mlogger[0m[33m"[0m].warning([33m"[0m[33mNo blob data found for the [0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m100 [0m                                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mcached.p[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1my[0m:56 in run_pov                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 53 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, detection: Detection            [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 54 [0m[2m│   [0m) -> [96mtuple[0m[[96mstr[0m, [96mstr[0m]:                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 55 [0m[2m│   │   [0m[94massert[0m [96mlen[0m(detection.blobs) > [94m0[0m, [33m"[0m[33mAt least one blob is required[0m[33m"[0m   [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 56 [2m│   │   [0m[94mreturn[0m [1;4;96mself[0m[1;4m.environment.run_pov(context, detection)[0m                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 57 [0m[2m│   [0m                                                                       [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 58 [0m[2m│   [0m[94mdef[0m[90m [0m[92mrun_tests[0m(                                                         [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 59 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, env: [96mdict[0m[[96mstr[0m, [96mstr[0m] = {}        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mdefault.[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1mpy[0m:210 in run_pov                                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m207 [0m[2m│   │   │   │   [0mcontext, blobinfo.blob, blobinfo.harness_name              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m208 [0m[2m│   │   │   [0m)                                                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m209 [0m[2m│   │   │   [0m[94mif[0m [95mnot[0m success:                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m210 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m ChallengePoVFoundError([0m                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m211 [0m[2m│   │   │   │   │   [0m[1;4mstdout=stdout.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m212 [0m[2m│   │   │   │   │   [0m[1;4mstderr=stderr.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m213 [0m[2m│   │   │   │   [0m[1;4m)[0m                                                          [31m│[0m [2m               [0m
[2;36m                    [0m         [31m╰──────────────────────────────────────────────────────────────────────────────────╯[0m [2m               [0m
[2;36m                    [0m         [1;91mChallengePoVFoundError: [0mPoV found:                                                   [2m               [0m
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m4204724374[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55c044b2e708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x55c044b2faa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55c044b2faa8[0m[39m,[0m[1;36m0x55c044b43448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x55c044ab4c02[0m[39m bp [0m[1;36m0x7ffea3e7fd00[0m[39m sp [0m[1;36m0x7ffea3e7fcf8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55c044ab4c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55c044a9cd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55c044ab18b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55c04491d350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55c0449085c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55c04490e05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55c044939302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f3ffc2f4082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55c0449007ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55c044a2911f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55c044ab179d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55c04491d350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55c0449085c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55c04490e05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55c044939302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f3ffc2f4082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpeaed5zlz[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Took [1;36m2.30[0m seconds;                ]8;id=579850;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=485419;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=619935;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=976095;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.83[0m seconds;              ]8;id=450424;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=425844;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/06/26 18:02:31][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=468508;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=461114;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 18:02:32][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.94[0m seconds;              ]8;id=587619;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=541086;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=404536;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=909198;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         +++ b/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-382[0m,[1;36m7[0m +[1;36m382[0m,[1;36m8[0m @@                                                                 [2m                [0m
[2;36m                    [0m          static void [1;35mrx_icmp[0m[1m([0mstruct mg_tcpip_if *ifp, struct pkt *pkt[1m)[0m [1m{[0m                    [2m                [0m
[2;36m                    [0m            [35m/[0m[35m/[0m [1;35mMG_DEBUG[0m[1m([0m[1m([0m[32m"ICMP %d"[0m, [1m([0mint[1m)[0m len[1m)[0m[1m)[0m;                                             [2m                [0m
[2;36m                    [0m            if [1m([0mpkt->icmp->type == [1;36m8[0m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[1m)[0m [1m{[0m        [2m                [0m
[2;36m                    [0m         -    size_t hlen = [1;35msizeof[0m[1m([0mstruct eth[1m)[0m + [1;35msizeof[0m[1m([0mstruct ip[1m)[0m + [1;35msizeof[0m[1m([0mstruct icmp[1m)[0m;    [2m                [0m
[2;36m                    [0m         +    uint8_t ip_hlen = [1m([0mpkt->ip->ver & [1;36m0xF[0m[1m)[0m * [1;36m4[0m;                                    [2m                [0m
[2;36m                    [0m         +    size_t hlen = [1;35msizeof[0m[1m([0mstruct eth[1m)[0m + ip_hlen + [1;35msizeof[0m[1m([0mstruct icmp[1m)[0m;              [2m                [0m
[2;36m                    [0m              size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;                        [2m                [0m
[2;36m                    [0m              if [1m([0mplen > space[1m)[0m plen = space;                                                [2m                [0m
[2;36m                    [0m              struct ip *ip = [1;35mtx_ip[0m[1m([0mifp, pkt->eth->src, [1;36m1[0m, ifp->ip, pkt->ip->src,            [2m                [0m
[2;36m                    [0m         @@ [1;36m-794[0m,[1;36m17[0m +[1;36m795[0m,[1;36m17[0m @@                                                               [2m                [0m
[2;36m                    [0m          static void [1;35mrx_ip[0m[1m([0mstruct mg_tcpip_if *ifp, struct pkt *pkt[1m)[0m [1m{[0m                      [2m                [0m
[2;36m                    [0m            uint16_t frag = [1;35mmg_ntohs[0m[1m([0mpkt->ip->frag[1m)[0m;                                         [2m                [0m
[2;36m                    [0m            if [1m([0mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[1m)[0m [1m{[0m                     [2m                [0m
[2;36m                    [0m         -    if [1m([0mpkt->ip->proto == [1;36m17[0m[1m)[0m pkt->udp = [1m([0mstruct udp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;             [2m                [0m
[2;36m                    [0m         -    if [1m([0mpkt->ip->proto == [1;36m6[0m[1m)[0m pkt->tcp = [1m([0mstruct tcp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;              [2m                [0m
[2;36m                    [0m         +    if [1m([0mpkt->ip->proto == [1;36m17[0m[1m)[0m pkt->udp = [1m([0mstruct udp *[1m)[0m pkt->pay.buf;              [2m                [0m
[2;36m                    [0m         +    if [1m([0mpkt->ip->proto == [1;36m6[0m[1m)[0m pkt->tcp = [1m([0mstruct tcp *[1m)[0m pkt->pay.buf;               [2m                [0m
[2;36m                    [0m              struct mg_connection *c = [1;35mgetpeer[0m[1m([0mifp->mgr, pkt, false[1m)[0m;                       [2m                [0m
[2;36m                    [0m              if [1m([0mc[1m)[0m [1;35mmg_error[0m[1m([0mc, [32m"Received fragmented packet"[0m[1m)[0m;                              [2m                [0m
[2;36m                    [0m            [1m}[0m else if [1m([0mpkt->ip->proto == [1;36m1[0m[1m)[0m [1m{[0m                                                [2m                [0m
[2;36m                    [0m         -    pkt->icmp = [1m([0mstruct icmp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;                                     [2m                [0m
[2;36m                    [0m         +    pkt->icmp = [1m([0mstruct icmp *[1m)[0m pkt->pay.buf;                                      [2m                [0m
[2;36m                    [0m              if [1m([0mpkt->pay.len [1m<[0m[39m [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [39m-    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m+    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m pkt->pay.buf;[0m                                        [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m        [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-822[0m[39m,[0m[1;36m11[0m[39m +[0m[1;36m823[0m[39m,[0m[1;36m12[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m-    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m+    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m pkt->pay.buf;[0m                                        [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m-    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [39m+    uint16_t ip_hlen = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [39m+    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip_hlen + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m        [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m            [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-888[0m[39m,[0m[1;36m10[0m[39m +[0m[1;36m890[0m[39m,[0m[1;36m11[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m    [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m       [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle IPv4 [0m [2m                [0m
[2;36m                    [0m         [39moptions[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m-    else[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+    uint8_t ihl = pkt.ip->ver & [0m[1;36m0xF[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mihl < [0m[1;36m5[0m[1;39m)[0m[39m return;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+    size_t ip_hlen = ihl * [0m[1;36m4[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hlen[0m[1;39m)[0m[39m return;[0m                          [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + ip_hlen[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m4204724374[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55c044b2e708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55c044b2faa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55c044b2faa8[0m[39m,[0m[1;36m0x55c044b43448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55c044ab4c02[0m[39m bp [0m[1;36m0x7ffea3e7fd00[0m[39m sp [0m[1;36m0x7ffea3e7fcf8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55c044ab4c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55c044a9cd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55c044ab18b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55c04491d350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55c0449085c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55c04490e05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55c044939302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f3ffc2f4082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55c0449007ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55c044a2911f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55c044ab179d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55c04491d350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55c0449085c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55c04490e05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55c044939302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f3ffc2f4082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpeaed5zlz[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2506875745[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55868688b708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55868688caa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55868688caa8[0m[39m,[0m[1;36m0x5586868a0448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x558686811c02[0m[39m bp [0m[1;36m0x7fffe2852160[0m[39m sp [0m[1;36m0x7fffe2852158[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x558686811c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x5586867f9d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55868680e8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55868667a350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5586866655c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55868666b05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x558686696302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fa4bb2fc082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55868665d7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55868678611f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55868680e79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55868667a350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5586866655c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55868666b05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x558686696302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fa4bb2fc082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpz8kxnkhj[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe initial issue is a heap-buffer-overflow vulnerability detected by [0m              [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer during fuzzing of the Mongoose network library. The overflow [0m      [2m                [0m
[2;36m                    [0m         [39moccurs in the `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` function at line [0m[1;36m385[0m[39m of `src/net_builtin.c`, where a [0m     [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m-byte read occurs beyond the bounds of a [0m[1;36m34[0m[39m-byte allocated buffer. The patch [0m      [2m                [0m
[2;36m                    [0m         [39mattempt aimed to fix this issue by adding proper validation for IP header lengths [0m  [2m                [0m
[2;36m                    [0m         [39mand payload sizes, including handling of IP options. However, after applying the [0m   [2m                [0m
[2;36m                    [0m         [39mpatch, the exact same heap-buffer-overflow error persists at the same location with[0m [2m                [0m
[2;36m                    [0m         [39midentical characteristics, indicating that the patch did not resolve the underlying[0m [2m                [0m
[2;36m                    [0m         [39missue.[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Initial Issue Analysis[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe initial issue manifests as a heap-buffer-overflow with the following key [0m       [2m                [0m
[2;36m                    [0m         [39mcharacteristics:[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Error Location**: The overflow occurs in the `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` function at [0m          [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m`[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Error Type**: READ of size [0m[1;36m1[0m[39m at address `[0m[1;36m0x504000000172[0m[39m`, which is located [0m[1;36m0[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mbytes after a [0m[1;36m34[0m[39m-byte region allocated at `[0m[1;36m0x504000000150[0m[39m`[0m                          [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Call Stack**: The error path is: `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` → `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m` → [0m              [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mLLVMFuzzerTestOneInput[0m[1;39m([0m[1;39m)[0m[39m`[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **SCARINESS Score**: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Memory Allocation**: The problematic buffer was allocated in [0m                  [2m                [0m
[2;36m                    [0m         [39m`LLVMFuzzerTestOneInput` at `[0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m[39m`[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe AddressSanitizer shadow bytes show that the address `[0m[1;36m0x504000000172[0m[39m` is marked [0m [2m                [0m
[2;36m                    [0m         [39mwith `[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39m`, indicating it is partially addressable [0m[1;39m([0m[1;36m2[0m[39m bytes accessible out of [0m[1;36m8[0m[1;39m)[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mfollowed by `fa` [0m[1;39m([0m[39mheap left redzone[0m[1;39m)[0m[39m, confirming the buffer boundary.[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Patch Attempt Description[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe patch attempted to address the issue through several modifications to [0m          [2m                [0m
[2;36m                    [0m         [39m`src/net_builtin.c`:[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **In `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` function [0m[1;39m([0m[39mlines [0m[1;36m382[0m[39m-[0m[1;36m391[0m[1;39m)[0m[39m**:[0m                                     [2m                [0m
[2;36m                    [0m         [39m   - Changed the calculation of `hlen` from using `[0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m` to using the [0m [2m                [0m
[2;36m                    [0m         [39mactual IP header length[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   - Introduced `ip_hlen` variable calculated as `[0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m` to [0m     [2m                [0m
[2;36m                    [0m         [39maccount for variable IP header length including options[0m                             [2m                [0m
[2;36m                    [0m         [39m   - Modified: `size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m             [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;` to `size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + ip_hlen + [0m             [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;`[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **In `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m` function [0m[1;39m([0m[39mlines [0m[1;36m795[0m[39m-[0m[1;36m839[0m[1;39m)[0m[39m**:[0m                                       [2m                [0m
[2;36m                    [0m         [39m   - Added calculation of `ip_hlen` and `ip_payload` pointer at the beginning[0m       [2m                [0m
[2;36m                    [0m         [39m   - Added length validation checks before assigning protocol-specific structures [0m  [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mUDP, TCP, ICMP[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m   - Changed all occurrences of `[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m` to use the calculated `ip_payload` [0m [2m                [0m
[2;36m                    [0m         [39mpointer[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   - Added bounds checking: `if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[1;39m)[0m[39m`, `if [0m         [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct udp[0m[1;39m)[0m[1;39m)[0m[39m`, `if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct tcp[0m[1;39m)[0m[1;39m)[0m[39m`[0m      [2m                [0m
[2;36m                    [0m         [39m   - Modified TCP offset calculation to use `ip_hlen` instead of `[0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m`[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **In `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m` function [0m[1;39m([0m[39mlines [0m[1;36m893[0m[39m-[0m[1;36m901[0m[1;39m)[0m[39m**:[0m                                 [2m                [0m
[2;36m                    [0m         [39m   - Added validation for IP header length [0m[1;39m([0m[39mIHL[0m[1;39m)[0m[39m field[0m                              [2m                [0m
[2;36m                    [0m         [39m   - Added check: `if [0m[1;39m([0m[39mihl < [0m[1;36m5[0m[1;39m)[0m[39m return;` to ensure minimum valid IHL value[0m          [2m                [0m
[2;36m                    [0m         [39m   - Consolidated the IP options handling into a single code path[0m                   [2m                [0m
[2;36m                    [0m         [39m   - Added validation: `if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hlen[0m[1;39m)[0m[39m return;` to [0m  [2m                [0m
[2;36m                    [0m         [39mensure the buffer contains the full IP header[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Post-Patch Result[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter applying the patch, the fuzzer produces the identical error:[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Same Error Location**: `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;92m385:18[0m                              [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Same Memory Address**: `[0m[1;36m0x504000000172[0m[39m` [0m[1;39m([0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Same Call Stack**: `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` → `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m` → `[0m[1;35mLLVMFuzzerTestOneInput[0m[1;39m([0m[1;39m)[0m[39m`[0m  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Same DEDUP_TOKEN**: Indicating the error signature is unchanged[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis indicates that while the patch addressed IP header length handling and added [0m  [2m                [0m
[2;36m                    [0m         [39mvarious validation checks, it did not prevent the specific buffer overflow [0m         [2m                [0m
[2;36m                    [0m         [39moccurring at line [0m[1;36m385[0m[39m in `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m`.[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas Requiring Further Investigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo obtain a holistic view of the issue, the following areas should be investigated:[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Line [0m[1;36m385[0m[39m in `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` function**: The exact code at this line that causes [0m   [2m                [0m
[2;36m                    [0m         [39mthe read overflow needs to be examined. The patch modified the `hlen` calculation [0m  [2m                [0m
[2;36m                    [0m         [39mabove this line, but the actual problematic read operation at line [0m[1;36m385[0m[39m should be [0m   [2m                [0m
[2;36m                    [0m         [39midentified.[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **The `[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m` function**: This function is called multiple times in the patch [0m [2m                [0m
[2;36m                    [0m         [39mand appears to set up payload pointers. Its implementation and how it calculates [0m   [2m                [0m
[2;36m                    [0m         [39m`pkt->pay.len` should be reviewed.[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **The `pkt` structure definition**: Understanding the complete structure of [0m     [2m                [0m
[2;36m                    [0m         [39m`struct pkt`, particularly the `pay` field and how `icmp`, `ip`, `eth`, `tcp`, and [0m [2m                [0m
[2;36m                    [0m         [39m`udp` pointers relate to the buffer boundaries.[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Buffer allocation in the fuzzer harness** [0m[1;39m([0m[39m`test/fuzz.[0m[1;92mc:95[0m[39m`[0m[1;39m)[0m[39m: While not the [0m   [2m                [0m
[2;36m                    [0m         [39mroot cause, understanding how the [0m[1;36m34[0m[39m-byte buffer is allocated and what data is [0m     [2m                [0m
[2;36m                    [0m         [39mbeing placed into it could provide context.[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **The `[0m[1;35mtx_ip[0m[1;39m([0m[1;39m)[0m[39m` function** [0m[1;39m([0m[39mcalled in `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m`[0m[1;39m)[0m[39m: This function is invoked [0m    [2m                [0m
[2;36m                    [0m         [39mafter the `hlen` calculation and might be where the actual overflow occurs, [0m        [2m                [0m
[2;36m                    [0m         [39mparticularly if it accesses packet data based on the calculated lengths.[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Payload length calculations**: The relationship between `pkt->pay.len`, the [0m   [2m                [0m
[2;36m                    [0m         [39mactual buffer size, and the various header sizes needs thorough examination to [0m     [2m                [0m
[2;36m                    [0m         [39mensure all bounds checks are correctly performed before any data access.[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. **ICMP packet structure access**: The specific fields being accessed in the ICMP[0m [2m                [0m
[2;36m                    [0m         [39mpacket at line [0m[1;36m385[0m[39m and whether the validation checks before this line are [0m          [2m                [0m
[2;36m                    [0m         [39msufficient to prevent out-of-bounds access.[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2506875745[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55868688b708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55868688caa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55868688caa8[0m[39m,[0m[1;36m0x5586868a0448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x558686811c02[0m[39m bp [0m[1;36m0x7fffe2852160[0m[39m sp [0m[1;36m0x7fffe2852158[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x558686811c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x5586867f9d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55868680e8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55868667a350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5586866655c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55868666b05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x558686696302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fa4bb2fc082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55868665d7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55868678611f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55868680e79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55868667a350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5586866655c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55868666b05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x558686696302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fa4bb2fc082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpz8kxnkhj[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3841705035[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x562aaa1fa708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x562aaa1fbaa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x562aaa1fbaa8[0m[39m,[0m[1;36m0x562aaa20f448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x562aaa180c02[0m[39m bp [0m[1;36m0x7fffed52d880[0m[39m sp [0m[1;36m0x7fffed52d878[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x562aaa180c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x562aaa168d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x562aaa17d8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x562aa9fe9350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x562aa9fd45c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x562aa9fda05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x562aaa005302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fc63b94d082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x562aa9fcc7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x562aaa0f511f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x562aaa17d79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x562aa9fe9350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x562aa9fd45c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x562aa9fda05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x562aaa005302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fc63b94d082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp99vtwqw5[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:129[0m[39m-[0m[1;36m141[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:struct pkt [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:  struct mg_str raw;  [0m[35m/[0m[35m/[0m[39m Raw packet data[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:  struct mg_str pay;  [0m[35m/[0m[35m/[0m[39m Payload data[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:  struct eth *eth;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:  struct llc *llc;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:  struct arp *arp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:  struct ip *ip;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:  struct ip6 *ip6;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:  struct icmp *icmp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:  struct tcp *tcp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:  struct udp *udp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:  struct dhcp *dhcp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:838[0m[39m-[0m[1;36m852[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m838[0m[39m:static void [0m[1;35mrx_ip6[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m839[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"IP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m840[0m[39m:  if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m1[0m[39m || pkt->ip6->proto == [0m[1;36m58[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m841[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m842[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m843[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m844[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m845[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m846[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m847[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m848[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"  UDP %u %u -> %u"[0m[39m, len, [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->sport[0m[1;39m)[0m[39m,[0m                [2m                [0m
[2;36m                    [0m         [1;36m849[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->dport[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m850[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m851[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m852[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:72[0m[39m-[0m[1;36m77[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:struct icmp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  uint8_t type;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint8_t code;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  uint16_t csum;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:110[0m[39m-[0m[1;36m115[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:struct udp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:  uint16_t sport;  [0m[35m/[0m[35m/[0m[39m Source port[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:  uint16_t dport;  [0m[35m/[0m[35m/[0m[39m Destination port[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:  uint16_t len;    [0m[35m/[0m[35m/[0m[39m UDP length[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:  uint16_t csum;   [0m[35m/[0m[35m/[0m[39m UDP checksum[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m800[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:854[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m854[0m[39m:void [0m[1;35mmg_tcpip_rx[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, void *buf, size_t len[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m855[0m[39m:  struct pkt pkt;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m856[0m[39m:  [0m[1;35mmemset[0m[1;39m([0m[39m&pkt, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mpkt[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m857[0m[39m:  pkt.raw.buf = [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m buf;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m858[0m[39m:  pkt.raw.len = len;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m859[0m[39m:  pkt.eth = [0m[1;39m([0m[39mstruct eth *[0m[1;39m)[0m[39m buf;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m860[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_hexdump[0m[1;39m([0m[39mbuf, len > [0m[1;36m16[0m[39m ? [0m[1;36m16[0m[39m: len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m861[0m[39m:  if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated - runt?[0m             [2m                [0m
[2;36m                    [0m         [1;36m862[0m[39m:  if [0m[1;39m([0m[39mifp->enable_mac_check &&[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m863[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, ifp->mac, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[39m &&[0m              [2m                [0m
[2;36m                    [0m         [1;36m864[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, broadcast, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m865[0m[39m:    return;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m866[0m[39m:  if [0m[1;39m([0m[39mifp->enable_crc32_check && len > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m867[0m[39m:    len -= [0m[1;36m4[0m[39m;  [0m[35m/[0m[35m/[0m[39m [0m[1;35mTODO[0m[1;39m([0m[39mscaprile[0m[1;39m)[0m[39m: check on bigendian[0m                            [2m                [0m
[2;36m                    [0m         [1;36m868[0m[39m:    uint32_t crc = [0m[1;35mmg_crc32[0m[1;39m([0m[1;36m0[0m[39m, [0m[1;39m([0m[39mconst char *[0m[1;39m)[0m[39m buf, len[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m869[0m[39m:    if [0m[1;39m([0m[1;35mmemcmp[0m[1;39m([0m[1;39m([0m[39mvoid *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m buf + len[0m[1;39m)[0m[39m, &crc, [0m[1;35msizeof[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m return;[0m       [2m                [0m
[2;36m                    [0m         [1;36m870[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m871[0m[39m:  if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x806[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m872[0m[39m:    pkt.arp = [0m[1;39m([0m[39mstruct arp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m873[0m[39m:    if [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.arp[0m[1;39m)[0m[39m > pkt.raw.len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m874[0m[39m:    [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mifp, MG_TCPIP_EV_ARP, &pkt.raw[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m875[0m[39m:    [0m[1;35mrx_arp[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m876[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x86dd[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m877[0m[39m:    pkt.ip6 = [0m[1;39m([0m[39mstruct ip6 *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m878[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip6[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m879[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip6->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m0x6[0m[1;39m)[0m[39m return;                         [0m[35m/[0m[35m/[0m[39m Not IP[0m   [2m                [0m
[2;36m                    [0m         [1;36m880[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m881[0m[39m:    [0m[1;35mrx_ip6[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:824[0m[39m-[0m[1;36m830[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:41[0m[39m-[0m[1;36m45[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:struct eth [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:  uint8_t dst[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Destination MAC address[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:  uint8_t src[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Source MAC address[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:  uint16_t type;   [0m[35m/[0m[35m/[0m[39m Ethernet type[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m384[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m894[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m384[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m809[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m384[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:806[0m[39m-[0m[1;36m809[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:824[0m[39m-[0m[1;36m827[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:796[0m[39m-[0m[1;36m800[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis of the Root Cause[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter thoroughly analyzing the code and error reports, I've identified the exact [0m   [2m                [0m
[2;36m                    [0m         [39mroot cause:[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe previous patch correctly modified `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m` to handle IP options and set [0m [2m                [0m
[2;36m                    [0m         [39m`pkt->pay.buf` to point after the complete IP header [0m[1;39m([0m[39mincluding options[0m[1;39m)[0m[39m. However, [0m [2m                [0m
[2;36m                    [0m         [39m**the critical bug remains in `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m` function**, where protocol-specific [0m        [2m                [0m
[2;36m                    [0m         [39mpointers [0m[1;39m([0m[39mICMP, UDP, TCP[0m[1;39m)[0m[39m are still set using `[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m`, which incorrectly [0m   [2m                [0m
[2;36m                    [0m         [39massumes a [0m[1;36m20[0m[39m-byte IP header without options.[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### The Bug Flow:[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. In `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m` lines [0m[1;36m891[0m[39m-[0m[1;36m894[0m[39m: `pkt->pay.buf` is **correctly** set to point [0m  [2m                [0m
[2;36m                    [0m         [39mafter IP header + options[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. In `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m` line [0m[1;36m802[0m[39m: `pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;` - [0m           [2m                [0m
[2;36m                    [0m         [39m**INCORRECTLY** assumes no IP options[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. In `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m` line [0m[1;36m803[0m[39m: Validation checks `pkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[39m` - [0m  [2m                [0m
[2;36m                    [0m         [39muses the correct `pkt->pay.len` from step [0m[1;36m1[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. If validation passes, line [0m[1;36m804[0m[39m calls `[0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m` - recalculates [0m [2m                [0m
[2;36m                    [0m         [39mbased on the **WRONG** `pkt->icmp` pointer[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. In `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` line [0m[1;36m384[0m[39m: Accesses `pkt->icmp->type` - uses the **WRONG** pointer[0m [2m                [0m
[2;36m                    [0m         [39mfrom step [0m[1;36m2[0m[39m, causing heap-buffer-overflow[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe validation at line [0m[1;36m803[0m[39m appears to work correctly by checking the proper payload[0m [2m                [0m
[2;36m                    [0m         [39mlength, but it cannot prevent the buffer overflow because `pkt->icmp` itself points[0m [2m                [0m
[2;36m                    [0m         [39mto the wrong memory location.[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why the Previous Patch Failed:[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe previous patch only modified:[0m                                                   [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m385[0m[39m in `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m`: Changed `hlen` calculation [0m[1;39m([0m[39mbut this is for TX path, not[0m [2m                [0m
[2;36m                    [0m         [39mthe issue[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m- Lines [0m[1;36m793[0m[39m-[0m[1;36m839[0m[39m in `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m`: Added `ip_hlen` and `ip_payload` variables but [0m       [2m                [0m
[2;36m                    [0m         [39m**continued using** the calculated `ip_payload` pointer instead of the [0m             [2m                [0m
[2;36m                    [0m         [39malready-correct `pkt->pay.buf`[0m                                                      [2m                [0m
[2;36m                    [0m         [39m- Lines [0m[1;36m893[0m[39m-[0m[1;36m901[0m[39m in `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m`: Added IHL validation [0m[1;39m([0m[39mgood, but not sufficient[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fundamental mistake was calculating `ip_payload = [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ip_hlen` in[0m [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m` and using that, when `pkt->pay.buf` was already correctly calculated in [0m  [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m` before calling `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m`.[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Comprehensive Fix Strategy[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix must use the already-correctly-positioned `pkt->pay.buf` pointer instead of[0m [2m                [0m
[2;36m                    [0m         [39mrecalculating from `pkt->ip`:[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m1[0m[39m. **Fix all protocol pointer assignments in `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m`**:[0m                       [2m                [0m
[2;36m                    [0m         [39m   [0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m   Replace all occurrences of `[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m` with `pkt->pay.buf`:[0m                  [2m                [0m
[2;36m                    [0m         [39m   [0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m   - **Line [0m[1;36m797[0m[39m** [0m[1;39m([0m[39mfragmented UDP[0m[1;39m)[0m[39m: Change from `pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip[0m [2m                [0m
[2;36m                    [0m         [39m+ [0m[1;36m1[0m[1;39m)[0m[39m;` to `pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m pkt->pay.buf;`[0m                                 [2m                [0m
[2;36m                    [0m         [39m   [0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m   - **Line [0m[1;36m798[0m[39m** [0m[1;39m([0m[39mfragmented TCP[0m[1;39m)[0m[39m: Change from `pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip[0m [2m                [0m
[2;36m                    [0m         [39m+ [0m[1;36m1[0m[1;39m)[0m[39m;` to `pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m pkt->pay.buf;`[0m                                 [2m                [0m
[2;36m                    [0m         [39m   [0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m   - **Line [0m[1;36m802[0m[39m** [0m[1;39m([0m[39mICMP[0m[1;39m)[0m[39m: Change from `pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;` [0m [2m                [0m
[2;36m                    [0m         [39mto `pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m pkt->pay.buf;`[0m                                      [2m                [0m
[2;36m                    [0m         [39m   [0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m   - **Line [0m[1;36m807[0m[39m** [0m[1;39m([0m[39mUDP[0m[1;39m)[0m[39m: Change from `pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;` to [0m [2m                [0m
[2;36m                    [0m         [39m`pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m pkt->pay.buf;`[0m                                           [2m                [0m
[2;36m                    [0m         [39m   [0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m   - **Line [0m[1;36m825[0m[39m** [0m[1;39m([0m[39mTCP[0m[1;39m)[0m[39m: Change from `pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;` to [0m [2m                [0m
[2;36m                    [0m         [39m`pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m pkt->pay.buf;`[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m2[0m[39m. **Fix TCP offset calculation at line [0m[1;36m829[0m[39m**:[0m                                  [2m                [0m
[2;36m                    [0m         [39m   [0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m   The current code uses `[0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m` which is always [0m[1;36m20[0m[39m:[0m                     [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m   Change to use actual IP header length:[0m                                           [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   uint16_t ip_hlen = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [39m   uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip_hlen + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m3[0m[39m. **Remove redundant variables from previous patch**:[0m                          [2m                [0m
[2;36m                    [0m         [39m   [0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m   The previous patch added `ip_hlen` and `ip_payload` variables at the start of [0m   [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m` and modified the protocol pointer assignments. These should be removed [0m   [2m                [0m
[2;36m                    [0m         [39msince we're using the already-correct `pkt->pay.buf`.[0m                               [2m                [0m
[2;36m                    [0m         [39m   [0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m   The only place we need `ip_hlen` is for the TCP offset calculation [0m[1;39m([0m[39mstep [0m[1;36m2[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mabove[0m[1;39m)[0m[39m.[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m4[0m[39m. **Keep the IHL validation from previous patch**:[0m                             [2m                [0m
[2;36m                    [0m         [39m   [0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m   The validation added in `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m` at lines [0m[1;36m893[0m[39m-[0m[1;36m901[0m[39m should be retained as [0m  [2m                [0m
[2;36m                    [0m         [39mit provides defense in depth:[0m                                                       [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   uint8_t ihl = pkt.ip->ver & [0m[1;36m0xF[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mihl < [0m[1;36m5[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m IHL must be at least [0m[1;36m5[0m[39m [0m[1;39m([0m[1;36m20[0m[39m bytes minimum[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39m   size_t ip_hlen = ihl * [0m[1;36m4[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hlen[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Buffer must contain [0m   [2m                [0m
[2;36m                    [0m         [39mfull IP header[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m   [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + ip_hlen[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m5[0m[39m. **Revert the bounds checking additions from previous patch**:[0m                [2m                [0m
[2;36m                    [0m         [39m   [0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m   The previous patch added checks like `if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[1;39m)[0m[39m` [0m  [2m                [0m
[2;36m                    [0m         [39mbefore assigning protocol pointers. These checks should remain AFTER the pointer [0m   [2m                [0m
[2;36m                    [0m         [39massignment [0m[1;39m([0m[39mas they were in the original code[0m[1;39m)[0m[39m, because:[0m                            [2m                [0m
[2;36m                    [0m         [39m   - They validate that there's enough payload data for the protocol header[0m         [2m                [0m
[2;36m                    [0m         [39m   - The assignment using `pkt->pay.buf` is now safe because `pkt->pay` was [0m        [2m                [0m
[2;36m                    [0m         [39mcalculated correctly in `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m`[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Justification[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This Fix is Optimal:[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Leverages existing correct calculation**: The `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m` function already[0m [2m                [0m
[2;36m                    [0m         [39mcorrectly calculates `pkt->pay.buf` to account for IP options. Using this value [0m    [2m                [0m
[2;36m                    [0m         [39meliminates redundant calculations and potential errors.[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Minimal code changes**: By using the already-available `pkt->pay.buf`, we [0m     [2m                [0m
[2;36m                    [0m         [39mavoid adding complex logic to recalculate IP payload positions in `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m`.[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Consistent with IPv6 handling**: The `[0m[1;35mrx_ip6[0m[1;39m([0m[1;39m)[0m[39m` function uses `[0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m`[0m [2m                [0m
[2;36m                    [0m         [39mwhich is always correct for IPv6 [0m[1;39m([0m[39mno variable header length[0m[1;39m)[0m[39m. For IPv4, using [0m      [2m                [0m
[2;36m                    [0m         [39m`pkt->pay.buf` achieves the same semantic correctness.[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Preserves existing validation logic**: The size checks at lines [0m[1;36m803[0m[39m, [0m[1;36m808[0m[39m, [0m[1;36m826[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39mremain in place and continue to validate that the payload contains enough data for [0m [2m                [0m
[2;36m                    [0m         [39mthe protocol headers.[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Fixes all affected protocol handlers**: ICMP, UDP, TCP, and fragmented packet [0m [2m                [0m
[2;36m                    [0m         [39mhandling all benefit from this fix.[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Preserves Existing Logic:[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- The `[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m` function calls after protocol pointer assignments continue to work [0m [2m                [0m
[2;36m                    [0m         [39mcorrectly, setting `pkt->pay` to point after each protocol header[0m                   [2m                [0m
[2;36m                    [0m         [39m- The DHCP handling in UDP [0m[1;39m([0m[39mlines [0m[1;36m813[0m[39m-[0m[1;36m823[0m[1;39m)[0m[39m continues to work as `pkt->udp` will now[0m [2m                [0m
[2;36m                    [0m         [39mpoint to the correct location[0m                                                       [2m                [0m
[2;36m                    [0m         [39m- The TCP payload length recalculation [0m[1;39m([0m[39mlines [0m[1;36m828[0m[39m-[0m[1;36m830[0m[1;39m)[0m[39m is fixed to use actual IP [0m   [2m                [0m
[2;36m                    [0m         [39mheader length[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m- All MG_VERBOSE logging statements continue to work with correct protocol pointers[0m [2m                [0m
[2;36m                    [0m         [39m- The fragmented packet error reporting [0m[1;39m([0m[39mline [0m[1;36m800[0m[1;39m)[0m[39m continues to function[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Addresses the Issue:[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe buffer overflow occurs because `pkt->icmp->type` is accessed at line [0m[1;36m384[0m[39m in [0m    [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` with an incorrectly positioned pointer. By setting `pkt->icmp = [0m[1;39m([0m[39mstruct[0m [2m                [0m
[2;36m                    [0m         [39micmp *[0m[1;39m)[0m[39m pkt->pay.buf;` in `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m`, the pointer will correctly point to the ICMP [0m  [2m                [0m
[2;36m                    [0m         [39mheader regardless of IP options, preventing the out-of-bounds read.[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Potential Side Effects and Mitigation:[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **[0m[3;35mNone[0m[39m expected for normal traffic**: IPv4 packets without options will work [0m    [2m                [0m
[2;36m                    [0m         [39midentically [0m[1;39m([0m[39msince `pkt->pay.buf` points to the same location as `[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m`[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Improved handling of IP options**: IPv4 packets with options [0m[1;39m([0m[39mwhich were [0m      [2m                [0m
[2;36m                    [0m         [39mpreviously broken[0m[1;39m)[0m[39m will now be handled correctly[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **No impact on IPv6**: The `[0m[1;35mrx_ip6[0m[1;39m([0m[1;39m)[0m[39m` function is unchanged and continues to [0m    [2m                [0m
[2;36m                    [0m         [39mwork correctly[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **No test breakage**: The fix makes the code more correct without changing the [0m  [2m                [0m
[2;36m                    [0m         [39mAPI or expected behavior for valid packets[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/06/26 18:02:56][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=307434;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=320693;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m6[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=395943;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=143884;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmprcy52vij[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/mongoose_mg-delta-02_mongoose[0m [2m               [0m
[2;36m                    [0m         [35m_2/[0m[95magent-output-1767722576.3749182[0m                                                   [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/mongoose_mg-delta-02_mongoose_2.toml                  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-mongoose[0m         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/06/26 18:05:06][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mmongoose[0m       ]8;id=85003;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=663043;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=50392;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=56486;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mmongoose[0m              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=283930;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=573809;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m               [2m               [0m
