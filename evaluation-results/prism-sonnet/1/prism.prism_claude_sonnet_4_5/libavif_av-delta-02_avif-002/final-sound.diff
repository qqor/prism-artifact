--- a/src/reformat.c
+++ b/src/reformat.c
@@ -806,6 +806,14 @@
                             b = 1;
                         }else{
                             b = -1;
+                        }
+                        // Bounds checking for a (column offset)
+                        if ((a < 0 && i == 0) || (a > 0 && i >= image->width - 1)) {
+                            a = 0;
+                        }
+                        // Bounds checking for b (row offset)
+                        if ((b < 0 && j == 0) || (b > 0 && j >= image->height - 1)) {
+                            b = 0;
                         }
                         uspill_image[i][j] -= pSpillCb;
                         vspill_image[i][j] -= pSpillCb;
