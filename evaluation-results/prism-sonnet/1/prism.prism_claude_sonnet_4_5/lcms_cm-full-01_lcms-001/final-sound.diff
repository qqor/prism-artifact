--- a/src/cmsps2.c
+++ b/src/cmsps2.c
@@ -760,6 +760,8 @@
         
     mpe = Pipeline->Elements;
 
+    if (mpe == NULL) return 0;
+
     switch (cmsStageInputChannels(mpe)) {
     case 3:
         _cmsIOPrintf(m, "[ /CIEBasedDEF\n");
@@ -783,7 +785,7 @@
 
     _cmsIOPrintf(m, "<<\n");
 
-    if (cmsStageType(mpe) == cmsSigCurveSetElemType) {
+    if (mpe != NULL && cmsStageType(mpe) == cmsSigCurveSetElemType) {
 
         _cmsIOPrintf(m, "/DecodeDEF [ ");
         EmitNGamma(m, cmsStageOutputChannels(mpe), _cmsStageGetPtrToCurveSet(mpe));
@@ -792,7 +794,7 @@
         mpe = mpe ->Next;
     }
 
-    if (cmsStageType(mpe) == cmsSigCLutElemType) {
+    if (mpe != NULL && cmsStageType(mpe) == cmsSigCLutElemType) {
 
             _cmsIOPrintf(m, "/Table ");
             WriteCLUT(m, mpe, PreMaj, PostMaj, PreMin, PostMin, FALSE, (cmsColorSpaceSignature) 0);
