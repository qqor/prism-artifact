[2;36m[01/06/26 11:23:41][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=422811;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=400765;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpzuycqhql[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/apache-commons-compress_cc-de[0m [2m               [0m
[2;36m                    [0m         [35mlta-04_vuln_6/[0m[95magent-output-1767698621.715073[0m                                         [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/apache-commons-compress_cc-delta-04_vuln_6.toml       [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-commons-compress[0m [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Building Cached for CLEAN        ]8;id=345123;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=720277;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Started[33m...[0m                                                        [2m                     [0m
[2;36m[01/06/26 11:25:11][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Building Cached for CLEAN       ]8;id=999451;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=209254;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Took [1;36m89.69[0m seconds; [33mexception[0m=[3;91mFalse[0m                              [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running tests for Cached for     ]8;id=227459;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=301953;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         CLEAN environment[1m)[0m Started[33m...[0m                                                  [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running tests for Cached for    ]8;id=377430;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=976859;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         CLEAN environment[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                         [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=430788;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=662476;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m89[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=710225;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=406119;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 11:25:12][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.90[0m        ]8;id=588942;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=993021;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/06/26 11:25:13][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=175850;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=756025;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=653076;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=564929;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=84969;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=419218;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=957378;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=372483;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 11:25:14][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m1.04[0m        ]8;id=347147;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=278547;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/06/26 11:25:15][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=52318;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=611394;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.85[0m        ]8;id=590392;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=362628;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/06/26 11:25:21][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=769303;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=943979;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp4005341953619202033/output/q/r/s/t/../../[0m[95mjazzer-traversal[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1m([0mFilePath [2m                [0m
[2;36m                    [0m         Traversal.jav[1;92ma:177[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:86[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:460[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:400[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:324[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:204[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1m([0mExpanderFuzzer.jav[1;92ma:52[0m[1m)[0m                [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: a87e9aa6b0374484                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp4005341953619202033/output/q/r/s/t/../../[0m[95mjazzer-traversal[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1m([0mFilePath [2m                [0m
[2;36m                    [0m         Traversal.jav[1;92ma:177[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:86[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:460[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:400[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:324[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:204[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1m([0mExpanderFuzzer.jav[1;92ma:52[0m[1m)[0m                [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: a87e9aa6b0374484                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/06/26 11:25:43][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=743735;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=273862;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/06/26 11:28:54][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=678468;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=202835;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/06/26 11:29:26][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=3396;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=383045;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=666960;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=41398;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 11:29:27][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.90[0m        ]8;id=99445;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=609230;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Patching[1m)[0m Started[33m...[0m             ]8;id=290884;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=802002;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpdgdunewp[0m                                                 ]8;id=197955;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=793865;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/06/26 11:30:05][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Patching[1m)[0m Took [1;36m37.65[0m seconds;   ]8;id=90924;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=781345;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Checking build[1m)[0m Started[33m...[0m       ]8;id=203315;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=4590;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 11:30:26][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Checking build[1m)[0m Took [1;36m20.62[0m      ]8;id=219743;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=156579;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running PoV[1m)[0m Started[33m...[0m          ]8;id=524516;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=515067;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 11:30:31][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running PoV[1m)[0m Took [1;36m5.15[0m seconds; ]8;id=655919;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=305060;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Testing[1m)[0m Started[33m...[0m              ]8;id=655360;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=491053;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Testing[1m)[0m Took [1;36m0.00[0m seconds;     ]8;id=876092;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=450448;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=58043;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=528710;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 11:30:32][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.84[0m        ]8;id=742597;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=18919;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=357801;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=730588;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 11:30:33][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.93[0m        ]8;id=994375;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=746812;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=423724;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=345228;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 11:30:34][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.91[0m        ]8;id=204116;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=651709;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/06/26 11:30:35][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=545675;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=328147;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/main/java/org/apache/commons/compress/archivers/ArchiveEntry.java         [2m                [0m
[2;36m                    [0m         +++ b/src/main/java/org/apache/commons/compress/archivers/ArchiveEntry.java         [2m                [0m
[2;36m                    [0m         @@ [1;36m-77[0m,[1;36m14[0m +[1;36m77[0m,[1;36m16[0m @@                                                                 [2m                [0m
[2;36m                    [0m               *[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m              default Path [1;35mresolveIn[0m[1m([0mfinal Path parentPath[1m)[0m throws IOException [1m{[0m             [2m                [0m
[2;36m                    [0m                  final String name = [1;35mgetName[0m[1m([0m[1m)[0m;                                             [2m                [0m
[2;36m                    [0m         -        final Path outputFile = [1;35mparentPath.resolve[0m[1m([0mname[1m)[0m[1;35m.normalize[0m[1m([0m[1m)[0m;              [2m                [0m
[2;36m                    [0m         +        String decodedName;                                                        [2m                [0m
[2;36m                    [0m         +        try [1m{[0m                                                                      [2m                [0m
[2;36m                    [0m         +            decodedName = [1;35mURLDecoder.decode[0m[1m([0mname,                                  [2m                [0m
[2;36m                    [0m         [1;35mStandardCharsets.US_ASCII.name[0m[1m([0m[1m)[0m[1m)[0m;                                                  [2m                [0m
[2;36m                    [0m         +        [1m}[0m catch [1m([0mIllegalArgumentException | UnsupportedEncodingException e[1m)[0m [1m{[0m      [2m                [0m
[2;36m                    [0m         +            decodedName = name;                                                    [2m                [0m
[2;36m                    [0m         +        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +        final Path outputFile = [1;35mparentPath.resolve[0m[1m([0mdecodedName[1m)[0m[1;35m.normalize[0m[1m([0m[1m)[0m;       [2m                [0m
[2;36m                    [0m                  if [1m([0m![1;35moutputFile.startsWith[0m[1m([0mparentPath[1m)[0m[1m)[0m [1m{[0m                                  [2m                [0m
[2;36m                    [0m                      throw new [1;35mIOException[0m[1m([0m[1;35mString.format[0m[1m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m,    [2m                [0m
[2;36m                    [0m         parentPath, name, outputFile[1m)[0m[1m)[0m;                                                     [2m                [0m
[2;36m                    [0m                  [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         -        try [1m{[0m                                                                      [2m                [0m
[2;36m                    [0m         -            return [1;35mparentPath.resolve[0m[1m([0m[1;35mURLDecoder.decode[0m[1m([0mname,                      [2m                [0m
[2;36m                    [0m         [1;35mStandardCharsets.US_ASCII.name[0m[1m([0m[1m)[0m[1m)[0m[1m)[0m;                                                 [2m                [0m
[2;36m                    [0m         -        [1m}[0m catch [1m([0mIllegalArgumentException | UnsupportedEncodingException e[1m)[0m [1m{[0m      [2m                [0m
[2;36m                    [0m         -            return outputFile;                                                     [2m                [0m
[2;36m                    [0m         -        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +        return outputFile;                                                         [2m                [0m
[2;36m                    [0m              [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp4005341953619202033/output/q/r/s/t/../../[0m[95mjazzer-traversal[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1m([0mFilePath [2m                [0m
[2;36m                    [0m         Traversal.jav[1;92ma:177[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:86[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:460[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:400[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:324[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:204[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1m([0mExpanderFuzzer.jav[1;92ma:52[0m[1m)[0m                [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: a87e9aa6b0374484                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m         # Evaluation Report                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Summary                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         A file path traversal vulnerability has been detected in the Apache Commons         [2m                [0m
[2;36m                    [0m         Compress library's `Expander` class. The fuzzer identified that malicious archive   [2m                [0m
[2;36m                    [0m         entries can escape the intended extraction directory using path traversal sequences [2m                [0m
[2;36m                    [0m         [1m([0me.g., `..[35m/../[0m`[1m)[0m, potentially allowing files to be written to arbitrary locations   [2m                [0m
[2;36m                    [0m         on the filesystem. The specific traversal attempt detected was                      [2m                [0m
[2;36m                    [0m         `[35m/tmp/expander-tmp4005341953619202033/output/q/r/s/t/../../[0m[95mjazzer-traversal[0m`, which [2m                [0m
[2;36m                    [0m         resolves outside the intended output directory.                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Description                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Issue Overview                                                                  [2m                [0m
[2;36m                    [0m         The issue is a **File Path Traversal** vulnerability [1m([0malso known as directory       [2m                [0m
[2;36m                    [0m         traversal or path traversal[1m)[0m, classified as a critical security issue by the Jazzer [2m                [0m
[2;36m                    [0m         fuzzing framework. This type of vulnerability occurs when an application uses       [2m                [0m
[2;36m                    [0m         user-supplied input to construct file paths without proper validation, allowing     [2m                [0m
[2;36m                    [0m         attackers to access files and directories stored outside the intended directory.    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Vulnerability Details                                                           [2m                [0m
[2;36m                    [0m         The security sanitizer `com.code_intelligence.jazzer.sanitizers.FilePathTraversal`  [2m                [0m
[2;36m                    [0m         detected an attempt to access or create a file at a path that traverses outside the [2m                [0m
[2;36m                    [0m         designated output directory. The problematic path                                   [2m                [0m
[2;36m                    [0m         `[35m/tmp/expander-tmp4005341953619202033/output/q/r/s/t/../../[0m[95mjazzer-traversal[0m`        [2m                [0m
[2;36m                    [0m         contains the path traversal sequence `..[35m/../[0m` which, when resolved, would point to  [2m                [0m
[2;36m                    [0m         a location outside the intended extraction directory.                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Stack Trace Analysis                                                            [2m                [0m
[2;36m                    [0m         The vulnerability manifests through the following call chain:                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m. **Entry Point**: `[1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1m([0m[1m)[0m` - The fuzzer harness that [2m                [0m
[2;36m                    [0m         feeds test input to the Expander                                                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m. **Multiple Expand Calls**: The `[1;35mExpander.expand[0m[1m([0m[1m)[0m` method is called recursively  [2m                [0m
[2;36m                    [0m         through lines [1;36m204[0m â†’ [1;36m324[0m â†’ [1;36m400[0m â†’ [1;36m460[0m â†’ [1;36m86[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m3[0m. **Detection Point**: At line [1;36m86[0m of `Expander.java`, a path operation triggers    [2m                [0m
[2;36m                    [0m         the security hook                                                                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m. **Interception**: `[1;35mFilePathTraversal.pathFirstArgHook[0m[1m([0m[1m)[0m` intercepts the path     [2m                [0m
[2;36m                    [0m         operation                                                                           [2m                [0m
[2;36m                    [0m         [1;36m5[0m. **Validation**: `[1;35mFilePathTraversal.checkPath[0m[1m([0m[1m)[0m` and `[1;35mFilePathTraversal.check[0m[1m([0m[1m)[0m`  [2m                [0m
[2;36m                    [0m         validate the path and detect the traversal attempt                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Key Observations                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         - The vulnerability occurs during archive extraction operations in the `Expander`   [2m                [0m
[2;36m                    [0m         class                                                                               [2m                [0m
[2;36m                    [0m         - The recursive nature of the `[1;35mexpand[0m[1m([0m[1m)[0m` method calls suggests the code handles     [2m                [0m
[2;36m                    [0m         nested archive structures or directory hierarchies                                  [2m                [0m
[2;36m                    [0m         - The path                                                                          [2m                [0m
[2;36m                    [0m         `[35m/tmp/expander-tmp4005341953619202033/output/q/r/s/t/../../[0m[95mjazzer-traversal[0m`        [2m                [0m
[2;36m                    [0m         indicates:                                                                          [2m                [0m
[2;36m                    [0m           - A temporary directory structure is created for extraction                       [2m                [0m
[2;36m                    [0m           - The archive contains entries with relative path components                      [2m                [0m
[2;36m                    [0m           - The traversal sequence `..[35m/../[0m` is present in the archive entry path            [2m                [0m
[2;36m                    [0m           - The final resolved path `jazzer-traversal` would be written outside the         [2m                [0m
[2;36m                    [0m         intended `output` directory                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Areas for Investigation                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         To gain a comprehensive understanding of this vulnerability, the following          [2m                [0m
[2;36m                    [0m         components should be examined:                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m. **`org.apache.commons.compress.archivers.examples.Expander` class**:             [2m                [0m
[2;36m                    [0m            - The `[1;35mexpand[0m[1m([0m[1m)[0m` method implementations at lines [1;36m86[0m, [1;36m204[0m, [1;36m324[0m, [1;36m400[0m, and [1;36m460[0m      [2m                [0m
[2;36m                    [0m            - How archive entry names are processed and converted to filesystem paths        [2m                [0m
[2;36m                    [0m            - Whether any path normalization or validation is performed before file creation [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m. **Archive Entry Processing**:                                                    [2m                [0m
[2;36m                    [0m            - How entry names from archives [1m([0mZIP, TAR, etc.[1m)[0m are extracted and used          [2m                [0m
[2;36m                    [0m            - Whether entry names are sanitized before being used as file paths              [2m                [0m
[2;36m                    [0m            - The handling of special characters and path separators in entry names          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m. **Path Construction Logic**:                                                     [2m                [0m
[2;36m                    [0m            - How the output directory and entry paths are combined                          [2m                [0m
[2;36m                    [0m            - Whether absolute paths in archive entries are handled                          [2m                [0m
[2;36m                    [0m            - The order of operations between path construction and validation               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m. **Security Controls**:                                                           [2m                [0m
[2;36m                    [0m            - Existing validation mechanisms for file paths [1m([0mif any[1m)[0m                         [2m                [0m
[2;36m                    [0m            - Whether there are checks to prevent directory traversal                        [2m                [0m
[2;36m                    [0m            - How symbolic links and other special file types are handled                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m. **Related Archive Handling Code**:                                               [2m                [0m
[2;36m                    [0m            - Other methods in the `Expander` class that may have similar vulnerabilities    [2m                [0m
[2;36m                    [0m            - Archive format-specific implementations that process entry names               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Initial Issue Log                                                                [2m                [0m
[2;36m                    [0m         Here is the initial issue log of the codebase:                                      [2m                [0m
[2;36m                    [0m         [1m<[0m[1;95missue[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: [0m   [2m                [0m
[2;36m                    [0m         [39mFile path traversal: [0m                                                               [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp4005341953619202033/output/q/r/s/t/../../[0m[95mjazzer-traversal[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1;39m([0m[39mFilePathTraversal.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:346[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1;39m([0m[39mFilePathTravers[0m [2m                [0m
[2;36m                    [0m         [39mal.jav[0m[1;92ma:293[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1;39m([0m[39mFilePath[0m [2m                [0m
[2;36m                    [0m         [39mTraversal.jav[0m[1;92ma:177[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:86[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:460[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:400[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:324[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:204[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mExpanderFuzzer.jav[0m[1;92ma:52[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: a87e9aa6b0374484[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:1[0m[39m-[0m[1;36m32[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one[0m                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * or more contributor license agreements.  See the NOTICE file[0m                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * distributed with this work for additional information[0m                          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * regarding copyright ownership.  The ASF licenses this file[0m                     [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * to you under the Apache License, Version [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mthe[0m                              [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance[0m                     [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * with the License.  You may obtain a copy of the License at[0m                     [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *   [0m[4;94mhttps://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * Unless required by applicable law or agreed to in writing,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * software distributed under the License is distributed on an[0m                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * [0m[32m"AS IS"[0m[39m BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY[0m                        [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * KIND, either express or implied.  See the License for the[0m                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * specific language governing permissions and limitations[0m                       [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * under the License.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:package org.apache.commons.compress.archivers.examples;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.BufferedInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.nio.channels.Channels;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.nio.channels.FileChannel;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.nio.channels.SeekableByteChannel;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.nio.file.StandardOpenOption;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.Enumeration;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:67[0m[39m-[0m[1;36m93[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    private <T extends ArchiveEntry> void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ArchiveEntrySupplier<T> [0m  [2m                [0m
[2;36m                    [0m         [39msupplier, final ArchiveEntryBiConsumer<T> writer, final Path targetDirectory[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            throws IOException [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        final boolean nullTarget = targetDirectory == null;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        final Path targetDirPath = nullTarget ? null : [0m                          [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        T nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        while [0m[1;39m([0m[39mnextEntry != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            final Path targetPath = nullTarget ? null : [0m                         [2m                [0m
[2;36m                    [0m         [1;35mnextEntry.resolveIn[0m[1;39m([0m[39mtargetDirPath[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            if [0m[1;39m([0m[1;35mnextEntry.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m && [0m            [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mtargetPath[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:                final Path parent = nullTarget ? null : [0m[1;35mtargetPath.getParent[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m && [0m                [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mparent[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                if [0m[1;39m([0m[39mnullTarget[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                    [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, NullOutputStream.INSTANCE[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                    try [0m[1;39m([0m[39mOutputStream outputStream = [0m                            [2m                [0m
[2;36m                    [0m         [1;35mFiles.newOutputStream[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                        [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, outputStream[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                    [0m[1;39m}[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/ArchiveEntry.jav[0m[1;92ma:21[0m[39m-[0m[1;36m26[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.UnsupportedEncodingException;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.net.URLDecoder;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.Date;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/ArchiveEntry.jav[0m[1;92ma:70[0m[39m-[0m[1;36m90[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * Resolves this entry in the given parent Path.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * @param parentPath the [0m[1;39m{[0m[39m@link Path#[0m[1;35mresolve[0m[1;39m([0m[39mPath[0m[1;39m)[0m[1;39m}[0m[39m receiver.[0m                [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * @return a resolved and normalized Path.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     * @throws IOException if this method detects a Zip slip.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     * @since [0m[1;36m1.26[0m[39m.[0m[1;36m0[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    default Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mparentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            return [0m[1;35mparentPath.resolve[0m[1;39m([0m[1;35mURLDecoder.decode[0m[1;39m([0m[39mname, [0m                   [2m                [0m
[2;36m                    [0m         [1;35mStandardCharsets.US_ASCII.name[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIllegalArgumentException | UnsupportedEncodingException e[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            return outputFile;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/ArchiveEntry.jav[0m[1;92ma:70[0m[39m-[0m[1;36m90[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * Resolves this entry in the given parent Path.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * @param parentPath the [0m[1;39m{[0m[39m@link Path#[0m[1;35mresolve[0m[1;39m([0m[39mPath[0m[1;39m)[0m[1;39m}[0m[39m receiver.[0m                [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * @return a resolved and normalized Path.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     * @throws IOException if this method detects a Zip slip.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     * @since [0m[1;36m1.26[0m[39m.[0m[1;36m0[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    default Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mparentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            return [0m[1;35mparentPath.resolve[0m[1;39m([0m[1;35mURLDecoder.decode[0m[1;39m([0m[39mname, [0m                   [2m                [0m
[2;36m                    [0m         [1;35mStandardCharsets.US_ASCII.name[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIllegalArgumentException | UnsupportedEncodingException e[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            return outputFile;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.jav[0m[1;92ma:1[0m[39m-[0m[1;36m56[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one[0m                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * or more contributor license agreements.  See the NOTICE file[0m                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * distributed with this work for additional information[0m                          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * regarding copyright ownership.  The ASF licenses this file[0m                     [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * to you under the Apache License, Version [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mthe[0m                              [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance[0m                     [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * with the License.  You may obtain a copy of the License at[0m                     [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *   [0m[4;94mhttps://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * Unless required by applicable law or agreed to in writing,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * software distributed under the License is distributed on an[0m                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * [0m[32m"AS IS"[0m[39m BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY[0m                        [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * KIND, either express or implied.  See the License for the[0m                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * specific language governing permissions and limitations[0m                       [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * under the License.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:package org.apache.commons.compress.archivers.examples;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import static java.nio.charset.StandardCharsets.UTF_8;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import static org.junit.jupiter.api.Assertions.assertArrayEquals;[0m                [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import static org.junit.jupiter.api.Assertions.assertEquals;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import static org.junit.jupiter.api.Assertions.assertFalse;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import static org.junit.jupiter.api.Assertions.assertThrows;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import static org.junit.jupiter.api.Assertions.assertTrue;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import static org.junit.jupiter.api.Assumptions.assumeFalse;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import static org.junit.jupiter.api.Assumptions.assumeTrue;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.io.BufferedInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.nio.channels.FileChannel;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.nio.channels.SeekableByteChannel;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import java.nio.file.StandardOpenOption;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.commons.compress.AbstractTest;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.commons.compress.archivers.ArchiveEntry;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.commons.compress.archivers.ArchiveException;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.commons.compress.archivers.ArchiveOutputStream;[0m                [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.commons.compress.archivers.ArchiveStreamFactory;[0m               [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.commons.compress.archivers.StreamingNotSupportedException;[0m     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.commons.compress.archivers.sevenz.SevenZFile;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.commons.compress.archivers.sevenz.SevenZOutputFile;[0m            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.commons.compress.archivers.tar.TarFile;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.commons.compress.archivers.zip.ZipFile;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.junit.jupiter.api.Test;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.junit.jupiter.api.io.TempDir;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m55:c[0m[39mlass ExpanderTest extends AbstractTest [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.jav[0m[1;92ma:178[0m[39m-[0m [2m                [0m
[2;36m                    [0m         [1;36m215[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:    void [0m[1;35mtestCompress603Tar[0m[1;39m([0m[1;39m)[0m[39m throws IOException, ArchiveException [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:        [0m[1;35msetupTarForCompress603[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:        try [0m[1;39m([0m[39mTarFile f = new [0m[1;35mTarFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:            new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, tempResultDir[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:        [0m[1;35mverifyTargetDir[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    void [0m[1;35mtestFileCantEscapeDoubleDotPath[0m[1;39m([0m[1;39m)[0m[39m throws IOException, ArchiveException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:        [0m[1;35msetupZip[0m[1;39m([0m[32m"../foo"[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:        try [0m[1;39m([0m[39mZipFile f = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:            [0m[1;35massertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, [0m     [2m                [0m
[2;36m                    [0m         [39mtempResultDir[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:    void [0m[1;35mtestFileCantEscapeDoubleDotPathWithSimilarSibling[0m[1;39m([0m[1;39m)[0m[39m throws [0m            [2m                [0m
[2;36m                    [0m         [39mIOException, ArchiveException [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:        final String sibling = [0m[1;35mtempResultDir.getName[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m"x"[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:        final File s = new [0m[1;35mFile[0m[1;39m([0m[1;35mtempResultDir.getParentFile[0m[1;39m([0m[1;39m)[0m[39m, sibling[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:        [0m[1;35massumeFalse[0m[1;39m([0m[1;35ms.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:        [0m[1;35ms.mkdirs[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:        [0m[1;35massumeTrue[0m[1;39m([0m[1;35ms.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:        [0m[1;35msetupZip[0m[1;39m([0m[32m"../"[0m[39m + sibling + [0m[32m"/a"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:        try [0m[1;39m([0m[39mZipFile f = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:            [0m[1;35massertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, [0m     [2m                [0m
[2;36m                    [0m         [39mtempResultDir[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    void [0m[1;35mtestFileCantEscapeViaAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m throws IOException, [0m               [2m                [0m
[2;36m                    [0m         [39mArchiveException [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:        [0m[1;35msetupZip[0m[1;39m([0m[32m"/tmp/foo"[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:        try [0m[1;39m([0m[39mZipFile f = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            [0m[1;35massertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, [0m     [2m                [0m
[2;36m                    [0m         [39mtempResultDir[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:        [0m[1;35massertFalse[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mtempResultDir, [0m[32m"tmp/foo"[0m[1;39m)[0m[1;35m.isFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.jav[0m[1;92ma:292[0m[39m-[0m [2m                [0m
[2;36m                    [0m         [1;36m301[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:    public void [0m[1;35mtestURLDecoding[0m[1;39m([0m[39m@TempDir Path output[0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:        Path input = [0m[1;35mPaths.get[0m[1;39m([0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:                [0m[1;35mExpanderTest.class.getResource[0m[1;39m([0m[32m"/testURLDecoded.zip"[0m[1;39m)[0m[1;35m.toURI[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:        new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39minput, output[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        File[0m[1;39m[[0m[1;39m][0m[39m files = [0m[1;35moutput.toFile[0m[1;39m([0m[1;39m)[0m[1;35m.listFiles[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[1;36m1[0m[39m, files.length[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[32m"test.txt"[0m[39m, files[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[1;36m12[0m[39m, [0m[1;35mFiles.size[0m[1;39m([0m[39mfiles[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:67[0m[39m-[0m[1;36m93[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    private <T extends ArchiveEntry> void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ArchiveEntrySupplier<T> [0m  [2m                [0m
[2;36m                    [0m         [39msupplier, final ArchiveEntryBiConsumer<T> writer, final Path targetDirectory[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            throws IOException [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        final boolean nullTarget = targetDirectory == null;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        final Path targetDirPath = nullTarget ? null : [0m                          [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        T nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        while [0m[1;39m([0m[39mnextEntry != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            final Path targetPath = nullTarget ? null : [0m                         [2m                [0m
[2;36m                    [0m         [1;35mnextEntry.resolveIn[0m[1;39m([0m[39mtargetDirPath[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            if [0m[1;39m([0m[1;35mnextEntry.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m && [0m            [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mtargetPath[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:                final Path parent = nullTarget ? null : [0m[1;35mtargetPath.getParent[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m && [0m                [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mparent[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                if [0m[1;39m([0m[39mnullTarget[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                    [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, NullOutputStream.INSTANCE[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                    try [0m[1;39m([0m[39mOutputStream outputStream = [0m                            [2m                [0m
[2;36m                    [0m         [1;35mFiles.newOutputStream[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                        [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, outputStream[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                    [0m[1;39m}[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/ArchiveEntry.jav[0m[1;92ma:78[0m[39m-[0m[1;36m89[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    default Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mparentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            return [0m[1;35mparentPath.resolve[0m[1;39m([0m[1;35mURLDecoder.decode[0m[1;39m([0m[39mname, [0m                   [2m                [0m
[2;36m                    [0m         [1;35mStandardCharsets.US_ASCII.name[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIllegalArgumentException | UnsupportedEncodingException e[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            return outputFile;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveEntry.jav[0m[1;92ma:1[0m[39m-[0m[1;36m64[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one[0m                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * or more contributor license agreements.  See the NOTICE file[0m                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * distributed with this work for additional information[0m                          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * regarding copyright ownership.  The ASF licenses this file[0m                     [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * to you under the Apache License, Version [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mthe[0m                              [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance[0m                     [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * with the License.  You may obtain a copy of the License at[0m                     [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *   [0m[4;94mhttps://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * Unless required by applicable law or agreed to in writing,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * software distributed under the License is distributed on an[0m                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * [0m[32m"AS IS"[0m[39m BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY[0m                        [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * KIND, either express or implied.  See the License for the[0m                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * specific language governing permissions and limitations[0m                       [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * under the License.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:package org.apache.commons.compress.archivers.zip;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.LinkOption;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.nio.file.attribute.BasicFileAttributes;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.nio.file.attribute.FileTime;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.Date;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.LinkedList;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.NoSuchElementException;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.util.Objects;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.util.function.Function;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.util.zip.ZipEntry;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.util.zip.ZipException;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.commons.compress.archivers.ArchiveEntry;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.commons.compress.archivers.EntryStreamOffsets;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.commons.compress.utils.ByteUtils;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.commons.io.file.attribute.FileTimes;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.commons.lang3.ArrayUtils;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m: * Extension that adds better handling of extra fields and provides access to [0m   [2m                [0m
[2;36m                    [0m         [39mthe internal and external file attributes.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m: * The extra data is expected to follow the recommendation of <a [0m                [2m                [0m
[2;36m                    [0m         [33mhref[0m[39m=[0m[32m"http[0m[32m://www.pkware.com/documents/casestudies/APPNOTE.TXT"[0m[39m>APPNOTE.TXT<[0m[35m/[0m[95ma[0m[39m>:[0m     [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m: * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m: * <ul>[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m: * <li>the extra byte array consists of a sequence of extra fields<[0m[35m/[0m[95mli[0m[39m>[0m          [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m: * <li>each extra fields starts by a two byte header id followed by a two byte [0m  [2m                [0m
[2;36m                    [0m         [39msequence holding the length of the remainder of data.<[0m[35m/[0m[95mli[0m[39m>[0m                          [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m: * <[0m[35m/[0m[95mul[0m[39m>[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m: * Any extra data that cannot be parsed by the rules above will be consumed as [0m  [2m                [0m
[2;36m                    [0m         [32m"unparseable"[0m[39m extra data and treated differently by the methods of this class.[0m      [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m: * Versions prior to Apache Commons Compress [0m[1;36m1.1[0m[39m would have thrown an exception [0m [2m                [0m
[2;36m                    [0m         [39mif any attempt was made to read or write extra data not conforming to the[0m           [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m: * recommendation.[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m: * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m: * @NotThreadSafe[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:public class ZipArchiveEntry extends ZipEntry implements ArchiveEntry, [0m          [2m                [0m
[2;36m                    [0m         [39mEntryStreamOffsets [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/tar/TarArchiveEntry.jav[0m[1;92ma:185[0m[39m-[0m[1;36m18[0m [2m                [0m
[2;36m                    [0m         [1;36m6[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:public class TarArchiveEntry implements ArchiveEntry, TarConstants, [0m            [2m                [0m
[2;36m                    [0m         [39mEntryStreamOffsets [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/arj/ArjArchiveEntry.jav[0m[1;92ma:33[0m[39m-[0m[1;36m34[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:public class ArjArchiveEntry implements ArchiveEntry [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/dump/DumpArchiveEntry.jav[0m[1;92ma:174[0m[39m-[0m [2m                [0m
[2;36m                    [0m         [1;36m175[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:public class DumpArchiveEntry implements ArchiveEntry [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/ar/ArArchiveEntry.jav[0m[1;92ma:59[0m[39m-[0m[1;36m60[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:public class ArArchiveEntry implements ArchiveEntry [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.jav[0m[1;92ma:188[0m[39m-[0m [2m                [0m
[2;36m                    [0m         [1;36m215[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    void [0m[1;35mtestFileCantEscapeDoubleDotPath[0m[1;39m([0m[1;39m)[0m[39m throws IOException, ArchiveException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:        [0m[1;35msetupZip[0m[1;39m([0m[32m"../foo"[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:        try [0m[1;39m([0m[39mZipFile f = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:            [0m[1;35massertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, [0m     [2m                [0m
[2;36m                    [0m         [39mtempResultDir[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:    void [0m[1;35mtestFileCantEscapeDoubleDotPathWithSimilarSibling[0m[1;39m([0m[1;39m)[0m[39m throws [0m            [2m                [0m
[2;36m                    [0m         [39mIOException, ArchiveException [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:        final String sibling = [0m[1;35mtempResultDir.getName[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m"x"[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:        final File s = new [0m[1;35mFile[0m[1;39m([0m[1;35mtempResultDir.getParentFile[0m[1;39m([0m[1;39m)[0m[39m, sibling[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:        [0m[1;35massumeFalse[0m[1;39m([0m[1;35ms.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:        [0m[1;35ms.mkdirs[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:        [0m[1;35massumeTrue[0m[1;39m([0m[1;35ms.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:        [0m[1;35msetupZip[0m[1;39m([0m[32m"../"[0m[39m + sibling + [0m[32m"/a"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:        try [0m[1;39m([0m[39mZipFile f = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:            [0m[1;35massertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, [0m     [2m                [0m
[2;36m                    [0m         [39mtempResultDir[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    void [0m[1;35mtestFileCantEscapeViaAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m throws IOException, [0m               [2m                [0m
[2;36m                    [0m         [39mArchiveException [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:        [0m[1;35msetupZip[0m[1;39m([0m[32m"/tmp/foo"[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:        try [0m[1;39m([0m[39mZipFile f = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            [0m[1;35massertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, [0m     [2m                [0m
[2;36m                    [0m         [39mtempResultDir[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:        [0m[1;35massertFalse[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mtempResultDir, [0m[32m"tmp/foo"[0m[1;39m)[0m[1;35m.isFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/ArchiveEntry.jav[0m[1;92ma:78[0m[39m-[0m[1;36m89[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    default Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mparentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            return [0m[1;35mparentPath.resolve[0m[1;39m([0m[1;35mURLDecoder.decode[0m[1;39m([0m[39mname, [0m                   [2m                [0m
[2;36m                    [0m         [1;35mStandardCharsets.US_ASCII.name[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIllegalArgumentException | UnsupportedEncodingException e[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            return outputFile;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.jav[0m[1;92ma:292[0m[39m-[0m [2m                [0m
[2;36m                    [0m         [1;36m301[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:    public void [0m[1;35mtestURLDecoding[0m[1;39m([0m[39m@TempDir Path output[0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:        Path input = [0m[1;35mPaths.get[0m[1;39m([0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:                [0m[1;35mExpanderTest.class.getResource[0m[1;39m([0m[32m"/testURLDecoded.zip"[0m[1;39m)[0m[1;35m.toURI[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:        new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39minput, output[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        File[0m[1;39m[[0m[1;39m][0m[39m files = [0m[1;35moutput.toFile[0m[1;39m([0m[1;39m)[0m[1;35m.listFiles[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[1;36m1[0m[39m, files.length[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[32m"test.txt"[0m[39m, files[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[1;36m12[0m[39m, [0m[1;35mFiles.size[0m[1;39m([0m[39mfiles[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis Summary[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter analyzing the code snippets and evaluation report, I've identified the root [0m  [2m                [0m
[2;36m                    [0m         [39mcause of the file path traversal vulnerability:[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Root Cause**: The `[0m[1;35mArchiveEntry.resolveIn[0m[1;39m([0m[1;39m)[0m[39m` method [0m[1;39m([0m[39mlines [0m[1;36m78[0m[39m-[0m[1;36m89[0m[39m in [0m              [2m                [0m
[2;36m                    [0m         [39m`src/main/java/org/apache/commons/compress/archivers/ArchiveEntry.java`[0m[1;39m)[0m[39m has a [0m     [2m                [0m
[2;36m                    [0m         [39mcritical logic flaw where it:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. First validates the raw [0m[1;39m([0m[39mURL-encoded[0m[1;39m)[0m[39m entry name against path traversal [0m[1;39m([0m[39mlines [0m  [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m-[0m[1;36m83[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Then URL-decodes the name and returns it WITHOUT re-validating [0m[1;39m([0m[39mline [0m[1;36m85[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis allows attackers to bypass the validation using URL-encoded path traversal [0m    [2m                [0m
[2;36m                    [0m         [39msequences like `%2e%2e%2f` [0m[1;39m([0m[39mwhich decodes to `..[0m[35m/[0m[39m`[0m[1;39m)[0m[39m.[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Attack Vector**: [0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- Entry name: `q%2Fr%2Fs%2Ft%2F..%2F..%2Fjazzer-traversal`[0m                          [2m                [0m
[2;36m                    [0m         [39m- Passes initial validation [0m[1;39m([0m[39mappears safe when encoded[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [39m- Gets decoded to: `q/r/s/t/..[0m[35m/../[0m[95mjazzer-traversal[0m[39m`[0m                                 [2m                [0m
[2;36m                    [0m         [39m- Resolves to a path outside the target directory[0m                                   [2m                [0m
[2;36m                    [0m         [39m- File is written to unintended location[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Impact**: All archive formats [0m[1;39m([0m[39mZIP, TAR, 7z, ARJ, DUMP, AR[0m[1;39m)[0m[39m are affected since [0m   [2m                [0m
[2;36m                    [0m         [39mthey all use the default `[0m[1;35mresolveIn[0m[1;39m([0m[1;39m)[0m[39m` implementation.[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Primary Fix: Modify `[0m[1;35mArchiveEntry.resolveIn[0m[1;39m([0m[1;39m)[0m[39m` Method[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**File**: `src/main/java/org/apache/commons/compress/archivers/ArchiveEntry.java`[0m   [2m                [0m
[2;36m                    [0m         [39m**Method**: `[0m[1;35mresolveIn[0m[1;39m([0m[39mPath parentPath[0m[1;39m)[0m[39m` [0m[1;39m([0m[39mlines [0m[1;36m78[0m[39m-[0m[1;36m89[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Strategy**: Decode the entry name FIRST, then perform path validation on the [0m     [2m                [0m
[2;36m                    [0m         [39mdecoded result. This ensures that any URL-encoded path traversal sequences are [0m     [2m                [0m
[2;36m                    [0m         [39mdecoded before the security check, preventing bypass attacks.[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation Steps**:[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Decode the entry name first** [0m[1;39m([0m[39mbefore any path resolution[0m[1;39m)[0m[39m:[0m                    [2m                [0m
[2;36m                    [0m         [39m   - Call `[0m[1;35mURLDecoder.decode[0m[1;39m([0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mStandardCharsets.US_ASCII.name[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m` at the [0m  [2m                [0m
[2;36m                    [0m         [39mbeginning[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m   - Handle the `UnsupportedEncodingException` and `IllegalArgumentException` [0m      [2m                [0m
[2;36m                    [0m         [39mexceptions[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   - If decoding fails, fall back to using the original name[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Resolve and normalize the decoded path**:[0m                                      [2m                [0m
[2;36m                    [0m         [39m   - Use `[0m[1;35mparentPath.resolve[0m[1;39m([0m[39mdecodedName[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m` to get the final path[0m        [2m                [0m
[2;36m                    [0m         [39m   - The normalization will collapse any `..[0m[35m/[0m[39m` sequences that resulted from URL [0m    [2m                [0m
[2;36m                    [0m         [39mdecoding[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Validate the final path**:[0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - Check if the normalized path starts with the parent path using `[0m[1;35mstartsWith[0m[1;39m([0m[1;39m)[0m[39m`[0m  [2m                [0m
[2;36m                    [0m         [39m   - If the check fails, throw an `IOException` with a descriptive [0m[32m"Zip slip"[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mmessage[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   - Include the parent path, original entry name, and resolved path in the error [0m  [2m                [0m
[2;36m                    [0m         [39mmessage[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Return the validated path**:[0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - Only return the path if it passes validation[0m                                   [2m                [0m
[2;36m                    [0m         [39m   - This ensures no unvalidated paths can escape the target directory[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Detailed Logic Flow**:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Get the entry name: name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Try to URL decode it:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m   - decodedName = [0m[1;35mURLDecoder.decode[0m[1;39m([0m[39mname, US_ASCII[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [39m   - If decoding fails, use name as decodedName[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Resolve the decoded name: outputFile = [0m                                          [2m                [0m
[2;36m                    [0m         [1;35mparentPath.resolve[0m[1;39m([0m[39mdecodedName[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Validate: if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m throw IOException[0m              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Return: outputFile[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This Approach is Optimal[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Fixes the vulnerability**: By decoding before validation, URL-encoded path [0m    [2m                [0m
[2;36m                    [0m         [39mtraversal sequences are caught by the security check[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Preserves legitimate functionality**: [0m                                         [2m                [0m
[2;36m                    [0m         [39m   - The existing test `[0m[1;35mtestURLDecoding[0m[1;39m([0m[1;39m)[0m[39m` expects URL-encoded filenames like [0m      [2m                [0m
[2;36m                    [0m         [39m`test%[0m[1;36m20.[0m[39mtxt` to work correctly[0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - This approach maintains that behavior while blocking malicious encoding[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Maintains existing API**: [0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - No changes to method signature or return type[0m                                  [2m                [0m
[2;36m                    [0m         [39m   - No changes to exception types thrown[0m                                           [2m                [0m
[2;36m                    [0m         [39m   - Fully backward compatible with existing code[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Single point of validation**: [0m                                                 [2m                [0m
[2;36m                    [0m         [39m   - All archive formats benefit from the fix since they inherit this default [0m      [2m                [0m
[2;36m                    [0m         [39mmethod[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   - No need to modify individual archive entry implementations[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Follows defense in depth**: [0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - Validates the actual path that will be used for file operations[0m                [2m                [0m
[2;36m                    [0m         [39m   - Prevents any encoding-based bypass techniques[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Preserves existing security checks**:[0m                                          [2m                [0m
[2;36m                    [0m         [39m   - The `[0m[1;35mstartsWith[0m[1;39m([0m[1;39m)[0m[39m` check remains the same[0m                                      [2m                [0m
[2;36m                    [0m         [39m   - The error message format remains consistent[0m                                    [2m                [0m
[2;36m                    [0m         [39m   - The normalization logic is preserved[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Addresses the Issues[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**For the reported vulnerability**:[0m                                                 [2m                [0m
[2;36m                    [0m         [39m- Malicious entry `q%2Fr%2Fs%2Ft%2F..%2F..%2Fjazzer-traversal` will:[0m                [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m1[0m[39m. Decode to `q/r/s/t/..[0m[35m/../[0m[95mjazzer-traversal[0m[39m`[0m                                     [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m2[0m[39m. Resolve and normalize to a path outside the parent[0m                             [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m3[0m[39m. Fail the `[0m[1;35mstartsWith[0m[1;39m([0m[1;39m)[0m[39m` check[0m                                                  [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m4[0m[39m. Throw `IOException` with [0m[32m"Zip slip"[0m[39m message[0m                                    [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m5[0m[39m. Prevent file creation outside the target directory[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**For legitimate use cases**:[0m                                                       [2m                [0m
[2;36m                    [0m         [39m- Entry `test%20file.txt` will:[0m                                                     [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m1[0m[39m. Decode to `test file.txt`[0m                                                      [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m2[0m[39m. Resolve to `parentPath/test file.txt`[0m                                          [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m3[0m[39m. Pass the `[0m[1;35mstartsWith[0m[1;39m([0m[1;39m)[0m[39m` check [0m[1;39m([0m[39mwithin parent[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m4[0m[39m. Return the valid path[0m                                                          [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m5[0m[39m. Extract successfully as `test file.txt`[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Potential Side Effects and Mitigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Side Effect [0m[1;36m1[0m[39m**: Potential performance impact from decoding all entry names[0m       [2m                [0m
[2;36m                    [0m         [39m- **Mitigation**: URL decoding is a lightweight operation and was already being [0m    [2m                [0m
[2;36m                    [0m         [39mperformed [0m[1;39m([0m[39mjust in the wrong order[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [39m- **Impact**: Negligible - the fix just reorders existing operations[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Side Effect [0m[1;36m2[0m[39m**: Different error messages for encoded vs. non-encoded malicious [0m  [2m                [0m
[2;36m                    [0m         [39mpaths[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m- **Mitigation**: The error message should include the original entry name to aid [0m  [2m                [0m
[2;36m                    [0m         [39mdebugging[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m- **Impact**: Minimal - error messages will be more accurate since they'll show [0m    [2m                [0m
[2;36m                    [0m         [39mdecoded paths[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Side Effect [0m[1;36m3[0m[39m**: Rare edge case where an entry name contains literal `%` followed[0m [2m                [0m
[2;36m                    [0m         [39mby hex digits[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m- **Mitigation**: The current code already has this behavior; the fix maintains it[0m  [2m                [0m
[2;36m                    [0m         [39m- **Impact**: [0m[3;35mNone[0m[39m - no regression from current behavior[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### No Modification to Other Components[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why the Expander class doesn't need changes**:[0m                                    [2m                [0m
[2;36m                    [0m         [39m- The `[0m[1;35mExpander.expand[0m[1;39m([0m[1;39m)[0m[39m` method correctly delegates path validation to [0m            [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mArchiveEntry.resolveIn[0m[1;39m([0m[1;39m)[0m[39m`[0m                                                          [2m                [0m
[2;36m                    [0m         [39m- It doesn't perform any additional path manipulation that could bypass the fix[0m     [2m                [0m
[2;36m                    [0m         [39m- The architectural design is sound - fixing `[0m[1;35mresolveIn[0m[1;39m([0m[1;39m)[0m[39m` fixes all callers[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why no changes to archive entry implementations**:[0m                                [2m                [0m
[2;36m                    [0m         [39m- [0m[3;35mNone[0m[39m of the concrete classes [0m[1;39m([0m[39mZipArchiveEntry, TarArchiveEntry, etc.[0m[1;39m)[0m[39m override [0m   [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mresolveIn[0m[1;39m([0m[1;39m)[0m[39m`[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m- They all inherit the default implementation from the ArchiveEntry interface[0m       [2m                [0m
[2;36m                    [0m         [39m- Fixing the interface method fixes all implementations[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why no changes to test harness or fuzzing logic**:[0m                                [2m                [0m
[2;36m                    [0m         [39m- The fuzzer correctly identified the vulnerability[0m                                 [2m                [0m
[2;36m                    [0m         [39m- The harness code `[0m[1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1;39m([0m[1;39m)[0m[39m` is working as intended[0m     [2m                [0m
[2;36m                    [0m         [39m- No modifications needed to maintain fuzzing capabilities[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Verification Strategy[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix should be verified against:[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Existing tests**: All current tests in `ExpanderTest.java` must pass:[0m          [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mtestFileCantEscapeDoubleDotPath[0m[1;39m([0m[1;39m)[0m[39m` - literal `..[0m[35m/[0m[39m`[0m                            [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mtestFileCantEscapeDoubleDotPathWithSimilarSibling[0m[1;39m([0m[1;39m)[0m[39m` - literal `..[0m[35m/sibling/[0m[39m`[0m  [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mtestFileCantEscapeViaAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m` - absolute paths[0m                         [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mtestURLDecoding[0m[1;39m([0m[1;39m)[0m[39m` - legitimate URL-encoded names[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **New test cases** [0m[1;39m([0m[39mrecommended but not part of the fix[0m[1;39m)[0m[39m:[0m                        [2m                [0m
[2;36m                    [0m         [39m   - URL-encoded traversal: `%2e%2e%2ffoo`[0m                                          [2m                [0m
[2;36m                    [0m         [39m   - Partially encoded: `..%2Ffoo`[0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - Windows-style: `%2e%2e%5cfoo`[0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - Double encoding: `%252e%252e%252f`[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Fuzzer replay**: The original crashing input should be blocked with proper [0m    [2m                [0m
[2;36m                    [0m         [39merror message[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=97469;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=830334;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=101387;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=458870;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpzuycqhql[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/apache-commons-compress_cc-de[0m [2m               [0m
[2;36m                    [0m         [35mlta-04_vuln_6/[0m[95magent-output-1767699035.337208[0m                                         [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/apache-commons-compress_cc-delta-04_vuln_6.toml       [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-commons-compress[0m [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/06/26 11:30:37][0m[2;36m [0m[34mINFO    [0m Deleting environments directory:                                                     ]8;id=225553;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=697067;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/.cache/environments/[0m[95mapache-commons-compress[0m                         [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=806733;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=118673;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mapache-commons-compre[0m [2m               [0m
[2;36m                    [0m         [95mss[0m                                                                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=576536;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=528371;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mapache-commons-compres[0m [2m               [0m
[2;36m                    [0m         [95ms[0m                                                                                    [2m               [0m
