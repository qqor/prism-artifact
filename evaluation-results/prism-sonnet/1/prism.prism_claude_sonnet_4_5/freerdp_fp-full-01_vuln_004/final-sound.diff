--- a/libfreerdp/core/gcc.c
+++ b/libfreerdp/core/gcc.c
@@ -1850,16 +1850,15 @@
 	WINPR_ASSERT(s);
 	WINPR_ASSERT(mcs);
 
-	const size_t blockLength = Stream_GetRemainingLength(s);
-	if (blockLength < 4)
-		return FALSE;
-
-	Stream_Read_UINT8(s, mcs->channelCount); /* channelCount */
-
-	if (blockLength < 4 + (UINT8)mcs->channelCount * 12)
-		return FALSE;
+	if (!Stream_CheckAndLogRequiredLength(TAG, s, 4))
+		return FALSE;
+
+	Stream_Read_UINT32(s, mcs->channelCount); /* channelCount */
 
 	if (mcs->channelCount > CHANNEL_MAX_COUNT)
+		return FALSE;
+
+	if (!Stream_CheckAndLogRequiredLengthOfSize(TAG, s, mcs->channelCount, 12ull))
 		return FALSE;
 
 	/* channelDefArray */
