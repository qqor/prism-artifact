--- a/lib/verynormalprotocol.c
+++ b/lib/verynormalprotocol.c
@@ -127,8 +127,12 @@
   /* Read the response from the server. If we see the correct "heartbeat",
      we should complete the transaction and return CURLE_OK. */
   do {
-    result = Curl_xfer_recv(data, response, 128, &nread);
+    result = Curl_xfer_recv(data, response, 127, &nread);
   } while(result == CURLE_AGAIN);
+
+  if(nread > 0 && nread < 128)
+    response[nread] = '\0';
+
   if(result)
     return result;
   else if(!nread) {
@@ -136,17 +140,15 @@
     *done = TRUE;
     result = CURLE_RECV_ERROR;
   }
-  else if(strcasecmp(response, "crashycrashy") == 0) {
+  else if(strcasecompare(response, "crashycrashy")) {
     *done = TRUE;
-    *(unsigned int *)result = CURLE_OK;
+    result = CURLE_OK;
   }
   else {
     *done = TRUE;
     result = CURLE_WEIRD_SERVER_REPLY;
   }
 
-  if(result == CURLE_AGAIN)
-    result = CURLE_OK;
   return result;
 }
 
