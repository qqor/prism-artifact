[2;36m[01/05/26 21:02:02][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=411057;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=468699;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpws9l444h[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/pdfbox_pdfbox-full-01_vuln_6/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1767646922.2003293[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc/pdfbox_pdfbox-full-01_vuln_6.toml       [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-pdfbox[0m           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Building Cached for CLEAN environment[1m)[0m Started[33m...[0m ]8;id=221287;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=833911;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 21:03:18][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Building Cached for CLEAN environment[1m)[0m Took      ]8;id=816864;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=904965;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m76.13[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running tests for Cached for CLEAN environment[1m)[0m   ]8;id=218112;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=501416;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=803819;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=15581;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=972946;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=766793;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m76[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=410903;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=575576;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 21:03:19][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.92[0m seconds;                ]8;id=757031;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=745846;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/05/26 21:03:20][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=295912;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=967310;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=413227;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=292263;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=660175;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=972013;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=685306;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=151012;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 21:03:21][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m1.10[0m seconds;                ]8;id=637306;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=438841;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=406882;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=148830;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 21:03:22][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.88[0m seconds;                ]8;id=547193;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=363983;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/05/26 21:03:29][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=405305;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=679309;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of  [2m                [0m
[2;36m                    [0m         memory [1m([0muse [32m'-Xmx1710m'[0m to reproduce[1m)[0m                                               [2m                [0m
[2;36m                    [0m         Caused by: java.lang.OutOfMemoryError: Java heap space                              [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.fontbox.pfb.PfbParser.parsePfb[0m[1m([0mPfbParser.jav[1;92ma:166[0m[1m)[0m            [2m                [0m
[2;36m                    [0m                 at org.apache.fontbox.pfb.PfbParser.[1m<[0m[1;95minit[0m[39m>[0m[1;39m([0m[39mPfbParser.jav[0m[1;92ma:116[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Font.createWithPFB[0m[1;39m([0m[39mType1Font.jav[0m[1;92ma:69[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.pdfbox.pdmodel.font.PDType1Font.<init>[0m[1;39m([0m[39mPDType1Font.jav[0m[1;92ma:227[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.pdmodel.font.PDFontFactory.createFont[0m[1;39m([0m[39mPDFontFactory.jav[0m[1;92ma:140[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.pdmodel.PDResources.getFont[0m[1;39m([0m[39mPDResources.jav[0m[1;92ma:170[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process[0m[1;39m([0m[39mSetFontAndSize[0m [2m                [0m
[2;36m                    [0m         [39m.jav[0m[1;92ma:72[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processOperator[0m[1;39m([0m[39mPDFStreamEngine.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:924[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators[0m[1;39m([0m[39mPDFStreamEng[0m [2m                [0m
[2;36m                    [0m         [39mine.jav[0m[1;92ma:557[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStream[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m515[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processPage[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:15[0m [2m                [0m
[2;36m                    [0m         [1;92m8[0m[1;39m)[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.LegacyPDFStreamEngine.processPage[0m[1;39m([0m[39mLegacyPDFStreamEngine.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:153[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPage[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:378[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPages[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:303[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.writeText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:251[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.text.PDFTextStripper.getText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:218[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.PDFExtractTextFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPDFExtractTextFuzzer.jav[0m[1;92ma:41[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$DMH/[0m[1;35m0x0000000800cbc000.invokeStaticInit[0m[1;39m([0m[39mLambd[0m [2m                [0m
[2;36m                    [0m         [39maForm$DMH[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cbd000.invoke[0m[1;39m([0m[39mLambdaForm$MH[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cbc800.invoke_MT[0m[1;39m([0m[39mLambdaForm$MH[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 4fc18e0e0662428e[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of [0m [2m                [0m
[2;36m                    [0m         [39mmemory [0m[1;39m([0m[39muse [0m[32m'-Xmx1710m'[0m[39m to reproduce[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [39mCaused by: java.lang.OutOfMemoryError: Java heap space[0m                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.pfb.PfbParser.parsePfb[0m[1;39m([0m[39mPfbParser.jav[0m[1;92ma:166[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.fontbox.pfb.PfbParser.<init>[0m[1;39m([0m[39mPfbParser.jav[0m[1;92ma:116[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Font.createWithPFB[0m[1;39m([0m[39mType1Font.jav[0m[1;92ma:69[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.pdfbox.pdmodel.font.PDType1Font.<init[0m[1m>[0m[1m([0mPDType1Font.jav[1;92ma:227[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.pdmodel.font.PDFontFactory.createFont[0m[1m([0mPDFontFactory.jav[1;92ma:140[0m[1m)[0m     [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.pdfbox.pdmodel.PDResources.getFont[0m[1m([0mPDResources.jav[1;92ma:170[0m[1m)[0m      [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process[0m[1m([0mSetFontAndSize [2m                [0m
[2;36m                    [0m         .jav[1;92ma:72[0m[1m)[0m                                                                           [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processOperator[0m[1m([0mPDFStreamEngine.jav [2m                [0m
[2;36m                    [0m         [1;92ma:924[0m[1m)[0m                                                                              [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators[0m[1m([0mPDFStreamEng [2m                [0m
[2;36m                    [0m         ine.jav[1;92ma:557[0m[1m)[0m                                                                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStream[0m[1m([0mPDFStreamEngine.jav[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m515[0m[1m)[0m                                                                                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processPage[0m[1m([0mPDFStreamEngine.jav[1;92ma:15[0m [2m                [0m
[2;36m                    [0m         [1;92m8[0m[1m)[0m                                                                                  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.LegacyPDFStreamEngine.processPage[0m[1m([0mLegacyPDFStreamEngine.jav[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:153[0m[1m)[0m                                                                               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPage[0m[1m([0mPDFTextStripper.jav[1;92ma:378[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPages[0m[1m([0mPDFTextStripper.jav[1;92ma:303[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.writeText[0m[1m([0mPDFTextStripper.jav[1;92ma:251[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.pdfbox.text.PDFTextStripper.getText[0m[1m([0mPDFTextStripper.jav[1;92ma:218[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.PDFExtractTextFuzzer.fuzzerTestOneInput[0m[1m([0mPDFExtractTextFuzzer.jav[1;92ma:41[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/java.lang.invoke.LambdaForm$DMH/[1;35m0x0000000800cbc000.invokeStaticInit[0m[1m([0mLambd [2m                [0m
[2;36m                    [0m         aForm$DMH[1m)[0m                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/java.lang.invoke.LambdaForm$MH/[1;35m0x0000000800cbd000.invoke[0m[1m([0mLambdaForm$MH[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/java.lang.invoke.LambdaForm$MH/[1;35m0x0000000800cbc800.invoke_MT[0m[1m([0mLambdaForm$MH [2m                [0m
[2;36m                    [0m         [1m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: 4fc18e0e0662428e                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/05/26 21:03:47][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=166057;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=870740;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/05/26 21:08:24][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=718002;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=145545;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/05/26 21:09:07][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=465255;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=774173;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=300920;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=438788;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 21:09:08][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.98[0m seconds;                ]8;id=281278;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=892793;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Patching[1m)[0m Started[33m...[0m                              ]8;id=906794;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=568683;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp7rrvj7ol[0m                                                 ]8;id=512668;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=55590;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/05/26 21:10:05][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Patching[1m)[0m Took [1;36m56.31[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=275824;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=866413;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Checking build[1m)[0m Started[33m...[0m                        ]8;id=982055;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=809683;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 21:10:19][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Checking build[1m)[0m Took [1;36m14.77[0m seconds;              ]8;id=720975;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=180662;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running PoV[1m)[0m Started[33m...[0m                           ]8;id=529257;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=353451;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 21:10:26][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running PoV[1m)[0m Took [1;36m6.15[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=104728;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=635751;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Testing[1m)[0m Started[33m...[0m                               ]8;id=679430;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=922060;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=933875;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=640894;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=619333;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=807507;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 21:10:27][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.87[0m seconds;                ]8;id=548563;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=230898;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=687957;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=817162;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 21:10:28][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.92[0m seconds;                ]8;id=73920;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=121330;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/05/26 21:10:29][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=116558;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=320483;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.82[0m seconds;                ]8;id=76117;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=621443;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/05/26 21:10:30][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=126068;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=8546;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java                   [2m                [0m
[2;36m                    [0m         +++ b/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java                   [2m                [0m
[2;36m                    [0m         @@ [1;36m-158[0m,[1;36m6[0m +[1;36m158[0m,[1;36m25[0m @@                                                                [2m                [0m
[2;36m                    [0m                      size += [1;35min.read[0m[1m([0m[1m)[0m [1m<[0m[39m< [0m[1;36m16[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m             size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m24[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, size[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [39m+            [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+            [0m[35m/[0m[35m/[0m[39m Validate segment size is not negative[0m                               [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[39msize < [0m[1;36m0[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Invalid negative segment size: "[0m[39m + size[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+            [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+            [0m[35m/[0m[35m/[0m[39m Validate individual segment size doesn't exceed maximum[0m             [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[39msize > MAX_LENGTH[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Segment size "[0m[39m + size + [0m[32m" exceeds maximum "[0m [2m                [0m
[2;36m                    [0m         [39m+ MAX_LENGTH[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+            [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+            [0m[35m/[0m[35m/[0m[39m Validate segment size doesn't exceed available data in stream[0m       [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[39msize > [0m[1;35min.available[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Segment size "[0m[39m + size + [0m[32m" exceeds available[0m [2m                [0m
[2;36m                    [0m         [32mdata "[0m[39m + [0m[1;35min.available[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+            [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m             long newTotal = total + size;[0m                                          [2m                [0m
[2;36m                    [0m         [39m             if [0m[1;39m([0m[39mnewTotal > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [39m                 throw new [0m[1;35mIOException[0m[1;39m([0m[32m"record size would be too large: "[0m[39m + [0m        [2m                [0m
[2;36m                    [0m         [39mnewTotal[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of [0m [2m                [0m
[2;36m                    [0m         [39mmemory [0m[1;39m([0m[39muse [0m[32m'-Xmx1710m'[0m[39m to reproduce[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [39mCaused by: java.lang.OutOfMemoryError: Java heap space[0m                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.pfb.PfbParser.parsePfb[0m[1;39m([0m[39mPfbParser.jav[0m[1;92ma:166[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.fontbox.pfb.PfbParser.<init>[0m[1;39m([0m[39mPfbParser.jav[0m[1;92ma:116[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Font.createWithPFB[0m[1;39m([0m[39mType1Font.jav[0m[1;92ma:69[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.pdfbox.pdmodel.font.PDType1Font.<init>[0m[1;39m([0m[39mPDType1Font.jav[0m[1;92ma:227[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.pdmodel.font.PDFontFactory.createFont[0m[1;39m([0m[39mPDFontFactory.jav[0m[1;92ma:140[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.pdmodel.PDResources.getFont[0m[1;39m([0m[39mPDResources.jav[0m[1;92ma:170[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process[0m[1;39m([0m[39mSetFontAndSize[0m [2m                [0m
[2;36m                    [0m         [39m.jav[0m[1;92ma:72[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processOperator[0m[1;39m([0m[39mPDFStreamEngine.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:924[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators[0m[1;39m([0m[39mPDFStreamEng[0m [2m                [0m
[2;36m                    [0m         [39mine.jav[0m[1;92ma:557[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStream[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m515[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processPage[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:15[0m [2m                [0m
[2;36m                    [0m         [1;92m8[0m[1;39m)[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.LegacyPDFStreamEngine.processPage[0m[1;39m([0m[39mLegacyPDFStreamEngine.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:153[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPage[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:378[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPages[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:303[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.writeText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:251[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.text.PDFTextStripper.getText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:218[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.PDFExtractTextFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPDFExtractTextFuzzer.jav[0m[1;92ma:41[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$DMH/[0m[1;35m0x0000000800cbc000.invokeStaticInit[0m[1;39m([0m[39mLambd[0m [2m                [0m
[2;36m                    [0m         [39maForm$DMH[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cbd000.invoke[0m[1;39m([0m[39mLambdaForm$MH[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cbc800.invoke_MT[0m[1;39m([0m[39mLambdaForm$MH[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 4fc18e0e0662428e[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAn Out of Memory [0m[1;39m([0m[39mOOM[0m[1;39m)[0m[39m error occurs during fuzzing of PDF text extraction [0m          [2m                [0m
[2;36m                    [0m         [39mfunctionality. The issue manifests when processing a PDF document that contains a [0m  [2m                [0m
[2;36m                    [0m         [39mType1 font with PFB [0m[1;39m([0m[39mPrinter Font Binary[0m[1;39m)[0m[39m data. The Java heap space is exhausted [0m   [2m                [0m
[2;36m                    [0m         [39mduring the parsing of the PFB font file at `[0m[1;35mPfbParser.parsePfb[0m[1;39m([0m[1;39m)[0m[39m`, causing a [0m       [2m                [0m
[2;36m                    [0m         [39m`java.lang.OutOfMemoryError` that is caught and wrapped as a [0m                       [2m                [0m
[2;36m                    [0m         [39m`FuzzerSecurityIssueLow` exception.[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe issue represents a memory exhaustion vulnerability triggered during PDF [0m        [2m                [0m
[2;36m                    [0m         [39mprocessing operations. The stack trace indicates the following execution flow:[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The fuzzer initiates PDF text extraction through `[0m[1;35mPDFTextStripper.getText[0m[1;39m([0m[1;39m)[0m[39m`[0m     [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. During page processing, a font operation [0m[1;39m([0m[39m`SetFontAndSize`[0m[1;39m)[0m[39m is encountered in [0m   [2m                [0m
[2;36m                    [0m         [39mthe PDF content stream[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. The system attempts to load a Type1 font from the PDF resources[0m                  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. A PFB [0m[1;39m([0m[39mPrinter Font Binary[0m[1;39m)[0m[39m parser is instantiated to parse the font data[0m        [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Memory exhaustion occurs at `[0m[1;35mPfbParser.parsePfb[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m166[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Vulnerability Type**: This is classified as a Denial of Service [0m[1;39m([0m[39mDoS[0m[1;39m)[0m[39m [0m            [2m                [0m
[2;36m                    [0m         [39mvulnerability through resource exhaustion. The fuzzer categorizes it as a [0m[32m"Low"[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39msecurity issue, suggesting it can cause availability problems but may not lead to [0m  [2m                [0m
[2;36m                    [0m         [39mdata corruption or unauthorized access.[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Important Observations**:[0m                                                         [2m                [0m
[2;36m                    [0m         [39m- The OOM error occurs specifically during PFB font parsing, indicating that the [0m   [2m                [0m
[2;36m                    [0m         [39mparser attempts to allocate memory based on data from the input PDF[0m                 [2m                [0m
[2;36m                    [0m         [39m- The error can be reproduced with a heap size of 1710MB [0m[1;39m([0m[39m`-Xmx1710m`[0m[1;39m)[0m[39m, suggesting [0m [2m                [0m
[2;36m                    [0m         [39mthat the problematic input causes allocation of a very large memory chunk[0m           [2m                [0m
[2;36m                    [0m         [39m- The issue is triggered by fuzzer-generated input, indicating that specially [0m      [2m                [0m
[2;36m                    [0m         [39mcrafted PDF files with malformed or malicious font data can cause this condition[0m    [2m                [0m
[2;36m                    [0m         [39m- The failure point is at line [0m[1;36m166[0m[39m of `PfbParser.java`, which is likely where a [0m    [2m                [0m
[2;36m                    [0m         [39mlarge buffer allocation or array creation occurs[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Areas for Investigation**:[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo understand the complete scope of this issue, the following components should be [0m [2m                [0m
[2;36m                    [0m         [39mexamined:[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **PfbParser.java [0m[1;39m([0m[39mline [0m[1;36m166[0m[1;39m)[0m[39m**: The specific allocation or operation that causes [0m [2m                [0m
[2;36m                    [0m         [39mthe memory exhaustion[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **PfbParser constructor and [0m[1;35mparsePfb[0m[1;39m([0m[1;39m)[0m[39m method**: How font data size is [0m          [2m                [0m
[2;36m                    [0m         [39mdetermined and validated before allocation[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **[0m[1;35mType1Font.createWithPFB[0m[1;39m([0m[1;39m)[0m[39m**: How PFB data is extracted from the PDF and passed[0m [2m                [0m
[2;36m                    [0m         [39mto the parser[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **[0m[1;35mPDFontFactory.createFont[0m[1;39m([0m[1;39m)[0m[39m**: The font creation workflow and any validation [0m   [2m                [0m
[2;36m                    [0m         [39mthat occurs before instantiating Type1 fonts[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Input validation mechanisms**: Whether there are size limits or sanity checks [0m [2m                [0m
[2;36m                    [0m         [39mon font data before parsing[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **The fuzzer input that triggered this issue**: Analysis of the malformed PDF [0m   [2m                [0m
[2;36m                    [0m         [39mstructure that causes excessive memory allocation[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe investigation should focus on whether the PFB parser trusts size fields from [0m   [2m                [0m
[2;36m                    [0m         [39mthe input data without validation, potentially allowing an attacker to specify [0m     [2m                [0m
[2;36m                    [0m         [39marbitrarily large allocation sizes through crafted PDF font data.[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of [0m [2m                [0m
[2;36m                    [0m         [39mmemory [0m[1;39m([0m[39muse [0m[32m'-Xmx1710m'[0m[39m to reproduce[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [39mCaused by: java.lang.OutOfMemoryError: Java heap space[0m                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.pfb.PfbParser.parsePfb[0m[1;39m([0m[39mPfbParser.jav[0m[1;92ma:166[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.fontbox.pfb.PfbParser.<init>[0m[1;39m([0m[39mPfbParser.jav[0m[1;92ma:116[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Font.createWithPFB[0m[1;39m([0m[39mType1Font.jav[0m[1;92ma:69[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.pdfbox.pdmodel.font.PDType1Font.<init>[0m[1;39m([0m[39mPDType1Font.jav[0m[1;92ma:227[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.pdmodel.font.PDFontFactory.createFont[0m[1;39m([0m[39mPDFontFactory.jav[0m[1;92ma:140[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.pdmodel.PDResources.getFont[0m[1;39m([0m[39mPDResources.jav[0m[1;92ma:170[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process[0m[1;39m([0m[39mSetFontAndSize[0m [2m                [0m
[2;36m                    [0m         [39m.jav[0m[1;92ma:72[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processOperator[0m[1;39m([0m[39mPDFStreamEngine.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:924[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators[0m[1;39m([0m[39mPDFStreamEng[0m [2m                [0m
[2;36m                    [0m         [39mine.jav[0m[1;92ma:557[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStream[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m515[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processPage[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:15[0m [2m                [0m
[2;36m                    [0m         [1;92m8[0m[1;39m)[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.LegacyPDFStreamEngine.processPage[0m[1;39m([0m[39mLegacyPDFStreamEngine.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:153[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPage[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:378[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPages[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:303[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.writeText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:251[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.text.PDFTextStripper.getText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:218[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.PDFExtractTextFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPDFExtractTextFuzzer.jav[0m[1;92ma:41[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$DMH/[0m[1;35m0x0000000800cbc000.invokeStaticInit[0m[1;39m([0m[39mLambd[0m [2m                [0m
[2;36m                    [0m         [39maForm$DMH[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cbd000.invoke[0m[1;39m([0m[39mLambdaForm$MH[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cbc800.invoke_MT[0m[1;39m([0m[39mLambdaForm$MH[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 4fc18e0e0662428e[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:1[0m[39m-[0m[1;36m30[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.fontbox.pfb;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.ByteArrayInputStream;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.EOFException;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.logging.log4j.LogManager;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:37[0m[39m-[0m[1;36m72[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:public class PfbParser [0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    private static final Logger LOG = [0m[1;35mLogManager.getLogger[0m[1;39m([0m[39mPfbParser.class[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * the pfb header length.[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     * [0m[1;39m([0m[39mstart-marker [0m[1;39m([0m[1;36m1[0m[39m byte[0m[1;39m)[0m[39m, ascii-[0m[35m/[0m[95mbinary-marker[0m[39m [0m[1;39m([0m[1;36m1[0m[39m byte[0m[1;39m)[0m[39m, size [0m[1;39m([0m[1;36m4[0m[39m byte[0m[1;39m)[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * [0m[1;36m3[0m[39m*[0m[1;36m6[0m[39m == [0m[1;36m18[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    private static final int PFB_[0m[1;33mHEAD[0m[39mER_LENGTH = [0m[1;36m18[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * the start marker.[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    private static final int START_MARKER = [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * the ascii marker.[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    private static final int ASCII_MARKER = [0m[1;36m0x01[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     * the binary marker.[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    private static final int BINARY_MARKER = [0m[1;36m0x02[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     * the EOF marker.[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    private static final int EOF_MARKER = [0m[1;36m0x03[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * Heuristically chosen max length to buffer a Type1 font[0m                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    private static final long MAX_LENGTH = 100_000_000;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:98[0m[39m-[0m[1;36m117[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     * Create a new object.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:     * @param in   The input.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:     * @throws IOException if an IO-error occurs.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    public [0m[1;35mPfbParser[0m[1;39m([0m[39mfinal InputStream in[0m[1;39m)[0m[39m throws IOException [0m                  [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m pfb = [0m[1;35min.readAllBytes[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        [0m[1;35mparsePfb[0m[1;39m([0m[39mpfb[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:     * Create a new object.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:     * @param bytes   The input.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:     * @throws IOException if an IO-error occurs.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    public [0m[1;35mPfbParser[0m[1;39m([0m[39mfinal byte[0m[1;39m[[0m[1;39m][0m[39m bytes[0m[1;39m)[0m[39m throws IOException[0m                     [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        [0m[1;35mparsePfb[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:119[0m[39m-[0m[1;36m177[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:     * Parse the pfb-array.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:     * @param pfb   The pfb-Array[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:     * @throws IOException in an IO-error occurs.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    private void [0m[1;35mparsePfb[0m[1;39m([0m[39mfinal byte[0m[1;39m[[0m[1;39m][0m[39m pfb[0m[1;39m)[0m[39m throws IOException [0m                 [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        if [0m[1;39m([0m[39mpfb.length < PFB_[0m[1;33mHEAD[0m[39mER_LENGTH[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"PFB header missing"[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        [0m[35m/[0m[35m/[0m[39m read into segments and keep them[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        List<Integer> typeList = new ArrayList<>[0m[1;39m([0m[1;36m3[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        List<byte[0m[1;39m[[0m[1;39m][0m[39m> barrList = new ArrayList<>[0m[1;39m([0m[1;36m3[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        ByteArrayInputStream in = new [0m[1;35mByteArrayInputStream[0m[1;39m([0m[39mpfb[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        int total = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        do[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            int r = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            if [0m[1;39m([0m[39mr == [0m[1;36m-1[0m[39m && total > [0m[1;36m0[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:                break; [0m[35m/[0m[35m/[0m[39m EOF[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:            if [0m[1;39m([0m[39mr != START_MARKER[0m[1;39m)[0m[39m [0m                                             [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Start marker missing"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:            int recordType = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:            if [0m[1;39m([0m[39mrecordType == EOF_MARKER[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:            if [0m[1;39m([0m[39mrecordType != ASCII_MARKER && recordType != BINARY_MARKER[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Incorrect record type: "[0m[39m + recordType[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            int size = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m8[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m16[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m24[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, size[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            long newTotal = total + size;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            if [0m[1;39m([0m[39mnewTotal > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"record size would be too large: "[0m[39m + [0m     [2m                [0m
[2;36m                    [0m         [39mnewTotal[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m ar = new byte[0m[1;39m[[0m[39msize[0m[1;39m][0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:            int got = [0m[1;35min.read[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:            if [0m[1;39m([0m[39mgot != size[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                throw new [0m[1;35mEOFException[0m[1;39m([0m[32m"EOF while reading PFB font"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            total += size;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            [0m[1;35mtypeList.add[0m[1;39m([0m[39mrecordType[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:            [0m[1;35mbarrList.add[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:        while [0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:178[0m[39m-[0m[1;36m222[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:        [0m[35m/[0m[35m/[0m[39m We now have ASCII and binary segments. Lets arrange these so that [0m   [2m                [0m
[2;36m                    [0m         [39mthe ASCII segments[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:        [0m[35m/[0m[35m/[0m[39m come first, then the binary segments, then the last ASCII segment if[0m [2m                [0m
[2;36m                    [0m         [39mit is[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:        [0m[35m/[0m[35m/[0m[39m [0m[1;36m0000[0m[33m...[0m[39m cleartomark[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:        pfbdata = new byte[0m[1;39m[[0m[39mtotal[0m[1;39m][0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m cleartomarkSegment = null;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:        int dstPos = [0m[1;36m0[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:        [0m[35m/[0m[35m/[0m[39m copy the ASCII segments[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < [0m[1;35mtypeList.size[0m[1;39m([0m[1;39m)[0m[39m; ++i[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:            if [0m[1;39m([0m[1;35mtypeList.get[0m[1;39m([0m[39mi[0m[1;39m)[0m[39m != ASCII_MARKER[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:                continue;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m ar = [0m[1;35mbarrList.get[0m[1;39m([0m[39mi[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:            if [0m[1;39m([0m[39mi == [0m[1;35mtypeList.size[0m[1;39m([0m[1;39m)[0m[39m - [0m[1;36m1[0m[39m && ar.length < [0m[1;36m600[0m[39m && new [0m             [2m                [0m
[2;36m                    [0m         [1;35mString[0m[1;39m([0m[39mar[0m[1;39m)[0m[1;35m.contains[0m[1;39m([0m[32m"cleartomark"[0m[1;39m)[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:                cleartomarkSegment = ar;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:                continue;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mar, [0m[1;36m0[0m[39m, pfbdata, dstPos, ar.length[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:            dstPos += ar.length;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:        lengths[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = dstPos;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:        [0m[35m/[0m[35m/[0m[39m copy the binary segments[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < [0m[1;35mtypeList.size[0m[1;39m([0m[1;39m)[0m[39m; ++i[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:            if [0m[1;39m([0m[1;35mtypeList.get[0m[1;39m([0m[39mi[0m[1;39m)[0m[39m != BINARY_MARKER[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:                continue;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m ar = [0m[1;35mbarrList.get[0m[1;39m([0m[39mi[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mar, [0m[1;36m0[0m[39m, pfbdata, dstPos, ar.length[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:            dstPos += ar.length;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:        lengths[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = dstPos - lengths[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:        if [0m[1;39m([0m[39mcleartomarkSegment != null[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:            [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mcleartomarkSegment, [0m[1;36m0[0m[39m, pfbdata, dstPos, [0m           [2m                [0m
[2;36m                    [0m         [39mcleartomarkSegment.length[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:            lengths[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = cleartomarkSegment.length;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Font.jav[0m[1;92ma:20[0m[39m-[0m[1;36m35[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.awt.geom.GeneralPath;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.LinkedHashMap;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.concurrent.ConcurrentHashMap;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.fontbox.FontBoxFont;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.fontbox.EncodedFont;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.fontbox.cff.Type1CharString;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.fontbox.cff.Type1CharStringParser;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.fontbox.encoding.Encoding;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.fontbox.pfb.PfbParser;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.fontbox.util.BoundingBox;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Font.jav[0m[1;92ma:52[0m[39m-[0m[1;36m72[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    public static Type1Font [0m[1;35mcreateWithPFB[0m[1;39m([0m[39mInputStream pfbStream[0m[1;39m)[0m[39m throws [0m         [2m                [0m
[2;36m                    [0m         [39mIOException[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        PfbParser pfb = new [0m[1;35mPfbParser[0m[1;39m([0m[39mpfbStream[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        Type1Parser parser = new [0m[1;35mType1Parser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        return [0m[1;35mparser.parse[0m[1;39m([0m[1;35mpfb.getSegment1[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mpfb.getSegment2[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     * Constructs a new Type1Font object from a .pfb stream.[0m                     [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * @param pfbBytes .pfb data, including headers[0m                              [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     * @return a type1 font[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * @throws IOException if something went wrong[0m                               [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    public static Type1Font [0m[1;35mcreateWithPFB[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m pfbBytes[0m[1;39m)[0m[39m throws IOException[0m    [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        PfbParser pfb = new [0m[1;35mPfbParser[0m[1;39m([0m[39mpfbBytes[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        Type1Parser parser = new [0m[1;35mType1Parser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        return [0m[1;35mparser.parse[0m[1;39m([0m[1;35mpfb.getSegment1[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mpfb.getSegment2[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDType1Font.jav[0m[1;92ma:183[0m[39m-[0m[1;36m282[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:     * Creates a Type [0m[1;36m1[0m[39m font from a Font dictionary in a PDF.[0m                   [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:     * [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:     * @param fontDictionary font dictionary.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:     * @throws IOException if there was an error initializing the font.[0m         [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:     * @throws IllegalArgumentException if [0m[35m/[0m[95mFontFile3[0m[39m was used.[0m                 [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:    public [0m[1;35mPDType1Font[0m[1;39m([0m[39mCOSDictionary fontDictionary[0m[1;39m)[0m[39m throws IOException[0m         [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[39mfontDictionary[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:        PDFontDescriptor fd = [0m[1;35mgetFontDescriptor[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:        Type1Font t1 = null;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:        boolean fontIsDamaged = false;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:        if [0m[1;39m([0m[39mfd != null[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:            [0m[35m/[0m[35m/[0m[39m a Type1 font may contain a Type1C font[0m                           [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            PDStream fontFile3 = [0m[1;35mfd.getFontFile3[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:            if [0m[1;39m([0m[39mfontFile3 != null[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"/FontFile3 for Type1 font not supported"[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:            [0m[35m/[0m[35m/[0m[39m or it may contain a PFB[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:            PDStream fontFile = [0m[1;35mfd.getFontFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:            if [0m[1;39m([0m[39mfontFile != null[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:                try[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:                    COSStream stream = [0m[1;35mfontFile.getCOSObject[0m[1;39m([0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:                    int length1 = [0m[1;35mstream.getInt[0m[1;39m([0m[39mCOSName.LENGTH1[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:                    int length2 = [0m[1;35mstream.getInt[0m[1;39m([0m[39mCOSName.LENGTH2[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:                    [0m[35m/[0m[35m/[0m[39m repair Length1 and Length2 if necessary[0m                  [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                    byte[0m[1;39m[[0m[1;39m][0m[39m bytes = [0m[1;35mfontFile.toByteArray[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:                    if [0m[1;39m([0m[39mbytes.length == [0m[1;36m0[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:                        throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Font data unavailable"[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:                    length1 = [0m[1;35mrepairLength1[0m[1;39m([0m[39mbytes, length1[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                    length2 = [0m[1;35mrepairLength2[0m[1;39m([0m[39mbytes, length1, length2[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:                    if [0m[1;39m([0m[1;39m([0m[39mbytes[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m & [0m[1;36m0xff[0m[1;39m)[0m[39m == PFB_START_MARKER[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:                        [0m[35m/[0m[35m/[0m[39m some bad files embed the entire PFB, see PDFBOX-[0m[1;36m2607[0m [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                        t1 = [0m[1;35mType1Font.createWithPFB[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                    else[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                        [0m[35m/[0m[35m/[0m[39m the PFB embedded as two segments back-to-back[0m        [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                        if [0m[1;39m([0m[39mlength1 < [0m[1;36m0[0m[39m || length1 > length1 + length2[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:                            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Invalid length data, actual [0m [2m                [0m
[2;36m                    [0m         [32mlength: "[0m[39m +[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:                                    bytes.length + [0m[32m", /Length1: "[0m[39m + length1 + [0m  [2m                [0m
[2;36m                    [0m         [32m", /Length2: "[0m[39m + length2[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:                        byte[0m[1;39m[[0m[1;39m][0m[39m segment1 = [0m[1;35mArrays.copyOfRange[0m[1;39m([0m[39mbytes, [0m[1;36m0[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [39mlength1[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:                        byte[0m[1;39m[[0m[1;39m][0m[39m segment2 = [0m[1;35mArrays.copyOfRange[0m[1;39m([0m[39mbytes, length1, [0m   [2m                [0m
[2;36m                    [0m         [39mlength1 + length2[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:                        [0m[35m/[0m[35m/[0m[39m empty streams are simply ignored[0m                     [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:                        if [0m[1;39m([0m[39mlength1 > [0m[1;36m0[0m[39m && length2 > [0m[1;36m0[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:                            t1 = [0m[1;35mType1Font.createWithSegments[0m[1;39m([0m[39msegment1, [0m        [2m                [0m
[2;36m                    [0m         [39msegment2[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:                catch [0m[1;39m([0m[39mDamagedFontException e[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:                    [0m[1;35mLOG.warn[0m[1;39m([0m[1;39m([0m[1;39m)[0m[39m -> [0m[32m"Can't read damaged embedded Type1 font "[0m[39m + [0m [2m                [0m
[2;36m                    [0m         [1;35mfd.getFontName[0m[1;39m([0m[1;39m)[0m[39m, e[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:                    fontIsDamaged = true;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:                catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:                    [0m[1;35mLOG.error[0m[1;39m([0m[1;39m([0m[1;39m)[0m[39m -> [0m[32m"Can't read the embedded Type1 font "[0m[39m + [0m    [2m                [0m
[2;36m                    [0m         [1;35mfd.getFontName[0m[1;39m([0m[1;39m)[0m[39m, e[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:                    fontIsDamaged = true;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:        isEmbedded = t1 != null;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:        isDamaged = fontIsDamaged;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:        type1font = t1;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:        [0m[35m/[0m[35m/[0m[39m find a generic font to use for rendering, could be a .pfb, but might[0m [2m                [0m
[2;36m                    [0m         [39mbe a .ttf[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:        if [0m[1;39m([0m[39mtype1font != null[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:            genericFont = type1font;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:        else[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:            FontMapping<FontBoxFont> mapping = [0m[1;35mFontMappers.instance[0m[1;39m([0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:                                                          [0m                      [2m                [0m
[2;36m                    [0m         [1;35m.getFontBoxFont[0m[1;39m([0m[1;35mgetBaseFont[0m[1;39m([0m[1;39m)[0m[39m, fd[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:            genericFont = [0m[1;35mmapping.getFont[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:            if [0m[1;39m([0m[1;35mmapping.isFallback[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Using fallback font [0m[32m{[0m[32m}[0m[32m for [0m[32m{[0m[32m}[0m[32m"[0m[39m, [0m                      [2m                [0m
[2;36m                    [0m         [1;35mgenericFont.getName[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mgetBaseFont[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:        [0m[1;35mreadEncoding[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:        fontMatrixTransform = [0m[1;35mgetFontMatrix[0m[1;39m([0m[1;39m)[0m[1;35m.createAffineTransform[0m[1;39m([0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:        [0m[1;35mfontMatrixTransform.scale[0m[1;39m([0m[1;36m1000[0m[39m, [0m[1;36m1000[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDType1Font.jav[0m[1;92ma:284[0m[39m-[0m[1;36m364[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:     * Some Type [0m[1;36m1[0m[39m fonts have an invalid Length1, which causes the binary [0m      [2m                [0m
[2;36m                    [0m         [39msegment of the font[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:     * to be truncated, see PDFBOX-[0m[1;36m2350[0m[39m, PDFBOX-[0m[1;36m3677[0m[39m.[0m                           [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:     * @param bytes Type [0m[1;36m1[0m[39m stream bytes[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:     * @param length1 Length1 from the Type [0m[1;36m1[0m[39m stream[0m                            [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:     * @return repaired Length1 value[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:    private int [0m[1;35mrepairLength1[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m bytes, int length1[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:        [0m[35m/[0m[35m/[0m[39m scan backwards from the end of the first segment to find [0m[32m'exec'[0m      [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:        int offset = [0m[1;35mMath.max[0m[1;39m([0m[1;36m0[0m[39m, length1 - [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        if [0m[1;39m([0m[39moffset <= [0m[1;36m0[0m[39m || offset > bytes.length - [0m[1;36m4[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:            offset = bytes.length - [0m[1;36m4[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:        offset = [0m[1;35mfindBinaryOffsetAfterExec[0m[1;39m([0m[39mbytes, offset[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:        if [0m[1;39m([0m[39moffset == [0m[1;36m0[0m[39m && length1 > [0m[1;36m0[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:            [0m[35m/[0m[35m/[0m[39m 2nd try with brute force[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:            offset = [0m[1;35mfindBinaryOffsetAfterExec[0m[1;39m([0m[39mbytes, bytes.length - [0m[1;36m4[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:        if [0m[1;39m([0m[39mlength1 - offset != [0m[1;36m0[0m[39m && offset > [0m[1;36m0[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:            if [0m[1;39m([0m[1;35mLOG.isWarnEnabled[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Ignored invalid Length1 [0m[32m{[0m[32m}[0m[32m for Type 1 font [0m[32m{[0m[32m}[0m[32m"[0m[39m, [0m      [2m                [0m
[2;36m                    [0m         [39mlength1, [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:            return offset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:        return length1;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:    private static int [0m[1;35mfindBinaryOffsetAfterExec[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m bytes, int startOffset[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;36m321[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m322[0m[39m:        int offset = startOffset;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m323[0m[39m:        while [0m[1;39m([0m[39moffset > [0m[1;36m0[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m324[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m325[0m[39m:            if [0m[1;39m([0m[39mbytes[0m[1;39m[[0m[39moffset + [0m[1;36m0[0m[1;39m][0m[39m == [0m[32m'e'[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m326[0m[39m:                    && bytes[0m[1;39m[[0m[39moffset + [0m[1;36m1[0m[1;39m][0m[39m == [0m[32m'x'[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m327[0m[39m:                    && bytes[0m[1;39m[[0m[39moffset + [0m[1;36m2[0m[1;39m][0m[39m == [0m[32m'e'[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m328[0m[39m:                    && bytes[0m[1;39m[[0m[39moffset + [0m[1;36m3[0m[1;39m][0m[39m == [0m[32m'c'[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m329[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m330[0m[39m:                offset += [0m[1;36m4[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m331[0m[39m:                [0m[35m/[0m[35m/[0m[39m skip additional CR LF space characters[0m                       [2m                [0m
[2;36m                    [0m         [1;36m332[0m[39m:                while [0m[1;39m([0m[39moffset < bytes.length && [0m                                [2m                [0m
[2;36m                    [0m         [1;36m333[0m[39m:                        [0m[1;39m([0m[39mbytes[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m == [0m[32m'\r'[0m[39m || bytes[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m == [0m[32m'\n'[0m[39m || [0m     [2m                [0m
[2;36m                    [0m         [1;36m334[0m[39m:                         bytes[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m == [0m[32m' '[0m[39m || bytes[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m == [0m[32m'\t'[0m[1;39m)[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m335[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m336[0m[39m:                    offset++;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m337[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m338[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m339[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m340[0m[39m:            offset--;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m341[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m342[0m[39m:        return offset;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m343[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m344[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m345[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m346[0m[39m:     * Some Type [0m[1;36m1[0m[39m fonts have an invalid Length2, see PDFBOX-[0m[1;36m3475[0m[39m. A negative [0m  [2m                [0m
[2;36m                    [0m         [35m/[0m[95mLength2[0m[39m brings an[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m347[0m[39m:     * IllegalArgumentException in [0m[1;35mArrays.copyOfRange[0m[1;39m([0m[1;39m)[0m[39m, a huge value eats up [0m  [2m                [0m
[2;36m                    [0m         [39mmemory because of[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m348[0m[39m:     * padding.[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m349[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:     * @param bytes Type [0m[1;36m1[0m[39m stream bytes[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m351[0m[39m:     * @param length1 Length1 from the Type [0m[1;36m1[0m[39m stream[0m                            [2m                [0m
[2;36m                    [0m         [1;36m352[0m[39m:     * @param length2 Length2 from the Type [0m[1;36m1[0m[39m stream[0m                            [2m                [0m
[2;36m                    [0m         [1;36m353[0m[39m:     * @return repaired Length2 value[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:    private int [0m[1;35mrepairLength2[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m bytes, int length1, int length2[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:        [0m[35m/[0m[35m/[0m[39m repair Length2 if necessary[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:        if [0m[1;39m([0m[39mlength2 < [0m[1;36m0[0m[39m || length2 > bytes.length - length1[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Ignored invalid Length2 [0m[32m{[0m[32m}[0m[32m for Type 1 font [0m[32m{[0m[32m}[0m[32m"[0m[39m, length2, [0m [2m                [0m
[2;36m                    [0m         [1;35mgetName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:            return bytes.length - length1;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:        return length2;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDFontFactory.jav[0m[1;92ma:1[0m[39m-[0m[1;36m50[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.pdfbox.pdmodel.font;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.pdfbox.cos.COSArray;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.pdfbox.cos.COSBase;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.pdfbox.cos.COSDictionary;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.pdfbox.cos.COSName;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.pdfbox.cos.COSStream;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.pdfbox.io.RandomAccessRead;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.logging.log4j.LogManager;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.pdfbox.pdmodel.ResourceCache;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m: * Creates the appropriate font subtype based on information in the dictionary.[0m  [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m: * @author Ben Litchfield[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:public final class PDFontFactory[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    private static final Logger LOG = [0m[1;35mLogManager.getLogger[0m[1;39m([0m[39mPDFontFactory.class[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    private static final String FONT_TYPE1C = [0m[32m"Type1C"[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    private static final String FONT_OPEN_TYPE = [0m[32m"OTTO"[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    private static final String FONT_TTF_COLLECTION = [0m[32m"ttcf"[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    private static final String FONT_TRUE_TYPE = [0m[32m"true"[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    private static final byte[0m[1;39m[[0m[1;39m][0m[39m TTF_[0m[1;33mHEAD[0m[39mER = new byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;39m{[0m[39m [0m[1;36m0[0m[39m, [0m[1;36m1[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0[0m[39m [0m[1;39m}[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    private [0m[1;35mPDFontFactory[0m[1;39m([0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDFontFactory.jav[0m[1;92ma:124[0m[39m-[0m[1;36m190[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    public static PDFont [0m[1;35mcreateFont[0m[1;39m([0m[39mCOSDictionary dictionary, ResourceCache [0m    [2m                [0m
[2;36m                    [0m         [39mresourceCache[0m[1;39m)[0m[39m throws IOException[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        COSName type = [0m[1;35mdictionary.getCOSName[0m[1;39m([0m[39mCOSName.TYPE, COSName.FONT[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35mCOSName.FONT.equals[0m[1;39m([0m[39mtype[0m[1;39m)[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            [0m[1;35mLOG.error[0m[1;39m([0m[32m"Expected 'Font' dictionary but found '[0m[32m{[0m[32m}[0m[32m'"[0m[39m, [0m             [2m                [0m
[2;36m                    [0m         [1;35mtype.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        COSName subType = [0m[1;35mdictionary.getCOSName[0m[1;39m([0m[39mCOSName.SUBTYPE[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        if [0m[1;39m([0m[1;35mCOSName.TYPE1.equals[0m[1;39m([0m[39msubType[0m[1;39m)[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:            COSDictionary fd = [0m[1;35mdictionary.getCOSDictionary[0m[1;39m([0m[39mCOSName.FONT_DESC[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            if [0m[1;39m([0m[39mfd != null && [0m[1;35mfd.containsKey[0m[1;39m([0m[39mCOSName.FONT_FILE3[0m[1;39m)[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:                return new [0m[1;35mPDType1CFont[0m[1;39m([0m[39mdictionary[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:            return new [0m[1;35mPDType1Font[0m[1;39m([0m[39mdictionary[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:        else if [0m[1;39m([0m[1;35mCOSName.MM_TYPE1.equals[0m[1;39m([0m[39msubType[0m[1;39m)[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:            COSDictionary fd = [0m[1;35mdictionary.getCOSDictionary[0m[1;39m([0m[39mCOSName.FONT_DESC[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:            if [0m[1;39m([0m[39mfd != null && [0m[1;35mfd.containsKey[0m[1;39m([0m[39mCOSName.FONT_FILE3[0m[1;39m)[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:                return new [0m[1;35mPDType1CFont[0m[1;39m([0m[39mdictionary[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            return new [0m[1;35mPDMMType1Font[0m[1;39m([0m[39mdictionary[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:        else if [0m[1;39m([0m[1;35mCOSName.TRUE_TYPE.equals[0m[1;39m([0m[39msubType[0m[1;39m)[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:            return new [0m[1;35mPDTrueTypeFont[0m[1;39m([0m[39mdictionary[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:        else if [0m[1;39m([0m[1;35mCOSName.TYPE3.equals[0m[1;39m([0m[39msubType[0m[1;39m)[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            return new [0m[1;35mPDType3Font[0m[1;39m([0m[39mdictionary, resourceCache[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:        else if [0m[1;39m([0m[1;35mCOSName.TYPE0.equals[0m[1;39m([0m[39msubType[0m[1;39m)[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            COSDictionary fontDescriptor = [0m[1;35mgetFontDescriptor[0m[1;39m([0m[39mdictionary[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            FontType fontTypeFromFont = [0m[1;35mgetFontTypeFromFont[0m[1;39m([0m[39mfontDescriptor, [0m    [2m                [0m
[2;36m                    [0m         [39msubType[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:            if [0m[1;39m([0m[39mfontTypeFromFont != null[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:                COSDictionary descendantFont = [0m[1;35mgetDescendantFont[0m[1;39m([0m[39mdictionary[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:                COSName descFontType = descendantFont != null[0m                   [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:                        ? [0m[1;35mdescendantFont.getCOSName[0m[1;39m([0m[39mCOSName.SUBTYPE[0m[1;39m)[0m[39m : null;[0m    [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:                if [0m[1;39m([0m[39mdescFontType != null && [0m                                    [2m                [0m
[2;36m                    [0m         [39m![0m[1;35mfontTypeFromFont.isCIDSubtype[0m[1;39m([0m[39mdescFontType[0m[1;39m)[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                    [0m[1;35mfixType0Subtype[0m[1;39m([0m[39mdescendantFont, fontDescriptor, [0m            [2m                [0m
[2;36m                    [0m         [1;35mfontTypeFromFont.getSubtype[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            return new [0m[1;35mPDType0Font[0m[1;39m([0m[39mdictionary[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:        else if [0m[1;39m([0m[1;35mCOSName.CID_FONT_TYPE0.equals[0m[1;39m([0m[39msubType[0m[1;39m)[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Type 0 descendant font not allowed"[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:        else if [0m[1;39m([0m[1;35mCOSName.CID_FONT_TYPE2.equals[0m[1;39m([0m[39msubType[0m[1;39m)[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Type 2 descendant font not allowed"[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:        else[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:            [0m[35m/[0m[35m/[0m[39m assuming Type [0m[1;36m1[0m[39m font [0m[1;39m([0m[39msee PDFBOX-[0m[1;36m1988[0m[1;39m)[0m[39m because it seems that [0m    [2m                [0m
[2;36m                    [0m         [39mAdobe Reader does this[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:            [0m[35m/[0m[35m/[0m[39m however, we may need more sophisticated logic perhaps looking at[0m [2m                [0m
[2;36m                    [0m         [39mthe FontFile[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Invalid font subtype '[0m[32m{[0m[32m}[0m[32m'"[0m[39m, subType[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:            return new [0m[1;35mPDType1Font[0m[1;39m([0m[39mdictionary[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.jav[0m[1;92ma:60[0m[39m-[0m[1;36m66[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    private static final long OBJECT_NUMBER_THRESHOLD = 10000000000L;[0m            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    private static final long GENERATION_NUMBER_THRESHOLD = [0m[1;36m65535[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    private static final int MAX_LENGTH_LONG = [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mLong.toString[0m[1;39m([0m[39mLong.MAX_VALUE[0m[1;39m)[0m[1;35m.length[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.jav[0m[1;92ma:1445[0m[39m-[0m[1;36m1455[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1445[0m[39m:        int lastByte;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1446[0m[39m:        StringBuilder buffer = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1447[0m[39m:        while [0m[1;39m([0m[1;35misDigit[0m[1;39m([0m[39mlastByte = [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1448[0m[39m:        [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1449[0m[39m:            [0m[1;35mbuffer.append[0m[1;39m([0m[39m [0m[1;39m([0m[39mchar[0m[1;39m)[0m[39mlastByte [0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1450[0m[39m:            if [0m[1;39m([0m[1;35mbuffer.length[0m[1;39m([0m[1;39m)[0m[39m > MAX_LENGTH_LONG[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1451[0m[39m:            [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1452[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Number '"[0m[39m + buffer + [0m                   [2m                [0m
[2;36m                    [0m         [1;36m1453[0m[39m:                        [0m[32m"' is getting too long, stop reading at offset "[0m[39m + [0m    [2m                [0m
[2;36m                    [0m         [1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1454[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1455[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/common/PDStream.jav[0m[1;92ma:19[0m[39m-[0m[1;36m43[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.logging.log4j.LogManager;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.pdfbox.cos.COSArray;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.pdfbox.cos.COSBase;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.pdfbox.cos.COSDictionary;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.pdfbox.cos.COSDocument;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.pdfbox.cos.COSInputStream;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.pdfbox.cos.COSName;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.pdfbox.cos.COSNull;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.pdfbox.cos.COSStream;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.pdfbox.filter.DecodeOptions;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.pdfbox.filter.Filter;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.pdfbox.filter.FilterFactory;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.pdfbox.io.RandomAccessInputStream;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.pdfbox.io.RandomAccessRead;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.pdfbox.pdmodel.PDDocument;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.pdfbox.pdmodel.common.filespecification.PDFileSpecification;[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/common/PDStream.jav[0m[1;92ma:400[0m[39m-[0m[1;36m406[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:    public byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mtoByteArray[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                              [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:        try [0m[1;39m([0m[39mInputStream is = [0m[1;35mcreateInputStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:            return [0m[1;35mis.readAllBytes[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mio/src/main/java/org/apache/pdfbox/io/RandomAccessReadMemoryMappedFile.jav[0m[1;92ma:26[0m[39m-[0m[1;36m92[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.Optional;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.function.Consumer;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m: * An implementation of the RandomAccess interface backed by a memory mapped [0m    [2m                [0m
[2;36m                    [0m         [39mfile channel. The whole file is mapped to[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m: * memory and the max size is limited to Integer.MAX_VALUE.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:public class RandomAccessReadMemoryMappedFile implements RandomAccessRead[0m        [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[35m/[0m[35m/[0m[39m mapped byte buffer[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    private ByteBuffer mappedByteBuffer;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    [0m[35m/[0m[35m/[0m[39m size of the whole file[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    private final long size;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    [0m[35m/[0m[35m/[0m[39m file channel of the file to be read[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    private final FileChannel fileChannel;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    [0m[35m/[0m[35m/[0m[39m function to unmap the byte buffer[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    private final Consumer<? super ByteBuffer> unmapper;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * Create a random access memory mapped file instance for the file with the [0m [2m                [0m
[2;36m                    [0m         [39mgiven name.[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     * [0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     * @param filename the filename of the file to be read[0m                       [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     * [0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     * @throws IOException If there is an IO error opening the file.[0m             [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    public [0m[1;35mRandomAccessReadMemoryMappedFile[0m[1;39m([0m[39mString filename[0m[1;39m)[0m[39m throws IOException[0m  [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     * Create a random access memory mapped file instance for the given file.[0m    [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * [0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     * @param file the file to be read[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     * [0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * @throws IOException If there is an IO error opening the file.[0m             [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    public [0m[1;35mRandomAccessReadMemoryMappedFile[0m[1;39m([0m[39mFile file[0m[1;39m)[0m[39m throws IOException[0m        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[1;35mfile.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * Create a random access memory mapped file instance using the given path.[0m  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * [0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     * @param path path of the file to be read.[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     * [0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     * @throws IOException If there is an IO error opening the file.[0m             [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    public [0m[1;35mRandomAccessReadMemoryMappedFile[0m[1;39m([0m[39mPath path[0m[1;39m)[0m[39m throws IOException[0m        [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        fileChannel = [0m[1;35mFileChannel.open[0m[1;39m([0m[39mpath, [0m                                    [2m                [0m
[2;36m                    [0m         [1;35mEnumSet.of[0m[1;39m([0m[39mStandardOpenOption.READ[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        size = [0m[1;35mfileChannel.size[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[35m/[0m[35m/[0m[39m TODO only ints are allowed -> implement paging[0m                        [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        if [0m[1;39m([0m[39msize > Integer.MAX_VALUE[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mgetClass[0m[1;39m([0m[1;39m)[0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m" doesn't yet support [0m  [2m                [0m
[2;36m                    [0m         [32mfiles bigger than "[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                    + Integer.MAX_VALUE[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[35m/[0m[35m/[0m[39m map the whole file to memory[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        mappedByteBuffer = [0m[1;35mfileChannel.map[0m[1;39m([0m[39mFileChannel.MapMode.READ_ONLY, [0m[1;36m0[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39msize[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        unmapper = IOUtils::unmap;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mio/src/main/java/org/apache/pdfbox/io/ScratchFileBuffer.jav[0m[1;92ma:104[0m[39m-[0m[1;36m118[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:            int newSize = pageIndexes.length*[0m[1;36m2[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            [0m[35m/[0m[35m/[0m[39m check overflow[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            if [0m[1;39m([0m[39mnewSize<pageIndexes.length[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:                if [0m[1;39m([0m[39mpageIndexes.length == Integer.MAX_VALUE[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Maximum buffer size reached."[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:                newSize = Integer.MAX_VALUE;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:            int[0m[1;39m[[0m[1;39m][0m[39m newPageIndexes = new int[0m[1;39m[[0m[39mnewSize[0m[1;39m][0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:            [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mpageIndexes, [0m[1;36m0[0m[39m, newPageIndexes, [0m[1;36m0[0m[39m, pageCount[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:            pageIndexes = newPageIndexes;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDType1FontEmbedder.jav[0m[1;92ma:43[0m[39m-[0m[1;36m84[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m43:c[0m[39mlass PDType1FontEmbedder[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    private final Encoding fontEncoding;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    private final Type1Font type1;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * This will load a PFB to be embedded into a document.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     * @param doc The PDF document that will hold the embedded font.[0m             [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     * @param dict The Font dictionary to write to.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     * @param pfbStream The pfb input.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * @throws IOException If there is an error loading the data.[0m                [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[1;35mPDType1FontEmbedder[0m[1;39m([0m[39mPDDocument doc, COSDictionary dict, InputStream [0m         [2m                [0m
[2;36m                    [0m         [39mpfbStream,[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:                        Encoding encoding[0m[1;39m)[0m[39m throws IOException[0m                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        [0m[1;35mdict.setItem[0m[1;39m([0m[39mCOSName.SUBTYPE, COSName.TYPE1[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        [0m[35m/[0m[35m/[0m[39m read the pfb[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m pfbBytes = [0m[1;35mpfbStream.readAllBytes[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        PfbParser pfbParser = new [0m[1;35mPfbParser[0m[1;39m([0m[39mpfbBytes[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        type1 = [0m[1;35mType1Font.createWithPFB[0m[1;39m([0m[39mpfbBytes[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        if [0m[1;39m([0m[39mencoding == null[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            fontEncoding = [0m[1;35mType1Encoding.fromFontBox[0m[1;39m([0m[1;35mtype1.getEncoding[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        else[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:            fontEncoding = encoding;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        [0m[35m/[0m[35m/[0m[39m build font descriptor[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        PDFontDescriptor fd = [0m[1;35mbuildFontDescriptor[0m[1;39m([0m[39mtype1[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        PDStream fontStream = new [0m[1;35mPDStream[0m[1;39m([0m[39mdoc, [0m[1;35mpfbParser.getInputStream[0m[1;39m([0m[1;39m)[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [39mCOSName.FLATE_DECODE[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        [0m[1;35mfontStream.getCOSObject[0m[1;39m([0m[1;39m)[0m[1;35m.setInt[0m[1;39m([0m[32m"Length"[0m[39m, [0m[1;35mpfbParser.size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < [0m[1;35mpfbParser.getLengths[0m[1;39m([0m[1;39m)[0m[39m.length; i++[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            [0m[1;35mfontStream.getCOSObject[0m[1;39m([0m[1;39m)[0m[1;35m.setInt[0m[1;39m([0m[32m"Length"[0m[39m + [0m[1;39m([0m[39mi + [0m[1;36m1[0m[1;39m)[0m[39m, [0m                [2m                [0m
[2;36m                    [0m         [1;35mpfbParser.getLengths[0m[1;39m([0m[1;39m)[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        [0m[1;35mfd.setFontFile[0m[1;39m([0m[39mfontStream[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:124[0m[39m-[0m[1;36m177[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    private void [0m[1;35mparsePfb[0m[1;39m([0m[39mfinal byte[0m[1;39m[[0m[1;39m][0m[39m pfb[0m[1;39m)[0m[39m throws IOException [0m                 [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        if [0m[1;39m([0m[39mpfb.length < PFB_[0m[1;33mHEAD[0m[39mER_LENGTH[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"PFB header missing"[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        [0m[35m/[0m[35m/[0m[39m read into segments and keep them[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        List<Integer> typeList = new ArrayList<>[0m[1;39m([0m[1;36m3[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        List<byte[0m[1;39m[[0m[1;39m][0m[39m> barrList = new ArrayList<>[0m[1;39m([0m[1;36m3[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        ByteArrayInputStream in = new [0m[1;35mByteArrayInputStream[0m[1;39m([0m[39mpfb[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        int total = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        do[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            int r = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            if [0m[1;39m([0m[39mr == [0m[1;36m-1[0m[39m && total > [0m[1;36m0[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:                break; [0m[35m/[0m[35m/[0m[39m EOF[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:            if [0m[1;39m([0m[39mr != START_MARKER[0m[1;39m)[0m[39m [0m                                             [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Start marker missing"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:            int recordType = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:            if [0m[1;39m([0m[39mrecordType == EOF_MARKER[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:            if [0m[1;39m([0m[39mrecordType != ASCII_MARKER && recordType != BINARY_MARKER[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Incorrect record type: "[0m[39m + recordType[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            int size = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m8[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m16[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m24[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, size[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            long newTotal = total + size;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            if [0m[1;39m([0m[39mnewTotal > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"record size would be too large: "[0m[39m + [0m     [2m                [0m
[2;36m                    [0m         [39mnewTotal[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m ar = new byte[0m[1;39m[[0m[39msize[0m[1;39m][0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:            int got = [0m[1;35min.read[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:            if [0m[1;39m([0m[39mgot != size[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                throw new [0m[1;35mEOFException[0m[1;39m([0m[32m"EOF while reading PFB font"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            total += size;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            [0m[1;35mtypeList.add[0m[1;39m([0m[39mrecordType[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:            [0m[1;35mbarrList.add[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:        while [0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:156[0m[39m-[0m[1;36m174[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            int size = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m8[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m16[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m24[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, size[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            long newTotal = total + size;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            if [0m[1;39m([0m[39mnewTotal > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"record size would be too large: "[0m[39m + [0m     [2m                [0m
[2;36m                    [0m         [39mnewTotal[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m ar = new byte[0m[1;39m[[0m[39msize[0m[1;39m][0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:            int got = [0m[1;35min.read[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:            if [0m[1;39m([0m[39mgot != size[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                throw new [0m[1;35mEOFException[0m[1;39m([0m[32m"EOF while reading PFB font"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            total += size;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            [0m[1;35mtypeList.add[0m[1;39m([0m[39mrecordType[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:            [0m[1;35mbarrList.add[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Font.jav[0m[1;92ma:52[0m[39m-[0m[1;36m72[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    public static Type1Font [0m[1;35mcreateWithPFB[0m[1;39m([0m[39mInputStream pfbStream[0m[1;39m)[0m[39m throws [0m         [2m                [0m
[2;36m                    [0m         [39mIOException[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        PfbParser pfb = new [0m[1;35mPfbParser[0m[1;39m([0m[39mpfbStream[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        Type1Parser parser = new [0m[1;35mType1Parser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        return [0m[1;35mparser.parse[0m[1;39m([0m[1;35mpfb.getSegment1[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mpfb.getSegment2[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     * Constructs a new Type1Font object from a .pfb stream.[0m                     [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * @param pfbBytes .pfb data, including headers[0m                              [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     * @return a type1 font[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * @throws IOException if something went wrong[0m                               [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    public static Type1Font [0m[1;35mcreateWithPFB[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m pfbBytes[0m[1;39m)[0m[39m throws IOException[0m    [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        PfbParser pfb = new [0m[1;35mPfbParser[0m[1;39m([0m[39mpfbBytes[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        Type1Parser parser = new [0m[1;35mType1Parser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        return [0m[1;35mparser.parse[0m[1;39m([0m[1;35mpfb.getSegment1[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mpfb.getSegment2[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/test/java/org/apache/fontbox/pfb/PfbParserTest.jav[0m[1;92ma:1[0m[39m-[0m[1;36m104[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.fontbox.pfb;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.FileInputStream;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.fontbox.encoding.BuiltInEncoding;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.fontbox.type1.Type1Font;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.junit.jupiter.api.Assertions;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.junit.jupiter.api.Test;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m: * @author Tilman Hausherr[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;92m33:c[0m[39mlass PfbParserTest[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:     * Test parsing a PFB font.[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * @throws IOException [0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    void [0m[1;35mtestPfb[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        Type1Font font;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:        try [0m[1;39m([0m[39mInputStream is = new [0m                                               [2m                [0m
[2;36m                    [0m         [1;35mFileInputStream[0m[1;39m([0m[32m"target/fonts/OpenSans-Regular.pfb"[0m[1;39m)[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:            font = [0m[1;35mType1Font.createWithPFB[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"1.10"[0m[39m, [0m[1;35mfont.getVersion[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"OpenSans-Regular"[0m[39m, [0m[1;35mfont.getFontName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"Open Sans Regular"[0m[39m, [0m[1;35mfont.getFullName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"Open Sans"[0m[39m, [0m[1;35mfont.getFamilyName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"Digitized data copyright [0m[32m([0m[32mc[0m[32m)[0m[32m 2010-2011, Google [0m [2m                [0m
[2;36m                    [0m         [32mCorporation."[0m[39m, [0m[1;35mfont.getNotice[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mfalse, [0m[1;35mfont.isFixedPitch[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mfalse, [0m[1;35mfont.isForceBold[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[1;36m0[0m[39m, [0m[1;35mfont.getItalicAngle[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"Book"[0m[39m, [0m[1;35mfont.getWeight[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        [0m[1;35mAssertions.assertTrue[0m[1;39m([0m[1;35mfont.getEncoding[0m[1;39m([0m[1;39m)[0m[39m instanceof BuiltInEncoding[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[1;36m4498[0m[39m, [0m[1;35mfont.getASCIISegment[0m[1;39m([0m[1;39m)[0m[39m.length[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[1;36m95911[0m[39m, [0m[1;35mfont.getBinarySegment[0m[1;39m([0m[1;39m)[0m[39m.length[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[1;36m938[0m[39m, [0m[1;35mfont.getCharStringsDict[0m[1;39m([0m[1;39m)[0m[1;35m.size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        for [0m[1;39m([0m[39mString s : [0m[1;35mfont.getCharStringsDict[0m[1;39m([0m[1;39m)[0m[1;35m.keySet[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:            [0m[1;35mAssertions.assertNotNull[0m[1;39m([0m[1;35mfont.getPath[0m[1;39m([0m[39ms[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:            [0m[1;35mAssertions.assertTrue[0m[1;39m([0m[1;35mfont.hasGlyph[0m[1;39m([0m[39ms[0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * PDFBOX-[0m[1;36m5713[0m[39m: font with several binary segments.[0m                           [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * @throws IOException [0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    void [0m[1;35mtestPfbPDFBox5713[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        Type1Font font;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        try [0m[1;39m([0m[39mInputStream is = new [0m                                               [2m                [0m
[2;36m                    [0m         [1;35mFileInputStream[0m[1;39m([0m[32m"target/fonts/DejaVuSerifCondensed.pfb"[0m[1;39m)[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            font = [0m[1;35mType1Font.createWithPFB[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"Version 2.33"[0m[39m, [0m[1;35mfont.getVersion[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"DejaVuSerifCondensed"[0m[39m, [0m[1;35mfont.getFontName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"DejaVu Serif Condensed"[0m[39m, [0m[1;35mfont.getFullName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"DejaVu Serif Condensed"[0m[39m, [0m[1;35mfont.getFamilyName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"Copyright [0m[32m[[0m[32mc[0m[32m][0m[32m 2003 by Bitstream, Inc. All [0m      [2m                [0m
[2;36m                    [0m         [32mRights Reserved."[0m[39m, [0m[1;35mfont.getNotice[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mfalse, [0m[1;35mfont.isFixedPitch[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mfalse, [0m[1;35mfont.isForceBold[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[1;36m0[0m[39m, [0m[1;35mfont.getItalicAngle[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"Book"[0m[39m, [0m[1;35mfont.getWeight[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        [0m[1;35mAssertions.assertTrue[0m[1;39m([0m[1;35mfont.getEncoding[0m[1;39m([0m[1;39m)[0m[39m instanceof BuiltInEncoding[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[1;36m5959[0m[39m, [0m[1;35mfont.getASCIISegment[0m[1;39m([0m[1;39m)[0m[39m.length[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[1;36m1056090[0m[39m, [0m[1;35mfont.getBinarySegment[0m[1;39m([0m[1;39m)[0m[39m.length[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[1;36m3399[0m[39m, [0m[1;35mfont.getCharStringsDict[0m[1;39m([0m[1;39m)[0m[1;35m.size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:     * Test [0m[1;36m0[0m[39m length font.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    void [0m[1;35mtestEmpty[0m[1;39m([0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        [0m[1;35mAssertions.assertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> [0m                       [2m                [0m
[2;36m                    [0m         [1;35mType1Font.createWithPFB[0m[1;39m([0m[39mnew byte[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDType1Font.jav[0m[1;92ma:232[0m[39m-[0m[1;36m236[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                        if [0m[1;39m([0m[39mlength1 < [0m[1;36m0[0m[39m || length1 > length1 + length2[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:                            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Invalid length data, actual [0m [2m                [0m
[2;36m                    [0m         [32mlength: "[0m[39m +[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:                                    bytes.length + [0m[32m", /Length1: "[0m[39m + length1 + [0m  [2m                [0m
[2;36m                    [0m         [32m", /Length2: "[0m[39m + length2[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDType1Font.jav[0m[1;92ma:355[0m[39m-[0m[1;36m363[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:    private int [0m[1;35mrepairLength2[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m bytes, int length1, int length2[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:        [0m[35m/[0m[35m/[0m[39m repair Length2 if necessary[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:        if [0m[1;39m([0m[39mlength2 < [0m[1;36m0[0m[39m || length2 > bytes.length - length1[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Ignored invalid Length2 [0m[32m{[0m[32m}[0m[32m for Type 1 font [0m[32m{[0m[32m}[0m[32m"[0m[39m, length2, [0m [2m                [0m
[2;36m                    [0m         [1;35mgetName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:            return bytes.length - length1;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:        return length2;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mio/src/main/java/org/apache/pdfbox/io/RandomAccessReadBuffer.jav[0m[1;92ma:163[0m[39m-[0m[1;36m173[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:    public void [0m[1;35mseek[0m[1;39m([0m[39mlong position[0m[1;39m)[0m[39m throws IOException[0m                          [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:        [0m[1;35mcheckClosed[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:        if [0m[1;39m([0m[39mposition < [0m[1;36m0[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Invalid position "[0m[39m + position[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:        if [0m[1;39m([0m[39mposition < size[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            pointer = position;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            [0m[35m/[0m[35m/[0m[39m calculate the chunk list index[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:19[0m[39m-[0m[1;36m29[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.ByteArrayInputStream;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.EOFException;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.logging.log4j.LogManager;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:68[0m[39m-[0m[1;36m72[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * Heuristically chosen max length to buffer a Type1 font[0m                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    private static final long MAX_LENGTH = 100_000_000;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:156[0m[39m-[0m[1;36m177[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            int size = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m8[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m16[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m24[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, size[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            long newTotal = total + size;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            if [0m[1;39m([0m[39mnewTotal > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"record size would be too large: "[0m[39m + [0m     [2m                [0m
[2;36m                    [0m         [39mnewTotal[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m ar = new byte[0m[1;39m[[0m[39msize[0m[1;39m][0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:            int got = [0m[1;35min.read[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:            if [0m[1;39m([0m[39mgot != size[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                throw new [0m[1;35mEOFException[0m[1;39m([0m[32m"EOF while reading PFB font"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            total += size;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            [0m[1;35mtypeList.add[0m[1;39m([0m[39mrecordType[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:            [0m[1;35mbarrList.add[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:        while [0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:124[0m[39m-[0m[1;36m177[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    private void [0m[1;35mparsePfb[0m[1;39m([0m[39mfinal byte[0m[1;39m[[0m[1;39m][0m[39m pfb[0m[1;39m)[0m[39m throws IOException [0m                 [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        if [0m[1;39m([0m[39mpfb.length < PFB_[0m[1;33mHEAD[0m[39mER_LENGTH[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"PFB header missing"[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        [0m[35m/[0m[35m/[0m[39m read into segments and keep them[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        List<Integer> typeList = new ArrayList<>[0m[1;39m([0m[1;36m3[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        List<byte[0m[1;39m[[0m[1;39m][0m[39m> barrList = new ArrayList<>[0m[1;39m([0m[1;36m3[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        ByteArrayInputStream in = new [0m[1;35mByteArrayInputStream[0m[1;39m([0m[39mpfb[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        int total = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        do[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            int r = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            if [0m[1;39m([0m[39mr == [0m[1;36m-1[0m[39m && total > [0m[1;36m0[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:                break; [0m[35m/[0m[35m/[0m[39m EOF[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:            if [0m[1;39m([0m[39mr != START_MARKER[0m[1;39m)[0m[39m [0m                                             [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Start marker missing"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:            int recordType = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:            if [0m[1;39m([0m[39mrecordType == EOF_MARKER[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:            if [0m[1;39m([0m[39mrecordType != ASCII_MARKER && recordType != BINARY_MARKER[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Incorrect record type: "[0m[39m + recordType[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            int size = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m8[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m16[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m24[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, size[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            long newTotal = total + size;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            if [0m[1;39m([0m[39mnewTotal > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"record size would be too large: "[0m[39m + [0m     [2m                [0m
[2;36m                    [0m         [39mnewTotal[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m ar = new byte[0m[1;39m[[0m[39msize[0m[1;39m][0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:            int got = [0m[1;35min.read[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:            if [0m[1;39m([0m[39mgot != size[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                throw new [0m[1;35mEOFException[0m[1;39m([0m[32m"EOF while reading PFB font"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            total += size;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            [0m[1;35mtypeList.add[0m[1;39m([0m[39mrecordType[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:            [0m[1;35mbarrList.add[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:        while [0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:1[0m[39m-[0m[1;36m18[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.fontbox.pfb;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:37[0m[39m-[0m[1;36m82[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:public class PfbParser [0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    private static final Logger LOG = [0m[1;35mLogManager.getLogger[0m[1;39m([0m[39mPfbParser.class[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * the pfb header length.[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     * [0m[1;39m([0m[39mstart-marker [0m[1;39m([0m[1;36m1[0m[39m byte[0m[1;39m)[0m[39m, ascii-[0m[35m/[0m[95mbinary-marker[0m[39m [0m[1;39m([0m[1;36m1[0m[39m byte[0m[1;39m)[0m[39m, size [0m[1;39m([0m[1;36m4[0m[39m byte[0m[1;39m)[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * [0m[1;36m3[0m[39m*[0m[1;36m6[0m[39m == [0m[1;36m18[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    private static final int PFB_[0m[1;33mHEAD[0m[39mER_LENGTH = [0m[1;36m18[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * the start marker.[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    private static final int START_MARKER = [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * the ascii marker.[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    private static final int ASCII_MARKER = [0m[1;36m0x01[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     * the binary marker.[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    private static final int BINARY_MARKER = [0m[1;36m0x02[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     * the EOF marker.[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    private static final int EOF_MARKER = [0m[1;36m0x03[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * Heuristically chosen max length to buffer a Type1 font[0m                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    private static final long MAX_LENGTH = 100_000_000;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * the parsed pfb-data.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    private byte[0m[1;39m[[0m[1;39m][0m[39m pfbdata;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     * the lengths of the records [0m[1;39m([0m[39mASCII, BINARY, ASCII[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private final int[0m[1;39m[[0m[1;39m][0m[39m lengths = new int[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:98[0m[39m-[0m[1;36m177[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     * Create a new object.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:     * @param in   The input.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:     * @throws IOException if an IO-error occurs.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    public [0m[1;35mPfbParser[0m[1;39m([0m[39mfinal InputStream in[0m[1;39m)[0m[39m throws IOException [0m                  [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m pfb = [0m[1;35min.readAllBytes[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        [0m[1;35mparsePfb[0m[1;39m([0m[39mpfb[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:     * Create a new object.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:     * @param bytes   The input.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:     * @throws IOException if an IO-error occurs.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    public [0m[1;35mPfbParser[0m[1;39m([0m[39mfinal byte[0m[1;39m[[0m[1;39m][0m[39m bytes[0m[1;39m)[0m[39m throws IOException[0m                     [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        [0m[1;35mparsePfb[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:     * Parse the pfb-array.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:     * @param pfb   The pfb-Array[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:     * @throws IOException in an IO-error occurs.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    private void [0m[1;35mparsePfb[0m[1;39m([0m[39mfinal byte[0m[1;39m[[0m[1;39m][0m[39m pfb[0m[1;39m)[0m[39m throws IOException [0m                 [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        if [0m[1;39m([0m[39mpfb.length < PFB_[0m[1;33mHEAD[0m[39mER_LENGTH[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"PFB header missing"[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        [0m[35m/[0m[35m/[0m[39m read into segments and keep them[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        List<Integer> typeList = new ArrayList<>[0m[1;39m([0m[1;36m3[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        List<byte[0m[1;39m[[0m[1;39m][0m[39m> barrList = new ArrayList<>[0m[1;39m([0m[1;36m3[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        ByteArrayInputStream in = new [0m[1;35mByteArrayInputStream[0m[1;39m([0m[39mpfb[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        int total = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        do[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            int r = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            if [0m[1;39m([0m[39mr == [0m[1;36m-1[0m[39m && total > [0m[1;36m0[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:                break; [0m[35m/[0m[35m/[0m[39m EOF[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:            if [0m[1;39m([0m[39mr != START_MARKER[0m[1;39m)[0m[39m [0m                                             [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Start marker missing"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:            int recordType = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:            if [0m[1;39m([0m[39mrecordType == EOF_MARKER[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:            if [0m[1;39m([0m[39mrecordType != ASCII_MARKER && recordType != BINARY_MARKER[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Incorrect record type: "[0m[39m + recordType[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            int size = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m8[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m16[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m24[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, size[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            long newTotal = total + size;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            if [0m[1;39m([0m[39mnewTotal > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"record size would be too large: "[0m[39m + [0m     [2m                [0m
[2;36m                    [0m         [39mnewTotal[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m ar = new byte[0m[1;39m[[0m[39msize[0m[1;39m][0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:            int got = [0m[1;35min.read[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:            if [0m[1;39m([0m[39mgot != size[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                throw new [0m[1;35mEOFException[0m[1;39m([0m[32m"EOF while reading PFB font"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            total += size;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            [0m[1;35mtypeList.add[0m[1;39m([0m[39mrecordType[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:            [0m[1;35mbarrList.add[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:        while [0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:223[0m[39m-[0m[1;36m277[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:     * Returns the lengths.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:     * @return Returns the lengths.[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    public int[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mgetLengths[0m[1;39m([0m[1;39m)[0m[39m [0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:        return lengths;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:     * Returns the pfbdata.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:     * @return Returns the pfbdata.[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:    public byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mgetPfbdata[0m[1;39m([0m[1;39m)[0m[39m [0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:        return pfbdata;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:     * Returns the pfb data as stream.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:     * @return Returns the pfb data as stream.[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:    public InputStream [0m[1;35mgetInputStream[0m[1;39m([0m[1;39m)[0m[39m [0m                                        [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:        return new [0m[1;35mByteArrayInputStream[0m[1;39m([0m[39mpfbdata[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:     * Returns the size of the pfb-data.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:     * @return Returns the size of the pfb-data.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:    public int [0m[1;35msize[0m[1;39m([0m[1;39m)[0m[39m [0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:        return pfbdata.length;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:     * Returns the first segment[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:     * @return first segment bytes[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:    public byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mgetSegment1[0m[1;39m([0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:        return [0m[1;35mArrays.copyOfRange[0m[1;39m([0m[39mpfbdata, [0m[1;36m0[0m[39m, lengths[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:     * Returns the second segment[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:     * @return second segment bytes[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:    public byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mgetSegment2[0m[1;39m([0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:        return [0m[1;35mArrays.copyOfRange[0m[1;39m([0m[39mpfbdata, lengths[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m, lengths[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m + [0m            [2m                [0m
[2;36m                    [0m         [39mlengths[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy for PfbParser Out of Memory Vulnerability[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m1[0m[39m. Analysis Summary[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability occurs in `[0m[1;35mPfbParser.parsePfb[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m166[0m[39m where a byte array [0m  [2m                [0m
[2;36m                    [0m         [39mis allocated based on an untrusted size field read directly from the input PFB font[0m [2m                [0m
[2;36m                    [0m         [39mdata without adequate validation. The code reads a [0m[1;36m4[0m[39m-byte little-endian integer [0m    [2m                [0m
[2;36m                    [0m         [39mfrom the input stream [0m[1;39m([0m[39mlines [0m[1;36m156[0m[39m-[0m[1;36m159[0m[1;39m)[0m[39m and immediately attempts to allocate an array[0m [2m                [0m
[2;36m                    [0m         [39mof that size, leading to potential OutOfMemoryError when processing malicious PDF [0m  [2m                [0m
[2;36m                    [0m         [39mfiles.[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Root Causes Identified:**[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **No negative value validation**: The size field can represent a negative number[0m [2m                [0m
[2;36m                    [0m         [39mwhen interpreted as a signed int, but Java array allocation interprets it as a [0m     [2m                [0m
[2;36m                    [0m         [39mlarge positive value[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **No individual segment size limit**: Only cumulative size is checked against [0m   [2m                [0m
[2;36m                    [0m         [39mMAX_LENGTH [0m[1;39m([0m[39m100MB[0m[1;39m)[0m[39m, allowing a single segment to consume excessive memory[0m           [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **No bounds checking against available data**: The size can exceed the remaining[0m [2m                [0m
[2;36m                    [0m         [39mbytes in the input array, causing allocation to succeed but subsequent read to fail[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Existing Protection [0m[1;39m([0m[39mInsufficient[0m[1;39m)[0m[39m:**[0m                                             [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m162[0m[39m-[0m[1;36m164[0m[39m: Checks cumulative total against MAX_LENGTH, but this happens AFTER [0m [2m                [0m
[2;36m                    [0m         [39mindividual allocations[0m                                                              [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m168[0m[39m-[0m[1;36m170[0m[39m: Validates actual bytes read matches expected size, but this occurs [0m [2m                [0m
[2;36m                    [0m         [39mAFTER the vulnerable allocation[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m2[0m[39m. Comprehensive Fix Strategy[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix must be applied to [0m                                                         [2m                [0m
[2;36m                    [0m         [39m`fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java` in the [0m               [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mparsePfb[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m pfb[0m[1;39m)[0m[39m` method, specifically between lines [0m[1;36m160[0m[39m and [0m[1;36m161[0m[39m [0m[1;39m([0m[39mafter [0m       [2m                [0m
[2;36m                    [0m         [39mlogging, before cumulative check[0m[1;39m)[0m[39m.[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m1[0m[39m: Add Individual Segment Size Validation**[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mInsert the following validation checks immediately after line [0m[1;36m160[0m[39m [0m[1;39m([0m[39mthe LOG.debug [0m   [2m                [0m
[2;36m                    [0m         [39mstatement[0m[1;39m)[0m[39m:[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m After line [0m[1;36m160[0m[39m: [0m[1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, [0m      [2m                [0m
[2;36m                    [0m         [39msize[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Validate segment size is not negative[0m                                            [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39msize < [0m[1;36m0[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Invalid negative segment size: "[0m[39m + size[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Validate individual segment size doesn't exceed maximum[0m                          [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39msize > MAX_LENGTH[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Segment size "[0m[39m + size + [0m[32m" exceeds maximum "[0m[39m + [0m           [2m                [0m
[2;36m                    [0m         [39mMAX_LENGTH[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Validate segment size doesn't exceed available data in stream[0m                    [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39msize > [0m[1;35min.available[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Segment size "[0m[39m + size + [0m[32m" exceeds available data "[0m[39m + [0m    [2m                [0m
[2;36m                    [0m         [1;35min.available[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Then continue with existing cumulative check at line [0m[1;36m161[0m                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m2[0m[39m: Maintain Existing Cumulative Check**[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mKeep the existing cumulative validation [0m[1;39m([0m[39mlines [0m[1;36m161[0m[39m-[0m[1;36m164[0m[1;39m)[0m[39m as-is. This provides [0m       [2m                [0m
[2;36m                    [0m         [39mdefense-in-depth for multi-segment PFB files:[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mlong newTotal = total + size;[0m                                                       [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mnewTotal > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"record size would be too large: "[0m[39m + newTotal[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m3[0m[39m: Preserve Existing Post-Allocation Validation**[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mKeep the existing EOF validation [0m[1;39m([0m[39mlines [0m[1;36m167[0m[39m-[0m[1;36m171[0m[1;39m)[0m[39m to detect cases where actual data [0m [2m                [0m
[2;36m                    [0m         [39mis less than claimed size:[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mint got = [0m[1;35min.read[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mgot != size[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    throw new [0m[1;35mEOFException[0m[1;39m([0m[32m"EOF while reading PFB font"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m3[0m[39m. Justification and Design Rationale[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why This is the Optimal Approach:**[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Minimal and Focused**: The fix adds only three validation checks at the exact [0m [2m                [0m
[2;36m                    [0m         [39mpoint where the untrusted size value is read, before any allocation occurs. This is[0m [2m                [0m
[2;36m                    [0m         [39mthe earliest possible intervention point.[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Follows Established Patterns**: The validation logic mirrors existing patterns[0m [2m                [0m
[2;36m                    [0m         [39min the PDFBox codebase:[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mPDType1Font.repairLength2[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m[1;36m358[0m[1;39m)[0m[39m: `if [0m[1;39m([0m[39mlength2 < [0m[1;36m0[0m[39m || length2 > [0m       [2m                [0m
[2;36m                    [0m         [39mbytes.length - length1[0m[1;39m)[0m[39m`[0m                                                            [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mRandomAccessReadBuffer.seek[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m[1;36m166[0m[1;39m)[0m[39m: Negative value check with [0m         [2m                [0m
[2;36m                    [0m         [39mIOException[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m   - `BaseParser` [0m[1;39m([0m[39mline [0m[1;36m1450[0m[1;39m)[0m[39m: Length limit validation during parsing[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Defense in Depth**: The fix creates multiple layers of protection:[0m             [2m                [0m
[2;36m                    [0m         [39m   - **Layer [0m[1;36m1[0m[39m**: Negative value check [0m[1;39m([0m[39mprevents negative-to-large-positive [0m        [2m                [0m
[2;36m                    [0m         [39mconversion[0m[1;39m)[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m   - **Layer [0m[1;36m2[0m[39m**: Individual segment limit [0m[1;39m([0m[39mprevents single huge segment OOM[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m   - **Layer [0m[1;36m3[0m[39m**: Available data check [0m[1;39m([0m[39mprevents allocation exceeding actual data[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m   - **Layer [0m[1;36m4[0m[39m**: Cumulative check [0m[1;39m([0m[39mexisting, prevents excessive total size[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m   - **Layer [0m[1;36m5[0m[39m**: Read verification [0m[1;39m([0m[39mexisting, detects short reads[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Preserves Existing Logic**: The fix does not modify any existing validation, [0m  [2m                [0m
[2;36m                    [0m         [39mallocation, or processing logic. All downstream code continues to work unchanged.[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Backward Compatible**: The validation allows all legitimate PFB files to be [0m   [2m                [0m
[2;36m                    [0m         [39mprocessed:[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   - Test fonts like OpenSans-Regular.pfb [0m[1;39m([0m[39mASCII: [0m[1;36m4498[0m[39m bytes, Binary: [0m[1;36m95911[0m[39m bytes[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m   - Large fonts like DejaVuSerifCondensed.pfb [0m[1;39m([0m[39mBinary: [0m[1;36m1[0m[39m,[0m[1;36m056[0m[39m,[0m[1;36m090[0m[39m bytes[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [39m   - All segments well within the 100MB MAX_LENGTH limit[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**How It Addresses the Evaluation Report Issues:**[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **OOM at Line [0m[1;36m166[0m[39m**: The individual segment size check prevents allocation of [0m   [2m                [0m
[2;36m                    [0m         [39mexcessively large arrays before the allocation occurs[0m                               [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Heap Exhaustion**: By validating size ≤ MAX_LENGTH before allocation, the fix [0m [2m                [0m
[2;36m                    [0m         [39mensures no single allocation exceeds reasonable limits[0m                              [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Malicious PDF Processing**: The negative value check prevents crafted size [0m    [2m                [0m
[2;36m                    [0m         [39mfields from being interpreted as large positive values[0m                              [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **DoS Vulnerability**: Early rejection of malformed data with IOException [0m       [2m                [0m
[2;36m                    [0m         [39mprevents resource exhaustion[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential Side Effects and Mitigation:**[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Legitimate Large Fonts**: The MAX_LENGTH constant [0m[1;39m([0m[39m100MB[0m[1;39m)[0m[39m is already defined [0m  [2m                [0m
[2;36m                    [0m         [39mas [0m[32m"heuristically chosen"[0m[39m and existing tests show typical fonts are well below this[0m [2m                [0m
[2;36m                    [0m         [39mlimit [0m[1;39m([0m[39mlargest test: ~1MB[0m[1;39m)[0m[39m. If legitimate fonts exceeding 100MB per segment are [0m    [2m                [0m
[2;36m                    [0m         [39mdiscovered, MAX_LENGTH can be increased.[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Error Handling**: The fix throws IOException with descriptive messages, [0m       [2m                [0m
[2;36m                    [0m         [39mconsistent with existing error handling in the class. Callers already expect and [0m   [2m                [0m
[2;36m                    [0m         [39mhandle IOException [0m[1;39m([0m[39msee PDType1Font lines [0m[1;36m247[0m[39m-[0m[1;36m256[0m[1;39m)[0m[39m.[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Performance**: The three additional checks [0m[1;39m([0m[39mnegative, max, available[0m[1;39m)[0m[39m are [0m[1;35mO[0m[1;39m([0m[1;36m1[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39moperations with negligible performance impact. [0m[1;35mByteArrayInputStream.available[0m[1;39m([0m[1;39m)[0m[39m is [0m [2m                [0m
[2;36m                    [0m         [39ma simple subtraction operation.[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Multi-Segment Files**: The fix validates each segment individually while [0m      [2m                [0m
[2;36m                    [0m         [39mpreserving cumulative validation, ensuring multi-segment PFB files [0m[1;39m([0m[39mlike [0m           [2m                [0m
[2;36m                    [0m         [39mDejaVuSerifCondensed.pfb tested in line [0m[1;36m74[0m[39m-[0m[1;36m94[0m[1;39m)[0m[39m continue to work correctly.[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Similar Solutions in Codebase:**[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix follows the exact pattern used in `[0m[1;35mPDType1Font.repairLength2[0m[1;39m([0m[1;39m)[0m[39m`:[0m            [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mlength2 < [0m[1;36m0[0m[39m || length2 > bytes.length - length1[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Ignored invalid Length2 [0m[32m{[0m[32m}[0m[32m for Type 1 font [0m[32m{[0m[32m}[0m[32m"[0m[39m, length2, [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [39m    return bytes.length - length1;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe main difference is that PfbParser should throw IOException rather than repair, [0m [2m                [0m
[2;36m                    [0m         [39msince:[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m- PfbParser is lower-level and doesn't have context for repair[0m                      [2m                [0m
[2;36m                    [0m         [39m- Malformed size fields in PFB data indicate corrupted or malicious input[0m           [2m                [0m
[2;36m                    [0m         [39m- Higher-level code [0m[1;39m([0m[39mPDType1Font[0m[1;39m)[0m[39m already has damage handling mechanisms[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m4[0m[39m. Implementation Location[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**File**: `fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java`[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Method**: `[0m[1;35mparsePfb[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m pfb[0m[1;39m)[0m[39m` [0m[1;39m([0m[39mlines [0m[1;36m124[0m[39m-[0m[1;36m222[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Exact Insertion Point**: After line [0m[1;36m160[0m[39m, before line [0m[1;36m161[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Context Before Fix**:[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mint size = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [39msize += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m8[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39msize += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m16[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39msize += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m24[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, size[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39mlong newTotal = total + size;  [0m[35m/[0m[35m/[0m[39m Line [0m[1;36m161[0m                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Context After Fix**:[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mint size = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [39msize += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m8[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39msize += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m16[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39msize += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m24[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, size[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m === FIX STARTS HERE ===[0m                                                          [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39msize < [0m[1;36m0[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Invalid negative segment size: "[0m[39m + size[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39msize > MAX_LENGTH[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Segment size "[0m[39m + size + [0m[32m" exceeds maximum "[0m[39m + [0m           [2m                [0m
[2;36m                    [0m         [39mMAX_LENGTH[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39msize > [0m[1;35min.available[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Segment size "[0m[39m + size + [0m[32m" exceeds available data "[0m[39m + [0m    [2m                [0m
[2;36m                    [0m         [1;35min.available[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m === FIX ENDS HERE ===[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mlong newTotal = total + size;  [0m[35m/[0m[35m/[0m[39m Line [0m[1;36m161[0m                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m5[0m[39m. Testing Considerations[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix should be validated to ensure:[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Existing Tests Pass**: All tests in `PfbParserTest.java` should continue to [0m   [2m                [0m
[2;36m                    [0m         [39mpass:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mtestPfb[0m[1;39m([0m[1;39m)[0m[39m`: Normal font parsing[0m                                               [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mtestPfbPDFBox5713[0m[1;39m([0m[1;39m)[0m[39m`: Multi-segment font parsing[0m                              [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mtestEmpty[0m[1;39m([0m[1;39m)[0m[39m`: Empty input rejection[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Malicious Input Rejection**: The fix should reject:[0m                            [2m                [0m
[2;36m                    [0m         [39m   - Negative size values [0m[1;39m([0m[39me.g., [0m[1;36m0xFFFFFFFF[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [39m   - Excessive individual segment sizes [0m[1;39m([0m[39me.g., 150MB[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [39m   - Size exceeding available data [0m[1;39m([0m[39me.g., [0m[33msize[0m[39m=[0m[1;36m1000[0m[39m with only [0m[1;36m100[0m[39m bytes remaining[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Error Messages**: IOException messages should be descriptive and include the [0m  [2m                [0m
[2;36m                    [0m         [39minvalid size value for debugging[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **No Regression**: The fix should not affect:[0m                                    [2m                [0m
[2;36m                    [0m         [39m   - Font embedding operations [0m[1;39m([0m[39m`PDType1FontEmbedder`[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [39m   - Type1Font creation workflows[0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - PDF text extraction operations[0m                                                 [2m                [0m
[2;36m                    [0m         [39m   - Other font parsing operations[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m6[0m[39m. Conclusion[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis fix strategy provides a minimal, focused, and robust solution to the PfbParser[0m [2m                [0m
[2;36m                    [0m         [39mOOM vulnerability. By validating individual segment sizes before allocation, it [0m    [2m                [0m
[2;36m                    [0m         [39mprevents memory exhaustion while maintaining full backward compatibility with [0m      [2m                [0m
[2;36m                    [0m         [39mlegitimate PFB font files. The approach follows established patterns in the PDFBox [0m [2m                [0m
[2;36m                    [0m         [39mcodebase and provides defense-in-depth through multiple validation layers.[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=336570;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=933447;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=422744;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=517511;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpws9l444h[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/pdfbox_pdfbox-full-01_vuln_6/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1767647430.5550601[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc/pdfbox_pdfbox-full-01_vuln_6.toml       [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-pdfbox[0m           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/05/26 21:10:32][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/qqor/crete/.cache/environments/[0m[95mpdfbox[0m         ]8;id=964345;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=8839;file:///home/qqor/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=683636;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=954176;file:///home/qqor/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mpdfbox[0m                [2m               [0m
[2;36m[01/05/26 21:10:33][0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=250526;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=791429;file:///home/qqor/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mpdfbox[0m                 [2m               [0m
