[2;36m[01/06/26 11:45:14][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=588377;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=591293;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp3qyx6dmt[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/apache-commons-compress_cc-de[0m [2m               [0m
[2;36m                    [0m         [35mlta-07_vuln_8/[0m[95magent-output-1767699914.1392488[0m                                        [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/apache-commons-compress_cc-delta-07_vuln_8.toml       [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-commons-compress[0m [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Building Cached for CLEAN        ]8;id=555648;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=495578;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Started[33m...[0m                                                        [2m                     [0m
[2;36m[01/06/26 11:46:45][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Building Cached for CLEAN       ]8;id=917264;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=254578;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Took [1;36m91.83[0m seconds; [33mexception[0m=[3;91mFalse[0m                              [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running tests for Cached for     ]8;id=6568;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=196536;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         CLEAN environment[1m)[0m Started[33m...[0m                                                  [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running tests for Cached for    ]8;id=275498;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=234310;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         CLEAN environment[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                         [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=315053;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=121929;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m91[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=290932;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=447510;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 11:46:46][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.89[0m        ]8;id=137773;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=738177;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/06/26 11:46:48][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=652058;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=722371;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=102441;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=956615;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=4239;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=219921;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=318122;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=544901;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 11:46:49][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m1.04[0m        ]8;id=21696;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=549638;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=186037;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=141984;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 11:46:50][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.87[0m        ]8;id=946680;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=735458;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/06/26 11:46:55][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=173918;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=565941;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp1175412454706167753/output/q/r/[0m[95mjazzer-traversal[0m                    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.copyMismatchMvHook[0m[1m([0mFilePa [2m                [0m
[2;36m                    [0m         thTraversal.jav[1;92ma:211[0m[1m)[0m                                                               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:502[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:412[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:336[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:216[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1m([0mExpanderFuzzer.jav[1;92ma:52[0m[1m)[0m                [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: 7bb3f9683ba8f59b                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp1175412454706167753/output/q/r/[0m[95mjazzer-traversal[0m                    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.copyMismatchMvHook[0m[1m([0mFilePa [2m                [0m
[2;36m                    [0m         thTraversal.jav[1;92ma:211[0m[1m)[0m                                                               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:502[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:412[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:336[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:216[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1m([0mExpanderFuzzer.jav[1;92ma:52[0m[1m)[0m                [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: 7bb3f9683ba8f59b                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/06/26 11:47:15][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=474819;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=647755;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/06/26 11:52:32][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=161969;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=975803;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/06/26 11:53:34][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=584136;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=193178;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=13736;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=547559;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 11:53:35][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.90[0m        ]8;id=549833;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=610008;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Patching[1m)[0m Started[33m...[0m             ]8;id=880914;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=769066;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpd2nebvsk[0m                                                 ]8;id=298265;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=437078;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/06/26 11:54:10][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Patching[1m)[0m Took [1;36m34.68[0m seconds;   ]8;id=731260;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=546729;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Checking build[1m)[0m Started[33m...[0m       ]8;id=127842;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=980948;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 11:54:30][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Checking build[1m)[0m Took [1;36m20.45[0m      ]8;id=730460;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=426690;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running PoV[1m)[0m Started[33m...[0m          ]8;id=624889;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=94156;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 11:54:36][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running PoV[1m)[0m Took [1;36m5.20[0m seconds; ]8;id=317297;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=821901;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Testing[1m)[0m Started[33m...[0m              ]8;id=491853;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=997278;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Testing[1m)[0m Took [1;36m0.00[0m seconds;     ]8;id=251294;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=692252;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=574490;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=59598;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 11:54:37][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.88[0m        ]8;id=80980;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=502811;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=405089;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=994370;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 11:54:38][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.96[0m        ]8;id=331006;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=535005;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=931778;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=791551;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 11:54:39][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.93[0m        ]8;id=656760;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=212616;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/06/26 11:54:40][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=359812;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=684577;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/main/java/org/apache/commons/compress/archivers/examples/Expander.java    [2m                [0m
[2;36m                    [0m         +++ b/src/main/java/org/apache/commons/compress/archivers/examples/Expander.java    [2m                [0m
[2;36m                    [0m         @@ [1;36m-471[0m,[1;36m6[0m +[1;36m471[0m,[1;36m7[0m @@                                                                 [2m                [0m
[2;36m                    [0m                  if [1m([0m! [1;35mFiles.isDirectory[0m[1m([0mtargetDirectory[1m)[0m[1m)[0m [1m{[0m                                [2m                [0m
[2;36m                    [0m                      [1;35mFiles.createDirectories[0m[1m([0mtargetDirectory[1m)[0m;                              [2m                [0m
[2;36m                    [0m                  [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +        final Path normalizedTargetDirectory =                                     [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.toAbsolutePath[0m[1m([0m[1m)[0m[1;35m.normalize[0m[1m([0m[1m)[0m;                                       [2m                [0m
[2;36m                    [0m                  final Enumeration[1m<[0m[1;95mZipArchiveEntry[0m[39m> entries = [0m[1;35marchive.getEntries[0m[1;39m([0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [39m         while [0m[1;39m([0m[1;35mentries.hasMoreElements[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [39m             ZipArchiveEntry zae = [0m[1;35mentries.nextElement[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-478[0m[39m,[0m[1;36m8[0m[39m +[0m[1;36m479[0m[39m,[0m[1;36m18[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m                 String targetName = [0m[1;35mIOUtils.toString[0m[1;39m([0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[39m,[0m  [2m                [0m
[2;36m                    [0m         [39m                         StandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [39m                 Path link = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [39m-                Path target = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[39mtargetName[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [39m+                Path target = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[39mtargetName[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [39m+                [0m[35m/[0m[35m/[0m[39m Validate symlink target is within bounds[0m                        [2m                [0m
[2;36m                    [0m         [39m+                final Path normalizedTarget = [0m[1;35mtarget.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [39m+                if [0m[1;39m([0m[39m![0m[1;35mnormalizedTarget.startsWith[0m[1;39m([0m[39mnormalizedTargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [39m+                    throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip via symlink [0m     [2m                [0m
[2;36m                    [0m         [32mtarget: '%s' + '%s' -> '%s'"[0m[39m, targetDirectory, targetName, target[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [39m+                [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m                 Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, link[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [39m+                [0m[35m/[0m[35m/[0m[39m Validate that createParentDirectory didn't escape via symlinks[0m  [2m                [0m
[2;36m                    [0m         [39m+                final Path normalizedParent = [0m[1;35mparent.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [39m+                if [0m[1;39m([0m[39m![0m[1;35mnormalizedParent.startsWith[0m[1;39m([0m[39mnormalizedTargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [39m+                    throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip via parent [0m      [2m                [0m
[2;36m                    [0m         [32mdirectory: '%s' -> '%s'"[0m[39m, targetDirectory, parent[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m+                [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m                 if [0m[1;39m([0m[39m![0m[1;35mFiles.isSameFile[0m[1;39m([0m[1;35mlink.getParent[0m[1;39m([0m[1;39m)[0m[39m, parent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [39m                     link = [0m[1;35mparent.relativize[0m[1;39m([0m[1;35mlink.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-494[0m[39m,[0m[1;36m9[0m[39m +[0m[1;36m505[0m[39m,[0m[1;36m19[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m                             targetDirectory, [0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[39m, target[0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m                 Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, target[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [39m+                [0m[35m/[0m[35m/[0m[39m Validate that createParentDirectory didn't escape via symlinks[0m  [2m                [0m
[2;36m                    [0m         [39m+                final Path normalizedParent = [0m[1;35mparent.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [39m+                if [0m[1;39m([0m[39m![0m[1;35mnormalizedParent.startsWith[0m[1;39m([0m[39mnormalizedTargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [39m+                    throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip via parent [0m      [2m                [0m
[2;36m                    [0m         [32mdirectory: '%s' -> '%s'"[0m[39m, targetDirectory, parent[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m+                [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m                 if [0m[1;39m([0m[39m! [0m[1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;35m.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m      [2m                [0m
[2;36m                    [0m         [39m                         [0m[1;35mparent.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [39m                     target = [0m[1;35mparent.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.resolve[0m[1;39m([0m[1;35mtarget.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [39m+                    [0m[35m/[0m[35m/[0m[39m Re-validate the reconstructed target path[0m                   [2m                [0m
[2;36m                    [0m         [39m+                    final Path normalizedTarget = [0m                                 [2m                [0m
[2;36m                    [0m         [1;35mtarget.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m+                    if [0m[1;39m([0m[39m![0m[1;35mnormalizedTarget.startsWith[0m[1;39m([0m[39mnormalizedTargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [39m+                        throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip via [0m         [2m                [0m
[2;36m                    [0m         [32mreconstructed path: '%s' -> '%s'"[0m[39m, targetDirectory, target[0m[1;39m)[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m+                    [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m                 try [0m[1;39m([0m[39mInputStream is = [0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [39m                     [0m[1;35mFiles.copy[0m[1;39m([0m[39mis, target[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-509[0m[39m,[0m[1;36m11[0m[39m +[0m[1;36m530[0m[39m,[0m[1;36m17[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m         Path relative =[0m                                                            [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mroot.relativize[0m[1;39m([0m[1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [39m         Path current = [0m[1;35mroot.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m+        final Path normalizedRoot = [0m[1;35mroot.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m         for [0m[1;39m([0m[39mPath p : relative[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [39m             current = [0m[1;35mcurrent.resolve[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [39m             if [0m[1;39m([0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [39m                 current = [0m[1;35mFiles.readSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m+                [0m[35m/[0m[35m/[0m[39m Validate that the symlink target is within root bounds[0m          [2m                [0m
[2;36m                    [0m         [39m+                final Path normalizedCurrent = [0m                                    [2m                [0m
[2;36m                    [0m         [1;35mcurrent.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m+                if [0m[1;39m([0m[39m![0m[1;35mnormalizedCurrent.startsWith[0m[1;39m([0m[39mnormalizedRoot[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [39m+                    throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Symlink points outside [0m   [2m                [0m
[2;36m                    [0m         [32mtarget directory: '%s' -> '%s'"[0m[39m, root, current[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [39m+                [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m             if [0m[1;39m([0m[39m! [0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mFiles.createDirectory[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: [0m   [2m                [0m
[2;36m                    [0m         [39mFile path traversal: [0m                                                               [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp1175412454706167753/output/q/r/[0m[95mjazzer-traversal[0m                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1;39m([0m[39mFilePathTraversal.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:346[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1;39m([0m[39mFilePathTravers[0m [2m                [0m
[2;36m                    [0m         [39mal.jav[0m[1;92ma:293[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.copyMismatchMvHook[0m[1;39m([0m[39mFilePa[0m [2m                [0m
[2;36m                    [0m         [39mthTraversal.jav[0m[1;92ma:211[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:502[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:412[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:336[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:216[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mExpanderFuzzer.jav[0m[1;92ma:52[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 7bb3f9683ba8f59b[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA critical security vulnerability has been detected in the Apache Commons Compress [0m [2m                [0m
[2;36m                    [0m         [39mlibrary's `Expander` component. The fuzzer has identified a file path traversal [0m    [2m                [0m
[2;36m                    [0m         [39mvulnerability where the code attempts to access a file outside the intended [0m        [2m                [0m
[2;36m                    [0m         [39mdirectory structure using the path [0m                                                 [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/tmp/expander-tmp1175412454706167753/output/q/r/[0m[95mjazzer-traversal[0m[39m`. This represents[0m [2m                [0m
[2;36m                    [0m         [39ma CWE-[0m[1;36m22[0m[39m [0m[1;39m([0m[39mPath Traversal[0m[1;39m)[0m[39m vulnerability that could allow attackers to read, write, [0m [2m                [0m
[2;36m                    [0m         [39mor manipulate files outside the intended archive extraction directory.[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe issue is a **file path traversal vulnerability** [0m[1;39m([0m[39malso known as directory [0m      [2m                [0m
[2;36m                    [0m         [39mtraversal or path traversal attack[0m[1;39m)[0m[39m detected during fuzzing of the Apache Commons [0m  [2m                [0m
[2;36m                    [0m         [39mCompress `Expander` class. This type of vulnerability occurs when an application [0m   [2m                [0m
[2;36m                    [0m         [39muses user-supplied input to construct file paths without proper validation or [0m      [2m                [0m
[2;36m                    [0m         [39msanitization, potentially allowing access to files and directories outside the [0m     [2m                [0m
[2;36m                    [0m         [39mintended scope.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Key Observations:[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Vulnerability Type**: The exception [0m                                           [2m                [0m
[2;36m                    [0m         [39m`com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical` with the message [0m    [2m                [0m
[2;36m                    [0m         [32m"File path traversal"[0m[39m clearly identifies this as a critical security issue related [0m [2m                [0m
[2;36m                    [0m         [39mto improper path handling.[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Detection Point**: The vulnerability was caught by the Jazzer sanitizer [0m       [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`FilePathTraversal.check`[0m[1;39m)[0m[39m at runtime, indicating that the code attempted to [0m      [2m                [0m
[2;36m                    [0m         [39mperform a file operation on a path that violated security boundaries.[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Call Stack Analysis**: The vulnerability originates from the following [0m        [2m                [0m
[2;36m                    [0m         [39mexecution flow:[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1;39m([0m[1;39m)[0m[39m` - The fuzzer entry point[0m                 [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mExpander.expand[0m[1;39m([0m[1;39m)[0m[39m` - Multiple levels of the expand method [0m[1;39m([0m[39mlines [0m[1;36m216[0m[39m, [0m[1;36m336[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m, [0m[1;36m502[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mFilePathTraversal.copyMismatchMvHook[0m[1;39m([0m[1;39m)[0m[39m` - The sanitizer hook that detected [0m   [2m                [0m
[2;36m                    [0m         [39mthe violation[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mFilePathTraversal.checkPath[0m[1;39m([0m[1;39m)[0m[39m` and `[0m[1;35mFilePathTraversal.check[0m[1;39m([0m[1;39m)[0m[39m` - The actual [0m  [2m                [0m
[2;36m                    [0m         [39msecurity check[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Problematic Path**: The path [0m                                                  [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/tmp/expander-tmp1175412454706167753/output/q/r/[0m[95mjazzer-traversal[0m[39m` suggests:[0m        [2m                [0m
[2;36m                    [0m         [39m   - A temporary directory was created [0m[1;39m([0m[39m`expander-tmp1175412454706167753`[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m   - An output subdirectory structure exists[0m                                        [2m                [0m
[2;36m                    [0m         [39m   - The final component `jazzer-traversal` appears to be a test marker used by the[0m [2m                [0m
[2;36m                    [0m         [39mfuzzer to detect traversal attempts[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Location in Code**: The issue occurs at line [0m[1;36m502[0m[39m in `Expander.java` during the[0m [2m                [0m
[2;36m                    [0m         [39mexpand operation, which is likely processing archive entries and creating the [0m      [2m                [0m
[2;36m                    [0m         [39mcorresponding file structure.[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas Requiring Investigation:[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo obtain a comprehensive understanding of this vulnerability, the following [0m       [2m                [0m
[2;36m                    [0m         [39mcomponents should be examined:[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **`org.apache.commons.compress.archivers.examples.Expander` class**:[0m             [2m                [0m
[2;36m                    [0m         [39m   - The `[0m[1;35mexpand[0m[1;39m([0m[1;39m)[0m[39m` method at line [0m[1;36m502[0m[39m where the vulnerability manifests[0m            [2m                [0m
[2;36m                    [0m         [39m   - The entire call chain: lines [0m[1;36m216[0m[39m, [0m[1;36m336[0m[39m, [0m[1;36m412[0m[39m, and [0m[1;36m502[0m                            [2m                [0m
[2;36m                    [0m         [39m   - How archive entry names are processed and converted to file paths[0m              [2m                [0m
[2;36m                    [0m         [39m   - What validation [0m[1;39m([0m[39mif any[0m[1;39m)[0m[39m is performed on entry names before creating files[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Archive Entry Processing**:[0m                                                    [2m                [0m
[2;36m                    [0m         [39m   - How the Expander handles special path components like `..`, `.[0m[35m/[0m[39m`, absolute [0m    [2m                [0m
[2;36m                    [0m         [39mpaths, and symbolic links[0m                                                           [2m                [0m
[2;36m                    [0m         [39m   - Whether entry names from archives are sanitized before being used to create [0m   [2m                [0m
[2;36m                    [0m         [39mfile system paths[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   - The logic for constructing destination file paths from archive entries[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Input Vector**:[0m                                                                [2m                [0m
[2;36m                    [0m         [39m   - The fuzzer input that triggered this vulnerability [0m[1;39m([0m[39mthe [0m[32m"libFuzzer crashing [0m   [2m                [0m
[2;36m                    [0m         [32minput"[0m[39m mentioned[0m[1;39m)[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   - What type of archive format was being processed[0m                                [2m                [0m
[2;36m                    [0m         [39m   - The specific entry name or path component that caused the traversal attempt[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Security Controls**:[0m                                                           [2m                [0m
[2;36m                    [0m         [39m   - What path validation mechanisms currently exist in the codebase[0m                [2m                [0m
[2;36m                    [0m         [39m   - Whether there are existing sanitization functions that were bypassed or not [0m   [2m                [0m
[2;36m                    [0m         [39minvoked[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   - Configuration options or parameters that control extraction behavior[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis vulnerability represents a significant security risk as path traversal attacks[0m [2m                [0m
[2;36m                    [0m         [39mcan lead to unauthorized file access, data exfiltration, or even remote code [0m       [2m                [0m
[2;36m                    [0m         [39mexecution if an attacker can write to sensitive system locations.[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: [0m   [2m                [0m
[2;36m                    [0m         [39mFile path traversal: [0m                                                               [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp1175412454706167753/output/q/r/[0m[95mjazzer-traversal[0m                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1;39m([0m[39mFilePathTraversal.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:346[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1;39m([0m[39mFilePathTravers[0m [2m                [0m
[2;36m                    [0m         [39mal.jav[0m[1;92ma:293[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.copyMismatchMvHook[0m[1;39m([0m[39mFilePa[0m [2m                [0m
[2;36m                    [0m         [39mthTraversal.jav[0m[1;92ma:211[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:502[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:412[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:336[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:216[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mExpanderFuzzer.jav[0m[1;92ma:52[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 7bb3f9683ba8f59b[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:1[0m[39m-[0m[1;36m47[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one[0m                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * or more contributor license agreements.  See the NOTICE file[0m                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * distributed with this work for additional information[0m                          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * regarding copyright ownership.  The ASF licenses this file[0m                     [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * to you under the Apache License, Version [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mthe[0m                              [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance[0m                     [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * with the License.  You may obtain a copy of the License at[0m                     [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *   [0m[4;94mhttps://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * Unless required by applicable law or agreed to in writing,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * software distributed under the License is distributed on an[0m                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * [0m[32m"AS IS"[0m[39m BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY[0m                        [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * KIND, either express or implied.  See the License for the[0m                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * specific language governing permissions and limitations[0m                       [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * under the License.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:package org.apache.commons.compress.archivers.examples;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.BufferedInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.nio.channels.Channels;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.nio.channels.FileChannel;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.nio.channels.SeekableByteChannel;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.nio.file.StandardOpenOption;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.Enumeration;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.commons.compress.archivers.ArchiveEntry;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.commons.compress.archivers.ArchiveException;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.commons.compress.archivers.ArchiveInputStream;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.commons.compress.archivers.ArchiveStreamFactory;[0m               [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.commons.compress.archivers.sevenz.SevenZFile;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.commons.compress.archivers.tar.TarArchiveEntry;[0m                [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.commons.compress.archivers.tar.TarFile;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.commons.compress.archivers.zip.ZipArchiveEntry;[0m                [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.commons.compress.archivers.zip.ZipFile;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.commons.io.IOUtils;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.commons.io.output.NullOutputStream;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:53[0m[39m-[0m[1;36m94[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:public class Expander [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    @FunctionalInterface[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    private interface ArchiveEntryBiConsumer<T extends ArchiveEntry> [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        void [0m[1;35maccept[0m[1;39m([0m[39mT entry, OutputStream out[0m[1;39m)[0m[39m throws IOException;[0m               [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    @FunctionalInterface[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    private interface ArchiveEntrySupplier<T extends ArchiveEntry> [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        T [0m[1;35mget[0m[1;39m([0m[1;39m)[0m[39m throws IOException;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     * @param targetDirectory May be null to simulate output to dev/null on [0m     [2m                [0m
[2;36m                    [0m         [39mLinux and NUL on Windows.[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    private <T extends ArchiveEntry> void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ArchiveEntrySupplier<T> [0m  [2m                [0m
[2;36m                    [0m         [39msupplier, final ArchiveEntryBiConsumer<T> writer, final Path targetDirectory[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:            throws IOException [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        final boolean nullTarget = targetDirectory == null;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        final Path targetDirPath = nullTarget ? null : [0m                          [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        T nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        while [0m[1;39m([0m[39mnextEntry != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            final Path targetPath = nullTarget ? null : [0m                         [2m                [0m
[2;36m                    [0m         [1;35mnextEntry.resolveIn[0m[1;39m([0m[39mtargetDirPath[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            if [0m[1;39m([0m[1;35mnextEntry.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m && [0m            [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mtargetPath[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                final Path parent = nullTarget ? null : [0m[1;35mtargetPath.getParent[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m && [0m                [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mparent[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                if [0m[1;39m([0m[39mnullTarget[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                    [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, NullOutputStream.INSTANCE[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                    try [0m[1;39m([0m[39mOutputStream outputStream = [0m                            [2m                [0m
[2;36m                    [0m         [1;35mFiles.newOutputStream[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                        [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, outputStream[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                    [0m[1;39m}[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/ArchiveEntry.jav[0m[1;92ma:19[0m[39m-[0m[1;36m84[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:package org.apache.commons.compress.archivers;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Date;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m: * An entry of an archive.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:public interface ArchiveEntry [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:     * Special value [0m[1;39m([0m[1;39m{[0m[39m@value[0m[1;39m}[0m[1;39m)[0m[39m indicating that the size is unknown.[0m             [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    long SIZE_UNKNOWN = [0m[1;36m-1[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:     * Gets the last modified date of this entry.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * @return the last modified date of this entry.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * @since [0m[1;36m1.1[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    Date [0m[1;35mgetLastModifiedDate[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * Gets the name of the entry in this archive. May refer to a file or [0m       [2m                [0m
[2;36m                    [0m         [39mdirectory or other item.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     * <p>[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     * This method returns the raw name as it is stored inside of the archive.[0m   [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * @return The name of this entry in the archive.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    String [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * Gets the uncompressed size of this entry. May be [0m[1;36m-1[0m[39m [0m[1;39m([0m[39mSIZE_UNKNOWN[0m[1;39m)[0m[39m if the[0m [2m                [0m
[2;36m                    [0m         [39msize is unknown[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     * @return the uncompressed size of this entry.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    long [0m[1;35mgetSize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     * Tests whether this entry refers to a directory [0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     * @return true if this entry refers to a directory.[0m                         [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    boolean [0m[1;35misDirectory[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * Resolves this entry in the given parent Path.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * @param parentPath the [0m[1;39m{[0m[39m@link Path#[0m[1;35mresolve[0m[1;39m([0m[39mPath[0m[1;39m)[0m[1;39m}[0m[39m receiver.[0m                [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * @return a resolved and normalized Path.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * @throws IOException if this method detects a Zip slip.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * @since [0m[1;36m1.26[0m[39m.[0m[1;36m0[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    default Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mparentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        return outputFile;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:470[0m[39m-[0m[1;36m506[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ZipFile archive, final Path targetDirectory[0m[1;39m)[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m472[0m[39m:            [0m[1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m473[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m474[0m[39m:        final Enumeration<ZipArchiveEntry> entries = [0m[1;35marchive.getEntries[0m[1;39m([0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m475[0m[39m:        while [0m[1;39m([0m[1;35mentries.hasMoreElements[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m476[0m[39m:            ZipArchiveEntry zae = [0m[1;35mentries.nextElement[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m477[0m[39m:            if [0m[1;39m([0m[1;35mzae.isUnixSymlink[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m478[0m[39m:                String targetName = [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mIOUtils.toString[0m[1;39m([0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m479[0m[39m:                        StandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m480[0m[39m:                Path link = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m481[0m[39m:                Path target = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[39mtargetName[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m482[0m[39m:                Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, link[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m483[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m484[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mFiles.isSameFile[0m[1;39m([0m[1;35mlink.getParent[0m[1;39m([0m[1;39m)[0m[39m, parent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m485[0m[39m:                    link = [0m[1;35mparent.relativize[0m[1;39m([0m[1;35mlink.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m486[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m487[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mlink[0m[1;39m)[0m[39m && ![0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mlink[0m[1;39m)[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m488[0m[39m:                    [0m[1;35mFiles.createSymbolicLink[0m[1;39m([0m[39mlink, target[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m489[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m490[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39m! [0m[1;35mzae.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m491[0m[39m:                Path target = [0m                                                  [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m492[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mtarget.startsWith[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' [0m  [2m                [0m
[2;36m                    [0m         [32m-> '%s'"[0m[39m,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:                            targetDirectory, [0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[39m, target[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:                Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, target[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:                if [0m[1;39m([0m[39m! [0m[1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;35m.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m   [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:                        [0m[1;35mparent.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:                    target = [0m[1;35mparent.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.resolve[0m[1;39m([0m[1;35mtarget.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:                try [0m[1;39m([0m[39mInputStream is = [0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:                    [0m[1;35mFiles.copy[0m[1;39m([0m[39mis, target[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:508[0m[39m-[0m[1;36m524[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:    private static Path [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mPath root, Path target[0m[1;39m)[0m[39m throws [0m   [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:        Path relative =[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:                [0m[1;35mroot.relativize[0m[1;39m([0m[1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:        Path current = [0m[1;35mroot.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:        for [0m[1;39m([0m[39mPath p : relative[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:            current = [0m[1;35mcurrent.resolve[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:            if [0m[1;39m([0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:                current = [0m[1;35mFiles.readSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m517[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m518[0m[39m:            if [0m[1;39m([0m[39m! [0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m519[0m[39m:                [0m[1;35mFiles.createDirectory[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m520[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m521[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m522[0m[39m:        return current;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m523[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m524[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:508[0m[39m-[0m[1;36m524[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:    private static Path [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mPath root, Path target[0m[1;39m)[0m[39m throws [0m   [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:        Path relative =[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:                [0m[1;35mroot.relativize[0m[1;39m([0m[1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:        Path current = [0m[1;35mroot.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:        for [0m[1;39m([0m[39mPath p : relative[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:            current = [0m[1;35mcurrent.resolve[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:            if [0m[1;39m([0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:                current = [0m[1;35mFiles.readSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m517[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m518[0m[39m:            if [0m[1;39m([0m[39m! [0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m519[0m[39m:                [0m[1;35mFiles.createDirectory[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m520[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m521[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m522[0m[39m:        return current;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m523[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m524[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:404[0m[39m-[0m[1;36m420[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal String format, final SeekableByteChannel archive, [0m [2m                [0m
[2;36m                    [0m         [39mfinal Path targetDirectory, final CloseableConsumer closeableConsumer[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:            throws IOException, ArchiveException [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:        try [0m[1;39m([0m[39mCloseableConsumerAdapter c = new [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mCloseableConsumerAdapter[0m[1;39m([0m[39mcloseableConsumer[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:            if [0m[1;39m([0m[39m![0m[1;35mprefersSeekableByteChannel[0m[1;39m([0m[39mformat[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:                [0m[1;35mexpand[0m[1;39m([0m[39mformat, [0m[1;35mc.track[0m[1;39m([0m[1;35mChannels.newInputStream[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;39m)[0m[39m, [0m      [2m                [0m
[2;36m                    [0m         [39mtargetDirectory, CloseableConsumer.NULL_CONSUMER[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m409[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mArchiveStreamFactory.TAR.equalsIgnoreCase[0m[1;39m([0m[39mformat[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:                [0m[1;35mexpand[0m[1;39m([0m[1;35mc.track[0m[1;39m([0m[39mnew [0m[1;35mTarFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;39m)[0m[39m, targetDirectory[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mArchiveStreamFactory.ZIP.equalsIgnoreCase[0m[1;39m([0m[39mformat[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:                [0m                                                                [2m                [0m
[2;36m                    [0m         [1;35mexpand[0m[1;39m([0m[1;35mc.track[0m[1;39m([0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setSeekableByteChannel[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m, [0m           [2m                [0m
[2;36m                    [0m         [39mtargetDirectory[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m413[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mArchiveStreamFactory.SEVEN_Z.equalsIgnoreCase[0m[1;39m([0m[39mformat[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m414[0m[39m:                [0m                                                                [2m                [0m
[2;36m                    [0m         [1;35mexpand[0m[1;39m([0m[1;35mc.track[0m[1;39m([0m[1;35mSevenZFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setSeekableByteChannel[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m, [0m        [2m                [0m
[2;36m                    [0m         [39mtargetDirectory[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:                [0m[35m/[0m[35m/[0m[39m never reached as prefersSeekableByteChannel only returns [0m    [2m                [0m
[2;36m                    [0m         [39mtrue for TAR, ZIP and 7z[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:                throw new [0m[1;35mArchiveException[0m[1;39m([0m[32m"Don't know how to handle format "[0m[39m +[0m [2m                [0m
[2;36m                    [0m         [39mformat[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:442[0m[39m-[0m[1;36m449[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m442[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal TarFile archive, final Path targetDirectory[0m[1;39m)[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m443[0m[39m:        final Iterator<TarArchiveEntry> entryIterator = [0m                        [2m                [0m
[2;36m                    [0m         [1;35marchive.getEntries[0m[1;39m([0m[1;39m)[0m[1;35m.iterator[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m444[0m[39m:        [0m[1;35mexpand[0m[1;39m([0m[1;39m([0m[1;39m)[0m[39m -> [0m[1;35mentryIterator.hasNext[0m[1;39m([0m[1;39m)[0m[39m ? [0m[1;35mentryIterator.next[0m[1;39m([0m[1;39m)[0m[39m : null, [0m    [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mentry, out[0m[1;39m)[0m[39m -> [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m445[0m[39m:            try [0m[1;39m([0m[39mInputStream in = [0m[1;35marchive.getInputStream[0m[1;39m([0m[39mentry[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m446[0m[39m:                [0m[1;35mIOUtils.copy[0m[1;39m([0m[39min, out[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m447[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m448[0m[39m:        [0m[1;39m}[0m[39m, targetDirectory[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m449[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:227[0m[39m-[0m[1;36m241[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal SevenZFile archive, final File targetDirectory[0m[1;39m)[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:        [0m[1;35mexpand[0m[1;39m([0m[39marchive, [0m[1;35mtoPath[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:     * Expands [0m[1;39m{[0m[39m@code archive[0m[1;39m}[0m[39m into [0m[1;39m{[0m[39m@code targetDirectory[0m[1;39m}[0m[39m.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:     * @param archive         the file to expand[0m                                [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:     * @param targetDirectory the target directory, may be null to simulate [0m    [2m                [0m
[2;36m                    [0m         [39moutput to dev/null on Linux and NUL on Windows.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:     * @throws IOException if an I/O error occurs[0m                               [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:     * @since [0m[1;36m1.22[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal SevenZFile archive, final Path targetDirectory[0m[1;39m)[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:        [0m[1;35mexpand[0m[1;39m([0m[39marchive::getNextEntry, [0m[1;39m([0m[39mentry, out[0m[1;39m)[0m[39m -> [0m                          [2m                [0m
[2;36m                    [0m         [1;35mIOUtils.copyLarge[0m[1;39m([0m[1;35marchive.getInputStream[0m[1;39m([0m[39mentry[0m[1;39m)[0m[39m, out[0m[1;39m)[0m[39m, targetDirectory[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:68[0m[39m-[0m[1;36m94[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    private <T extends ArchiveEntry> void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ArchiveEntrySupplier<T> [0m  [2m                [0m
[2;36m                    [0m         [39msupplier, final ArchiveEntryBiConsumer<T> writer, final Path targetDirectory[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:            throws IOException [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        final boolean nullTarget = targetDirectory == null;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        final Path targetDirPath = nullTarget ? null : [0m                          [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        T nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        while [0m[1;39m([0m[39mnextEntry != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            final Path targetPath = nullTarget ? null : [0m                         [2m                [0m
[2;36m                    [0m         [1;35mnextEntry.resolveIn[0m[1;39m([0m[39mtargetDirPath[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            if [0m[1;39m([0m[1;35mnextEntry.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m && [0m            [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mtargetPath[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                final Path parent = nullTarget ? null : [0m[1;35mtargetPath.getParent[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m && [0m                [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mparent[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                if [0m[1;39m([0m[39mnullTarget[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                    [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, NullOutputStream.INSTANCE[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                    try [0m[1;39m([0m[39mOutputStream outputStream = [0m                            [2m                [0m
[2;36m                    [0m         [1;35mFiles.newOutputStream[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                        [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, outputStream[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                    [0m[1;39m}[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:126[0m[39m-[0m[1;36m134[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ArchiveInputStream<?> archive, final Path [0m         [2m                [0m
[2;36m                    [0m         [39mtargetDirectory[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        [0m[1;35mexpand[0m[1;39m([0m[1;39m([0m[1;39m)[0m[39m -> [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            ArchiveEntry next = [0m[1;35marchive.getNextEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            while [0m[1;39m([0m[39mnext != null && ![0m[1;35marchive.canReadEntryData[0m[1;39m([0m[39mnext[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:                next = [0m[1;35marchive.getNextEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:            return next;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        [0m[1;39m}[0m[39m, [0m[1;39m([0m[39mentry, out[0m[1;39m)[0m[39m -> [0m[1;35mIOUtils.copy[0m[1;39m([0m[39marchive, out[0m[1;39m)[0m[39m, targetDirectory[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.jav[0m[1;92ma:191[0m[39m-[0m [2m                [0m
[2;36m                    [0m         [1;36m218[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:    void [0m[1;35mtestFileCantEscapeDoubleDotPath[0m[1;39m([0m[1;39m)[0m[39m throws IOException, ArchiveException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        [0m[1;35msetupZip[0m[1;39m([0m[32m"../foo"[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:        try [0m[1;39m([0m[39mZipFile f = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:            [0m[1;35massertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, [0m     [2m                [0m
[2;36m                    [0m         [39mtempResultDir[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:    void [0m[1;35mtestFileCantEscapeDoubleDotPathWithSimilarSibling[0m[1;39m([0m[1;39m)[0m[39m throws [0m            [2m                [0m
[2;36m                    [0m         [39mIOException, ArchiveException [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:        final String sibling = [0m[1;35mtempResultDir.getName[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m"x"[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:        final File s = new [0m[1;35mFile[0m[1;39m([0m[1;35mtempResultDir.getParentFile[0m[1;39m([0m[1;39m)[0m[39m, sibling[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:        [0m[1;35massumeFalse[0m[1;39m([0m[1;35ms.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:        [0m[1;35ms.mkdirs[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:        [0m[1;35massumeTrue[0m[1;39m([0m[1;35ms.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:        [0m[1;35msetupZip[0m[1;39m([0m[32m"../"[0m[39m + sibling + [0m[32m"/a"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:        try [0m[1;39m([0m[39mZipFile f = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:            [0m[1;35massertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, [0m     [2m                [0m
[2;36m                    [0m         [39mtempResultDir[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:    void [0m[1;35mtestFileCantEscapeViaAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m throws IOException, [0m               [2m                [0m
[2;36m                    [0m         [39mArchiveException [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:        [0m[1;35msetupZip[0m[1;39m([0m[32m"/tmp/foo"[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:        try [0m[1;39m([0m[39mZipFile f = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:            [0m[1;35massertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, [0m     [2m                [0m
[2;36m                    [0m         [39mtempResultDir[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:        [0m[1;35massertFalse[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mtempResultDir, [0m[32m"tmp/foo"[0m[1;39m)[0m[1;35m.isFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.jav[0m[1;92ma:294[0m[39m-[0m [2m                [0m
[2;36m                    [0m         [1;36m316[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:    public void [0m[1;35mtestSymLinks[0m[1;39m([0m[39m@TempDir Path tmp[0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        Path input = [0m                                                           [2m                [0m
[2;36m                    [0m         [1;35mPaths.get[0m[1;39m([0m[1;35mExpanderTest.class.getResource[0m[1;39m([0m[32m"/testSymLinks.zip"[0m[1;39m)[0m[1;35m.toURI[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:        [0m[35m/[0m[35m/[0m[95mcheck[0m[39m that the test file is defined correctly.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:        ZipFile zipFile = new [0m[1;35mZipFile[0m[1;39m([0m[39minput[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:        ZipArchiveEntry zae = [0m[1;35mzipFile.getEntry[0m[1;39m([0m[32m"a"[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:        [0m[1;35massertNotNull[0m[1;39m([0m[39mzae[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:        [0m[1;35massertTrue[0m[1;39m([0m[1;35mzae.isUnixSymlink[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m contents = new byte[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:        [0m[1;35mIOUtils.readFully[0m[1;39m([0m[1;35mzipFile.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[39m, contents[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[32m"b"[0m[39m, new [0m[1;35mString[0m[1;39m([0m[39mcontents[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:        zae = [0m[1;35mzipFile.getEntry[0m[1;39m([0m[32m"a/c/d/hello_world.txt"[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:        [0m[1;35massertNotNull[0m[1;39m([0m[39mzae[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:        [0m[35m/[0m[35m/[0m[95mnow[0m[39m actually test that the file is written[0m                            [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:        [0m[35m/[0m[35m/[0m[95mto[0m[39m the correct path[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:        new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39minput, tmp[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:        Path target = [0m[1;35mtmp.resolve[0m[1;39m([0m[32m"b/c/d/hello_world.txt"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:        [0m[1;35massertTrue[0m[1;39m([0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[1;36m13[0m[39m, [0m[1;35mFiles.size[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:477[0m[39m-[0m[1;36m506[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m477[0m[39m:            if [0m[1;39m([0m[1;35mzae.isUnixSymlink[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m478[0m[39m:                String targetName = [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mIOUtils.toString[0m[1;39m([0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m479[0m[39m:                        StandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m480[0m[39m:                Path link = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m481[0m[39m:                Path target = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[39mtargetName[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m482[0m[39m:                Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, link[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m483[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m484[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mFiles.isSameFile[0m[1;39m([0m[1;35mlink.getParent[0m[1;39m([0m[1;39m)[0m[39m, parent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m485[0m[39m:                    link = [0m[1;35mparent.relativize[0m[1;39m([0m[1;35mlink.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m486[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m487[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mlink[0m[1;39m)[0m[39m && ![0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mlink[0m[1;39m)[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m488[0m[39m:                    [0m[1;35mFiles.createSymbolicLink[0m[1;39m([0m[39mlink, target[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m489[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m490[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39m! [0m[1;35mzae.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m491[0m[39m:                Path target = [0m                                                  [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m492[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mtarget.startsWith[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' [0m  [2m                [0m
[2;36m                    [0m         [32m-> '%s'"[0m[39m,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:                            targetDirectory, [0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[39m, target[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:                Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, target[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:                if [0m[1;39m([0m[39m! [0m[1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;35m.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m   [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:                        [0m[1;35mparent.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:                    target = [0m[1;35mparent.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.resolve[0m[1;39m([0m[1;35mtarget.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:                try [0m[1;39m([0m[39mInputStream is = [0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:                    [0m[1;35mFiles.copy[0m[1;39m([0m[39mis, target[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:508[0m[39m-[0m[1;36m524[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:    private static Path [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mPath root, Path target[0m[1;39m)[0m[39m throws [0m   [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:        Path relative =[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:                [0m[1;35mroot.relativize[0m[1;39m([0m[1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:        Path current = [0m[1;35mroot.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:        for [0m[1;39m([0m[39mPath p : relative[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:            current = [0m[1;35mcurrent.resolve[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:            if [0m[1;39m([0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:                current = [0m[1;35mFiles.readSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m517[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m518[0m[39m:            if [0m[1;39m([0m[39m! [0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m519[0m[39m:                [0m[1;35mFiles.createDirectory[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m520[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m521[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m522[0m[39m:        return current;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m523[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m524[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/ArchiveEntry.jav[0m[1;92ma:67[0m[39m-[0m[1;36m82[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * Resolves this entry in the given parent Path.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * @param parentPath the [0m[1;39m{[0m[39m@link Path#[0m[1;35mresolve[0m[1;39m([0m[39mPath[0m[1;39m)[0m[1;39m}[0m[39m receiver.[0m                [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * @return a resolved and normalized Path.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * @throws IOException if this method detects a Zip slip.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * @since [0m[1;36m1.26[0m[39m.[0m[1;36m0[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    default Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mparentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        return outputFile;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:68[0m[39m-[0m[1;36m94[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    private <T extends ArchiveEntry> void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ArchiveEntrySupplier<T> [0m  [2m                [0m
[2;36m                    [0m         [39msupplier, final ArchiveEntryBiConsumer<T> writer, final Path targetDirectory[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:            throws IOException [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        final boolean nullTarget = targetDirectory == null;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        final Path targetDirPath = nullTarget ? null : [0m                          [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        T nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        while [0m[1;39m([0m[39mnextEntry != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            final Path targetPath = nullTarget ? null : [0m                         [2m                [0m
[2;36m                    [0m         [1;35mnextEntry.resolveIn[0m[1;39m([0m[39mtargetDirPath[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            if [0m[1;39m([0m[1;35mnextEntry.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m && [0m            [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mtargetPath[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                final Path parent = nullTarget ? null : [0m[1;35mtargetPath.getParent[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m && [0m                [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mparent[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                if [0m[1;39m([0m[39mnullTarget[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                    [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, NullOutputStream.INSTANCE[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                    try [0m[1;39m([0m[39mOutputStream outputStream = [0m                            [2m                [0m
[2;36m                    [0m         [1;35mFiles.newOutputStream[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                        [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, outputStream[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                    [0m[1;39m}[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:477[0m[39m-[0m[1;36m506[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m477[0m[39m:            if [0m[1;39m([0m[1;35mzae.isUnixSymlink[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m478[0m[39m:                String targetName = [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mIOUtils.toString[0m[1;39m([0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m479[0m[39m:                        StandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m480[0m[39m:                Path link = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m481[0m[39m:                Path target = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[39mtargetName[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m482[0m[39m:                Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, link[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m483[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m484[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mFiles.isSameFile[0m[1;39m([0m[1;35mlink.getParent[0m[1;39m([0m[1;39m)[0m[39m, parent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m485[0m[39m:                    link = [0m[1;35mparent.relativize[0m[1;39m([0m[1;35mlink.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m486[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m487[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mlink[0m[1;39m)[0m[39m && ![0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mlink[0m[1;39m)[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m488[0m[39m:                    [0m[1;35mFiles.createSymbolicLink[0m[1;39m([0m[39mlink, target[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m489[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m490[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39m! [0m[1;35mzae.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m491[0m[39m:                Path target = [0m                                                  [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m492[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mtarget.startsWith[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' [0m  [2m                [0m
[2;36m                    [0m         [32m-> '%s'"[0m[39m,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:                            targetDirectory, [0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[39m, target[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:                Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, target[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:                if [0m[1;39m([0m[39m! [0m[1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;35m.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m   [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:                        [0m[1;35mparent.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:                    target = [0m[1;35mparent.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.resolve[0m[1;39m([0m[1;35mtarget.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:                try [0m[1;39m([0m[39mInputStream is = [0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:                    [0m[1;35mFiles.copy[0m[1;39m([0m[39mis, target[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:508[0m[39m-[0m[1;36m524[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:    private static Path [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mPath root, Path target[0m[1;39m)[0m[39m throws [0m   [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:        Path relative =[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:                [0m[1;35mroot.relativize[0m[1;39m([0m[1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:        Path current = [0m[1;35mroot.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:        for [0m[1;39m([0m[39mPath p : relative[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:            current = [0m[1;35mcurrent.resolve[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:            if [0m[1;39m([0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:                current = [0m[1;35mFiles.readSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m517[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m518[0m[39m:            if [0m[1;39m([0m[39m! [0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m519[0m[39m:                [0m[1;35mFiles.createDirectory[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m520[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m521[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m522[0m[39m:        return current;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m523[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m524[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:491[0m[39m-[0m[1;36m502[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m491[0m[39m:                Path target = [0m                                                  [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m492[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mtarget.startsWith[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' [0m  [2m                [0m
[2;36m                    [0m         [32m-> '%s'"[0m[39m,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:                            targetDirectory, [0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[39m, target[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:                Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, target[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:                if [0m[1;39m([0m[39m! [0m[1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;35m.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m   [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:                        [0m[1;35mparent.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:                    target = [0m[1;35mparent.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.resolve[0m[1;39m([0m[1;35mtarget.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:                try [0m[1;39m([0m[39mInputStream is = [0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:                    [0m[1;35mFiles.copy[0m[1;39m([0m[39mis, target[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:470[0m[39m-[0m[1;36m506[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ZipFile archive, final Path targetDirectory[0m[1;39m)[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m472[0m[39m:            [0m[1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m473[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m474[0m[39m:        final Enumeration<ZipArchiveEntry> entries = [0m[1;35marchive.getEntries[0m[1;39m([0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m475[0m[39m:        while [0m[1;39m([0m[1;35mentries.hasMoreElements[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m476[0m[39m:            ZipArchiveEntry zae = [0m[1;35mentries.nextElement[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m477[0m[39m:            if [0m[1;39m([0m[1;35mzae.isUnixSymlink[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m478[0m[39m:                String targetName = [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mIOUtils.toString[0m[1;39m([0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m479[0m[39m:                        StandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m480[0m[39m:                Path link = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m481[0m[39m:                Path target = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[39mtargetName[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m482[0m[39m:                Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, link[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m483[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m484[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mFiles.isSameFile[0m[1;39m([0m[1;35mlink.getParent[0m[1;39m([0m[1;39m)[0m[39m, parent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m485[0m[39m:                    link = [0m[1;35mparent.relativize[0m[1;39m([0m[1;35mlink.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m486[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m487[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mlink[0m[1;39m)[0m[39m && ![0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mlink[0m[1;39m)[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m488[0m[39m:                    [0m[1;35mFiles.createSymbolicLink[0m[1;39m([0m[39mlink, target[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m489[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m490[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39m! [0m[1;35mzae.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m491[0m[39m:                Path target = [0m                                                  [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m492[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mtarget.startsWith[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' [0m  [2m                [0m
[2;36m                    [0m         [32m-> '%s'"[0m[39m,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:                            targetDirectory, [0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[39m, target[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:                Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, target[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:                if [0m[1;39m([0m[39m! [0m[1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;35m.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m   [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:                        [0m[1;35mparent.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:                    target = [0m[1;35mparent.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.resolve[0m[1;39m([0m[1;35mtarget.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:                try [0m[1;39m([0m[39mInputStream is = [0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:                    [0m[1;35mFiles.copy[0m[1;39m([0m[39mis, target[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:508[0m[39m-[0m[1;36m524[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:    private static Path [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mPath root, Path target[0m[1;39m)[0m[39m throws [0m   [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:        Path relative =[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:                [0m[1;35mroot.relativize[0m[1;39m([0m[1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:        Path current = [0m[1;35mroot.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:        for [0m[1;39m([0m[39mPath p : relative[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:            current = [0m[1;35mcurrent.resolve[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:            if [0m[1;39m([0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:                current = [0m[1;35mFiles.readSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m517[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m518[0m[39m:            if [0m[1;39m([0m[39m! [0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m519[0m[39m:                [0m[1;35mFiles.createDirectory[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m520[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m521[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m522[0m[39m:        return current;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m523[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m524[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:68[0m[39m-[0m[1;36m94[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    private <T extends ArchiveEntry> void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ArchiveEntrySupplier<T> [0m  [2m                [0m
[2;36m                    [0m         [39msupplier, final ArchiveEntryBiConsumer<T> writer, final Path targetDirectory[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:            throws IOException [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        final boolean nullTarget = targetDirectory == null;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        final Path targetDirPath = nullTarget ? null : [0m                          [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        T nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        while [0m[1;39m([0m[39mnextEntry != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            final Path targetPath = nullTarget ? null : [0m                         [2m                [0m
[2;36m                    [0m         [1;35mnextEntry.resolveIn[0m[1;39m([0m[39mtargetDirPath[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            if [0m[1;39m([0m[1;35mnextEntry.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m && [0m            [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mtargetPath[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                final Path parent = nullTarget ? null : [0m[1;35mtargetPath.getParent[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m && [0m                [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mparent[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                if [0m[1;39m([0m[39mnullTarget[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                    [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, NullOutputStream.INSTANCE[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                    try [0m[1;39m([0m[39mOutputStream outputStream = [0m                            [2m                [0m
[2;36m                    [0m         [1;35mFiles.newOutputStream[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                        [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, outputStream[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                    [0m[1;39m}[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:114[0m[39m-[0m[1;36m134[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ArchiveInputStream<?> archive, final File [0m         [2m                [0m
[2;36m                    [0m         [39mtargetDirectory[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        [0m[1;35mexpand[0m[1;39m([0m[39marchive, [0m[1;35mtoPath[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:     * Expands [0m[1;39m{[0m[39m@code archive[0m[1;39m}[0m[39m into [0m[1;39m{[0m[39m@code targetDirectory[0m[1;39m}[0m[39m.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:     * @param archive         the file to expand[0m                                [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:     * @param targetDirectory the target directory, may be null to simulate [0m    [2m                [0m
[2;36m                    [0m         [39moutput to dev/null on Linux and NUL on Windows.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:     * @throws IOException if an I/O error occurs[0m                               [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:     * @since [0m[1;36m1.22[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ArchiveInputStream<?> archive, final Path [0m         [2m                [0m
[2;36m                    [0m         [39mtargetDirectory[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        [0m[1;35mexpand[0m[1;39m([0m[1;39m([0m[1;39m)[0m[39m -> [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            ArchiveEntry next = [0m[1;35marchive.getNextEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            while [0m[1;39m([0m[39mnext != null && ![0m[1;35marchive.canReadEntryData[0m[1;39m([0m[39mnext[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:                next = [0m[1;35marchive.getNextEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:            return next;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        [0m[1;39m}[0m[39m, [0m[1;39m([0m[39mentry, out[0m[1;39m)[0m[39m -> [0m[1;35mIOUtils.copy[0m[1;39m([0m[39marchive, out[0m[1;39m)[0m[39m, targetDirectory[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:227[0m[39m-[0m[1;36m241[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal SevenZFile archive, final File targetDirectory[0m[1;39m)[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:        [0m[1;35mexpand[0m[1;39m([0m[39marchive, [0m[1;35mtoPath[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:     * Expands [0m[1;39m{[0m[39m@code archive[0m[1;39m}[0m[39m into [0m[1;39m{[0m[39m@code targetDirectory[0m[1;39m}[0m[39m.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:     * @param archive         the file to expand[0m                                [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:     * @param targetDirectory the target directory, may be null to simulate [0m    [2m                [0m
[2;36m                    [0m         [39moutput to dev/null on Linux and NUL on Windows.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:     * @throws IOException if an I/O error occurs[0m                               [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:     * @since [0m[1;36m1.22[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal SevenZFile archive, final Path targetDirectory[0m[1;39m)[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:        [0m[1;35mexpand[0m[1;39m([0m[39marchive::getNextEntry, [0m[1;39m([0m[39mentry, out[0m[1;39m)[0m[39m -> [0m                          [2m                [0m
[2;36m                    [0m         [1;35mIOUtils.copyLarge[0m[1;39m([0m[1;35marchive.getInputStream[0m[1;39m([0m[39mentry[0m[1;39m)[0m[39m, out[0m[1;39m)[0m[39m, targetDirectory[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:442[0m[39m-[0m[1;36m449[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m442[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal TarFile archive, final Path targetDirectory[0m[1;39m)[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m443[0m[39m:        final Iterator<TarArchiveEntry> entryIterator = [0m                        [2m                [0m
[2;36m                    [0m         [1;35marchive.getEntries[0m[1;39m([0m[1;39m)[0m[1;35m.iterator[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m444[0m[39m:        [0m[1;35mexpand[0m[1;39m([0m[1;39m([0m[1;39m)[0m[39m -> [0m[1;35mentryIterator.hasNext[0m[1;39m([0m[1;39m)[0m[39m ? [0m[1;35mentryIterator.next[0m[1;39m([0m[1;39m)[0m[39m : null, [0m    [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mentry, out[0m[1;39m)[0m[39m -> [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m445[0m[39m:            try [0m[1;39m([0m[39mInputStream in = [0m[1;35marchive.getInputStream[0m[1;39m([0m[39mentry[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m446[0m[39m:                [0m[1;35mIOUtils.copy[0m[1;39m([0m[39min, out[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m447[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m448[0m[39m:        [0m[1;39m}[0m[39m, targetDirectory[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m449[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:470[0m[39m-[0m[1;36m506[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ZipFile archive, final Path targetDirectory[0m[1;39m)[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m472[0m[39m:            [0m[1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m473[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m474[0m[39m:        final Enumeration<ZipArchiveEntry> entries = [0m[1;35marchive.getEntries[0m[1;39m([0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m475[0m[39m:        while [0m[1;39m([0m[1;35mentries.hasMoreElements[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m476[0m[39m:            ZipArchiveEntry zae = [0m[1;35mentries.nextElement[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m477[0m[39m:            if [0m[1;39m([0m[1;35mzae.isUnixSymlink[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m478[0m[39m:                String targetName = [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mIOUtils.toString[0m[1;39m([0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m479[0m[39m:                        StandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m480[0m[39m:                Path link = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m481[0m[39m:                Path target = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[39mtargetName[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m482[0m[39m:                Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, link[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m483[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m484[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mFiles.isSameFile[0m[1;39m([0m[1;35mlink.getParent[0m[1;39m([0m[1;39m)[0m[39m, parent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m485[0m[39m:                    link = [0m[1;35mparent.relativize[0m[1;39m([0m[1;35mlink.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m486[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m487[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mlink[0m[1;39m)[0m[39m && ![0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mlink[0m[1;39m)[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m488[0m[39m:                    [0m[1;35mFiles.createSymbolicLink[0m[1;39m([0m[39mlink, target[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m489[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m490[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39m! [0m[1;35mzae.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m491[0m[39m:                Path target = [0m                                                  [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m492[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mtarget.startsWith[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' [0m  [2m                [0m
[2;36m                    [0m         [32m-> '%s'"[0m[39m,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:                            targetDirectory, [0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[39m, target[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:                Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, target[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:                if [0m[1;39m([0m[39m! [0m[1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;35m.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m   [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:                        [0m[1;35mparent.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:                    target = [0m[1;35mparent.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.resolve[0m[1;39m([0m[1;35mtarget.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:                try [0m[1;39m([0m[39mInputStream is = [0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:                    [0m[1;35mFiles.copy[0m[1;39m([0m[39mis, target[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:508[0m[39m-[0m[1;36m524[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:    private static Path [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mPath root, Path target[0m[1;39m)[0m[39m throws [0m   [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:        Path relative =[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:                [0m[1;35mroot.relativize[0m[1;39m([0m[1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:        Path current = [0m[1;35mroot.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:        for [0m[1;39m([0m[39mPath p : relative[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:            current = [0m[1;35mcurrent.resolve[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:            if [0m[1;39m([0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:                current = [0m[1;35mFiles.readSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m517[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m518[0m[39m:            if [0m[1;39m([0m[39m! [0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m519[0m[39m:                [0m[1;35mFiles.createDirectory[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m520[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m521[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m522[0m[39m:        return current;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m523[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m524[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/ArchiveEntry.jav[0m[1;92ma:75[0m[39m-[0m[1;36m82[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    default Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mparentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        return outputFile;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/zip/Lister.jav[0m[1;92ma:51[0m[39m-[0m[1;36m59[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    private static void [0m[1;35mextract[0m[1;39m([0m[39mfinal Path targetDir, final ZipArchiveEntry [0m     [2m                [0m
[2;36m                    [0m         [39mentry, final InputStream inputStream[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        final Path outputFile = [0m[1;35mentry.resolveIn[0m[1;39m([0m[39mtargetDir[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        final Path parent = [0m[1;35moutputFile.getParent[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        if [0m[1;39m([0m[39mparent != null && ![0m[1;35mFiles.exists[0m[1;39m([0m[39mparent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:            [0m[1;35mFiles.createDirectories[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        [0m[1;35mFiles.copy[0m[1;39m([0m[39minputStream, outputFile[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/AbstractTest.jav[0m[1;92ma:156[0m[39m-[0m[1;36m168[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            [0m[1;35minputStream.iterator[0m[1;39m([0m[1;39m)[0m[1;35m.forEachRemaining[0m[1;39m([0m[39mentry -> [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:                final Path outputFile = [0m[1;35mentry.resolveIn[0m[1;39m([0m[39mresult[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:                long bytesCopied = [0m[1;36m0[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:                if [0m[1;39m([0m[1;35mentry.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:                    [0m[1;35mFiles.createDirectories[0m[1;39m([0m[39moutputFile[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                    [0m[1;35mFiles.createDirectories[0m[1;39m([0m[1;35moutputFile.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:                    bytesCopied = [0m[1;35mFiles.copy[0m[1;39m([0m[39minputStream, outputFile[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:                final long size = [0m[1;35mentry.getSize[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:                if [0m[1;39m([0m[39msize != ArchiveEntry.SIZE_UNKNOWN[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:                    [0m[1;35massertEquals[0m[1;39m([0m[39msize, bytesCopied, [0m[32m"Entry.size should equal [0m   [2m                [0m
[2;36m                    [0m         [32mbytes read."[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:470[0m[39m-[0m[1;36m506[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ZipFile archive, final Path targetDirectory[0m[1;39m)[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m472[0m[39m:            [0m[1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m473[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m474[0m[39m:        final Enumeration<ZipArchiveEntry> entries = [0m[1;35marchive.getEntries[0m[1;39m([0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m475[0m[39m:        while [0m[1;39m([0m[1;35mentries.hasMoreElements[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m476[0m[39m:            ZipArchiveEntry zae = [0m[1;35mentries.nextElement[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m477[0m[39m:            if [0m[1;39m([0m[1;35mzae.isUnixSymlink[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m478[0m[39m:                String targetName = [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mIOUtils.toString[0m[1;39m([0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m479[0m[39m:                        StandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m480[0m[39m:                Path link = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m481[0m[39m:                Path target = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[39mtargetName[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m482[0m[39m:                Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, link[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m483[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m484[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mFiles.isSameFile[0m[1;39m([0m[1;35mlink.getParent[0m[1;39m([0m[1;39m)[0m[39m, parent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m485[0m[39m:                    link = [0m[1;35mparent.relativize[0m[1;39m([0m[1;35mlink.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m486[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m487[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mlink[0m[1;39m)[0m[39m && ![0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mlink[0m[1;39m)[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m488[0m[39m:                    [0m[1;35mFiles.createSymbolicLink[0m[1;39m([0m[39mlink, target[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m489[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m490[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39m! [0m[1;35mzae.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m491[0m[39m:                Path target = [0m                                                  [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m492[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mtarget.startsWith[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' [0m  [2m                [0m
[2;36m                    [0m         [32m-> '%s'"[0m[39m,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:                            targetDirectory, [0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[39m, target[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:                Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, target[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:                if [0m[1;39m([0m[39m! [0m[1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;35m.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m   [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:                        [0m[1;35mparent.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:                    target = [0m[1;35mparent.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.resolve[0m[1;39m([0m[1;35mtarget.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:                try [0m[1;39m([0m[39mInputStream is = [0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:                    [0m[1;35mFiles.copy[0m[1;39m([0m[39mis, target[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:508[0m[39m-[0m[1;36m524[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:    private static Path [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mPath root, Path target[0m[1;39m)[0m[39m throws [0m   [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:        Path relative =[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:                [0m[1;35mroot.relativize[0m[1;39m([0m[1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:        Path current = [0m[1;35mroot.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:        for [0m[1;39m([0m[39mPath p : relative[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:            current = [0m[1;35mcurrent.resolve[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:            if [0m[1;39m([0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:                current = [0m[1;35mFiles.readSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m517[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m518[0m[39m:            if [0m[1;39m([0m[39m! [0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m519[0m[39m:                [0m[1;35mFiles.createDirectory[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m520[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m521[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m522[0m[39m:        return current;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m523[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m524[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/zip/Lister.jav[0m[1;92ma:52[0m[39m-[0m[1;36m59[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    private static void [0m[1;35mextract[0m[1;39m([0m[39mfinal Path targetDir, final ZipArchiveEntry [0m     [2m                [0m
[2;36m                    [0m         [39mentry, final InputStream inputStream[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        final Path outputFile = [0m[1;35mentry.resolveIn[0m[1;39m([0m[39mtargetDir[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        final Path parent = [0m[1;35moutputFile.getParent[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        if [0m[1;39m([0m[39mparent != null && ![0m[1;35mFiles.exists[0m[1;39m([0m[39mparent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:            [0m[1;35mFiles.createDirectories[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        [0m[1;35mFiles.copy[0m[1;39m([0m[39minputStream, outputFile[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.jav[0m[1;92ma:294[0m[39m-[0m [2m                [0m
[2;36m                    [0m         [1;36m316[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:    public void [0m[1;35mtestSymLinks[0m[1;39m([0m[39m@TempDir Path tmp[0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        Path input = [0m                                                           [2m                [0m
[2;36m                    [0m         [1;35mPaths.get[0m[1;39m([0m[1;35mExpanderTest.class.getResource[0m[1;39m([0m[32m"/testSymLinks.zip"[0m[1;39m)[0m[1;35m.toURI[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:        [0m[35m/[0m[35m/[0m[95mcheck[0m[39m that the test file is defined correctly.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:        ZipFile zipFile = new [0m[1;35mZipFile[0m[1;39m([0m[39minput[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:        ZipArchiveEntry zae = [0m[1;35mzipFile.getEntry[0m[1;39m([0m[32m"a"[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:        [0m[1;35massertNotNull[0m[1;39m([0m[39mzae[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:        [0m[1;35massertTrue[0m[1;39m([0m[1;35mzae.isUnixSymlink[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m contents = new byte[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:        [0m[1;35mIOUtils.readFully[0m[1;39m([0m[1;35mzipFile.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[39m, contents[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[32m"b"[0m[39m, new [0m[1;35mString[0m[1;39m([0m[39mcontents[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:        zae = [0m[1;35mzipFile.getEntry[0m[1;39m([0m[32m"a/c/d/hello_world.txt"[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:        [0m[1;35massertNotNull[0m[1;39m([0m[39mzae[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:        [0m[35m/[0m[35m/[0m[95mnow[0m[39m actually test that the file is written[0m                            [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:        [0m[35m/[0m[35m/[0m[95mto[0m[39m the correct path[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:        new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39minput, tmp[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:        Path target = [0m[1;35mtmp.resolve[0m[1;39m([0m[32m"b/c/d/hello_world.txt"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:        [0m[1;35massertTrue[0m[1;39m([0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[1;36m13[0m[39m, [0m[1;35mFiles.size[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:68[0m[39m-[0m[1;36m94[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    private <T extends ArchiveEntry> void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ArchiveEntrySupplier<T> [0m  [2m                [0m
[2;36m                    [0m         [39msupplier, final ArchiveEntryBiConsumer<T> writer, final Path targetDirectory[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:            throws IOException [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        final boolean nullTarget = targetDirectory == null;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        final Path targetDirPath = nullTarget ? null : [0m                          [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        T nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        while [0m[1;39m([0m[39mnextEntry != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            final Path targetPath = nullTarget ? null : [0m                         [2m                [0m
[2;36m                    [0m         [1;35mnextEntry.resolveIn[0m[1;39m([0m[39mtargetDirPath[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            if [0m[1;39m([0m[1;35mnextEntry.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m && [0m            [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mtargetPath[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                final Path parent = nullTarget ? null : [0m[1;35mtargetPath.getParent[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m && [0m                [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mparent[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                if [0m[1;39m([0m[39mnullTarget[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                    [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, NullOutputStream.INSTANCE[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                    try [0m[1;39m([0m[39mOutputStream outputStream = [0m                            [2m                [0m
[2;36m                    [0m         [1;35mFiles.newOutputStream[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                        [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, outputStream[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                    [0m[1;39m}[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:470[0m[39m-[0m[1;36m506[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ZipFile archive, final Path targetDirectory[0m[1;39m)[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m472[0m[39m:            [0m[1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m473[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m474[0m[39m:        final Enumeration<ZipArchiveEntry> entries = [0m[1;35marchive.getEntries[0m[1;39m([0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m475[0m[39m:        while [0m[1;39m([0m[1;35mentries.hasMoreElements[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m476[0m[39m:            ZipArchiveEntry zae = [0m[1;35mentries.nextElement[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m477[0m[39m:            if [0m[1;39m([0m[1;35mzae.isUnixSymlink[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m478[0m[39m:                String targetName = [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mIOUtils.toString[0m[1;39m([0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m479[0m[39m:                        StandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m480[0m[39m:                Path link = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m481[0m[39m:                Path target = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[39mtargetName[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m482[0m[39m:                Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, link[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m483[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m484[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mFiles.isSameFile[0m[1;39m([0m[1;35mlink.getParent[0m[1;39m([0m[1;39m)[0m[39m, parent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m485[0m[39m:                    link = [0m[1;35mparent.relativize[0m[1;39m([0m[1;35mlink.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m486[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m487[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mlink[0m[1;39m)[0m[39m && ![0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mlink[0m[1;39m)[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m488[0m[39m:                    [0m[1;35mFiles.createSymbolicLink[0m[1;39m([0m[39mlink, target[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m489[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m490[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39m! [0m[1;35mzae.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m491[0m[39m:                Path target = [0m                                                  [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m492[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mtarget.startsWith[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' [0m  [2m                [0m
[2;36m                    [0m         [32m-> '%s'"[0m[39m,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:                            targetDirectory, [0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[39m, target[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:                Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, target[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:                if [0m[1;39m([0m[39m! [0m[1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;35m.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m   [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:                        [0m[1;35mparent.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:                    target = [0m[1;35mparent.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.resolve[0m[1;39m([0m[1;35mtarget.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:                try [0m[1;39m([0m[39mInputStream is = [0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:                    [0m[1;35mFiles.copy[0m[1;39m([0m[39mis, target[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/ArchiveEntry.jav[0m[1;92ma:75[0m[39m-[0m[1;36m82[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    default Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mparentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        return outputFile;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis Summary[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter analyzing the code snippets and evaluation report, I've identified a critical[0m [2m                [0m
[2;36m                    [0m         [39mpath traversal vulnerability [0m[1;39m([0m[39mCWE-[0m[1;36m22[0m[1;39m)[0m[39m in the `Expander.java` class, specifically in[0m [2m                [0m
[2;36m                    [0m         [39mthe `ZipFile` expansion implementation. The vulnerability allows attackers to write[0m [2m                [0m
[2;36m                    [0m         [39mfiles outside the intended extraction directory through symbolic link manipulation.[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Root Cause[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability exists in two main areas:[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **The `createParentDirectory` method [0m[1;39m([0m[39mlines [0m[1;36m508[0m[39m-[0m[1;36m524[0m[1;39m)[0m[39m**: This method follows [0m     [2m                [0m
[2;36m                    [0m         [39msymbolic links without validating that the resolved path remains within the target [0m [2m                [0m
[2;36m                    [0m         [39mdirectory bounds. At line [0m[1;36m516[0m[39m, `[0m[1;35mFiles.readSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m` replaces the [0m      [2m                [0m
[2;36m                    [0m         [39mcurrent path with the symlink target, which can point anywhere on the filesystem.[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **The `[0m[1;35mexpand[0m[1;39m([0m[39mZipFile, Path[0m[1;39m)[0m[39m` method [0m[1;39m([0m[39mlines [0m[1;36m470[0m[39m-[0m[1;36m506[0m[1;39m)[0m[39m**: This method reconstructs[0m [2m                [0m
[2;36m                    [0m         [39mfile paths after initial validation [0m[1;39m([0m[39mlines [0m[1;36m497[0m[39m-[0m[1;36m499[0m[1;39m)[0m[39m, using the potentially [0m         [2m                [0m
[2;36m                    [0m         [39mcompromised parent path returned by `createParentDirectory`, without re-validating [0m [2m                [0m
[2;36m                    [0m         [39mthe reconstructed path before writing files.[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Critical Code Flows[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Vulnerable Flow for Regular Files:**[0m                                              [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m491[0m[39m-[0m[1;36m495[0m[39m: Initial path validation [0m[1;39m([0m[39mGOOD[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m496[0m[39m: Calls `createParentDirectory` which can return external path [0m[1;39m([0m[39mBAD[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m499[0m[39m: Reconstructs path using compromised parent [0m[1;39m([0m[39mBAD[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m502[0m[39m: Writes file without re-validation [0m[1;39m([0m[39mBAD[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Vulnerable Flow for Symlinks:**[0m                                                   [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m481[0m[39m: Resolves symlink target without validation [0m[1;39m([0m[39mBAD[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m482[0m[39m: Creates parent directory following external symlinks [0m[1;39m([0m[39mBAD[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m488[0m[39m: Creates symlink to potentially external target [0m[1;39m([0m[39mBAD[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Comparison with Safe Implementations[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mOther archive types [0m[1;39m([0m[39mTarFile, SevenZFile[0m[1;39m)[0m[39m delegate to the generic `expand` method [0m  [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mlines [0m[1;36m68[0m[39m-[0m[1;36m94[0m[1;39m)[0m[39m which:[0m                                                                [2m                [0m
[2;36m                    [0m         [39m- Uses `[0m[1;35mentry.resolveIn[0m[1;39m([0m[1;39m)[0m[39m` for validation[0m                                           [2m                [0m
[2;36m                    [0m         [39m- Uses standard `[0m[1;35mFiles.createDirectories[0m[1;39m([0m[1;39m)[0m[39m` without manual symlink following[0m        [2m                [0m
[2;36m                    [0m         [39m- Never reconstructs paths after validation[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mI will implement a **multi-layered validation approach** that preserves the symlink[0m [2m                [0m
[2;36m                    [0m         [39mfunctionality required by the test suite while preventing path traversal attacks. [0m  [2m                [0m
[2;36m                    [0m         [39mThis approach adds validation at critical points without changing the fundamental [0m  [2m                [0m
[2;36m                    [0m         [39msymlink-following behavior.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Implementation Steps[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### [0m[1;36m1[0m[39m. Add Validation Helper Method[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd a new private static method to validate that a path remains within the target [0m  [2m                [0m
[2;36m                    [0m         [39mdirectory:[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mprivate static void [0m[1;35mvalidatePathWithinTarget[0m[1;39m([0m[39mfinal Path targetDirectory, final Path[0m [2m                [0m
[2;36m                    [0m         [39mpath, final String context[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [39m    final Path normalizedTarget = [0m[1;35mtargetDirectory.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [39m    final Path normalizedPath = [0m[1;35mpath.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39m![0m[1;35mnormalizedPath.startsWith[0m[1;39m([0m[39mnormalizedTarget[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [39m        throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip via %s: '%s' -> '%s'"[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39mcontext, targetDirectory, path[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis helper provides consistent validation logic across all vulnerable points.[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### [0m[1;36m2[0m[39m. Fix the `createParentDirectory` Method[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mModify the `createParentDirectory` method to validate symlink targets after [0m        [2m                [0m
[2;36m                    [0m         [39mresolution:[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAt line [0m[1;36m516[0m[39m-[0m[1;36m517[0m[39m, after `current = [0m[1;35mFiles.readSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m;`, add [0m           [2m                [0m
[2;36m                    [0m         [39mvalidation:[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m    current = [0m[1;35mFiles.readSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Validate that the symlink target is within root bounds[0m                       [2m                [0m
[2;36m                    [0m         [39m    final Path normalizedRoot = [0m[1;35mroot.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [39m    final Path normalizedCurrent = [0m[1;35mcurrent.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39m![0m[1;35mnormalizedCurrent.startsWith[0m[1;39m([0m[39mnormalizedRoot[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [39m        throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Symlink points outside target [0m         [2m                [0m
[2;36m                    [0m         [32mdirectory: '%s' -> '%s'"[0m[39m, root, current[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis ensures that following any symlink keeps us within the extraction target [0m      [2m                [0m
[2;36m                    [0m         [39mdirectory.[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### [0m[1;36m3[0m[39m. Validate Symlink Targets in `[0m[1;35mexpand[0m[1;39m([0m[39mZipFile, Path[0m[1;39m)[0m[39m`[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mFor symlink entry handling, after line [0m[1;36m481[0m[39m, add validation:[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mPath target = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[39mtargetName[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Validate symlink target is within bounds[0m                                         [2m                [0m
[2;36m                    [0m         [1;35mvalidatePathWithinTarget[0m[1;39m([0m[39mtargetDirectory, target, [0m[32m"symlink target"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis prevents creating symlinks that point outside the target directory.[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### [0m[1;36m4[0m[39m. Validate Parent Path After `createParentDirectory`[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mFor regular file handling, after line [0m[1;36m496[0m[39m, add validation:[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mPath parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, target[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Validate that createParentDirectory didn't escape via symlinks[0m                   [2m                [0m
[2;36m                    [0m         [1;35mvalidatePathWithinTarget[0m[1;39m([0m[39mtargetDirectory, parent, [0m[32m"parent directory"[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### [0m[1;36m5[0m[39m. Re-validate Reconstructed Path[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter line [0m[1;36m499[0m[39m where the path is reconstructed, add re-validation:[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mtarget = [0m[1;35mparent.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.resolve[0m[1;39m([0m[1;35mtarget.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Re-validate the reconstructed target path[0m                                        [2m                [0m
[2;36m                    [0m         [1;35mvalidatePathWithinTarget[0m[1;39m([0m[39mtargetDirectory, target, [0m[32m"reconstructed path"[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis ensures the final path used for file writing is within bounds.[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Preserved Functionality[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis fix strategy preserves:[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Symlink support**: Symlinks within the target directory continue to work as [0m   [2m                [0m
[2;36m                    [0m         [39mexpected [0m[1;39m([0m[39mtestSymLinks test will pass[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Path traversal protection**: All existing path traversal tests will continue [0m  [2m                [0m
[2;36m                    [0m         [39mto pass[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Directory creation behavior**: The symlink-following behavior for directory [0m   [2m                [0m
[2;36m                    [0m         [39mcreation is maintained, but only for symlinks within bounds[0m                         [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Error messages**: Consistent [0m[32m"Zip slip"[0m[39m error messages for all validation [0m     [2m                [0m
[2;36m                    [0m         [39mfailures[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Justification[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis approach is optimal because:[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Minimal changes**: Only adds validation without changing the core logic[0m        [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Defense in depth**: Multiple validation points ensure no path can escape[0m       [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Backward compatible**: Legitimate symlinks within the target directory [0m        [2m                [0m
[2;36m                    [0m         [39mcontinue to work[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Consistent with existing code**: Uses the same validation pattern as [0m          [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mArchiveEntry.resolveIn[0m[1;39m([0m[1;39m)[0m[39m`[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Test suite compliant**: Both security tests and functionality tests will pass[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Side Effects and Mitigation[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential side effects:**[0m                                                         [2m                [0m
[2;36m                    [0m         [39m- Archives with symlinks pointing outside the target directory will now fail [0m[1;39m([0m[39mthis [0m [2m                [0m
[2;36m                    [0m         [39mis the intended security fix[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [39m- Slightly increased processing time due to additional path validation [0m[1;39m([0m[39mnegligible [0m [2m                [0m
[2;36m                    [0m         [39mimpact[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Mitigation:**[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m- The error messages clearly indicate [0m[32m"Zip slip"[0m[39m attempts, helping users understand[0m [2m                [0m
[2;36m                    [0m         [39mwhy extraction failed[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Documentation should be updated to note that external symlinks are not supported [0m [2m                [0m
[2;36m                    [0m         [39mfor security reasons[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Alternative Approaches Considered[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Alternative [0m[1;36m1[0m[39m**: Replace the entire ZipFile expand implementation to use the [0m     [2m                [0m
[2;36m                    [0m         [39mgeneric expand method[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- **Pros**: Simpler, more maintainable[0m                                              [2m                [0m
[2;36m                    [0m         [39m- **Cons**: Would break the testSymLinks test, changing expected behavior[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Alternative [0m[1;36m2[0m[39m**: Disable symlink following entirely[0m                               [2m                [0m
[2;36m                    [0m         [39m- **Pros**: Maximum security[0m                                                        [2m                [0m
[2;36m                    [0m         [39m- **Cons**: Breaks legitimate use cases, fails testSymLinks test[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe chosen approach balances security with functionality preservation.[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=843335;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=206901;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=552362;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=401643;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp3qyx6dmt[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/apache-commons-compress_cc-de[0m [2m               [0m
[2;36m                    [0m         [35mlta-07_vuln_8/[0m[95magent-output-1767700480.4448514[0m                                        [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/apache-commons-compress_cc-delta-07_vuln_8.toml       [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-commons-compress[0m [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/06/26 11:54:42][0m[2;36m [0m[34mINFO    [0m Deleting environments directory:                                                     ]8;id=153394;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=363631;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/.cache/environments/[0m[95mapache-commons-compress[0m                         [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=445178;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=715993;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mapache-commons-compre[0m [2m               [0m
[2;36m                    [0m         [95mss[0m                                                                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=462269;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=90842;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mapache-commons-compres[0m [2m               [0m
[2;36m                    [0m         [95ms[0m                                                                                    [2m               [0m
