[2;36m[01/06/26 16:32:34][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=507648;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=417721;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpxh7__s1r[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/libexif_ex-delta-03_exif-002/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1767717154.8787584[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/libexif_ex-delta-03_exif-[1;36m002.[0mtoml                     [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-libexif[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Building Cached for CLEAN environment[1m)[0m           ]8;id=491908;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=112168;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[01/06/26 16:33:02][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Building Cached for CLEAN environment[1m)[0m Took     ]8;id=59189;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=579842;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m27.94[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=524108;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=762719;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Running tests for Cached for CLEAN environment[1m)[0m ]8;id=270011;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=342914;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=922468;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=656522;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m27[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=987703;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=649467;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 16:33:03][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.83[0m seconds;               ]8;id=957666;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=360704;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/06/26 16:33:04][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=895518;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=767923;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=667371;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=884352;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=976108;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=109694;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=847597;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=100297;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 16:33:05][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.85[0m seconds;               ]8;id=659200;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=847494;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=764888;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=698865;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.76[0m seconds;               ]8;id=113265;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=724790;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/06/26 16:33:08][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=113633;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=958068;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mexif_from_data_fuzzer[0m                                                      [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer exif_from_data_fuzzer -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                              [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m       [2m                [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3137944059[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m2866[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m2866[0m[39m [0m[1;39m[[0m[1;36m0x55d9c193e738[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55d9c193f26a[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m2866[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m2866[0m[39m [0m[1;39m[[0m[1;36m0x55d9c193f270[0m[39m,[0m[1;36m0x55d9c194a590[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                      [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x51100000024f[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55d9c1818ff2[0m[39m bp [0m[1;36m0x7ffe0d630e20[0m[39m sp [0m[1;36m0x7ffe0d6305e0[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m16[0m[39m at [0m[1;36m0x51100000024f[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m26[0m[39m [0m[1;39m([0m[39mmulti-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d9c1818ff1[0m[39m in __asan_memcpy [0m                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_interceptors_memintrinsics.cpp[0m[39m:[0m[1;92m63:3[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d9c185f219[0m[39m in exif_data_load_data_entry [0m                                 [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m213:3[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d9c185f219[0m[39m in exif_data_load_data_content [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m531:8[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d9c185dd45[0m[39m in exif_data_load_data [0m[35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m984:2[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d9c185d36e[0m[39m in exif_data_new_from_data [0m                                   [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m159:2[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d9c185a8af[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_from_data_fuzzer.cc[0m[39m:[0m[1;92m51:16[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d9c170f330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d9c16fa5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d9c170003f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d9c172b2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7fb8cc822082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55d9c16f278d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mexif_from_data_fuzzer+0x8678d[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __asan_memcpy--exif_data_load_data_entry--exif_data_load_data_content[0m  [2m                [0m
[2;36m                    [0m         [1;36m0x51100000024f[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m207[0m[39m-byte region [0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x511000000180[0m[39m,[0m[1;36m0x51100000024f[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d9c181b0ff[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d9c1898093[0m[39m in operator [0m[1;35mnew[0m[1;39m([0m[39munsigned long[0m[1;39m)[0m[39m cxa_noexception.cpp[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d9c16fa5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d9c170003f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d9c172b2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x7fb8cc822082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--operator [0m[1;35mnew[0m[1;39m([0m[39munsigned [0m                           [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m--fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned long[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m213:3[0m[39m in exif_data_load_data_entry[0m                 [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x510fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000000[0m[39m: fa fa fa fa fa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000080[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000100[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m07[0m[39m fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000180[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x511000000200[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m07[0m[1;39m][0m[39mfa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000400[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000480[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpiibfzzcj[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mexif_from_data_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mexif_from_data_fuzzer[0m                                                      [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer exif_from_data_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                              [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3137944059[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m2866[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m2866[0m[39m [0m[1;39m[[0m[1;36m0x55d9c193e738[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55d9c193f26a[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m2866[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m2866[0m[39m [0m[1;39m[[0m[1;36m0x55d9c193f270[0m[39m,[0m[1;36m0x55d9c194a590[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                      [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x51100000024f[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55d9c1818ff2[0m[39m bp [0m[1;36m0x7ffe0d630e20[0m[39m sp [0m[1;36m0x7ffe0d6305e0[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m16[0m[39m at [0m[1;36m0x51100000024f[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m26[0m[39m [0m[1;39m([0m[39mmulti-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d9c1818ff1[0m[39m in __asan_memcpy [0m                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_interceptors_memintrinsics.cpp[0m[39m:[0m[1;92m63:3[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d9c185f219[0m[39m in exif_data_load_data_entry [0m                                 [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m213:3[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d9c185f219[0m[39m in exif_data_load_data_content [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m531:8[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d9c185dd45[0m[39m in exif_data_load_data [0m[35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m984:2[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d9c185d36e[0m[39m in exif_data_new_from_data [0m                                   [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m159:2[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d9c185a8af[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_from_data_fuzzer.cc[0m[39m:[0m[1;92m51:16[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d9c170f330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d9c16fa5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d9c170003f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d9c172b2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7fb8cc822082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55d9c16f278d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mexif_from_data_fuzzer+0x8678d[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __asan_memcpy--exif_data_load_data_entry--exif_data_load_data_content[0m  [2m                [0m
[2;36m                    [0m         [1;36m0x51100000024f[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m207[0m[39m-byte region [0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x511000000180[0m[39m,[0m[1;36m0x51100000024f[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d9c181b0ff[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d9c1898093[0m[39m in operator [0m[1;35mnew[0m[1;39m([0m[39munsigned long[0m[1;39m)[0m[39m cxa_noexception.cpp[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d9c16fa5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d9c170003f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d9c172b2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x7fb8cc822082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--operator [0m[1;35mnew[0m[1;39m([0m[39munsigned [0m                           [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m--fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned long[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m213:3[0m[39m in exif_data_load_data_entry[0m                 [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x510fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000000[0m[39m: fa fa fa fa fa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000080[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000100[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m07[0m[39m fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000180[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x511000000200[0m: [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m07[0m[1m][0mfa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x511000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x511000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x511000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x511000000400[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x511000000480[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                [2m                [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                       [2m                [0m
[2;36m                    [0m           Heap left redzone:       fa                                                       [2m                [0m
[2;36m                    [0m           Freed heap region:       fd                                                       [2m                [0m
[2;36m                    [0m           Stack left redzone:      f1                                                       [2m                [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                       [2m                [0m
[2;36m                    [0m           Stack right redzone:     f3                                                       [2m                [0m
[2;36m                    [0m           Stack after return:      f5                                                       [2m                [0m
[2;36m                    [0m           Stack use after scope:   f8                                                       [2m                [0m
[2;36m                    [0m           Global redzone:          f9                                                       [2m                [0m
[2;36m                    [0m           Global init order:       f6                                                       [2m                [0m
[2;36m                    [0m           Poisoned by user:        f7                                                       [2m                [0m
[2;36m                    [0m           Container overflow:      fc                                                       [2m                [0m
[2;36m                    [0m           Array cookie:            ac                                                       [2m                [0m
[2;36m                    [0m           Intra object redzone:    bb                                                       [2m                [0m
[2;36m                    [0m           ASan internal:           fe                                                       [2m                [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                       [2m                [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                       [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                      [2m                [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                               [2m                [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64 [2m                [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                    [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m:[35m/[0m[95mout[0m -v       [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpiibfzzcj[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce     [2m                [0m
[2;36m                    [0m         exif_from_data_fuzzer -[33mruns[0m=[1;36m100[0m.                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/06/26 16:33:30][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=173985;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=172078;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/06/26 16:39:03][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=349859;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=935912;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/06/26 16:39:43][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=418682;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=68361;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=592930;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=75934;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 16:39:44][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.93[0m seconds;               ]8;id=640536;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=566907;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Patching[1m)[0m Started[33m...[0m                             ]8;id=382474;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=221086;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpcl5a60og[0m                                                 ]8;id=686502;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=190081;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/06/26 16:40:09][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Patching[1m)[0m Took [1;36m25.29[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=322539;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=187387;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Checking build[1m)[0m Started[33m...[0m                       ]8;id=303735;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=766270;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 16:40:13][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Checking build[1m)[0m Took [1;36m3.95[0m seconds;              ]8;id=117479;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=478282;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Running PoV[1m)[0m Started[33m...[0m                          ]8;id=885222;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=72974;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 16:40:15][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Running PoV[1m)[0m Took [1;36m2.06[0m seconds; [33mexception[0m=[3;91mFalse[0m ]8;id=326820;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=23709;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Testing[1m)[0m Started[33m...[0m                              ]8;id=188546;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=776329;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m     ]8;id=605832;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=380147;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=861594;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=780797;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 16:40:16][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.88[0m seconds;               ]8;id=953485;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=788985;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/06/26 16:40:17][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=163922;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=177779;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 16:40:18][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.89[0m seconds;               ]8;id=463556;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=483672;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=923999;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=841597;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 16:40:19][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.92[0m seconds;               ]8;id=107668;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=873820;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=278258;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=608628;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/libexif/exif-data.c                                                           [2m                [0m
[2;36m                    [0m         +++ b/libexif/exif-data.c                                                           [2m                [0m
[2;36m                    [0m         @@ [1;36m-921[0m,[1;36m6[0m +[1;36m921[0m,[1;36m11[0m @@                                                                [2m                [0m
[2;36m                    [0m                         d++;                                                                [2m                [0m
[2;36m                    [0m                         ds--;                                                               [2m                [0m
[2;36m                    [0m                         len = [1m([0m[1m([0m[1m([0munsigned int[1m)[0md[1m[[0m[1;36m0[0m[1m][0m[1m)[0m [1m<[0m[39m< [0m[1;36m8[0m[1;39m)[0m[39m | d[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[39mif [0m[1;39m([0m[39mlen < [0m[1;36m2[0m[39m || len > ds[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m      [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifData"[0m[39m, [0m[1;35m_[0m[1;39m([0m[32m"Size of EXIF data [0m[32m([0m[32m%u[0m[32m)[0m[32m is invalid [0m [2m                [0m
[2;36m                    [0m         [32mor exceeds buffer [0m[32m([0m[32m%u[0m[32m)[0m[32m."[0m[1;39m)[0m[39m, len, ds[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[39m        [0m[39mreturn;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"We have to deal with %i byte[0m[32m([0m[32ms[0m[32m)[0m[32m of EXIF data."[0m[39m,[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39m        [0m[39m        [0m[39m  len[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mexif_from_data_fuzzer[0m                                                      [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer exif_from_data_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                              [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3137944059[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m2866[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m2866[0m[39m [0m[1;39m[[0m[1;36m0x55d9c193e738[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55d9c193f26a[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m2866[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m2866[0m[39m [0m[1;39m[[0m[1;36m0x55d9c193f270[0m[39m,[0m[1;36m0x55d9c194a590[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                      [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x51100000024f[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55d9c1818ff2[0m[39m bp [0m[1;36m0x7ffe0d630e20[0m[39m sp [0m[1;36m0x7ffe0d6305e0[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m16[0m[39m at [0m[1;36m0x51100000024f[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m26[0m[39m [0m[1;39m([0m[39mmulti-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d9c1818ff1[0m[39m in __asan_memcpy [0m                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_interceptors_memintrinsics.cpp[0m[39m:[0m[1;92m63:3[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d9c185f219[0m[39m in exif_data_load_data_entry [0m                                 [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m213:3[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d9c185f219[0m[39m in exif_data_load_data_content [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m531:8[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d9c185dd45[0m[39m in exif_data_load_data [0m[35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m984:2[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d9c185d36e[0m[39m in exif_data_new_from_data [0m                                   [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m159:2[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d9c185a8af[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_from_data_fuzzer.cc[0m[39m:[0m[1;92m51:16[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d9c170f330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d9c16fa5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d9c170003f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d9c172b2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7fb8cc822082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55d9c16f278d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mexif_from_data_fuzzer+0x8678d[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __asan_memcpy--exif_data_load_data_entry--exif_data_load_data_content[0m  [2m                [0m
[2;36m                    [0m         [1;36m0x51100000024f[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m207[0m[39m-byte region [0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x511000000180[0m[39m,[0m[1;36m0x51100000024f[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d9c181b0ff[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d9c1898093[0m[39m in operator [0m[1;35mnew[0m[1;39m([0m[39munsigned long[0m[1;39m)[0m[39m cxa_noexception.cpp[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d9c16fa5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d9c170003f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d9c172b2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x7fb8cc822082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--operator [0m[1;35mnew[0m[1;39m([0m[39munsigned [0m                           [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m--fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned long[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m213:3[0m[39m in exif_data_load_data_entry[0m                 [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x510fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000000[0m[39m: fa fa fa fa fa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000080[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000100[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m07[0m[39m fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000180[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x511000000200[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m07[0m[1;39m][0m[39mfa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000400[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000480[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpiibfzzcj[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mexif_from_data_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA heap-buffer-overflow vulnerability has been detected in libexif during fuzzing [0m   [2m                [0m
[2;36m                    [0m         [39moperations. The issue occurs in the `exif_data_load_data_entry` function when [0m      [2m                [0m
[2;36m                    [0m         [39mprocessing EXIF data, resulting in a READ operation of [0m[1;36m16[0m[39m bytes beyond the [0m         [2m                [0m
[2;36m                    [0m         [39mallocated buffer boundary. The overflow happens at address [0m[1;36m0x51100000024f[0m[39m, which is[0m [2m                [0m
[2;36m                    [0m         [39mlocated immediately after a [0m[1;36m207[0m[39m-byte allocated region.[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Vulnerability Type[0m                                                              [2m                [0m
[2;36m                    [0m         [39mThis is a **heap-buffer-overflow** vulnerability with a SCARINESS score of [0m[1;36m26[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [39mclassified as a multi-byte-read-heap-buffer-overflow. The issue involves an [0m        [2m                [0m
[2;36m                    [0m         [39mout-of-bounds read operation rather than a write operation.[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Issue Details[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mThe vulnerability manifests when the AddressSanitizer [0m[1;39m([0m[39mASan[0m[1;39m)[0m[39m detects an attempt to [0m [2m                [0m
[2;36m                    [0m         [39mread [0m[1;36m16[0m[39m bytes starting at address [0m[1;36m0x51100000024f[0m[39m. This address is precisely at the [0m [2m                [0m
[2;36m                    [0m         [39mboundary of an allocated heap region:[0m                                               [2m                [0m
[2;36m                    [0m         [39m- Allocated region: [0m[1;39m[[0m[1;36m0x511000000180[0m[39m, [0m[1;36m0x51100000024f[0m[1;39m)[0m[39m - [0m[1;36m207[0m[39m bytes[0m                    [2m                [0m
[2;36m                    [0m         [39m- Overflow location: [0m[1;36m0x51100000024f[0m[39m [0m[1;39m([0m[1;36m0[0m[39m bytes after the allocated region[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe shadow byte analysis shows the memory region has a value of `[0m[1;36m07[0m[39m` at the [0m        [2m                [0m
[2;36m                    [0m         [39moverflow location, indicating the address is only partially addressable [0m[1;39m([0m[1;36m7[0m[39m out of [0m[1;36m8[0m [2m                [0m
[2;36m                    [0m         [39mbytes[0m[1;39m)[0m[39m.[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Call Stack Analysis[0m                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability is triggered through the following call chain:[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Entry Point**: `LLVMFuzzerTestOneInput` in [0m                                    [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/[0m[95mexif_from_data_fuzzer.cc[0m[39m:[0m[1;92m51:16[0m[39m` [0m[1;39m([0m[39mfuzzer harness[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **API Call**: `exif_data_new_from_data` in [0m                                      [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m159:2[0m[39m`[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Processing**: `exif_data_load_data` in [0m                                        [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m984:2[0m[39m`[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Content Loading**: `exif_data_load_data_content` in [0m                           [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m531:8[0m[39m`[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Vulnerable Function**: `exif_data_load_data_entry` in [0m                         [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m213:3[0m[39m`[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Overflow Point**: `__asan_memcpy` attempting to copy [0m[1;36m16[0m[39m bytes[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Key Observations[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Memory Operation**: The overflow occurs during a `memcpy` operation within [0m    [2m                [0m
[2;36m                    [0m         [39m`exif_data_load_data_entry`, suggesting the code is attempting to copy data from a [0m [2m                [0m
[2;36m                    [0m         [39mbuffer without proper bounds checking.[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Data Size Mismatch**: The attempt to read [0m[1;36m16[0m[39m bytes when only [0m[1;36m207[0m[39m bytes were [0m   [2m                [0m
[2;36m                    [0m         [39mallocated [0m[1;39m([0m[39mand all appear to be consumed[0m[1;39m)[0m[39m indicates a potential issue with:[0m         [2m                [0m
[2;36m                    [0m         [39m   - Incorrect size calculations when parsing EXIF data structures[0m                  [2m                [0m
[2;36m                    [0m         [39m   - Missing validation of data lengths from untrusted input[0m                        [2m                [0m
[2;36m                    [0m         [39m   - Improper handling of entry data sizes[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Location in Processing Pipeline**: The vulnerability occurs deep in the EXIF [0m  [2m                [0m
[2;36m                    [0m         [39mdata parsing pipeline, specifically when loading individual data entries, [0m          [2m                [0m
[2;36m                    [0m         [39msuggesting the issue relates to parsing field-level data rather than higher-level [0m  [2m                [0m
[2;36m                    [0m         [39mstructure parsing.[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas for Investigation[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo understand the full scope of this vulnerability, the following components should[0m [2m                [0m
[2;36m                    [0m         [39mbe examined:[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **exif-data.c [0m[1;39m([0m[39mPrimary Focus[0m[1;39m)[0m[39m**:[0m                                                 [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m213[0m[39m: The specific `memcpy` operation in `exif_data_load_data_entry`[0m       [2m                [0m
[2;36m                    [0m         [39m   - The logic determining the size parameter for the memory copy operation[0m         [2m                [0m
[2;36m                    [0m         [39m   - How entry sizes are calculated and validated[0m                                   [2m                [0m
[2;36m                    [0m         [39m   - The relationship between the parsed data structure and actual buffer bounds[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Data Entry Processing**:[0m                                                       [2m                [0m
[2;36m                    [0m         [39m   - How `exif_data_load_data_entry` interprets size fields from EXIF data[0m          [2m                [0m
[2;36m                    [0m         [39m   - Validation mechanisms [0m[1;39m([0m[39mor lack thereof[0m[1;39m)[0m[39m for entry data lengths[0m                 [2m                [0m
[2;36m                    [0m         [39m   - The structure and format expectations for EXIF entries[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Buffer Allocation**:[0m                                                           [2m                [0m
[2;36m                    [0m         [39m   - The origin of the [0m[1;36m207[0m[39m-byte buffer allocation[0m                                   [2m                [0m
[2;36m                    [0m         [39m   - Whether this size is derived from input data or predetermined[0m                  [2m                [0m
[2;36m                    [0m         [39m   - Memory management patterns for EXIF data structures[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Input Validation**:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m   - Entry point validation in `exif_data_new_from_data`[0m                            [2m                [0m
[2;36m                    [0m         [39m   - Size checks in `exif_data_load_data` and `exif_data_load_data_content`[0m         [2m                [0m
[2;36m                    [0m         [39m   - Trust boundaries and assumptions about input data integrity[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fuzzer harness [0m[1;39m([0m[39m`exif_from_data_fuzzer.cc`[0m[1;39m)[0m[39m serves as the entry point for [0m      [2m                [0m
[2;36m                    [0m         [39mtesting but is not the source of the vulnerability; it simply provides crafted [0m     [2m                [0m
[2;36m                    [0m         [39minput data that exposes the underlying buffer overflow in the EXIF parsing logic.[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mexif_from_data_fuzzer[0m                                                      [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer exif_from_data_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                              [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3137944059[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m2866[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m2866[0m[39m [0m[1;39m[[0m[1;36m0x55d9c193e738[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55d9c193f26a[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m2866[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m2866[0m[39m [0m[1;39m[[0m[1;36m0x55d9c193f270[0m[39m,[0m[1;36m0x55d9c194a590[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                      [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x51100000024f[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55d9c1818ff2[0m[39m bp [0m[1;36m0x7ffe0d630e20[0m[39m sp [0m[1;36m0x7ffe0d6305e0[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m16[0m[39m at [0m[1;36m0x51100000024f[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m26[0m[39m [0m[1;39m([0m[39mmulti-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d9c1818ff1[0m[39m in __asan_memcpy [0m                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_interceptors_memintrinsics.cpp[0m[39m:[0m[1;92m63:3[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d9c185f219[0m[39m in exif_data_load_data_entry [0m                                 [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m213:3[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d9c185f219[0m[39m in exif_data_load_data_content [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m531:8[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d9c185dd45[0m[39m in exif_data_load_data [0m[35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m984:2[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d9c185d36e[0m[39m in exif_data_new_from_data [0m                                   [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m159:2[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d9c185a8af[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_from_data_fuzzer.cc[0m[39m:[0m[1;92m51:16[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d9c170f330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d9c16fa5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d9c170003f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d9c172b2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7fb8cc822082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55d9c16f278d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mexif_from_data_fuzzer+0x8678d[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __asan_memcpy--exif_data_load_data_entry--exif_data_load_data_content[0m  [2m                [0m
[2;36m                    [0m         [1;36m0x51100000024f[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m207[0m[39m-byte region [0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x511000000180[0m[39m,[0m[1;36m0x51100000024f[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d9c181b0ff[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d9c1898093[0m[39m in operator [0m[1;35mnew[0m[1;39m([0m[39munsigned long[0m[1;39m)[0m[39m cxa_noexception.cpp[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d9c16fa5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d9c170003f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d9c172b2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x7fb8cc822082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--operator [0m[1;35mnew[0m[1;39m([0m[39munsigned [0m                           [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m--fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned long[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m213:3[0m[39m in exif_data_load_data_entry[0m                 [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x510fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000000[0m[39m: fa fa fa fa fa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000080[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000100[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m07[0m[39m fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000180[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x511000000200[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m07[0m[1;39m][0m[39mfa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000400[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000480[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpiibfzzcj[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mexif_from_data_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:1[0m[39m-[0m[1;36m10[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* exif-data.c[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * Copyright [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;36m2001[0m[39m Lutz Mueller <lutz@users.sourceforge.net>[0m                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * This library is free software; you can redistribute it and/or[0m                  [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * modify it under the terms of the GNU Lesser General Public[0m                     [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * License as published by the Free Software Foundation; either[0m                   [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * version [0m[1;36m2[0m[39m of the License, or [0m[1;39m([0m[39mat your option[0m[1;39m)[0m[39m any later version.[0m               [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: * This library is distributed in the hope that it will be useful,[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:163[0m[39m-[0m[1;36m217[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:static int[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;92m164:e[0m[39mxif_data_load_data_entry [0m[1;39m([0m[39mExifData *data, ExifEntry *entry,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:    [0m[39m        [0m[39m        [0m[39m   const unsigned char *d,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:    [0m[39m        [0m[39m        [0m[39m   unsigned int size, unsigned int offset[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    [0m[39munsigned int s, doff;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:    [0m[39mentry->tag        = exif_get_short [0m[1;39m([0m[39md + offset + [0m[1;36m0[0m[39m, data->priv->order[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:    [0m[39mentry->format     = exif_get_short [0m[1;39m([0m[39md + offset + [0m[1;36m2[0m[39m, data->priv->order[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:    [0m[39mentry->components = exif_get_long  [0m[1;39m([0m[39md + offset + [0m[1;36m4[0m[39m, data->priv->order[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:    [0m[35m/[0m[39m* FIXME: should use exif_tag_get_name_in_ifd here but entry->parent [0m       [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[39m * has not been set yet[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:    [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    [0m[39m        [0m[39m  [0m[32m"Loading entry 0x%x [0m[32m([0m[32m'%s'[0m[32m)[0m[32m..."[0m[39m, entry->tag,[0m                       [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:    [0m[39m        [0m[39m  exif_tag_get_name [0m[1;39m([0m[39mentry->tag[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:    [0m[35m/[0m[39m* [0m[1;39m{[0m[1;36m0[0m[39m,[0m[1;36m1[0m[39m,[0m[1;36m2[0m[39m,[0m[1;36m4[0m[39m,[0m[1;36m8[0m[1;39m}[0m[39m x [0m[1;39m{[0m[39m [0m[1;36m0x00000000[0m[39m .. [0m[1;36m0xffffffff[0m[39m [0m[1;39m}[0m[39m [0m                              [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:    [0m[39m *   -> [0m[1;39m{[0m[39m [0m[1;36m0x000000000[0m[39m .. [0m[1;36m0x7fffffff8[0m[39m [0m[1;39m}[0m[39m *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:    [0m[39ms = [0m[1;35mexif_format_get_size[0m[1;39m([0m[39mentry->format[0m[1;39m)[0m[39m * entry->components;[0m                [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:    [0m[39mif [0m[1;39m([0m[1;39m([0m[39ms < entry->components[0m[1;39m)[0m[39m || [0m[1;39m([0m[39ms == [0m[1;36m0[0m[1;39m)[0m[1;39m)[0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    [0m[35m/[0m[39m*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:    [0m[39m * Size? If bigger than [0m[1;36m4[0m[39m bytes, the actual data is not[0m                     [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:    [0m[39m * in the entry but somewhere else [0m[1;39m([0m[39moffset[0m[1;39m)[0m[39m.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:    [0m[39mif [0m[1;39m([0m[39ms > [0m[1;36m4[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:    [0m[39m        [0m[39mdoff = exif_get_long [0m[1;39m([0m[39md + offset + [0m[1;36m8[0m[39m, data->priv->order[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:    [0m[39melse[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:    [0m[39m        [0m[39mdoff = offset + [0m[1;36m8[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:    [0m[35m/[0m[39m* Sanity checks *[0m[35m/[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:    [0m[39mif [0m[1;39m([0m[39mdoff >= size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"Tag starts past end of buffer [0m[32m([0m[32m%u > %u[0m[32m)[0m[32m"[0m[39m, doff, [0m [2m                [0m
[2;36m                    [0m         [39msize[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:    [0m[39mif [0m[1;39m([0m[39ms > size - doff[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"Tag data goes past end of buffer [0m[32m([0m[32m%u > %u[0m[32m)[0m[32m"[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mdoff+s, size[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:    [0m[39mentry->data = exif_data_alloc [0m[1;39m([0m[39mdata, s[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:    [0m[39mif [0m[1;39m([0m[39mentry->data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:    [0m[39m        [0m[39mentry->size = s;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    [0m[39m        [0m[39mmemcpy [0m[1;39m([0m[39mentry->data, d + doff, s[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    [0m[39m        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mdata->priv->log, [0m[32m"ExifData"[0m[39m, s[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:51[0m[39m-[0m[1;36m52[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:#define [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset,datasize,structsize[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39m offset >= datasize[0m[1;39m)[0m[39m || [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstructsize > datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset > datasize - structsize [0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:843[0m[39m-[0m[1;36m866[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m843[0m[39m:void[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;92m844:e[0m[39mxif_data_load_data [0m[1;39m([0m[39mExifData *data, const unsigned char *d_orig,[0m               [2m                [0m
[2;36m                    [0m         [1;36m845[0m[39m:    [0m[39m        [0m[39m     unsigned int ds[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m846[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m847[0m[39m:    [0m[39munsigned int l;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m848[0m[39m:    [0m[39mExifLong offset;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m849[0m[39m:    [0m[39mExifShort n;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m850[0m[39m:    [0m[39mconst unsigned char *d = d_orig;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m851[0m[39m:    [0m[39munsigned int len, fullds;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m852[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m853[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!data || !data->priv || !d || !ds[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m854[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m855[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m856[0m[39m:    [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m857[0m[39m:    [0m[39m        [0m[39m  [0m[32m"Parsing %i byte[0m[32m([0m[32ms[0m[32m)[0m[32m EXIF data...\n"[0m[39m, ds[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m858[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m859[0m[39m:    [0m[35m/[0m[39m*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m860[0m[39m:    [0m[39m * It can be that the data starts with the EXIF header. If it does[0m          [2m                [0m
[2;36m                    [0m         [1;36m861[0m[39m:    [0m[39m * not, search the EXIF marker.[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m862[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m863[0m[39m:    [0m[39mif [0m[1;39m([0m[39mds < [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m864[0m[39m:    [0m[39m        [0m[39mLOG_TOO_SMALL;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m865[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m866[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:928[0m[39m-[0m[1;36m958[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m928[0m[39m:    [0m[39m        [0m[39mds = len - [0m[1;36m2[0m[39m;   [0m[35m/[0m[39m* we do not want the full rest size, but only the [0m [2m                [0m
[2;36m                    [0m         [39msize of the tag *[0m[35m/[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m929[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m930[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m931[0m[39m:    [0m[35m/[0m[39m*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m932[0m[39m:    [0m[39m * Verify the exif header[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m933[0m[39m:    [0m[39m * [0m[1;39m([0m[39moffset [0m[1;36m2[0m[39m, length [0m[1;36m6[0m[1;39m)[0m[39m.[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m934[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m935[0m[39m:    [0m[39mif [0m[1;39m([0m[39mds < [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m936[0m[39m:    [0m[39m        [0m[39mLOG_TOO_SMALL;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m937[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m938[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m939[0m[39m:    [0m[39mif [0m[1;39m([0m[39mmemcmp [0m[1;39m([0m[39md, ExifHeader, [0m[1;36m6[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m940[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m941[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifData"[0m[39m, [0m[1;35m_[0m[1;39m([0m[32m"EXIF header not found."[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m942[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m943[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m944[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m945[0m[39m:    [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m946[0m[39m:    [0m[39m        [0m[39m  [0m[32m"Found EXIF header."[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m947[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m948[0m[39m:    [0m[35m/[0m[39m* Sanity check the data length *[0m[35m/[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m949[0m[39m:    [0m[39mif [0m[1;39m([0m[39mds < [0m[1;36m14[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m950[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m951[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m952[0m[39m:    [0m[35m/[0m[39m* The JPEG APP1 section can be no longer than [0m[1;36m64[0m[39m KiB [0m[1;39m([0m[39mincluding a[0m          [2m                [0m
[2;36m                    [0m         [1;36m953[0m[39m:    [0m[39m   [0m[1;36m16[0m[39m-bit length[0m[1;39m)[0m[39m, so cap the data length to protect against overflow[0m       [2m                [0m
[2;36m                    [0m         [1;36m954[0m[39m:    [0m[39m   in future offset calculations *[0m[35m/[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m955[0m[39m:    [0m[39mfullds = ds;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m956[0m[39m:    [0m[39mif [0m[1;39m([0m[39mds > [0m[1;36m0xfffe[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m957[0m[39m:    [0m[39m        [0m[39mds = [0m[1;36m0xfffe[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m958[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:974[0m[39m-[0m[1;36m984[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m974[0m[39m:    [0m[35m/[0m[39m* IFD [0m[1;36m0[0m[39m offset *[0m[35m/[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m975[0m[39m:    [0m[39moffset = exif_get_long [0m[1;39m([0m[39md + [0m[1;36m10[0m[39m, data->priv->order[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m976[0m[39m:    [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m, [0m                [2m                [0m
[2;36m                    [0m         [1;36m977[0m[39m:    [0m[39m        [0m[39m  [0m[32m"IFD 0 at %i."[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m offset[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m978[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m979[0m[39m:    [0m[35m/[0m[39m* ds is restricted to [0m[1;36m16[0m[39m bit above, so offset is restricted too, and [0m      [2m                [0m
[2;36m                    [0m         [39moffset+[0m[1;36m8[0m[39m should not overflow. *[0m[35m/[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m980[0m[39m:    [0m[39mif [0m[1;39m([0m[39moffset > ds || offset + [0m[1;36m6[0m[39m + [0m[1;36m2[0m[39m > ds[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m981[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m982[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m983[0m[39m:    [0m[35m/[0m[39m* Parse the actual exif data [0m[1;39m([0m[39musually offset [0m[1;36m14[0m[39m from start[0m[1;39m)[0m[39m *[0m[35m/[0m             [2m                [0m
[2;36m                    [0m         [1;36m984[0m[39m:    [0m[39mexif_data_load_data_content [0m[1;39m([0m[39mdata, EXIF_IFD_0, d + [0m[1;36m6[0m[39m, ds - [0m[1;36m6[0m[39m, offset, [0m[1;36m0[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:390[0m[39m-[0m[1;36m441[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m391:e[0m[39mxif_data_load_data_content [0m[1;39m([0m[39mExifData *data, ExifIfd ifd,[0m                       [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[39m        [0m[39m        [0m[39m     const unsigned char *d,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    [0m[39m        [0m[39m        [0m[39m     unsigned int ds, unsigned int offset, unsigned int [0m    [2m                [0m
[2;36m                    [0m         [39mrecursion_cost[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:    [0m[39mExifLong o, thumbnail_offset = [0m[1;36m0[0m[39m, thumbnail_length = [0m[1;36m0[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:    [0m[39mExifShort n;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m397[0m[39m:    [0m[39mExifEntry *entry;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:    [0m[39munsigned int i;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:    [0m[39mExifTag tag;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!data || !data->priv[0m[1;39m)[0m[39m [0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:    [0m[35m/[0m[39m* check for valid ExifIfd enum range *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:    [0m[39mif [0m[1;39m([0m[1;39m([0m[1;39m([0m[1;39m([0m[39mint[0m[1;39m)[0m[39mifd[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m || [0m[1;39m([0m[39m [0m[1;39m([0m[1;39m([0m[39mint[0m[1;39m)[0m[39mifd[0m[1;39m)[0m[39m >= EXIF_IFD_COUNT[0m[1;39m)[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:    [0m[39m  return;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:    [0m[39mif [0m[1;39m([0m[39mrecursion_cost > [0m[1;36m170[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m409[0m[39m:    [0m[39m        [0m[35m/[0m[39m*[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:    [0m[39m        [0m[39m * recursion_cost is a logarithmic-scale indicator of how expensive[0m [2m                [0m
[2;36m                    [0m         [39mthis[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:    [0m[39m        [0m[39m * recursive call might end up being. It is an indicator of the [0m    [2m                [0m
[2;36m                    [0m         [39mdepth of[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:    [0m[39m        [0m[39m * recursion as well as the potential for worst-case future [0m        [2m                [0m
[2;36m                    [0m         [39mrecursive[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m413[0m[39m:    [0m[39m        [0m[39m * calls. Since it's difficult to tell ahead of time how often [0m     [2m                [0m
[2;36m                    [0m         [39mrecursion[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m414[0m[39m:    [0m[39m        [0m[39m * will occur, this assumes the worst by assuming every tag could [0m  [2m                [0m
[2;36m                    [0m         [39mend up[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m:    [0m[39m        [0m[39m * causing recursion.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:    [0m[39m        [0m[39m * The value of [0m[1;36m170[0m[39m was chosen to limit typical EXIF structures to [0m [2m                [0m
[2;36m                    [0m         [39ma[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:    [0m[39m        [0m[39m * recursive depth of about [0m[1;36m6[0m[39m, but pathological ones [0m[1;39m([0m[39mthose with [0m   [2m                [0m
[2;36m                    [0m         [39mvery[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:    [0m[39m        [0m[39m * many tags[0m[1;39m)[0m[39m to only [0m[1;36m2[0m[39m.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:    [0m[39m        [0m[39m *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_CORRUPT_DATA, [0m[32m"ExifData"[0m[39m,[0m  [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"Deep/expensive recursion detected!"[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:    [0m[35m/[0m[39m* Read the number of entries *[0m[35m/[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m426[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset, ds, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m427[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_CORRUPT_DATA, [0m[32m"ExifData"[0m[39m,[0m  [2m                [0m
[2;36m                    [0m         [1;36m428[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"Tag data past end of buffer [0m[32m([0m[32m%u+2 > %u[0m[32m)[0m[32m"[0m[39m, offset, ds[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m429[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m430[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m431[0m[39m:    [0m[39mn = exif_get_short [0m[1;39m([0m[39md + offset, data->priv->order[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m432[0m[39m:    [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m433[0m[39m:    [0m[39m          [0m[32m"Loading %hu entries..."[0m[39m, n[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m434[0m[39m:    [0m[39moffset += [0m[1;36m2[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m435[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m436[0m[39m:    [0m[35m/[0m[39m* Check if we have enough data. *[0m[35m/[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m437[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset, ds, [0m[1;36m12[0m[39m*n[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m438[0m[39m:    [0m[39m        [0m[39mn = [0m[1;39m([0m[39mds - offset[0m[1;39m)[0m[39m [0m[35m/[0m[39m [0m[1;36m12[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m439[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m440[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"Short data; only loading %hu entries..."[0m[39m, n[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m441[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:525[0m[39m-[0m[1;36m534[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m525[0m[39m:    [0m[39m        [0m[39m        [0m[39mentry = exif_entry_new_mem [0m[1;39m([0m[39mdata->priv->mem[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m526[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39m!entry[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m527[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  exif_log [0m[1;39m([0m[39mdata->priv->log, [0m                       [2m                [0m
[2;36m                    [0m         [39mEXIF_LOG_CODE_NO_MEMORY, [0m[32m"ExifData"[0m[39m,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m528[0m[39m:                                          [0m[32m"Could not allocate memory"[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m529[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  return;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m530[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m531[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mexif_data_load_data_entry [0m[1;39m([0m[39mdata, entry, d, ds,[0m          [2m                [0m
[2;36m                    [0m         [1;36m532[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m   offset + [0m[1;36m12[0m[39m * i[0m[1;39m)[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m533[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mexif_content_add_entry [0m[1;39m([0m[39mdata->ifd[0m[1;39m[[0m[39mifd[0m[1;39m][0m[39m, entry[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m534[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_entry_unref [0m[1;39m([0m[39mentry[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-format.[0m[1;92mc:32[0m[39m-[0m[1;36m50[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:static const struct [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:        ExifFormat format;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:     [0m[39mconst char *name;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        unsigned char size;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m[1;39m}[0m[39m ExifFormatTable[0m[1;39m[[0m[1;39m][0m[39m = [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:        [0m[1;39m{[0m[39mEXIF_FORMAT_SHORT,     [0m[1;35mN_[0m[1;39m([0m[32m"Short"[0m[1;39m)[0m[39m,     [0m[1;36m2[0m[1;39m}[0m[39m,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:        [0m[1;39m{[0m[39mEXIF_FORMAT_RATIONAL,  [0m[1;35mN_[0m[1;39m([0m[32m"Rational"[0m[1;39m)[0m[39m,  [0m[1;36m8[0m[1;39m}[0m[39m,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:        [0m[1;39m{[0m[39mEXIF_FORMAT_SRATIONAL, [0m[1;35mN_[0m[1;39m([0m[32m"SRational"[0m[1;39m)[0m[39m, [0m[1;36m8[0m[1;39m}[0m[39m,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:        [0m[1;39m{[0m[39mEXIF_FORMAT_UNDEFINED, [0m[1;35mN_[0m[1;39m([0m[32m"Undefined"[0m[1;39m)[0m[39m, [0m[1;36m1[0m[1;39m}[0m[39m,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:        [0m[1;39m{[0m[39mEXIF_FORMAT_ASCII,     [0m[1;35mN_[0m[1;39m([0m[32m"ASCII"[0m[1;39m)[0m[39m,     [0m[1;36m1[0m[1;39m}[0m[39m,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        [0m[1;39m{[0m[39mEXIF_FORMAT_LONG,      [0m[1;35mN_[0m[1;39m([0m[32m"Long"[0m[1;39m)[0m[39m,      [0m[1;36m4[0m[1;39m}[0m[39m,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        [0m[1;39m{[0m[39mEXIF_FORMAT_BYTE,      [0m[1;35mN_[0m[1;39m([0m[32m"Byte"[0m[1;39m)[0m[39m,      [0m[1;36m1[0m[1;39m}[0m[39m,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     [0m[1;39m{[0m[39mEXIF_FORMAT_SBYTE,     [0m[1;35mN_[0m[1;39m([0m[32m"SByte"[0m[1;39m)[0m[39m,     [0m[1;36m1[0m[1;39m}[0m[39m,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     [0m[1;39m{[0m[39mEXIF_FORMAT_SSHORT,    [0m[1;35mN_[0m[1;39m([0m[32m"SShort"[0m[1;39m)[0m[39m,    [0m[1;36m2[0m[1;39m}[0m[39m,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:        [0m[1;39m{[0m[39mEXIF_FORMAT_SLONG,     [0m[1;35mN_[0m[1;39m([0m[32m"SLong"[0m[1;39m)[0m[39m,     [0m[1;36m4[0m[1;39m}[0m[39m,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     [0m[1;39m{[0m[39mEXIF_FORMAT_FLOAT,     [0m[1;35mN_[0m[1;39m([0m[32m"Float"[0m[1;39m)[0m[39m,     [0m[1;36m4[0m[1;39m}[0m[39m,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     [0m[1;39m{[0m[39mEXIF_FORMAT_DOUBLE,    [0m[1;35mN_[0m[1;39m([0m[32m"Double"[0m[1;39m)[0m[39m,    [0m[1;36m8[0m[1;39m}[0m[39m,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        [0m[1;39m{[0m[1;36m0[0m[39m, NULL, [0m[1;36m0[0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-format.[0m[1;92mc:65[0m[39m-[0m[1;36m74[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:unsigned char[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;92m66:e[0m[39mxif_format_get_size [0m[1;39m([0m[39mExifFormat format[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     [0m[39munsigned int i;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     [0m[39mfor [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; ExifFormatTable[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.size; i++[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     [0m[39m        [0m[39mif [0m[1;39m([0m[39mExifFormatTable[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format == format[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     [0m[39m        [0m[39m        [0m[39mreturn ExifFormatTable[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.size;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:163[0m[39m-[0m[1;36m208[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:static int[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;92m164:e[0m[39mxif_data_load_data_entry [0m[1;39m([0m[39mExifData *data, ExifEntry *entry,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:    [0m[39m        [0m[39m        [0m[39m   const unsigned char *d,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:    [0m[39m        [0m[39m        [0m[39m   unsigned int size, unsigned int offset[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    [0m[39munsigned int s, doff;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:    [0m[39mentry->tag        = exif_get_short [0m[1;39m([0m[39md + offset + [0m[1;36m0[0m[39m, data->priv->order[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:    [0m[39mentry->format     = exif_get_short [0m[1;39m([0m[39md + offset + [0m[1;36m2[0m[39m, data->priv->order[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:    [0m[39mentry->components = exif_get_long  [0m[1;39m([0m[39md + offset + [0m[1;36m4[0m[39m, data->priv->order[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:    [0m[35m/[0m[39m* FIXME: should use exif_tag_get_name_in_ifd here but entry->parent [0m       [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[39m * has not been set yet[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:    [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    [0m[39m        [0m[39m  [0m[32m"Loading entry 0x%x [0m[32m([0m[32m'%s'[0m[32m)[0m[32m..."[0m[39m, entry->tag,[0m                       [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:    [0m[39m        [0m[39m  exif_tag_get_name [0m[1;39m([0m[39mentry->tag[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:    [0m[35m/[0m[39m* [0m[1;39m{[0m[1;36m0[0m[39m,[0m[1;36m1[0m[39m,[0m[1;36m2[0m[39m,[0m[1;36m4[0m[39m,[0m[1;36m8[0m[1;39m}[0m[39m x [0m[1;39m{[0m[39m [0m[1;36m0x00000000[0m[39m .. [0m[1;36m0xffffffff[0m[39m [0m[1;39m}[0m[39m [0m                              [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:    [0m[39m *   -> [0m[1;39m{[0m[39m [0m[1;36m0x000000000[0m[39m .. [0m[1;36m0x7fffffff8[0m[39m [0m[1;39m}[0m[39m *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:    [0m[39ms = [0m[1;35mexif_format_get_size[0m[1;39m([0m[39mentry->format[0m[1;39m)[0m[39m * entry->components;[0m                [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:    [0m[39mif [0m[1;39m([0m[1;39m([0m[39ms < entry->components[0m[1;39m)[0m[39m || [0m[1;39m([0m[39ms == [0m[1;36m0[0m[1;39m)[0m[1;39m)[0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    [0m[35m/[0m[39m*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:    [0m[39m * Size? If bigger than [0m[1;36m4[0m[39m bytes, the actual data is not[0m                     [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:    [0m[39m * in the entry but somewhere else [0m[1;39m([0m[39moffset[0m[1;39m)[0m[39m.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:    [0m[39mif [0m[1;39m([0m[39ms > [0m[1;36m4[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:    [0m[39m        [0m[39mdoff = exif_get_long [0m[1;39m([0m[39md + offset + [0m[1;36m8[0m[39m, data->priv->order[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:    [0m[39melse[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:    [0m[39m        [0m[39mdoff = offset + [0m[1;36m8[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:    [0m[35m/[0m[39m* Sanity checks *[0m[35m/[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:    [0m[39mif [0m[1;39m([0m[39mdoff >= size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"Tag starts past end of buffer [0m[32m([0m[32m%u > %u[0m[32m)[0m[32m"[0m[39m, doff, [0m [2m                [0m
[2;36m                    [0m         [39msize[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:    [0m[39mif [0m[1;39m([0m[39ms > size - doff[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"Tag data goes past end of buffer [0m[32m([0m[32m%u > %u[0m[32m)[0m[32m"[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mdoff+s, size[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:86[0m[39m-[0m[1;36m99[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     [0m[39mreturn NULL;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m89:E[0m[39mxifMnoteData *[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;92m90:e[0m[39mxif_data_get_mnote_data [0m[1;39m([0m[39mExifData *d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     [0m[39mreturn [0m[1;39m([0m[39md && d->priv[0m[1;39m)[0m[39m ? d->priv->md : NULL;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m95:E[0m[39mxifData *[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;92m96:e[0m[39mxif_data_new [0m[1;39m([0m[39mvoid[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     [0m[39mExifMem *mem = exif_mem_new_default [0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     [0m[39mExifData *d = exif_data_new_mem [0m[1;39m([0m[39mmem[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-utils.[0m[1;92mc:129[0m[39m-[0m[1;36m142[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m129:E[0m[39mxifSLong[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;92m130:e[0m[39mxif_get_slong [0m[1;39m([0m[39mconst unsigned char *b, ExifByteOrder order[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!b[0m[1;39m)[0m[39m return [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        switch [0m[1;39m([0m[39morder[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        case EXIF_BYTE_ORDER_MOTOROLA:[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:                return [0m[1;39m([0m[1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m << [0m[1;36m24[0m[1;39m)[0m[39m | [0m[1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m << [0m[1;36m16[0m[1;39m)[0m[39m | [0m      [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | [0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        case EXIF_BYTE_ORDER_INTEL:[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:                return [0m[1;39m([0m[1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m << [0m[1;36m24[0m[1;39m)[0m[39m | [0m[1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m << [0m[1;36m16[0m[1;39m)[0m[39m | [0m      [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | [0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:    [0m[35m/[0m[39m* Won't be reached *[0m[35m/[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    [0m[39mreturn [0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-utils.[0m[1;92mc:164[0m[39m-[0m[1;36m168[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m164:E[0m[39mxifLong[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;92m165:e[0m[39mxif_get_long [0m[1;39m([0m[39mconst unsigned char *buf, ExifByteOrder order[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:        return [0m[1;39m([0m[39mexif_get_slong [0m[1;39m([0m[39mbuf, order[0m[1;39m)[0m[39m & [0m[1;36m0xffffffff[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:163[0m[39m-[0m[1;36m186[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:static int[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;92m164:e[0m[39mxif_data_load_data_entry [0m[1;39m([0m[39mExifData *data, ExifEntry *entry,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:    [0m[39m        [0m[39m        [0m[39m   const unsigned char *d,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:    [0m[39m        [0m[39m        [0m[39m   unsigned int size, unsigned int offset[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    [0m[39munsigned int s, doff;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:    [0m[39mentry->tag        = exif_get_short [0m[1;39m([0m[39md + offset + [0m[1;36m0[0m[39m, data->priv->order[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:    [0m[39mentry->format     = exif_get_short [0m[1;39m([0m[39md + offset + [0m[1;36m2[0m[39m, data->priv->order[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:    [0m[39mentry->components = exif_get_long  [0m[1;39m([0m[39md + offset + [0m[1;36m4[0m[39m, data->priv->order[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:    [0m[35m/[0m[39m* FIXME: should use exif_tag_get_name_in_ifd here but entry->parent [0m       [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[39m * has not been set yet[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:    [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    [0m[39m        [0m[39m  [0m[32m"Loading entry 0x%x [0m[32m([0m[32m'%s'[0m[32m)[0m[32m..."[0m[39m, entry->tag,[0m                       [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:    [0m[39m        [0m[39m  exif_tag_get_name [0m[1;39m([0m[39mentry->tag[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:    [0m[35m/[0m[39m* [0m[1;39m{[0m[1;36m0[0m[39m,[0m[1;36m1[0m[39m,[0m[1;36m2[0m[39m,[0m[1;36m4[0m[39m,[0m[1;36m8[0m[1;39m}[0m[39m x [0m[1;39m{[0m[39m [0m[1;36m0x00000000[0m[39m .. [0m[1;36m0xffffffff[0m[39m [0m[1;39m}[0m[39m [0m                              [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:    [0m[39m *   -> [0m[1;39m{[0m[39m [0m[1;36m0x000000000[0m[39m .. [0m[1;36m0x7fffffff8[0m[39m [0m[1;39m}[0m[39m *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:    [0m[39ms = [0m[1;35mexif_format_get_size[0m[1;39m([0m[39mentry->format[0m[1;39m)[0m[39m * entry->components;[0m                [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:    [0m[39mif [0m[1;39m([0m[1;39m([0m[39ms < entry->components[0m[1;39m)[0m[39m || [0m[1;39m([0m[39ms == [0m[1;36m0[0m[1;39m)[0m[1;39m)[0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:53[0m[39m-[0m[1;36m53[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:static const unsigned char ExifHeader[0m[1;39m[[0m[1;39m][0m[39m = [0m[1;39m{[0m[1;36m0x45[0m[39m, [0m[1;36m0x78[0m[39m, [0m[1;36m0x69[0m[39m, [0m[1;36m0x66[0m[39m, [0m[1;36m0x00[0m[39m, [0m[1;36m0x00[0m[1;39m}[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:920[0m[39m-[0m[1;36m929[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m920[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m921[0m[39m:    [0m[39m        [0m[39md++;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m922[0m[39m:    [0m[39m        [0m[39mds--;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m923[0m[39m:    [0m[39m        [0m[39mlen = [0m[1;39m([0m[1;39m([0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39md[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | d[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m924[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m925[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"We have to deal with %i byte[0m[32m([0m[32ms[0m[32m)[0m[32m of EXIF data."[0m[39m,[0m          [2m                [0m
[2;36m                    [0m         [1;36m926[0m[39m:    [0m[39m        [0m[39m        [0m[39m  len[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m927[0m[39m:    [0m[39m        [0m[39md += [0m[1;36m2[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m928[0m[39m:    [0m[39m        [0m[39mds = len - [0m[1;36m2[0m[39m;   [0m[35m/[0m[39m* we do not want the full rest size, but only the [0m [2m                [0m
[2;36m                    [0m         [39msize of the tag *[0m[35m/[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m929[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:843[0m[39m-[0m[1;36m858[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m843[0m[39m:void[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;92m844:e[0m[39mxif_data_load_data [0m[1;39m([0m[39mExifData *data, const unsigned char *d_orig,[0m               [2m                [0m
[2;36m                    [0m         [1;36m845[0m[39m:    [0m[39m        [0m[39m     unsigned int ds[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m846[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m847[0m[39m:    [0m[39munsigned int l;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m848[0m[39m:    [0m[39mExifLong offset;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m849[0m[39m:    [0m[39mExifShort n;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m850[0m[39m:    [0m[39mconst unsigned char *d = d_orig;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m851[0m[39m:    [0m[39munsigned int len, fullds;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m852[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m853[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!data || !data->priv || !d || !ds[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m854[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m855[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m856[0m[39m:    [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m857[0m[39m:    [0m[39m        [0m[39m  [0m[32m"Parsing %i byte[0m[32m([0m[32ms[0m[32m)[0m[32m EXIF data...\n"[0m[39m, ds[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m858[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:870[0m[39m-[0m[1;36m929[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m870[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m871[0m[39m:    [0m[39m        [0m[39mwhile [0m[1;39m([0m[39mds >= [0m[1;36m3[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m872[0m[39m:    [0m[39m        [0m[39m        [0m[39mwhile [0m[1;39m([0m[39mds && [0m[1;39m([0m[39md[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[1;36m0xff[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m873[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39md++;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m874[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mds--;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m875[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m876[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m877[0m[39m:    [0m[39m        [0m[39m        [0m[35m/[0m[39m* JPEG_MARKER_SOI *[0m[35m/[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m878[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mds && d[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == JPEG_MARKER_SOI[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m879[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39md++;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m880[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mds--;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m881[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    [0m[39m        [0m[39m        [0m[35m/[0m[39m* JPEG_MARKER_APP1 *[0m[35m/[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mds && d[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == JPEG_MARKER_APP1[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[35m/[0m[39m*[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m * Verify the exif header[0m                           [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m * [0m[1;39m([0m[39moffset [0m[1;36m3[0m[39m, length [0m[1;36m6[0m[1;39m)[0m[39m.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m * FF E1 NN NN EXIF[0m[1;33mHEAD[0m[39mER[0m                           [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m *    ^^ d points here currently[0m                    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[1;39m([0m[39mds >= [0m[1;36m9[0m[1;39m)[0m[39m && !memcmp [0m[1;39m([0m[39md+[0m[1;36m3[0m[39m, ExifHeader, [0m[1;36m6[0m[1;39m)[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[35m/[0m[39m* fallthrough *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[39m        [0m[39m        [0m[35m/[0m[39m* Skip irrelevant APP markers. The branch for APP1 must [0m   [2m                [0m
[2;36m                    [0m         [39mcome before this,[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m897[0m[39m:    [0m[39m        [0m[39m        [0m[39m   otherwise this code block will cause APP1 to be skipped.[0m [2m                [0m
[2;36m                    [0m         [39mThis code path[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m898[0m[39m:    [0m[39m        [0m[39m        [0m[39m   is only relevant for files that are nonconformant to the[0m [2m                [0m
[2;36m                    [0m         [39mEXIF[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m899[0m[39m:    [0m[39m        [0m[39m        [0m[39m   specification. For conformant files, the APP1 code path [0m [2m                [0m
[2;36m                    [0m         [39mabove will be[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m900[0m[39m:    [0m[39m        [0m[39m        [0m[39m   taken. *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m901[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mds >= [0m[1;36m3[0m[39m && d[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m >= [0m[1;36m0xe0[0m[39m && d[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m <= [0m[1;36m0xef[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m  [0m[35m/[0m[39m* [0m         [2m                [0m
[2;36m                    [0m         [39mJPEG_MARKER_APPn *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m902[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39md++;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m903[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mds--;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m904[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39ml = [0m[1;39m([0m[1;39m([0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39md[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | d[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m905[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39ml > ds[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m906[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mreturn;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m907[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39md += l;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m908[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mds -= l;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m909[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m910[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m911[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m912[0m[39m:    [0m[39m        [0m[39m        [0m[35m/[0m[39m* Unknown marker or data. Give up. *[0m[35m/[0m                      [2m                [0m
[2;36m                    [0m         [1;36m913[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m      [2m                [0m
[2;36m                    [0m         [1;36m914[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifData"[0m[39m, [0m[1;35m_[0m[1;39m([0m[32m"EXIF marker not found."[0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m915[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m916[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m917[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39mds < [0m[1;36m3[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m918[0m[39m:    [0m[39m        [0m[39m        [0m[39mLOG_TOO_SMALL;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m919[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m920[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m921[0m[39m:    [0m[39m        [0m[39md++;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m922[0m[39m:    [0m[39m        [0m[39mds--;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m923[0m[39m:    [0m[39m        [0m[39mlen = [0m[1;39m([0m[1;39m([0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39md[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | d[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m924[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m925[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"We have to deal with %i byte[0m[32m([0m[32ms[0m[32m)[0m[32m of EXIF data."[0m[39m,[0m          [2m                [0m
[2;36m                    [0m         [1;36m926[0m[39m:    [0m[39m        [0m[39m        [0m[39m  len[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m927[0m[39m:    [0m[39m        [0m[39md += [0m[1;36m2[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m928[0m[39m:    [0m[39m        [0m[39mds = len - [0m[1;36m2[0m[39m;   [0m[35m/[0m[39m* we do not want the full rest size, but only the [0m [2m                [0m
[2;36m                    [0m         [39msize of the tag *[0m[35m/[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m929[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:948[0m[39m-[0m[1;36m958[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m948[0m[39m:    [0m[35m/[0m[39m* Sanity check the data length *[0m[35m/[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m949[0m[39m:    [0m[39mif [0m[1;39m([0m[39mds < [0m[1;36m14[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m950[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m951[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m952[0m[39m:    [0m[35m/[0m[39m* The JPEG APP1 section can be no longer than [0m[1;36m64[0m[39m KiB [0m[1;39m([0m[39mincluding a[0m          [2m                [0m
[2;36m                    [0m         [1;36m953[0m[39m:    [0m[39m   [0m[1;36m16[0m[39m-bit length[0m[1;39m)[0m[39m, so cap the data length to protect against overflow[0m       [2m                [0m
[2;36m                    [0m         [1;36m954[0m[39m:    [0m[39m   in future offset calculations *[0m[35m/[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m955[0m[39m:    [0m[39mfullds = ds;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m956[0m[39m:    [0m[39mif [0m[1;39m([0m[39mds > [0m[1;36m0xfffe[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m957[0m[39m:    [0m[39m        [0m[39mds = [0m[1;36m0xfffe[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m958[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:901[0m[39m-[0m[1;36m910[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m901[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mds >= [0m[1;36m3[0m[39m && d[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m >= [0m[1;36m0xe0[0m[39m && d[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m <= [0m[1;36m0xef[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m  [0m[35m/[0m[39m* [0m         [2m                [0m
[2;36m                    [0m         [39mJPEG_MARKER_APPn *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m902[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39md++;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m903[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mds--;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m904[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39ml = [0m[1;39m([0m[1;39m([0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39md[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | d[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m905[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39ml > ds[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m906[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mreturn;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m907[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39md += l;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m908[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mds -= l;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m909[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m910[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:324[0m[39m-[0m[1;36m346[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m324[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m325:e[0m[39mxif_data_load_data_thumbnail [0m[1;39m([0m[39mExifData *data, const unsigned char *d,[0m          [2m                [0m
[2;36m                    [0m         [1;36m326[0m[39m:    [0m[39m        [0m[39m        [0m[39m       unsigned int ds, ExifLong o, ExifLong s[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m327[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m328[0m[39m:    [0m[35m/[0m[39m* Sanity checks *[0m[35m/[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m329[0m[39m:    [0m[39mif [0m[1;39m([0m[39mo >= ds[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m330[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m, [0m[32m"Bogus [0m [2m                [0m
[2;36m                    [0m         [32mthumbnail offset [0m[32m([0m[32m%u[0m[32m)[0m[32m."[0m[39m, o[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m331[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m332[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m333[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo,ds,s[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m334[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m, [0m[32m"Bogus [0m [2m                [0m
[2;36m                    [0m         [32mthumbnail size [0m[32m([0m[32m%u[0m[32m)[0m[32m, max would be %u."[0m[39m, s, ds-o[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m335[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m336[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m337[0m[39m:    [0m[39mif [0m[1;39m([0m[39mdata->data[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m338[0m[39m:    [0m[39m        [0m[39mexif_mem_free [0m[1;39m([0m[39mdata->priv->mem, data->data[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m339[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;39m([0m[39mdata->data = exif_data_alloc [0m[1;39m([0m[39mdata, s[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m340[0m[39m:    [0m[39m        [0m[39mEXIF_LOG_NO_MEMORY [0m[1;39m([0m[39mdata->priv->log, [0m[32m"ExifData"[0m[39m, s[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m341[0m[39m:    [0m[39m        [0m[39mdata->size = [0m[1;36m0[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m342[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m343[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m344[0m[39m:    [0m[39mdata->size = s;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m345[0m[39m:    [0m[39mmemcpy [0m[1;39m([0m[39mdata->data, d + o, s[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m346[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:870[0m[39m-[0m[1;36m929[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m870[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m871[0m[39m:    [0m[39m        [0m[39mwhile [0m[1;39m([0m[39mds >= [0m[1;36m3[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m872[0m[39m:    [0m[39m        [0m[39m        [0m[39mwhile [0m[1;39m([0m[39mds && [0m[1;39m([0m[39md[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[1;36m0xff[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m873[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39md++;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m874[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mds--;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m875[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m876[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m877[0m[39m:    [0m[39m        [0m[39m        [0m[35m/[0m[39m* JPEG_MARKER_SOI *[0m[35m/[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m878[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mds && d[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == JPEG_MARKER_SOI[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m879[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39md++;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m880[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mds--;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m881[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    [0m[39m        [0m[39m        [0m[35m/[0m[39m* JPEG_MARKER_APP1 *[0m[35m/[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mds && d[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == JPEG_MARKER_APP1[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[35m/[0m[39m*[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m * Verify the exif header[0m                           [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m * [0m[1;39m([0m[39moffset [0m[1;36m3[0m[39m, length [0m[1;36m6[0m[1;39m)[0m[39m.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m * FF E1 NN NN EXIF[0m[1;33mHEAD[0m[39mER[0m                           [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m *    ^^ d points here currently[0m                    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[1;39m([0m[39mds >= [0m[1;36m9[0m[1;39m)[0m[39m && !memcmp [0m[1;39m([0m[39md+[0m[1;36m3[0m[39m, ExifHeader, [0m[1;36m6[0m[1;39m)[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[35m/[0m[39m* fallthrough *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[39m        [0m[39m        [0m[35m/[0m[39m* Skip irrelevant APP markers. The branch for APP1 must [0m   [2m                [0m
[2;36m                    [0m         [39mcome before this,[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m897[0m[39m:    [0m[39m        [0m[39m        [0m[39m   otherwise this code block will cause APP1 to be skipped.[0m [2m                [0m
[2;36m                    [0m         [39mThis code path[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m898[0m[39m:    [0m[39m        [0m[39m        [0m[39m   is only relevant for files that are nonconformant to the[0m [2m                [0m
[2;36m                    [0m         [39mEXIF[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m899[0m[39m:    [0m[39m        [0m[39m        [0m[39m   specification. For conformant files, the APP1 code path [0m [2m                [0m
[2;36m                    [0m         [39mabove will be[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m900[0m[39m:    [0m[39m        [0m[39m        [0m[39m   taken. *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m901[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mds >= [0m[1;36m3[0m[39m && d[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m >= [0m[1;36m0xe0[0m[39m && d[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m <= [0m[1;36m0xef[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m  [0m[35m/[0m[39m* [0m         [2m                [0m
[2;36m                    [0m         [39mJPEG_MARKER_APPn *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m902[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39md++;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m903[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mds--;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m904[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39ml = [0m[1;39m([0m[1;39m([0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39md[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | d[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m905[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39ml > ds[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m906[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mreturn;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m907[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39md += l;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m908[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mds -= l;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m909[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m910[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m911[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m912[0m[39m:    [0m[39m        [0m[39m        [0m[35m/[0m[39m* Unknown marker or data. Give up. *[0m[35m/[0m                      [2m                [0m
[2;36m                    [0m         [1;36m913[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m      [2m                [0m
[2;36m                    [0m         [1;36m914[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifData"[0m[39m, [0m[1;35m_[0m[1;39m([0m[32m"EXIF marker not found."[0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m915[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m916[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m917[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39mds < [0m[1;36m3[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m918[0m[39m:    [0m[39m        [0m[39m        [0m[39mLOG_TOO_SMALL;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m919[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m920[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m921[0m[39m:    [0m[39m        [0m[39md++;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m922[0m[39m:    [0m[39m        [0m[39mds--;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m923[0m[39m:    [0m[39m        [0m[39mlen = [0m[1;39m([0m[1;39m([0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39md[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | d[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m924[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m925[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"We have to deal with %i byte[0m[32m([0m[32ms[0m[32m)[0m[32m of EXIF data."[0m[39m,[0m          [2m                [0m
[2;36m                    [0m         [1;36m926[0m[39m:    [0m[39m        [0m[39m        [0m[39m  len[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m927[0m[39m:    [0m[39m        [0m[39md += [0m[1;36m2[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m928[0m[39m:    [0m[39m        [0m[39mds = len - [0m[1;36m2[0m[39m;   [0m[35m/[0m[39m* we do not want the full rest size, but only the [0m [2m                [0m
[2;36m                    [0m         [39msize of the tag *[0m[35m/[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m929[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:791[0m[39m-[0m[1;36m837[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m791[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m792[0m[39m:[0m[1;35minterpret_maker_note[0m[1;39m([0m[39mExifData *data, const unsigned char *d, unsigned int ds[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [1;36m793[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:    [0m[39mint mnoteid;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:    [0m[39mExifEntry* e = exif_data_get_entry [0m[1;39m([0m[39mdata, EXIF_TAG_MAKER_NOTE[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!e[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    [0m[39mif [0m[1;39m([0m[1;39m([0m[39mmnoteid = exif_mnote_data_olympus_identify [0m[1;39m([0m[39mdata, e[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:    [0m[39m        [0m[39m        [0m[32m"ExifData"[0m[39m, [0m[32m"Olympus MakerNote variant type %d"[0m[39m, mnoteid[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    [0m[39m        [0m[39mdata->priv->md = exif_mnote_data_olympus_new [0m[1;39m([0m[39mdata->priv->mem[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mmnoteid = exif_mnote_data_canon_identify [0m[1;39m([0m[39mdata, e[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:    [0m[39m        [0m[39m        [0m[32m"ExifData"[0m[39m, [0m[32m"Canon MakerNote variant type %d"[0m[39m, mnoteid[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    [0m[39m        [0m[39mdata->priv->md = exif_mnote_data_canon_new [0m[1;39m([0m[39mdata->priv->mem, [0m       [2m                [0m
[2;36m                    [0m         [39mdata->priv->options[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mmnoteid = exif_mnote_data_fuji_identify [0m[1;39m([0m[39mdata, e[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:    [0m[39m        [0m[39m        [0m[32m"ExifData"[0m[39m, [0m[32m"Fuji MakerNote variant type %d"[0m[39m, mnoteid[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:    [0m[39m        [0m[39mdata->priv->md = exif_mnote_data_fuji_new [0m[1;39m([0m[39mdata->priv->mem[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:    [0m[35m/[0m[39m* NOTE: Must do Pentax detection last because some of the[0m                  [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:    [0m[39m * heuristics are pretty general. *[0m[35m/[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mmnoteid = exif_mnote_data_pentax_identify [0m[1;39m([0m[39mdata, e[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:    [0m[39m        [0m[39m        [0m[32m"ExifData"[0m[39m, [0m[32m"Pentax MakerNote variant type %d"[0m[39m, mnoteid[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:    [0m[39m        [0m[39mdata->priv->md = exif_mnote_data_pentax_new [0m[1;39m([0m[39mdata->priv->mem[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mmnoteid = exif_mnote_data_apple_identify [0m[1;39m([0m[39mdata, e[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:    [0m[39m        [0m[39m        [0m[32m"ExifData"[0m[39m, [0m[32m"Apple MakerNote variant type %d"[0m[39m, mnoteid[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[39m        [0m[39mdata->priv->md = exif_mnote_data_apple_new [0m[1;39m([0m[39mdata->priv->mem[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    [0m[35m/[0m[39m* [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[39m * If we are able to interpret the maker note, do so.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    [0m[39mif [0m[1;39m([0m[39mdata->priv->md[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    [0m[39m        [0m[39mexif_mnote_data_log [0m[1;39m([0m[39mdata->priv->md, data->priv->log[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[39m        [0m[39mexif_mnote_data_set_byte_order [0m[1;39m([0m[39mdata->priv->md,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mdata->priv->order[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:    [0m[39m        [0m[39mexif_mnote_data_set_offset [0m[1;39m([0m[39mdata->priv->md,[0m                         [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m    data->priv->offset_mnote[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:    [0m[39m        [0m[39mexif_mnote_data_load [0m[1;39m([0m[39mdata->priv->md, d, ds[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m837[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:1006[0m[39m-[0m[1;36m1017[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1006[0m[39m:   [0m[35m/[0m[39m*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1007[0m[39m:   [0m[39m * If we got an EXIF_TAG_MAKER_NOTE, try to interpret it. Some[0m              [2m                [0m
[2;36m                    [0m         [1;36m1008[0m[39m:   [0m[39m * cameras use pointers in the maker note tag that point to the[0m             [2m                [0m
[2;36m                    [0m         [1;36m1009[0m[39m:   [0m[39m * space between IFDs. Here is the only place where we have access[0m          [2m                [0m
[2;36m                    [0m         [1;36m1010[0m[39m:   [0m[39m * to that data.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1011[0m[39m:   [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1012[0m[39m:   [0m[1;35minterpret_maker_note[0m[1;39m([0m[39mdata, d, fullds[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1013[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1014[0m[39m:   [0m[35m/[0m[39m* Fixup tags if requested *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1015[0m[39m:   [0m[39mif [0m[1;39m([0m[39mdata->priv->options & EXIF_DATA_OPTION_FOLLOW_SPECIFICATION[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [1;36m1016[0m[39m:   [0m[39m        [0m[39mexif_data_fix [0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1017[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:974[0m[39m-[0m[1;36m984[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m974[0m[39m:    [0m[35m/[0m[39m* IFD [0m[1;36m0[0m[39m offset *[0m[35m/[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m975[0m[39m:    [0m[39moffset = exif_get_long [0m[1;39m([0m[39md + [0m[1;36m10[0m[39m, data->priv->order[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m976[0m[39m:    [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m, [0m                [2m                [0m
[2;36m                    [0m         [1;36m977[0m[39m:    [0m[39m        [0m[39m  [0m[32m"IFD 0 at %i."[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m offset[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m978[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m979[0m[39m:    [0m[35m/[0m[39m* ds is restricted to [0m[1;36m16[0m[39m bit above, so offset is restricted too, and [0m      [2m                [0m
[2;36m                    [0m         [39moffset+[0m[1;36m8[0m[39m should not overflow. *[0m[35m/[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m980[0m[39m:    [0m[39mif [0m[1;39m([0m[39moffset > ds || offset + [0m[1;36m6[0m[39m + [0m[1;36m2[0m[39m > ds[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m981[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m982[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m983[0m[39m:    [0m[35m/[0m[39m* Parse the actual exif data [0m[1;39m([0m[39musually offset [0m[1;36m14[0m[39m from start[0m[1;39m)[0m[39m *[0m[35m/[0m             [2m                [0m
[2;36m                    [0m         [1;36m984[0m[39m:    [0m[39mexif_data_load_data_content [0m[1;39m([0m[39mdata, EXIF_IFD_0, d + [0m[1;36m6[0m[39m, ds - [0m[1;36m6[0m[39m, offset, [0m[1;36m0[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:917[0m[39m-[0m[1;36m929[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m917[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39mds < [0m[1;36m3[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m918[0m[39m:    [0m[39m        [0m[39m        [0m[39mLOG_TOO_SMALL;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m919[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m920[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m921[0m[39m:    [0m[39m        [0m[39md++;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m922[0m[39m:    [0m[39m        [0m[39mds--;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m923[0m[39m:    [0m[39m        [0m[39mlen = [0m[1;39m([0m[1;39m([0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39md[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | d[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m924[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m925[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"We have to deal with %i byte[0m[32m([0m[32ms[0m[32m)[0m[32m of EXIF data."[0m[39m,[0m          [2m                [0m
[2;36m                    [0m         [1;36m926[0m[39m:    [0m[39m        [0m[39m        [0m[39m  len[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m927[0m[39m:    [0m[39m        [0m[39md += [0m[1;36m2[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m928[0m[39m:    [0m[39m        [0m[39mds = len - [0m[1;36m2[0m[39m;   [0m[35m/[0m[39m* we do not want the full rest size, but only the [0m [2m                [0m
[2;36m                    [0m         [39msize of the tag *[0m[35m/[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m929[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:349[0m[39m-[0m[1;36m365[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m349[0m[39m:#define [0m[1;35mCHECK_REC[0m[1;39m([0m[39mi[0m[1;39m)[0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m\[0m                   [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:if [0m[1;39m([0m[1;39m([0m[39mi[0m[1;39m)[0m[39m == ifd[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m   [0m[39m        [0m[39m        [0m[39m        [0m[39m\[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m351[0m[39m:    [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, \[0m                           [2m                [0m
[2;36m                    [0m         [1;36m352[0m[39m:    [0m[39m        [0m[32m"ExifData"[0m[39m, [0m[32m"Recursive entry in IFD "[0m[39m   [0m[39m\[0m                           [2m                [0m
[2;36m                    [0m         [1;36m353[0m[39m:    [0m[39m        [0m[32m"'%s' detected. Skipping..."[0m[39m,   [0m[39m        [0m[39m\[0m                           [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:    [0m[39m        [0m[39mexif_ifd_get_name [0m[1;39m([0m[39mi[0m[1;39m)[0m[1;39m)[0m[39m; [0m[39m        [0m[39m        [0m[39m\[0m                           [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:    [0m[39mbreak;  [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m\[0m                           [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:[0m[1;39m}[0m[39m   [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m\[0m                           [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:if [0m[1;39m([0m[39mdata->ifd[0m[1;39m[[0m[1;39m([0m[39mi[0m[1;39m)[0m[1;39m][0m[39m->count[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m\[0m                   [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:    [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[39m\[0m                           [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:    [0m[39m        [0m[32m"ExifData"[0m[39m, [0m[32m"Attempt to load IFD "[0m[39m      [0m[39m\[0m                           [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:    [0m[39m        [0m[32m"'%s' multiple times detected. "[0m[39m        [0m[39m\[0m                           [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:    [0m[39m        [0m[32m"Skipping..."[0m[39m,  [0m[39m        [0m[39m        [0m[39m        [0m[39m\[0m                           [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:    [0m[39m        [0m[39mexif_ifd_get_name [0m[1;39m([0m[39mi[0m[1;39m)[0m[1;39m)[0m[39m; [0m[39m        [0m[39m        [0m[39m\[0m                           [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:    [0m[39mbreak;  [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m\[0m                           [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:371[0m[39m-[0m[1;36m378[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:static unsigned int[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:[0m[1;35mlevel_cost[0m[1;39m([0m[39munsigned int n[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:    static const double log_1_1 = [0m[1;36m0.09531017980432493[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:    [0m[35m/[0m[39m* Adding [0m[1;36m0.1[0m[39m protects against the case where [0m[33mn[0m[39m==[0m[1;36m1[0m[39m *[0m[35m/[0m                       [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:    [0m[39mreturn [0m[1;35mceil[0m[1;39m([0m[1;35mlog[0m[1;39m([0m[39mn + [0m[1;36m0.1[0m[1;39m)[0m[35m/[0m[95mlog_1_1[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:917[0m[39m-[0m[1;36m929[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m917[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39mds < [0m[1;36m3[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m918[0m[39m:    [0m[39m        [0m[39m        [0m[39mLOG_TOO_SMALL;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m919[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m920[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m921[0m[39m:    [0m[39m        [0m[39md++;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m922[0m[39m:    [0m[39m        [0m[39mds--;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m923[0m[39m:    [0m[39m        [0m[39mlen = [0m[1;39m([0m[1;39m([0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39md[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | d[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m924[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m925[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"We have to deal with %i byte[0m[32m([0m[32ms[0m[32m)[0m[32m of EXIF data."[0m[39m,[0m          [2m                [0m
[2;36m                    [0m         [1;36m926[0m[39m:    [0m[39m        [0m[39m        [0m[39m  len[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m927[0m[39m:    [0m[39m        [0m[39md += [0m[1;36m2[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m928[0m[39m:    [0m[39m        [0m[39mds = len - [0m[1;36m2[0m[39m;   [0m[35m/[0m[39m* we do not want the full rest size, but only the [0m [2m                [0m
[2;36m                    [0m         [39msize of the tag *[0m[35m/[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m929[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:238[0m[39m-[0m[1;36m322[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m239:e[0m[39mxif_data_save_data_entry [0m[1;39m([0m[39mExifData *data, ExifEntry *e,[0m                        [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:    [0m[39m        [0m[39m        [0m[39m   unsigned char **d, unsigned int *ds,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:    [0m[39m        [0m[39m        [0m[39m   unsigned int offset[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:    [0m[39munsigned int doff, s;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:    [0m[39munsigned int ts;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!data || !data->priv[0m[1;39m)[0m[39m [0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:    [0m[35m/[0m[39m*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:    [0m[39m * Each entry is [0m[1;36m12[0m[39m bytes long. The memory for the entry has[0m                [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:    [0m[39m * already been allocated.[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:    [0m[39mexif_set_short [0m[1;39m([0m[39m*d + [0m[1;36m6[0m[39m + offset + [0m[1;36m0[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:    [0m[39m        [0m[39m        [0m[39mdata->priv->order, [0m[1;39m([0m[39mExifShort[0m[1;39m)[0m[39m e->tag[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:    [0m[39mexif_set_short [0m[1;39m([0m[39m*d + [0m[1;36m6[0m[39m + offset + [0m[1;36m2[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:    [0m[39m        [0m[39m        [0m[39mdata->priv->order, [0m[1;39m([0m[39mExifShort[0m[1;39m)[0m[39m e->format[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;39m([0m[39mdata->priv->options & EXIF_DATA_OPTION_DONT_CHANGE_MAKER_NOTE[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:    [0m[39m        [0m[35m/[0m[39m* If this is the maker note tag, update it. *[0m[35m/[0m                     [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[1;39m([0m[39me->tag == EXIF_TAG_MAKER_NOTE[0m[1;39m)[0m[39m && data->priv->md[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:    [0m[39m        [0m[39m        [0m[35m/[0m[39m* TODO: this is using the wrong ExifMem to free e->data *[0m[35m/[0m [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_mem_free [0m[1;39m([0m[39mdata->priv->mem, e->data[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:    [0m[39m        [0m[39m        [0m[39me->data = NULL;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:    [0m[39m        [0m[39m        [0m[39me->size = [0m[1;36m0[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_mnote_data_set_offset [0m[1;39m([0m[39mdata->priv->md, *ds - [0m[1;36m6[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_mnote_data_save [0m[1;39m([0m[39mdata->priv->md, &e->data, &e->size[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:    [0m[39m        [0m[39m        [0m[39me->components = e->size;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mexif_format_get_size [0m[1;39m([0m[39me->format[0m[1;39m)[0m[39m != [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[35m/[0m[39m* e->format is taken from input code,[0m              [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m * but we need to make sure it is a [0m[1;36m1[0m[39m byte[0m          [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m * entity due to the multiplication below. *[0m[35m/[0m       [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39me->format = EXIF_FORMAT_UNDEFINED;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:    [0m[39mexif_set_long  [0m[1;39m([0m[39m*d + [0m[1;36m6[0m[39m + offset + [0m[1;36m4[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:    [0m[39m        [0m[39m        [0m[39mdata->priv->order, e->components[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:    [0m[35m/[0m[39m*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:    [0m[39m * Size? If bigger than [0m[1;36m4[0m[39m bytes, the actual data is not in[0m                  [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:    [0m[39m * the entry but somewhere else.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:    [0m[39ms = exif_format_get_size [0m[1;39m([0m[39me->format[0m[1;39m)[0m[39m * e->components;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:    [0m[39mif [0m[1;39m([0m[39ms > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:    [0m[39m        [0m[39munsigned char *t;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:    [0m[39m        [0m[39mdoff = *ds - [0m[1;36m6[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:    [0m[39m        [0m[39mts = *ds + s;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:    [0m[39m        [0m[35m/[0m[39m*[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:    [0m[39m        [0m[39m * According to the TIFF specification,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:    [0m[39m        [0m[39m * the offset must be an even number. If we need to introduce[0m       [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:    [0m[39m        [0m[39m * a padding byte, we set it to [0m[1;36m0[0m[39m.[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:    [0m[39m        [0m[39m *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39ms & [0m[1;36m1[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:    [0m[39m        [0m[39m        [0m[39mts++;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:    [0m[39m        [0m[39mt = exif_mem_realloc [0m[1;39m([0m[39mdata->priv->mem, *d, ts[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m!t[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:    [0m[39m        [0m[39m        [0m[39mEXIF_LOG_NO_MEMORY [0m[1;39m([0m[39mdata->priv->log, [0m[32m"ExifData"[0m[39m, ts[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:    [0m[39m        [0m[39m*d = t;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:    [0m[39m        [0m[39m*ds = ts;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:    [0m[39m        [0m[39mexif_set_long [0m[1;39m([0m[39m*d + [0m[1;36m6[0m[39m + offset + [0m[1;36m8[0m[39m, data->priv->order, doff[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39ms & [0m[1;36m1[0m[1;39m)[0m[39m [0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:    [0m[39m        [0m[39m        [0m[39m*[0m[1;39m([0m[39m*d + *ds - [0m[1;36m1[0m[1;39m)[0m[39m = [0m[32m'\0'[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:    [0m[1;39m}[0m[39m else[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:    [0m[39m        [0m[39mdoff = offset + [0m[1;36m8[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:    [0m[35m/[0m[39m* Write the data. Fill unneeded bytes with [0m[1;36m0[0m[39m. Do not crash with[0m            [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:    [0m[39m * e->data is NULL *[0m[35m/[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:    [0m[39mif [0m[1;39m([0m[39me->data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:    [0m[39m        [0m[39munsigned int len = s;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39me->size < s[0m[1;39m)[0m[39m len = e->size;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:    [0m[39m        [0m[39mmemcpy [0m[1;39m([0m[39m*d + [0m[1;36m6[0m[39m + doff, e->data, len[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:    [0m[39m        [0m[39mmemset [0m[1;39m([0m[39m*d + [0m[1;36m6[0m[39m + doff, [0m[1;36m0[0m[39m, s[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:    [0m[39mif [0m[1;39m([0m[39ms < [0m[1;36m4[0m[1;39m)[0m[39m [0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m321[0m[39m:    [0m[39m        [0m[39mmemset [0m[1;39m([0m[39m*d + [0m[1;36m6[0m[39m + doff + s, [0m[1;36m0[0m[39m, [0m[1;39m([0m[1;36m4[0m[39m - s[0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m322[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/canon/exif-mnote-data-canon.[0m[1;92mc:203[0m[39m-[0m[1;36m233[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m204:e[0m[39mxif_mnote_data_canon_load [0m[1;39m([0m[39mExifMnoteData *ne,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:    [0m[39mconst unsigned char *buf, unsigned int buf_size[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:    [0m[39mExifMnoteDataCanon *n = [0m[1;39m([0m[39mExifMnoteDataCanon *[0m[1;39m)[0m[39m ne;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:    [0m[39mExifShort c;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    [0m[39msize_t i, tcount, o, datao;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:    [0m[39mlong failsafe_size = [0m[1;36m0[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n || !buf || !buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:    [0m[35m/[0m[39m* Read the number of tags *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:    [0m[39mc = exif_get_short [0m[1;39m([0m[39mbuf + datao, n->order[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    [0m[39mdatao += [0m[1;36m2[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:    [0m[35m/[0m[39m* Just use an arbitrary max tag limit here to avoid needing to much memory[0m [2m                [0m
[2;36m                    [0m         [39mor time. There are [0m[1;36m24[0m[39m named tags currently.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[39m * current [0m[1;36m2020[0m[39m camera EOS M6 Mark [0m[1;36m2[0m[39m had [0m[1;36m156[0m[39m entries.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[39m * The format allows specifying the same range of memory as often as it [0m    [2m                [0m
[2;36m                    [0m         [39mcan, so this multiplies quickly. *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[39mif [0m[1;39m([0m[39mc > [0m[1;36m250[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA, [0m[32m"ExifMnoteCanon"[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [32m"Too much tags [0m[32m([0m[32m%d[0m[32m)[0m[32m in Canon MakerNote"[0m[39m, c[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/olympus/exif-mnote-data-olympus.[0m[1;92mc:237[0m[39m-[0m[1;36m250[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m238:e[0m[39mxif_mnote_data_olympus_load [0m[1;39m([0m[39mExifMnoteData *en,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    [0m[39m        [0m[39m        [0m[39m      const unsigned char *buf, unsigned int buf_size[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:    [0m[39mExifMnoteDataOlympus *n = [0m[1;39m([0m[39mExifMnoteDataOlympus *[0m[1;39m)[0m[39m en;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:    [0m[39mExifShort c;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:    [0m[39msize_t i, tcount, o, o2, datao = [0m[1;36m6[0m[39m, base = [0m[1;36m0[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n || !buf || !buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataOlympus"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:    [0m[39mo2 = [0m[1;36m6[0m[39m + n->offset; [0m[35m/[0m[39m* Start of interesting data *[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:153[0m[39m-[0m[1;36m161[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m153:E[0m[39mxifData *[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;92m154:e[0m[39mxif_data_new_from_data [0m[1;39m([0m[39mconst unsigned char *data, unsigned int size[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:    [0m[39mExifData *edata;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    [0m[39medata = exif_data_new [0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:    [0m[39mexif_data_load_data [0m[1;39m([0m[39medata, data, size[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:    [0m[39mreturn [0m[1;39m([0m[39medata[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:843[0m[39m-[0m[1;36m845[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m843[0m[39m:void[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;92m844:e[0m[39mxif_data_load_data [0m[1;39m([0m[39mExifData *data, const unsigned char *d_orig,[0m               [2m                [0m
[2;36m                    [0m         [1;36m845[0m[39m:    [0m[39m        [0m[39m     unsigned int ds[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:901[0m[39m-[0m[1;36m910[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m901[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mds >= [0m[1;36m3[0m[39m && d[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m >= [0m[1;36m0xe0[0m[39m && d[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m <= [0m[1;36m0xef[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m  [0m[35m/[0m[39m* [0m         [2m                [0m
[2;36m                    [0m         [39mJPEG_MARKER_APPn *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m902[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39md++;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m903[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mds--;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m904[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39ml = [0m[1;39m([0m[1;39m([0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39md[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | d[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m905[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39ml > ds[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m906[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mreturn;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m907[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39md += l;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m908[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mds -= l;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m909[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m910[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:917[0m[39m-[0m[1;36m929[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m917[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39mds < [0m[1;36m3[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m918[0m[39m:    [0m[39m        [0m[39m        [0m[39mLOG_TOO_SMALL;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m919[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m920[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m921[0m[39m:    [0m[39m        [0m[39md++;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m922[0m[39m:    [0m[39m        [0m[39mds--;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m923[0m[39m:    [0m[39m        [0m[39mlen = [0m[1;39m([0m[1;39m([0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39md[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | d[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m924[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m925[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"We have to deal with %i byte[0m[32m([0m[32ms[0m[32m)[0m[32m of EXIF data."[0m[39m,[0m          [2m                [0m
[2;36m                    [0m         [1;36m926[0m[39m:    [0m[39m        [0m[39m        [0m[39m  len[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m927[0m[39m:    [0m[39m        [0m[39md += [0m[1;36m2[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m928[0m[39m:    [0m[39m        [0m[39mds = len - [0m[1;36m2[0m[39m;   [0m[35m/[0m[39m* we do not want the full rest size, but only the [0m [2m                [0m
[2;36m                    [0m         [39msize of the tag *[0m[35m/[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m929[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:917[0m[39m-[0m[1;36m958[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m917[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39mds < [0m[1;36m3[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m918[0m[39m:    [0m[39m        [0m[39m        [0m[39mLOG_TOO_SMALL;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m919[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m920[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m921[0m[39m:    [0m[39m        [0m[39md++;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m922[0m[39m:    [0m[39m        [0m[39mds--;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m923[0m[39m:    [0m[39m        [0m[39mlen = [0m[1;39m([0m[1;39m([0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39md[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | d[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m924[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m925[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"We have to deal with %i byte[0m[32m([0m[32ms[0m[32m)[0m[32m of EXIF data."[0m[39m,[0m          [2m                [0m
[2;36m                    [0m         [1;36m926[0m[39m:    [0m[39m        [0m[39m        [0m[39m  len[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m927[0m[39m:    [0m[39m        [0m[39md += [0m[1;36m2[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m928[0m[39m:    [0m[39m        [0m[39mds = len - [0m[1;36m2[0m[39m;   [0m[35m/[0m[39m* we do not want the full rest size, but only the [0m [2m                [0m
[2;36m                    [0m         [39msize of the tag *[0m[35m/[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m929[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m930[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m931[0m[39m:    [0m[35m/[0m[39m*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m932[0m[39m:    [0m[39m * Verify the exif header[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m933[0m[39m:    [0m[39m * [0m[1;39m([0m[39moffset [0m[1;36m2[0m[39m, length [0m[1;36m6[0m[1;39m)[0m[39m.[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m934[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m935[0m[39m:    [0m[39mif [0m[1;39m([0m[39mds < [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m936[0m[39m:    [0m[39m        [0m[39mLOG_TOO_SMALL;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m937[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m938[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m939[0m[39m:    [0m[39mif [0m[1;39m([0m[39mmemcmp [0m[1;39m([0m[39md, ExifHeader, [0m[1;36m6[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m940[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m941[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifData"[0m[39m, [0m[1;35m_[0m[1;39m([0m[32m"EXIF header not found."[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m942[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m943[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m944[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m945[0m[39m:    [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m946[0m[39m:    [0m[39m        [0m[39m  [0m[32m"Found EXIF header."[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m947[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m948[0m[39m:    [0m[35m/[0m[39m* Sanity check the data length *[0m[35m/[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m949[0m[39m:    [0m[39mif [0m[1;39m([0m[39mds < [0m[1;36m14[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m950[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m951[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m952[0m[39m:    [0m[35m/[0m[39m* The JPEG APP1 section can be no longer than [0m[1;36m64[0m[39m KiB [0m[1;39m([0m[39mincluding a[0m          [2m                [0m
[2;36m                    [0m         [1;36m953[0m[39m:    [0m[39m   [0m[1;36m16[0m[39m-bit length[0m[1;39m)[0m[39m, so cap the data length to protect against overflow[0m       [2m                [0m
[2;36m                    [0m         [1;36m954[0m[39m:    [0m[39m   in future offset calculations *[0m[35m/[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m955[0m[39m:    [0m[39mfullds = ds;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m956[0m[39m:    [0m[39mif [0m[1;39m([0m[39mds > [0m[1;36m0xfffe[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m957[0m[39m:    [0m[39m        [0m[39mds = [0m[1;36m0xfffe[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m958[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:974[0m[39m-[0m[1;36m984[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m974[0m[39m:    [0m[35m/[0m[39m* IFD [0m[1;36m0[0m[39m offset *[0m[35m/[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m975[0m[39m:    [0m[39moffset = exif_get_long [0m[1;39m([0m[39md + [0m[1;36m10[0m[39m, data->priv->order[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m976[0m[39m:    [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m, [0m                [2m                [0m
[2;36m                    [0m         [1;36m977[0m[39m:    [0m[39m        [0m[39m  [0m[32m"IFD 0 at %i."[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m offset[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m978[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m979[0m[39m:    [0m[35m/[0m[39m* ds is restricted to [0m[1;36m16[0m[39m bit above, so offset is restricted too, and [0m      [2m                [0m
[2;36m                    [0m         [39moffset+[0m[1;36m8[0m[39m should not overflow. *[0m[35m/[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m980[0m[39m:    [0m[39mif [0m[1;39m([0m[39moffset > ds || offset + [0m[1;36m6[0m[39m + [0m[1;36m2[0m[39m > ds[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m981[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m982[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m983[0m[39m:    [0m[35m/[0m[39m* Parse the actual exif data [0m[1;39m([0m[39musually offset [0m[1;36m14[0m[39m from start[0m[1;39m)[0m[39m *[0m[35m/[0m             [2m                [0m
[2;36m                    [0m         [1;36m984[0m[39m:    [0m[39mexif_data_load_data_content [0m[1;39m([0m[39mdata, EXIF_IFD_0, d + [0m[1;36m6[0m[39m, ds - [0m[1;36m6[0m[39m, offset, [0m[1;36m0[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:51[0m[39m-[0m[1;36m52[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:#define [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset,datasize,structsize[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39m offset >= datasize[0m[1;39m)[0m[39m || [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstructsize > datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset > datasize - structsize [0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:163[0m[39m-[0m[1;36m217[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:static int[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;92m164:e[0m[39mxif_data_load_data_entry [0m[1;39m([0m[39mExifData *data, ExifEntry *entry,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:    [0m[39m        [0m[39m        [0m[39m   const unsigned char *d,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:    [0m[39m        [0m[39m        [0m[39m   unsigned int size, unsigned int offset[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    [0m[39munsigned int s, doff;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:    [0m[39mentry->tag        = exif_get_short [0m[1;39m([0m[39md + offset + [0m[1;36m0[0m[39m, data->priv->order[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:    [0m[39mentry->format     = exif_get_short [0m[1;39m([0m[39md + offset + [0m[1;36m2[0m[39m, data->priv->order[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:    [0m[39mentry->components = exif_get_long  [0m[1;39m([0m[39md + offset + [0m[1;36m4[0m[39m, data->priv->order[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:    [0m[35m/[0m[39m* FIXME: should use exif_tag_get_name_in_ifd here but entry->parent [0m       [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[39m * has not been set yet[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:    [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    [0m[39m        [0m[39m  [0m[32m"Loading entry 0x%x [0m[32m([0m[32m'%s'[0m[32m)[0m[32m..."[0m[39m, entry->tag,[0m                       [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:    [0m[39m        [0m[39m  exif_tag_get_name [0m[1;39m([0m[39mentry->tag[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:    [0m[35m/[0m[39m* [0m[1;39m{[0m[1;36m0[0m[39m,[0m[1;36m1[0m[39m,[0m[1;36m2[0m[39m,[0m[1;36m4[0m[39m,[0m[1;36m8[0m[1;39m}[0m[39m x [0m[1;39m{[0m[39m [0m[1;36m0x00000000[0m[39m .. [0m[1;36m0xffffffff[0m[39m [0m[1;39m}[0m[39m [0m                              [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:    [0m[39m *   -> [0m[1;39m{[0m[39m [0m[1;36m0x000000000[0m[39m .. [0m[1;36m0x7fffffff8[0m[39m [0m[1;39m}[0m[39m *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:    [0m[39ms = [0m[1;35mexif_format_get_size[0m[1;39m([0m[39mentry->format[0m[1;39m)[0m[39m * entry->components;[0m                [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:    [0m[39mif [0m[1;39m([0m[1;39m([0m[39ms < entry->components[0m[1;39m)[0m[39m || [0m[1;39m([0m[39ms == [0m[1;36m0[0m[1;39m)[0m[1;39m)[0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    [0m[35m/[0m[39m*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:    [0m[39m * Size? If bigger than [0m[1;36m4[0m[39m bytes, the actual data is not[0m                     [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:    [0m[39m * in the entry but somewhere else [0m[1;39m([0m[39moffset[0m[1;39m)[0m[39m.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:    [0m[39mif [0m[1;39m([0m[39ms > [0m[1;36m4[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:    [0m[39m        [0m[39mdoff = exif_get_long [0m[1;39m([0m[39md + offset + [0m[1;36m8[0m[39m, data->priv->order[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:    [0m[39melse[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:    [0m[39m        [0m[39mdoff = offset + [0m[1;36m8[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:    [0m[35m/[0m[39m* Sanity checks *[0m[35m/[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:    [0m[39mif [0m[1;39m([0m[39mdoff >= size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"Tag starts past end of buffer [0m[32m([0m[32m%u > %u[0m[32m)[0m[32m"[0m[39m, doff, [0m [2m                [0m
[2;36m                    [0m         [39msize[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:    [0m[39mif [0m[1;39m([0m[39ms > size - doff[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"Tag data goes past end of buffer [0m[32m([0m[32m%u > %u[0m[32m)[0m[32m"[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mdoff+s, size[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:    [0m[39mentry->data = exif_data_alloc [0m[1;39m([0m[39mdata, s[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:    [0m[39mif [0m[1;39m([0m[39mentry->data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:    [0m[39m        [0m[39mentry->size = s;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    [0m[39m        [0m[39mmemcpy [0m[1;39m([0m[39mentry->data, d + doff, s[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    [0m[39m        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mdata->priv->log, [0m[32m"ExifData"[0m[39m, s[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:390[0m[39m-[0m[1;36m441[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m391:e[0m[39mxif_data_load_data_content [0m[1;39m([0m[39mExifData *data, ExifIfd ifd,[0m                       [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[39m        [0m[39m        [0m[39m     const unsigned char *d,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    [0m[39m        [0m[39m        [0m[39m     unsigned int ds, unsigned int offset, unsigned int [0m    [2m                [0m
[2;36m                    [0m         [39mrecursion_cost[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:    [0m[39mExifLong o, thumbnail_offset = [0m[1;36m0[0m[39m, thumbnail_length = [0m[1;36m0[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:    [0m[39mExifShort n;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m397[0m[39m:    [0m[39mExifEntry *entry;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:    [0m[39munsigned int i;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:    [0m[39mExifTag tag;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!data || !data->priv[0m[1;39m)[0m[39m [0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:    [0m[35m/[0m[39m* check for valid ExifIfd enum range *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:    [0m[39mif [0m[1;39m([0m[1;39m([0m[1;39m([0m[1;39m([0m[39mint[0m[1;39m)[0m[39mifd[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m || [0m[1;39m([0m[39m [0m[1;39m([0m[1;39m([0m[39mint[0m[1;39m)[0m[39mifd[0m[1;39m)[0m[39m >= EXIF_IFD_COUNT[0m[1;39m)[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:    [0m[39m  return;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:    [0m[39mif [0m[1;39m([0m[39mrecursion_cost > [0m[1;36m170[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m409[0m[39m:    [0m[39m        [0m[35m/[0m[39m*[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:    [0m[39m        [0m[39m * recursion_cost is a logarithmic-scale indicator of how expensive[0m [2m                [0m
[2;36m                    [0m         [39mthis[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:    [0m[39m        [0m[39m * recursive call might end up being. It is an indicator of the [0m    [2m                [0m
[2;36m                    [0m         [39mdepth of[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:    [0m[39m        [0m[39m * recursion as well as the potential for worst-case future [0m        [2m                [0m
[2;36m                    [0m         [39mrecursive[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m413[0m[39m:    [0m[39m        [0m[39m * calls. Since it's difficult to tell ahead of time how often [0m     [2m                [0m
[2;36m                    [0m         [39mrecursion[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m414[0m[39m:    [0m[39m        [0m[39m * will occur, this assumes the worst by assuming every tag could [0m  [2m                [0m
[2;36m                    [0m         [39mend up[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m:    [0m[39m        [0m[39m * causing recursion.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:    [0m[39m        [0m[39m * The value of [0m[1;36m170[0m[39m was chosen to limit typical EXIF structures to [0m [2m                [0m
[2;36m                    [0m         [39ma[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:    [0m[39m        [0m[39m * recursive depth of about [0m[1;36m6[0m[39m, but pathological ones [0m[1;39m([0m[39mthose with [0m   [2m                [0m
[2;36m                    [0m         [39mvery[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:    [0m[39m        [0m[39m * many tags[0m[1;39m)[0m[39m to only [0m[1;36m2[0m[39m.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:    [0m[39m        [0m[39m *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_CORRUPT_DATA, [0m[32m"ExifData"[0m[39m,[0m  [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"Deep/expensive recursion detected!"[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:    [0m[35m/[0m[39m* Read the number of entries *[0m[35m/[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m426[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset, ds, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m427[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_CORRUPT_DATA, [0m[32m"ExifData"[0m[39m,[0m  [2m                [0m
[2;36m                    [0m         [1;36m428[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"Tag data past end of buffer [0m[32m([0m[32m%u+2 > %u[0m[32m)[0m[32m"[0m[39m, offset, ds[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m429[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m430[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m431[0m[39m:    [0m[39mn = exif_get_short [0m[1;39m([0m[39md + offset, data->priv->order[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m432[0m[39m:    [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m433[0m[39m:    [0m[39m          [0m[32m"Loading %hu entries..."[0m[39m, n[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m434[0m[39m:    [0m[39moffset += [0m[1;36m2[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m435[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m436[0m[39m:    [0m[35m/[0m[39m* Check if we have enough data. *[0m[35m/[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m437[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset, ds, [0m[1;36m12[0m[39m*n[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m438[0m[39m:    [0m[39m        [0m[39mn = [0m[1;39m([0m[39mds - offset[0m[1;39m)[0m[39m [0m[35m/[0m[39m [0m[1;36m12[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m439[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m440[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"Short data; only loading %hu entries..."[0m[39m, n[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m441[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:525[0m[39m-[0m[1;36m534[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m525[0m[39m:    [0m[39m        [0m[39m        [0m[39mentry = exif_entry_new_mem [0m[1;39m([0m[39mdata->priv->mem[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m526[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39m!entry[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m527[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  exif_log [0m[1;39m([0m[39mdata->priv->log, [0m                       [2m                [0m
[2;36m                    [0m         [39mEXIF_LOG_CODE_NO_MEMORY, [0m[32m"ExifData"[0m[39m,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m528[0m[39m:                                          [0m[32m"Could not allocate memory"[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m529[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  return;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m530[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m531[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mexif_data_load_data_entry [0m[1;39m([0m[39mdata, entry, d, ds,[0m          [2m                [0m
[2;36m                    [0m         [1;36m532[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m   offset + [0m[1;36m12[0m[39m * i[0m[1;39m)[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m533[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mexif_content_add_entry [0m[1;39m([0m[39mdata->ifd[0m[1;39m[[0m[39mifd[0m[1;39m][0m[39m, entry[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m534[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_entry_unref [0m[1;39m([0m[39mentry[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:843[0m[39m-[0m[1;36m858[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m843[0m[39m:void[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;92m844:e[0m[39mxif_data_load_data [0m[1;39m([0m[39mExifData *data, const unsigned char *d_orig,[0m               [2m                [0m
[2;36m                    [0m         [1;36m845[0m[39m:    [0m[39m        [0m[39m     unsigned int ds[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m846[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m847[0m[39m:    [0m[39munsigned int l;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m848[0m[39m:    [0m[39mExifLong offset;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m849[0m[39m:    [0m[39mExifShort n;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m850[0m[39m:    [0m[39mconst unsigned char *d = d_orig;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m851[0m[39m:    [0m[39munsigned int len, fullds;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m852[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m853[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!data || !data->priv || !d || !ds[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m854[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m855[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m856[0m[39m:    [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m857[0m[39m:    [0m[39m        [0m[39m  [0m[32m"Parsing %i byte[0m[32m([0m[32ms[0m[32m)[0m[32m EXIF data...\n"[0m[39m, ds[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m858[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:917[0m[39m-[0m[1;36m929[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m917[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39mds < [0m[1;36m3[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m918[0m[39m:    [0m[39m        [0m[39m        [0m[39mLOG_TOO_SMALL;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m919[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m920[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m921[0m[39m:    [0m[39m        [0m[39md++;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m922[0m[39m:    [0m[39m        [0m[39mds--;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m923[0m[39m:    [0m[39m        [0m[39mlen = [0m[1;39m([0m[1;39m([0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39md[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | d[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m924[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m925[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"We have to deal with %i byte[0m[32m([0m[32ms[0m[32m)[0m[32m of EXIF data."[0m[39m,[0m          [2m                [0m
[2;36m                    [0m         [1;36m926[0m[39m:    [0m[39m        [0m[39m        [0m[39m  len[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m927[0m[39m:    [0m[39m        [0m[39md += [0m[1;36m2[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m928[0m[39m:    [0m[39m        [0m[39mds = len - [0m[1;36m2[0m[39m;   [0m[35m/[0m[39m* we do not want the full rest size, but only the [0m [2m                [0m
[2;36m                    [0m         [39msize of the tag *[0m[35m/[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m929[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:974[0m[39m-[0m[1;36m984[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m974[0m[39m:    [0m[35m/[0m[39m* IFD [0m[1;36m0[0m[39m offset *[0m[35m/[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m975[0m[39m:    [0m[39moffset = exif_get_long [0m[1;39m([0m[39md + [0m[1;36m10[0m[39m, data->priv->order[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m976[0m[39m:    [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m, [0m                [2m                [0m
[2;36m                    [0m         [1;36m977[0m[39m:    [0m[39m        [0m[39m  [0m[32m"IFD 0 at %i."[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m offset[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m978[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m979[0m[39m:    [0m[35m/[0m[39m* ds is restricted to [0m[1;36m16[0m[39m bit above, so offset is restricted too, and [0m      [2m                [0m
[2;36m                    [0m         [39moffset+[0m[1;36m8[0m[39m should not overflow. *[0m[35m/[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m980[0m[39m:    [0m[39mif [0m[1;39m([0m[39moffset > ds || offset + [0m[1;36m6[0m[39m + [0m[1;36m2[0m[39m > ds[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m981[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m982[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m983[0m[39m:    [0m[35m/[0m[39m* Parse the actual exif data [0m[1;39m([0m[39musually offset [0m[1;36m14[0m[39m from start[0m[1;39m)[0m[39m *[0m[35m/[0m             [2m                [0m
[2;36m                    [0m         [1;36m984[0m[39m:    [0m[39mexif_data_load_data_content [0m[1;39m([0m[39mdata, EXIF_IFD_0, d + [0m[1;36m6[0m[39m, ds - [0m[1;36m6[0m[39m, offset, [0m[1;36m0[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:324[0m[39m-[0m[1;36m346[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m324[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m325:e[0m[39mxif_data_load_data_thumbnail [0m[1;39m([0m[39mExifData *data, const unsigned char *d,[0m          [2m                [0m
[2;36m                    [0m         [1;36m326[0m[39m:    [0m[39m        [0m[39m        [0m[39m       unsigned int ds, ExifLong o, ExifLong s[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m327[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m328[0m[39m:    [0m[35m/[0m[39m* Sanity checks *[0m[35m/[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m329[0m[39m:    [0m[39mif [0m[1;39m([0m[39mo >= ds[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m330[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m, [0m[32m"Bogus [0m [2m                [0m
[2;36m                    [0m         [32mthumbnail offset [0m[32m([0m[32m%u[0m[32m)[0m[32m."[0m[39m, o[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m331[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m332[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m333[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo,ds,s[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m334[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m, [0m[32m"Bogus [0m [2m                [0m
[2;36m                    [0m         [32mthumbnail size [0m[32m([0m[32m%u[0m[32m)[0m[32m, max would be %u."[0m[39m, s, ds-o[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m335[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m336[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m337[0m[39m:    [0m[39mif [0m[1;39m([0m[39mdata->data[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m338[0m[39m:    [0m[39m        [0m[39mexif_mem_free [0m[1;39m([0m[39mdata->priv->mem, data->data[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m339[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;39m([0m[39mdata->data = exif_data_alloc [0m[1;39m([0m[39mdata, s[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m340[0m[39m:    [0m[39m        [0m[39mEXIF_LOG_NO_MEMORY [0m[1;39m([0m[39mdata->priv->log, [0m[32m"ExifData"[0m[39m, s[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m341[0m[39m:    [0m[39m        [0m[39mdata->size = [0m[1;36m0[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m342[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m343[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m344[0m[39m:    [0m[39mdata->size = s;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m345[0m[39m:    [0m[39mmemcpy [0m[1;39m([0m[39mdata->data, d + o, s[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m346[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:901[0m[39m-[0m[1;36m910[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m901[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mds >= [0m[1;36m3[0m[39m && d[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m >= [0m[1;36m0xe0[0m[39m && d[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m <= [0m[1;36m0xef[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m  [0m[35m/[0m[39m* [0m         [2m                [0m
[2;36m                    [0m         [39mJPEG_MARKER_APPn *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m902[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39md++;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m903[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mds--;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m904[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39ml = [0m[1;39m([0m[1;39m([0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39md[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | d[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m905[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39ml > ds[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m906[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mreturn;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m907[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39md += l;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m908[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mds -= l;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m909[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m910[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/canon/exif-mnote-data-canon.[0m[1;92mc:218[0m[39m-[0m[1;36m233[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:    [0m[35m/[0m[39m* Read the number of tags *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:    [0m[39mc = exif_get_short [0m[1;39m([0m[39mbuf + datao, n->order[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    [0m[39mdatao += [0m[1;36m2[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:    [0m[35m/[0m[39m* Just use an arbitrary max tag limit here to avoid needing to much memory[0m [2m                [0m
[2;36m                    [0m         [39mor time. There are [0m[1;36m24[0m[39m named tags currently.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[39m * current [0m[1;36m2020[0m[39m camera EOS M6 Mark [0m[1;36m2[0m[39m had [0m[1;36m156[0m[39m entries.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[39m * The format allows specifying the same range of memory as often as it [0m    [2m                [0m
[2;36m                    [0m         [39mcan, so this multiplies quickly. *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[39mif [0m[1;39m([0m[39mc > [0m[1;36m250[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA, [0m[32m"ExifMnoteCanon"[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [32m"Too much tags [0m[32m([0m[32m%d[0m[32m)[0m[32m in Canon MakerNote"[0m[39m, c[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m1[0m[39m. Root Cause Analysis[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe heap-buffer-overflow vulnerability occurs in `libexif/exif-data.c` at line [0m[1;36m928[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39min the `exif_data_load_data` function. The root cause is:[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Missing validation of untrusted length field**: The code reads a length value [0m    [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`len`[0m[1;39m)[0m[39m from the EXIF data at line [0m[1;36m923[0m[39m and directly uses it to set the buffer size [0m [2m                [0m
[2;36m                    [0m         [39mvariable [0m[1;39m([0m[39m`ds`[0m[1;39m)[0m[39m at line [0m[1;36m928[0m[39m without validating that this length doesn't exceed the [0m [2m                [0m
[2;36m                    [0m         [39mactual remaining buffer size.[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Vulnerability chain**:[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Line [0m[1;36m922[0m[39m: `ds--` - represents the actual remaining buffer size [0m[1;39m([0m[39me.g., [0m[1;36m206[0m[39m bytes[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Line [0m[1;36m923[0m[39m: `len = [0m[1;39m([0m[1;39m([0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39md[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | d[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;` - reads length from [0m       [2m                [0m
[2;36m                    [0m         [39muntrusted fuzzer input [0m[1;39m([0m[39me.g., [0m[1;36m225[0m[39m bytes[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Line [0m[1;36m928[0m[39m: `ds = len - [0m[1;36m2[0m[39m;` - overwrites `ds` with inflated value [0m[1;39m([0m[1;36m223[0m[39m bytes[0m[1;39m)[0m[39m [0m     [2m                [0m
[2;36m                    [0m         [39mWITHOUT validation[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. This inflated `ds` propagates to `exif_data_load_data_content` [0m[1;39m([0m[39mline [0m[1;36m984[0m[1;39m)[0m[39m and [0m   [2m                [0m
[2;36m                    [0m         [39m`exif_data_load_data_entry` [0m[1;39m([0m[39mline [0m[1;36m531[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. The bounds checks in `exif_data_load_data_entry` [0m[1;39m([0m[39mlines [0m[1;36m198[0m[39m, [0m[1;36m204[0m[1;39m)[0m[39m use this [0m      [2m                [0m
[2;36m                    [0m         [39minflated size, so they incorrectly pass[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. The `memcpy` at line [0m[1;36m213[0m[39m attempts to read [0m[1;36m16[0m[39m bytes from offset [0m[1;36m207[0m[39m in a [0m[1;36m207[0m[39m-byte[0m [2m                [0m
[2;36m                    [0m         [39mbuffer, causing the overflow[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m2[0m[39m. Fix Implementation[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: `libexif/exif-data.c`, between lines [0m[1;36m923[0m[39m and [0m[1;36m927[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Add validation**:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mlen = [0m[1;39m([0m[1;39m([0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39md[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | d[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Validate that the claimed length doesn't exceed actual buffer[0m                    [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mlen < [0m[1;36m2[0m[39m || len > ds[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mexif_log[0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_CORRUPT_DATA, [0m[32m"ExifData"[0m[39m,[0m               [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35m_[0m[1;39m([0m[32m"Size of EXIF data [0m[32m([0m[32m%u[0m[32m)[0m[32m is invalid or exceeds buffer [0m[32m([0m[32m%u[0m[32m)[0m[32m."[0m[1;39m)[0m[39m, len, [0m  [2m                [0m
[2;36m                    [0m         [39mds[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    return;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;35mexif_log[0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m                          [2m                [0m
[2;36m                    [0m         [39m         [0m[32m"We have to deal with %i byte[0m[32m([0m[32ms[0m[32m)[0m[32m of EXIF data."[0m[39m, len[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39md += [0m[1;36m2[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mds = len - [0m[1;36m2[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Validation logic**:[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- `len < [0m[1;36m2[0m[39m`: The length field must be at least [0m[1;36m2[0m[39m bytes [0m[1;39m([0m[39maccounting for the [0m[1;36m2[0m[39m-byte [0m  [2m                [0m
[2;36m                    [0m         [39mlength field itself per JPEG APP segment format[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m- `len > ds`: The claimed length must not exceed the actual remaining buffer size [0m  [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`ds` at line [0m[1;36m922[0m[39m represents the true remaining buffer after pointer adjustments[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m3[0m[39m. Why This Fix is Optimal[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Follows existing patterns**: The codebase already implements this exact [0m          [2m                [0m
[2;36m                    [0m         [39mvalidation pattern at lines [0m[1;36m904[0m[39m-[0m[1;36m906[0m[39m for other JPEG APP markers:[0m                     [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39ml = [0m[1;39m([0m[1;39m([0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39md[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | d[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39ml > ds[0m[1;39m)[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m    return;[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Preserves existing logic**:[0m                                                       [2m                [0m
[2;36m                    [0m         [39m- Does not modify the parsing algorithm or data structures[0m                          [2m                [0m
[2;36m                    [0m         [39m- Maintains the same control flow for valid EXIF data[0m                               [2m                [0m
[2;36m                    [0m         [39m- Only adds a safety check that rejects malformed/malicious data[0m                    [2m                [0m
[2;36m                    [0m         [39m- Uses existing error logging mechanisms consistent with the codebase[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Addresses the exact issue**:[0m                                                      [2m                [0m
[2;36m                    [0m         [39m- Prevents the inflated `ds` value from propagating to downstream functions[0m         [2m                [0m
[2;36m                    [0m         [39m- Ensures all subsequent bounds checks operate on accurate buffer sizes[0m             [2m                [0m
[2;36m                    [0m         [39m- Stops the vulnerability at its source before memory operations occur[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Minimal and surgical**:[0m                                                           [2m                [0m
[2;36m                    [0m         [39m- Only [0m[1;36m5[0m[39m lines of code added[0m                                                        [2m                [0m
[2;36m                    [0m         [39m- No changes to function signatures or APIs[0m                                         [2m                [0m
[2;36m                    [0m         [39m- No impact on valid EXIF data processing[0m                                           [2m                [0m
[2;36m                    [0m         [39m- No modification to fuzzing harness or test infrastructure[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m4[0m[39m. Impact Analysis[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Security impact**:[0m                                                                [2m                [0m
[2;36m                    [0m         [39m- Completely prevents the heap-buffer-overflow vulnerability[0m                        [2m                [0m
[2;36m                    [0m         [39m- Protects against maliciously crafted EXIF data with inflated length fields[0m        [2m                [0m
[2;36m                    [0m         [39m- No new vulnerabilities introduced[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Functional impact**:[0m                                                              [2m                [0m
[2;36m                    [0m         [39m- Valid EXIF files continue to parse correctly [0m[1;39m([0m[39mlen will match actual buffer size[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m- Invalid/corrupted EXIF files are rejected with proper error logging[0m               [2m                [0m
[2;36m                    [0m         [39m- Maintains backward compatibility for all legitimate use cases[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Side effects**:[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- Malformed EXIF data will be rejected earlier in the parsing pipeline[0m              [2m                [0m
[2;36m                    [0m         [39m- Error logging provides clear diagnostic information[0m                               [2m                [0m
[2;36m                    [0m         [39m- No impact on performance for valid data [0m[1;39m([0m[39msingle comparison added[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m5[0m[39m. Why This Doesn't Modify the Harness[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe harness code [0m[1;39m([0m[39m`exif_from_data_fuzzer.cc`[0m[1;39m)[0m[39m serves as an entry point for fuzzing [0m [2m                [0m
[2;36m                    [0m         [39mand is NOT the root cause. The harness:[0m                                             [2m                [0m
[2;36m                    [0m         [39m- Simply calls `[0m[1;35mexif_data_new_from_data[0m[1;39m([0m[1;39m)[0m[39m` with fuzzer-provided data[0m                [2m                [0m
[2;36m                    [0m         [39m- This is the intended API usage for parsing EXIF data[0m                              [2m                [0m
[2;36m                    [0m         [39m- The vulnerability exists in the library's internal parsing logic, not in how it's[0m [2m                [0m
[2;36m                    [0m         [39minvoked[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix addresses the library's incorrect trust of untrusted length fields, which [0m  [2m                [0m
[2;36m                    [0m         [39mis where the actual bug resides. The fuzzing logic remains unchanged and will [0m      [2m                [0m
[2;36m                    [0m         [39mcontinue to test the codebase effectively.[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m6[0m[39m. Relationship to Test Code[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis fix does not modify any test code because:[0m                                     [2m                [0m
[2;36m                    [0m         [39m- The vulnerability is in production parsing code, not test infrastructure[0m          [2m                [0m
[2;36m                    [0m         [39m- Valid test cases will continue to pass [0m[1;39m([0m[39mtheir length fields match actual data[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m- Only malformed test cases designed to trigger this specific vulnerability will [0m   [2m                [0m
[2;36m                    [0m         [39mnow be properly rejected[0m                                                            [2m                [0m
[2;36m                    [0m         [39m- The fix maintains API compatibility and doesn't break existing tests[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m7[0m[39m. Alternative Approaches Considered and Rejected[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Alternative [0m[1;36m1[0m[39m**: Add validation in `exif_data_load_data_entry` at line [0m[1;36m198[0m[39m/[0m[1;36m204[0m    [2m                [0m
[2;36m                    [0m         [39m- **Rejected**: This treats the symptom, not the cause. The inflated `size` [0m        [2m                [0m
[2;36m                    [0m         [39mparameter would still be incorrect for other uses within the function and in [0m       [2m                [0m
[2;36m                    [0m         [39msibling code paths.[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Alternative [0m[1;36m2[0m[39m**: Use CHECKOVERFLOW macro at line [0m[1;36m928[0m                              [2m                [0m
[2;36m                    [0m         [39m- **Rejected**: The macro is designed for offset+size calculations, not for [0m        [2m                [0m
[2;36m                    [0m         [39mvalidating a length field against buffer bounds. The direct comparison is clearer [0m  [2m                [0m
[2;36m                    [0m         [39mand matches the pattern at line [0m[1;36m905[0m[39m.[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Alternative [0m[1;36m3[0m[39m**: Cap `ds` to remaining buffer size after line [0m[1;36m928[0m                 [2m                [0m
[2;36m                    [0m         [39m- **Rejected**: This would silently truncate data, potentially causing subtle [0m      [2m                [0m
[2;36m                    [0m         [39mparsing errors or incomplete EXIF data. Rejecting invalid data with an error is the[0m [2m                [0m
[2;36m                    [0m         [39mcorrect approach.[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m8[0m[39m. Consistency with Codebase Patterns[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix maintains consistency with multiple existing patterns:[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Lines [0m[1;36m904[0m[39m-[0m[1;36m906[0m[39m**: Identical validation pattern for other APP marker lengths[0m     [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Lines [0m[1;36m329[0m[39m-[0m[1;36m335[0m[39m** [0m[1;39m([0m[39m`exif_data_load_data_thumbnail`[0m[1;39m)[0m[39m: Validates offsets and sizes[0m [2m                [0m
[2;36m                    [0m         [39mbefore memcpy[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Lines [0m[1;36m218[0m[39m-[0m[1;36m222[0m[39m** [0m[1;39m([0m[39mCanon MakerNote loader[0m[1;39m)[0m[39m: Uses CHECKOVERFLOW before reading [0m   [2m                [0m
[2;36m                    [0m         [39mdata[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Lines [0m[1;36m980[0m[39m-[0m[1;36m981[0m[39m**: Validates IFD offset against buffer size[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe proposed fix applies the same defensive programming philosophy already present [0m [2m                [0m
[2;36m                    [0m         [39mthroughout the codebase.[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=352712;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=496129;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=269994;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=248124;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpxh7__s1r[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/libexif_ex-delta-03_exif-002/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1767717619.8586218[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/libexif_ex-delta-03_exif-[1;36m002.[0mtoml                     [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-libexif[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/06/26 16:40:21][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mlibexif[0m        ]8;id=364027;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=111541;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m[01/06/26 16:40:22][0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=835142;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=765806;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mlibexif[0m               [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=348043;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=886813;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m                [2m               [0m
