[2;36m[01/05/26 21:31:54][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=846484;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=402303;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpwnqvjnrk[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/pdfbox_pdfbox-full-01_vuln_8/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1767648714.7287498[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc/pdfbox_pdfbox-full-01_vuln_8.toml       [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-pdfbox[0m           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Building Cached for CLEAN environment[1m)[0m Started[33m...[0m ]8;id=143536;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=622580;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 21:33:11][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Building Cached for CLEAN environment[1m)[0m Took      ]8;id=592376;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=777849;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m76.78[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running tests for Cached for CLEAN environment[1m)[0m   ]8;id=722917;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=32590;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=558765;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=334235;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=744215;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=785873;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m76[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=668693;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=573887;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 21:33:12][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.91[0m seconds;                ]8;id=871886;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=108045;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/05/26 21:33:13][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=391334;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=847485;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=156458;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=360001;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=306571;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=340854;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=631191;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=564534;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 21:33:14][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m1.18[0m seconds;                ]8;id=829280;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=746348;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/05/26 21:33:15][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=496553;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=741583;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 21:33:16][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.89[0m seconds;                ]8;id=629811;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=463841;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/05/26 21:33:47][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=103146;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=511020;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 21:33:48][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.98[0m seconds;                ]8;id=106737;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=91684;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running a pov[1m)[0m Started[33m...[0m                         ]8;id=768074;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=914426;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 21:34:19][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running a pov[1m)[0m Took [1;36m30.54[0m seconds;               ]8;id=477505;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=807347;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;92mTrue[0m                                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m Crash analysis results is empty. This should not happen.                              ]8;id=415845;file:///home/user/crete/packages/crete/commons/crash_analysis/functions/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=643425;file:///home/user/crete/packages/crete/commons/crash_analysis/functions/__init__.py#41\[2m41[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=309461;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=716824;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.89[0m seconds;                ]8;id=897429;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=153241;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/05/26 21:34:51][0m[2;36m [0m[34mINFO    [0m Found jstack output at                                                                ]8;id=825410;file:///home/user/crete/packages/crete/framework/analyzer/services/jvm_timeout_stacktrace/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=643515;file:///home/user/crete/packages/crete/framework/analyzer/services/jvm_timeout_stacktrace/__init__.py#43\[2m43[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/pdfbox/[0m[95mjstack.txt[0m       [2m              [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=637647;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=620088;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         ERROR: libFuzzer: timeout                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         ERROR: libFuzzer: timeout                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/05/26 21:35:11][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=235068;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=329785;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/05/26 21:41:58][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=90036;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=864790;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/05/26 21:43:16][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=821637;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=915741;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=940523;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=90871;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 21:43:17][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.93[0m seconds;                ]8;id=469629;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=174275;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Patching[1m)[0m Started[33m...[0m                              ]8;id=604052;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=796261;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpl2t205jo[0m                                                 ]8;id=896885;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=345374;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/05/26 21:44:14][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Patching[1m)[0m Took [1;36m56.49[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=87831;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=897623;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Checking build[1m)[0m Started[33m...[0m                        ]8;id=106073;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=4616;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 21:44:29][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Checking build[1m)[0m Took [1;36m14.98[0m seconds;              ]8;id=64035;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=348466;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running PoV[1m)[0m Started[33m...[0m                           ]8;id=470526;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=578237;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 21:44:35][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running PoV[1m)[0m Took [1;36m6.02[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=267675;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=516363;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Testing[1m)[0m Started[33m...[0m                               ]8;id=720055;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=486448;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=655750;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=179827;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=638089;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=918965;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 21:44:36][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.96[0m seconds;                ]8;id=6497;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=545896;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/05/26 21:44:37][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=6650;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=587909;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 21:44:38][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.99[0m seconds;                ]8;id=792993;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=973606;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=854539;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=16614;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/05/26 21:44:39][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.94[0m seconds;                ]8;id=609221;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=31932;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=853793;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=66318;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java               [2m                [0m
[2;36m                    [0m         +++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java               [2m                [0m
[2;36m                    [0m         @@ [1;36m-219[0m,[1;36m7[0m +[1;36m219[0m,[1;36m10[0m @@                                                                [2m                [0m
[2;36m                    [0m                                      || [1;35mlexer.peekToken[0m[1m([0m[1m)[0m[1;35m.getText[0m[1m([0m[1m)[0m[1;35m.equals[0m[1m([0m[32m"readonly"[0m[1m)[0m      [2m                [0m
[2;36m                    [0m                                      || [1;35mlexer.peekToken[0m[1m([0m[1m)[0m[1;35m.getText[0m[1m([0m[1m)[0m[1;35m.equals[0m[1m([0m[32m"def"[0m[1m)[0m[1m)[0m[1m)[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                      [1m{[0m                                                                      [2m                [0m
[2;36m                    [0m         -                [1;35mlexer.nextToken[0m[1m([0m[1m)[0m;                                                 [2m                [0m
[2;36m                    [0m         +                if [1m([0m[1;35mlexer.nextToken[0m[1m([0m[1m)[0m == null[1m)[0m                                     [2m                [0m
[2;36m                    [0m         +                [1m{[0m                                                                  [2m                [0m
[2;36m                    [0m         +                    throw new [1;35mIOException[0m[1m([0m[32m"Unexpected EOF while looking for dup, [0m  [2m                [0m
[2;36m                    [0m         [32mreadonly or def"[0m[1m)[0m;                                                                  [2m                [0m
[2;36m                    [0m         +                [1m}[0m                                                                  [2m                [0m
[2;36m                    [0m                      [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                      Map[1m<[0m[1;95mInteger[0m[39m, String> codeToName = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-640[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m643[0m[39m,[0m[1;36m10[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m         while [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [39m                 && [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"CharStrings"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m-            [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Unexpected EOF while looking for [0m           [2m                [0m
[2;36m                    [0m         [32mCharStrings"[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[39m CharStrings dict[0m                                                        [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-707[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m713[0m[39m,[0m[1;36m11[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[39m allocate size [0m[1;39m([0m[39marray indexes may not be in-order[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m         int length = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[39mlength < [0m[1;36m0[0m[39m || length > [0m[1;36m65535[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Invalid Subrs array size: "[0m[39m + length + [0m         [2m                [0m
[2;36m                    [0m         [39m+                    [0m[32m". Must be between 0 and 65535"[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m         for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mfont.subrs.add[0m[1;39m([0m[39mnull[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m--- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java[0m                [2m                [0m
[2;36m                    [0m         [39m+++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java[0m                [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-22[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m22[0m[39m,[0m[1;36m7[0m[39m @@[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m import java.io.IOException;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m import java.nio.BufferUnderflowException;[0m                                          [2m                [0m
[2;36m                    [0m         [39m import java.nio.ByteBuffer;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m+import org.apache.fontbox.type1.DamagedFontException;[0m                              [2m                [0m
[2;36m                    [0m         [39m import org.apache.logging.log4j.Logger;[0m                                            [2m                [0m
[2;36m                    [0m         [39m import org.apache.logging.log4j.LogManager;[0m                                        [2m                [0m
[2;36m                    [0m         [39m [0m[35m/[0m[39m**[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-48[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m49[0m[39m,[0m[1;36m7[0m[39m @@[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m      * Log instance.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m      *[0m[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m     private static final Logger LOG = [0m[1;35mLogManager.getLogger[0m[1;39m([0m[39mType1Lexer.class[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [39m+    private static final int MAX_CHAR_STRING_SIZE = 1_000_000;[0m                     [2m                [0m
[2;36m                    [0m         [39m     [0m                                                                               [2m                [0m
[2;36m                    [0m         [39m     private final ByteBuffer buffer;[0m                                               [2m                [0m
[2;36m                    [0m         [39m     private Token aheadToken;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-501[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m503[0m[39m,[0m[1;36m11[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m      *[0m[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m     private Token [0m[1;35mreadCharString[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m throws IOException[0m                    [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[39mlength > MAX_CHAR_STRING_SIZE[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+            throw new [0m[1;35mDamagedFontException[0m[1;39m([0m[32m"char string is too long. [0m[32mlength[0m[32m="[0m[39m +[0m    [2m                [0m
[2;36m                    [0m         [39m+                    length + [0m[32m" [0m[32mmax_length[0m[32m="[0m[39m + MAX_CHAR_STRING_SIZE[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m         try[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mbuffer.get[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m space[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m--- a/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java[0m                   [2m                [0m
[2;36m                    [0m         [39m+++ b/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java[0m                   [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-158[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m158[0m[39m,[0m[1;36m7[0m[39m @@[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m             size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m16[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m             size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m24[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, size[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [39m-            long newTotal = total + size;[0m                                          [2m                [0m
[2;36m                    [0m         [39m+            long newTotal = [0m[1;39m([0m[39mlong[0m[1;39m)[0m[39mtotal + [0m[1;39m([0m[39mlong[0m[1;39m)[0m[39msize;[0m                              [2m                [0m
[2;36m                    [0m         [39m             if [0m[1;39m([0m[39mnewTotal > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [39m                 throw new [0m[1;35mIOException[0m[1;39m([0m[32m"record size would be too large: "[0m[39m + [0m        [2m                [0m
[2;36m                    [0m         [39mnewTotal[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java[0m                [2m                [0m
[2;36m                    [0m         [39m+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java[0m                [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-180[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m180[0m[39m,[0m[1;36m7[0m[39m @@[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m     private final class PageIterator implements Iterator<PDPage>[0m                   [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m         private final Queue<COSDictionary> queue = new ArrayDeque<>[0m[1;39m([0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [39m+        private final Set<COSDictionary> seen = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m         private [0m[1;35mPageIterator[0m[1;39m([0m[39mCOSDictionary node[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-205[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m206[0m[39m,[0m[1;36m12[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m          *[0m[35m/[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m         private List<COSDictionary> [0m[1;35menqueueKids[0m[1;39m([0m[39mCOSDictionary node[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[1;35mseen.contains[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Found an infinite loop in the page tree"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [39m+                return Collections.EMPTY_LIST;[0m                                     [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mseen.add[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m             if [0m[1;39m([0m[1;35misPageTreeNode[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m                 return [0m[1;35mgetKids[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java[0m              [2m                [0m
[2;36m                    [0m         [39m+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java[0m              [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-23[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m23[0m[39m,[0m[1;36m7[0m[39m @@[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m import java.util.Map;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m import java.util.Optional;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m import java.util.Map.Entry;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m+import java.util.Set;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m import org.apache.logging.log4j.LogManager;[0m                                        [2m                [0m
[2;36m                    [0m         [39m import org.apache.logging.log4j.Logger;[0m                                            [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-98[0m[39m,[0m[1;36m17[0m[39m +[0m[1;36m99[0m[39m,[0m[1;36m19[0m[39m @@[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mdocument.setStartXref[0m[1;39m([0m[39mstartXrefOffset[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m         long prev = startXrefOffset;[0m                                               [2m                [0m
[2;36m                    [0m         [39m-        [0m[35m/[0m[35m/[0m[95mlastPrev[0m[39m prevents potential infinite loops in crafted files[0m              [2m                [0m
[2;36m                    [0m         [39m-        long lastPrev = [0m[1;36m-1[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[39m ---- parse whole chain of xref tables/object streams using PREV [0m        [2m                [0m
[2;36m                    [0m         [39mreference[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+        Set<Long> prevSet = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m         COSDictionary trailer = null;[0m                                              [2m                [0m
[2;36m                    [0m         [39m-        while [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[39m && prev != lastPrev[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m-            lastPrev = prev;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+        while [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+            [0m[35m/[0m[35m/[0m[39m save expected position for loop detection[0m                           [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mprevSet.add[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m             [0m[35m/[0m[35m/[0m[39m seek to xref table[0m                                                  [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35msource.seek[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m             [0m[35m/[0m[35m/[0m[39m skip white spaces[0m                                                   [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mparser.skipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+            [0m[35m/[0m[35m/[0m[39m save current position as well due to skipped spaces[0m                 [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mprevSet.add[0m[1;39m([0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [39m             [0m[35m/[0m[35m/[0m[39m -- parse xref[0m                                                       [2m                [0m
[2;36m                    [0m         [39m             if [0m[1;39m([0m[1;35msource.peek[0m[1;39m([0m[1;39m)[0m[39m == X[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-170[0m[39m,[0m[1;36m9[0m[39m +[0m[1;36m173[0m[39m,[0m[1;36m9[0m[39m @@[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m                     [0m[1;35mtrailer.setLong[0m[1;39m([0m[39mCOSName.PREV, prev[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m-            if [0m[1;39m([0m[39mprev == lastPrev[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39m-            [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m-                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"/Prev loop at offset "[0m[39m + prev[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[1;35mprevSet.contains[0m[1;39m([0m[39mprev[0m[1;39m)[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"/Prev loop detected at offset "[0m[39m + prev[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[39m ---- build valid xrefs out of the xref chain[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39mERROR: libFuzzer: timeout[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe codebase is experiencing a timeout error during fuzzing operations with [0m        [2m                [0m
[2;36m                    [0m         [39mlibFuzzer. This indicates that the fuzzer encountered an input that caused [0m         [2m                [0m
[2;36m                    [0m         [39mexecution to exceed the configured timeout threshold, suggesting the presence of [0m   [2m                [0m
[2;36m                    [0m         [39mcode that can enter an unexpectedly long-running or potentially infinite execution [0m [2m                [0m
[2;36m                    [0m         [39mpath.[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Issue Details[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe error [0m[32m"libFuzzer: timeout"[0m[39m indicates that during fuzz testing, at least one [0m    [2m                [0m
[2;36m                    [0m         [39mtest case caused the program execution to exceed the maximum allowed time limit. [0m   [2m                [0m
[2;36m                    [0m         [39mLibFuzzer implements timeout mechanisms to detect inputs that trigger abnormally [0m   [2m                [0m
[2;36m                    [0m         [39mlong execution paths, which could indicate:[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Performance issues that manifest with certain inputs[0m                              [2m                [0m
[2;36m                    [0m         [39m- Algorithmic complexity problems where specific inputs trigger worst-case [0m         [2m                [0m
[2;36m                    [0m         [39mscenarios[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m- Infinite or near-infinite loops[0m                                                   [2m                [0m
[2;36m                    [0m         [39m- Deadlocks or resource contention issues[0m                                           [2m                [0m
[2;36m                    [0m         [39m- Recursive calls that don't terminate properly[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Vulnerability Classification[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis represents a **Denial of Service [0m[1;39m([0m[39mDoS[0m[1;39m)[0m[39m** vulnerability class. While timeout [0m   [2m                [0m
[2;36m                    [0m         [39missues don't typically result in memory corruption or information disclosure, they [0m [2m                [0m
[2;36m                    [0m         [39mcan be exploited to:[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Cause resource exhaustion by forcing the application to consume excessive CPU [0m    [2m                [0m
[2;36m                    [0m         [39mtime[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m- Make the application unresponsive to legitimate requests[0m                          [2m                [0m
[2;36m                    [0m         [39m- Enable algorithmic complexity attacks where carefully crafted inputs trigger [0m     [2m                [0m
[2;36m                    [0m         [39mworst-case performance[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Important Observations[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Reproducibility**: The fuzzer has identified at least one input that reliably [0m [2m                [0m
[2;36m                    [0m         [39mtriggers the timeout condition. This input may be saved in the fuzzer's [0m            [2m                [0m
[2;36m                    [0m         [39mcrash/timeout corpus for reproduction and analysis.[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Timeout Threshold**: The specific timeout duration depends on libFuzzer's [0m     [2m                [0m
[2;36m                    [0m         [39mconfiguration [0m[1;39m([0m[39mtypically set via `-timeout` flag or default values[0m[1;39m)[0m[39m. The fact that [0m [2m                [0m
[2;36m                    [0m         [39mthis threshold was exceeded indicates substantial execution time.[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Fuzzer Coverage**: The timeout occurred during automated testing, meaning the [0m [2m                [0m
[2;36m                    [0m         [39mproblematic code path is reachable through the fuzzing harness entry point.[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Investigation Areas[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo gain a holistic understanding of this issue, the following areas of the codebase[0m [2m                [0m
[2;36m                    [0m         [39mshould be investigated:[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Fuzzing Harness**: Examine the harness code to understand:[0m                     [2m                [0m
[2;36m                    [0m         [39m   - Which functions/APIs are being tested[0m                                          [2m                [0m
[2;36m                    [0m         [39m   - How input data is processed and passed to the target code[0m                      [2m                [0m
[2;36m                    [0m         [39m   - What code paths are being exercised[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Input Processing Logic**: Investigate components that:[0m                         [2m                [0m
[2;36m                    [0m         [39m   - Parse or process external input[0m                                                [2m                [0m
[2;36m                    [0m         [39m   - Perform validation or sanitization[0m                                             [2m                [0m
[2;36m                    [0m         [39m   - Transform input data before further processing[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Algorithmic Components**: Review code sections containing:[0m                     [2m                [0m
[2;36m                    [0m         [39m   - Loops [0m[1;39m([0m[39mfor, while, do-while[0m[1;39m)[0m[39m that depend on input values[0m                       [2m                [0m
[2;36m                    [0m         [39m   - Recursive functions[0m                                                            [2m                [0m
[2;36m                    [0m         [39m   - Search or sorting algorithms[0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - Pattern matching or string processing operations[0m                               [2m                [0m
[2;36m                    [0m         [39m   - Graph traversal or tree operations[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Resource-Intensive Operations**: Examine areas with:[0m                           [2m                [0m
[2;36m                    [0m         [39m   - Complex computational operations[0m                                               [2m                [0m
[2;36m                    [0m         [39m   - Large data structure manipulations[0m                                             [2m                [0m
[2;36m                    [0m         [39m   - Memory allocation patterns that depend on input size[0m                           [2m                [0m
[2;36m                    [0m         [39m   - Network or I/O operations that might block[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Control Flow Dependencies**: Analyze:[0m                                          [2m                [0m
[2;36m                    [0m         [39m   - Conditional branches that depend on input characteristics[0m                      [2m                [0m
[2;36m                    [0m         [39m   - State machines or parsers that could enter problematic states[0m                  [2m                [0m
[2;36m                    [0m         [39m   - Termination conditions for loops and recursive calls[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Known Performance Bottlenecks**: Review any previously identified [0m             [2m                [0m
[2;36m                    [0m         [39mperformance-sensitive code paths that might be triggered by specific input [0m         [2m                [0m
[2;36m                    [0m         [39mpatterns.[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe investigation should focus on identifying which specific input characteristics [0m [2m                [0m
[2;36m                    [0m         [39mtrigger the timeout and tracing the execution path to determine where excessive [0m    [2m                [0m
[2;36m                    [0m         [39mtime is being consumed.[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mERROR: libFuzzer: timeout[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:20[0m[39m-[0m[1;36m27[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import org.apache.fontbox.encoding.BuiltInEncoding;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import org.apache.fontbox.encoding.StandardEncoding;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:192[0m[39m-[0m[1;36m239[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:    private void [0m[1;35mreadEncoding[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                              [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:        if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:            String name = [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:            if [0m[1;39m([0m[1;35mname.equals[0m[1;39m([0m[32m"StandardEncoding"[0m[1;39m)[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:                font.encoding = StandardEncoding.INSTANCE;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Unknown encoding: "[0m[39m + name[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:            [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"readonly"[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"def"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:        else[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"array"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:            [0m[35m/[0m[35m/[0m[39m [0m[1;36m0[0m[39m [0m[1;36m1[0m[39m [0m[1;36m255[0m[39m [0m[1;39m{[0m[1;36m1[0m[39m index exch [0m[35m/[0m[95m.notdef[0m[39m put [0m[1;39m}[0m[39m for[0m                         [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:            [0m[35m/[0m[35m/[0m[39m we have to check [0m[32m"readonly"[0m[39m and [0m[32m"def"[0m[39m too[0m                        [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:            [0m[35m/[0m[35m/[0m[39m as some fonts don't provide any dup-values, see PDFBOX-[0m[1;36m2134[0m      [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:            while [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                    && [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"dup"[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:                            || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"readonly"[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                            || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"def"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:            Map<Integer, String> codeToName = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:            while [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m &&[0m                                [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                    [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"dup"[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dup"[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                int code = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                String name = [0m[1;35mread[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"put"[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                [0m[1;35mcodeToName.put[0m[1;39m([0m[39mcode, name[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:            font.encoding = new [0m[1;35mBuiltInEncoding[0m[1;39m([0m[39mcodeToName[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:            [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"readonly"[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"def"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:20[0m[39m-[0m[1;36m27[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import org.apache.fontbox.encoding.BuiltInEncoding;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import org.apache.fontbox.encoding.StandardEncoding;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:636[0m[39m-[0m[1;36m650[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m636[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m637[0m[39m:        [0m[35m/[0m[35m/[0m[39m some fonts have [0m[32m"2 index"[0m[39m here, others have [0m[32m"end noaccess put"[0m       [2m                [0m
[2;36m                    [0m         [1;36m638[0m[39m:        [0m[35m/[0m[35m/[0m[39m sometimes followed by [0m[32m"put"[0m[39m. Either way, we just skip until[0m          [2m                [0m
[2;36m                    [0m         [1;36m639[0m[39m:        [0m[35m/[0m[35m/[0m[39m the [0m[35m/[0m[95mCharStrings[0m[39m dict is found[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m640[0m[39m:        while [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m641[0m[39m:                && [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"CharStrings"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [1;36m642[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m643[0m[39m:            [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m644[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m645[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m646[0m[39m:        [0m[35m/[0m[35m/[0m[39m CharStrings dict[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m647[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.LITERAL, [0m[32m"CharStrings"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m648[0m[39m:        [0m[1;35mreadCharStrings[0m[1;39m([0m[39mlenIV[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m649[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m650[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:22[0m[39m-[0m[1;36m26[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.BufferUnderflowException;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.ByteBuffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.logging.log4j.LogManager;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:45[0m[39m-[0m[1;36m111[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m45:c[0m[39mlass Type1Lexer[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * Log instance.[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    private static final Logger LOG = [0m[1;35mLogManager.getLogger[0m[1;39m([0m[39mType1Lexer.class[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    private final ByteBuffer buffer;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    private Token aheadToken;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    private int openParens = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     * Constructs a new Type1Lexer given a header-less .pfb segment.[0m             [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     * @param bytes Header-less .pfb segment[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     * @throws IOException[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    [0m[1;35mType1Lexer[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m bytes[0m[1;39m)[0m[39m throws IOException[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        buffer = [0m[1;35mByteBuffer.wrap[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        aheadToken = [0m[1;35mreadToken[0m[1;39m([0m[39mnull[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * Returns the next token and consumes it.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * @return The next token.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    public Token [0m[1;35mnextToken[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        Token curToken = aheadToken;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        [0m[35m/[0m[35m/[0m[95mSystem.out.println[0m[1;39m([0m[39mcurToken[0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m for debugging[0m                         [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        aheadToken = [0m[1;35mreadToken[0m[1;39m([0m[39mcurToken[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        return curToken;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     * Returns the next token without consuming it.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     * @return The next token[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    public Token [0m[1;35mpeekToken[0m[1;39m([0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        return aheadToken;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     * Checks if the kind of the next token equals the given one without [0m        [2m                [0m
[2;36m                    [0m         [39mconsuming it.[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     * [0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     * @return true if the kind of the next token equals the given one[0m           [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    public boolean [0m[1;35mpeekKind[0m[1;39m([0m[39mToken.Kind kind[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        return aheadToken != null && [0m[1;35maheadToken.getKind[0m[1;39m([0m[1;39m)[0m[39m == kind;[0m               [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     * Reads an ASCII char from the buffer.[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    private char [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        try[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:            return [0m[1;39m([0m[39mchar[0m[1;39m)[0m[39m [0m[1;35mbuffer.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        catch [0m[1;39m([0m[39mBufferUnderflowException exception[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Premature end of buffer reached"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:20[0m[39m-[0m[1;36m27[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import org.apache.fontbox.encoding.BuiltInEncoding;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import org.apache.fontbox.encoding.StandardEncoding;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:507[0m[39m-[0m[1;36m536[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m507[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:     * Reads a procedure but without returning anything.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:    private void [0m[1;35mreadProcVoid[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                              [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:        int openProc = [0m[1;36m1[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:        while [0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m517[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Malformed procedure: missing token"[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m518[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m519[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.START_PROC[0m[1;39m)[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m520[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m521[0m[39m:                openProc++;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m522[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m523[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m524[0m[39m:            Token token = [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m525[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m526[0m[39m:            if [0m[1;39m([0m[1;35mtoken.getKind[0m[1;39m([0m[1;39m)[0m[39m == Token.END_PROC[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m527[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m528[0m[39m:                openProc--;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m529[0m[39m:                if [0m[1;39m([0m[39mopenProc == [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m530[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m531[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m532[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m533[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m534[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m535[0m[39m:        [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"executeonly"[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m536[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.jav[0m[1;92ma:19[0m[39m-[0m[1;36m54[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.security.GeneralSecurityException;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.security.KeyStore;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.HashSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.logging.log4j.LogManager;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.pdfbox.cos.COSArray;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.pdfbox.cos.COSBase;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.pdfbox.cos.COSDictionary;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.pdfbox.cos.COSDocument;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.pdfbox.cos.COSName;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.pdfbox.cos.COSNull;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.pdfbox.cos.COSNumber;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.pdfbox.cos.COSObject;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.pdfbox.cos.COSObjectKey;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.pdfbox.cos.COSStream;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.pdfbox.cos.ICOSParser;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.pdfbox.io.IOUtils;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.pdfbox.io.RandomAccessRead;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.pdfbox.io.RandomAccessReadView;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.pdfbox.io.RandomAccessStreamCache.StreamCacheCreateFunction;[0m   [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.pdfbox.pdmodel.encryption.AccessPermission;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.pdfbox.pdmodel.encryption.DecryptionMaterial;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.pdfbox.pdmodel.encryption.InvalidPasswordException;[0m            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.pdfbox.pdmodel.encryption.PDEncryption;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.pdfbox.pdmodel.encryption.ProtectionPolicy;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.pdfbox.pdmodel.encryption.PublicKeyDecryptionMaterial;[0m         [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.apache.pdfbox.pdmodel.encryption.SecurityHandler;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:import org.apache.pdfbox.pdmodel.encryption.StandardDecryptionMaterial;[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.jav[0m[1;92ma:938[0m[39m-[0m[1;36m999[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m938[0m[39m:    protected void [0m[1;35mcheckPages[0m[1;39m([0m[39mCOSDictionary root[0m[1;39m)[0m[39m throws IOException[0m            [2m                [0m
[2;36m                    [0m         [1;36m939[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m940[0m[39m:        if [0m[1;39m([0m[39mtrailerWasRebuild[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m941[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m942[0m[39m:            [0m[35m/[0m[35m/[0m[39m check if all page objects are dereferenced[0m                       [2m                [0m
[2;36m                    [0m         [1;36m943[0m[39m:            COSDictionary pages = [0m[1;35mroot.getCOSDictionary[0m[1;39m([0m[39mCOSName.PAGES[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m944[0m[39m:            if [0m[1;39m([0m[39mpages != null[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m945[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m946[0m[39m:                [0m[1;35mcheckPagesDictionary[0m[1;39m([0m[39mpages, new HashSet<>[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m947[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m948[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m949[0m[39m:        if [0m[1;39m([0m[1;35mroot.getCOSDictionary[0m[1;39m([0m[39mCOSName.PAGES[0m[1;39m)[0m[39m == null[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m950[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m951[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Page tree root must be a dictionary"[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m952[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m953[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m954[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m955[0m[39m:    private int [0m[1;35mcheckPagesDictionary[0m[1;39m([0m[39mCOSDictionary pagesDict, Set<COSObject> [0m   [2m                [0m
[2;36m                    [0m         [39mset[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m956[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m957[0m[39m:        [0m[35m/[0m[35m/[0m[39m check for kids[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m958[0m[39m:        COSArray kidsArray = [0m[1;35mpagesDict.getCOSArray[0m[1;39m([0m[39mCOSName.KIDS[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m959[0m[39m:        int numberOfPages = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m960[0m[39m:        if [0m[1;39m([0m[39mkidsArray != null[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m961[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m962[0m[39m:            List<? extends COSBase> kidsList = [0m[1;35mkidsArray.toList[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m963[0m[39m:            for [0m[1;39m([0m[39mCOSBase kid : kidsList[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m964[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m965[0m[39m:                if [0m[1;39m([0m[39m![0m[1;39m([0m[39mkid instanceof COSObject[0m[1;39m)[0m[39m || [0m[1;35mset.contains[0m[1;39m([0m[1;39m([0m[39mCOSObject[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mkid[0m[1;39m)[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m966[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m967[0m[39m:                    [0m[1;35mkidsArray.remove[0m[1;39m([0m[39mkid[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m968[0m[39m:                    continue;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m969[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m970[0m[39m:                COSObject kidObject = [0m[1;39m([0m[39mCOSObject[0m[1;39m)[0m[39m kid;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m971[0m[39m:                COSBase kidBaseobject = [0m[1;35mkidObject.getObject[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m972[0m[39m:                [0m[35m/[0m[35m/[0m[39m object wasn't dereferenced -> remove it[0m                      [2m                [0m
[2;36m                    [0m         [1;36m973[0m[39m:                if [0m[1;39m([0m[39mkidBaseobject == null || [0m                                   [2m                [0m
[2;36m                    [0m         [1;35mkidBaseobject.equals[0m[1;39m([0m[39mCOSNull.NULL[0m[1;39m)[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m974[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m975[0m[39m:                    [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Removed null object [0m[32m{[0m[32m}[0m[32m from pages dictionary"[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [39mkid[0m[1;39m)[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m976[0m[39m:                    [0m[1;35mkidsArray.remove[0m[1;39m([0m[39mkid[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m977[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m978[0m[39m:                else if [0m[1;39m([0m[39mkidBaseobject instanceof COSDictionary[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m979[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m980[0m[39m:                    COSDictionary kidDictionary = [0m[1;39m([0m[39mCOSDictionary[0m[1;39m)[0m[39m [0m              [2m                [0m
[2;36m                    [0m         [39mkidBaseobject;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m981[0m[39m:                    COSName type = [0m[1;35mkidDictionary.getCOSName[0m[1;39m([0m[39mCOSName.TYPE[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m982[0m[39m:                    if [0m[1;39m([0m[1;35mCOSName.PAGES.equals[0m[1;39m([0m[39mtype[0m[1;39m)[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m983[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m984[0m[39m:                        [0m[35m/[0m[35m/[0m[39m process nested pages dictionaries[0m                    [2m                [0m
[2;36m                    [0m         [1;36m985[0m[39m:                        [0m[1;35mset.add[0m[1;39m([0m[39mkidObject[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m986[0m[39m:                        numberOfPages += [0m[1;35mcheckPagesDictionary[0m[1;39m([0m[39mkidDictionary, [0m   [2m                [0m
[2;36m                    [0m         [39mset[0m[1;39m)[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m987[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m988[0m[39m:                    else if [0m[1;39m([0m[1;35mCOSName.PAGE.equals[0m[1;39m([0m[39mtype[0m[1;39m)[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m989[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m990[0m[39m:                        [0m[35m/[0m[35m/[0m[39m count pages[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m991[0m[39m:                        numberOfPages++;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m992[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m993[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m994[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m995[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m996[0m[39m:        [0m[35m/[0m[35m/[0m[39m fix counter[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m997[0m[39m:        [0m[1;35mpagesDict.setInt[0m[1;39m([0m[39mCOSName.COUNT, numberOfPages[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m998[0m[39m:        return numberOfPages;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m999[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:20[0m[39m-[0m[1;36m27[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import org.apache.fontbox.encoding.BuiltInEncoding;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import org.apache.fontbox.encoding.StandardEncoding;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:555[0m[39m-[0m[1;36m565[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m555[0m[39m:        [0m[35m/[0m[35m/[0m[39m find [0m[35m/[0m[95mPrivate[0m[39m dict[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m556[0m[39m:        Token peekToken = [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m557[0m[39m:        while [0m[1;39m([0m[39mpeekToken != null && ![0m[32m"Private"[0m[1;35m.equals[0m[1;39m([0m[1;35mpeekToken.getText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m558[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m559[0m[39m:            [0m[35m/[0m[35m/[0m[39m for a more thorough validation, the presence of [0m[32m"begin"[0m[39m before [0m  [2m                [0m
[2;36m                    [0m         [39mPrivate[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m560[0m[39m:            [0m[35m/[0m[35m/[0m[39m determines how code before and following charstrings should look[0m [2m                [0m
[2;36m                    [0m         [1;36m561[0m[39m:            [0m[35m/[0m[35m/[0m[39m it is not currently checked anyway[0m                               [2m                [0m
[2;36m                    [0m         [1;36m562[0m[39m:            [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m563[0m[39m:            peekToken = [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m564[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m565[0m[39m:        if [0m[1;39m([0m[39mpeekToken == null[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:20[0m[39m-[0m[1;36m27[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import org.apache.fontbox.encoding.BuiltInEncoding;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import org.apache.fontbox.encoding.StandardEncoding;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:706[0m[39m-[0m[1;36m743[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m706[0m[39m:    private void [0m[1;35mreadSubrs[0m[1;39m([0m[39mint lenIV[0m[1;39m)[0m[39m throws IOException[0m                        [2m                [0m
[2;36m                    [0m         [1;36m707[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m708[0m[39m:        [0m[35m/[0m[35m/[0m[39m allocate size [0m[1;39m([0m[39marray indexes may not be in-order[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m709[0m[39m:        int length = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m710[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m711[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m712[0m[39m:            [0m[1;35mfont.subrs.add[0m[1;39m([0m[39mnull[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m713[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m714[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"array"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m715[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m716[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m717[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m718[0m[39m:            [0m[35m/[0m[35m/[0m[39m premature end[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m719[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m720[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m721[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m722[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m723[0m[39m:            if [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m &&[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m724[0m[39m:                  [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"dup"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m725[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m726[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m727[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m728[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m729[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dup"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m730[0m[39m:            Token index = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m731[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m732[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m733[0m[39m:            [0m[35m/[0m[35m/[0m[39m RD[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m734[0m[39m:            Token charstring = [0m[1;35mread[0m[1;39m([0m[39mToken.CHARSTRING[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m735[0m[39m:            int j = [0m[1;35mindex.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m736[0m[39m:            if [0m[1;39m([0m[39mj < [0m[1;35mfont.subrs.size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m737[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m738[0m[39m:                [0m[1;35mfont.subrs.set[0m[1;39m([0m[39mj, [0m[1;35mdecrypt[0m[1;39m([0m[1;35mcharstring.getData[0m[1;39m([0m[1;39m)[0m[39m, CHARSTRING_KEY,[0m [2m                [0m
[2;36m                    [0m         [39mlenIV[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m739[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m740[0m[39m:            [0m[1;35mreadPut[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m741[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m742[0m[39m:        [0m[1;35mreadDef[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m743[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.jav[0m[1;92ma:1[0m[39m-[0m[1;36m25[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.pdfbox.pdmodel;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.util.ArrayDeque;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.Queue;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.pdfbox.cos.COSArray;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.pdfbox.cos.COSBase;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.pdfbox.cos.COSDictionary;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.jav[0m[1;92ma:19[0m[39m-[0m[1;36m35[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.HashSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.Optional;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.Map.Entry;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.logging.log4j.LogManager;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.pdfbox.cos.COSDictionary;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.pdfbox.cos.COSDocument;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.pdfbox.cos.COSName;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.pdfbox.cos.COSObjectKey;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.pdfbox.cos.COSStream;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.pdfbox.io.RandomAccessRead;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.pdfbox.pdfparser.XrefTrailerResolver.XRefType;[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.jav[0m[1;92ma:574[0m[39m-[0m[1;36m688[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m574[0m[39m:    private boolean [0m[1;35mparseXrefTable[0m[1;39m([0m[39mlong startByteOffset[0m[1;39m)[0m[39m throws IOException[0m     [2m                [0m
[2;36m                    [0m         [1;36m575[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m576[0m[39m:        if [0m[1;39m([0m[1;35msource.peek[0m[1;39m([0m[1;39m)[0m[39m != [0m[32m'x'[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m577[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m578[0m[39m:            return false;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m579[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m580[0m[39m:        String xref = [0m[1;35mparser.readString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m581[0m[39m:        [0m[1;35mif[0m[1;39m([0m[39m ![0m[1;35mxref.trim[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[39m [0m[32m"xref"[0m[39m [0m[1;39m)[0m[39m [0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m582[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m583[0m[39m:            return false;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m584[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m585[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m586[0m[39m:        [0m[35m/[0m[35m/[0m[39m check for trailer after xref[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m587[0m[39m:        String str = [0m[1;35mparser.readString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m588[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m b = [0m[1;35mstr.getBytes[0m[1;39m([0m[39mStandardCharsets.ISO_8859_1[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m589[0m[39m:        [0m[1;35msource.seek[0m[1;39m([0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[39m - b.length[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m590[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m591[0m[39m:        [0m[35m/[0m[35m/[0m[39m signal start of new XRef[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m592[0m[39m:        [0m[1;35mxrefTrailerResolver.nextXrefObj[0m[1;39m([0m[39m startByteOffset, XRefType.TABLE [0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m593[0m[39m:    [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m594[0m[39m:        if [0m[1;39m([0m[1;35mstr.startsWith[0m[1;39m([0m[32m"trailer"[0m[1;39m)[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m595[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m596[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"skipping empty xref table"[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m597[0m[39m:            return false;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m598[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m599[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m600[0m[39m:        [0m[35m/[0m[35m/[0m[39m Xref tables can have multiple sections. Each starts with a starting [0m [2m                [0m
[2;36m                    [0m         [39mobject id and a count.[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m601[0m[39m:        [0m[1;35mwhile[0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m602[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m603[0m[39m:            String currentLine = [0m[1;35mparser.readLine[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m604[0m[39m:            String[0m[1;39m[[0m[1;39m][0m[39m splitString = [0m[1;35mcurrentLine.split[0m[1;39m([0m[32m"\\s"[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m605[0m[39m:            if [0m[1;39m([0m[39msplitString.length != [0m[1;36m2[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m606[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m607[0m[39m:                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Unexpected XRefTable Entry: [0m[32m{[0m[32m}[0m[32m"[0m[39m, currentLine[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m608[0m[39m:                return false;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m609[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m610[0m[39m:            [0m[35m/[0m[35m/[0m[39m first obj id[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m611[0m[39m:            long currObjID;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m612[0m[39m:            try[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m613[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m614[0m[39m:                currObjID = [0m[1;35mLong.parseLong[0m[1;39m([0m[39msplitString[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m615[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m616[0m[39m:            catch [0m[1;39m([0m[39mNumberFormatException exception[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m617[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m618[0m[39m:                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"XRefTable: invalid ID for the first object: [0m[32m{[0m[32m}[0m[32m"[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [39mcurrentLine[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m619[0m[39m:                return false;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m620[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m621[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m622[0m[39m:            [0m[35m/[0m[35m/[0m[39m the number of objects in the xref table[0m                          [2m                [0m
[2;36m                    [0m         [1;36m623[0m[39m:            int count = [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m624[0m[39m:            try[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m625[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m626[0m[39m:                count = [0m[1;35mInteger.parseInt[0m[1;39m([0m[39msplitString[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m627[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m628[0m[39m:            catch [0m[1;39m([0m[39mNumberFormatException exception[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m629[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m630[0m[39m:                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"XRefTable: invalid number of objects: [0m[32m{[0m[32m}[0m[32m"[0m[39m, [0m           [2m                [0m
[2;36m                    [0m         [39mcurrentLine[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m631[0m[39m:                return false;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m632[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m633[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m634[0m[39m:            [0m[1;35mparser.skipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m635[0m[39m:            [0m[1;35mfor[0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < count; i++[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m636[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m637[0m[39m:                if [0m[1;39m([0m[1;35mparser.isEOF[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m638[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m639[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m640[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m641[0m[39m:                int nextChar = [0m[1;35msource.peek[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m642[0m[39m:                if [0m[1;39m([0m[39mnextChar == [0m[32m't'[0m[39m || [0m[1;35mBaseParser.isEndOfName[0m[1;39m([0m[39mnextChar[0m[1;39m)[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m643[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m644[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m645[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m646[0m[39m:                [0m[35m/[0m[35m/[0m[95mIgnore[0m[39m table contents[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m647[0m[39m:                currentLine = [0m[1;35mparser.readLine[0m[1;39m([0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m648[0m[39m:                splitString = [0m[1;35mcurrentLine.split[0m[1;39m([0m[32m"\\s"[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m649[0m[39m:                if [0m[1;39m([0m[39msplitString.length < [0m[1;36m3[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m650[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m651[0m[39m:                    [0m[1;35mLOG.warn[0m[1;39m([0m[32m"invalid xref line: [0m[32m{[0m[32m}[0m[32m"[0m[39m, currentLine[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m652[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m653[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m654[0m[39m:                [0m[35m/[0m[39m* This supports the corrupt table as reported in[0m               [2m                [0m
[2;36m                    [0m         [1;36m655[0m[39m:                 * PDFBOX-[0m[1;36m474[0m[39m [0m[1;39m([0m[39mXXXX XXX XX n[0m[1;39m)[0m[39m *[0m[35m/[0m                                [2m                [0m
[2;36m                    [0m         [1;36m656[0m[39m:                [0m[1;35mif[0m[1;39m([0m[39msplitString[0m[1;39m[[0m[39msplitString.length-[0m[1;36m1[0m[1;39m][0m[1;35m.equals[0m[1;39m([0m[32m"n"[0m[1;39m)[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m657[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m658[0m[39m:                    try[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m659[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m660[0m[39m:                        long currOffset = [0m[1;35mLong.parseLong[0m[1;39m([0m[39msplitString[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m661[0m[39m:                        [0m[35m/[0m[35m/[0m[39m skip [0m[1;36m0[0m[39m offsets[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m662[0m[39m:                        if [0m[1;39m([0m[39mcurrOffset > [0m[1;36m0[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m663[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m664[0m[39m:                            int currGenID = [0m[1;35mInteger.parseInt[0m[1;39m([0m[39msplitString[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m665[0m[39m:                            COSObjectKey objKey = new [0m[1;35mCOSObjectKey[0m[1;39m([0m[39mcurrObjID, [0m  [2m                [0m
[2;36m                    [0m         [39mcurrGenID[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m666[0m[39m:                            [0m[1;35mxrefTrailerResolver.setXRef[0m[1;39m([0m[39mobjKey, currOffset[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m667[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m668[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m669[0m[39m:                    catch [0m[1;39m([0m[39mIllegalArgumentException e[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m670[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m671[0m[39m:                        throw new [0m[1;35mIOException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m672[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m673[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m674[0m[39m:                else [0m[1;35mif[0m[1;39m([0m[39m!splitString[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[1;35m.equals[0m[1;39m([0m[32m"f"[0m[1;39m)[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m675[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m676[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Corrupt XRefTable Entry - ObjID:"[0m[39m + [0m [2m                [0m
[2;36m                    [0m         [39mcurrObjID[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m677[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m678[0m[39m:                currObjID++;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m679[0m[39m:                [0m[1;35mparser.skipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m680[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m681[0m[39m:            [0m[1;35mparser.skipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m682[0m[39m:            if [0m[1;39m([0m[39m![0m[1;35mparser.isDigit[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m683[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m684[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m685[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m686[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m687[0m[39m:        return true;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m688[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.jav[0m[1;92ma:19[0m[39m-[0m[1;36m37[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.util.ArrayDeque;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.Queue;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.pdfbox.cos.COSArray;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.pdfbox.cos.COSBase;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.pdfbox.cos.COSDictionary;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.pdfbox.cos.COSInteger;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.pdfbox.cos.COSName;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.pdfbox.pdmodel.common.COSObjectable;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.HashSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.util.NoSuchElementException;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.logging.log4j.LogManager;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.jav[0m[1;92ma:180[0m[39m-[0m[1;36m225[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:    private final class PageIterator implements Iterator<PDPage>[0m                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:        private final Queue<COSDictionary> queue = new ArrayDeque<>[0m[1;39m([0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:        private [0m[1;35mPageIterator[0m[1;39m([0m[39mCOSDictionary node[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:            List<COSDictionary> kids = [0m[1;35menqueueKids[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:            while [0m[1;39m([0m[39m![0m[1;35mkids.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:                List<COSDictionary> newKids = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:                for [0m[1;39m([0m[39mCOSDictionary kid : kids[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:                    [0m[1;35mnewKids.addAll[0m[1;39m([0m[1;35menqueueKids[0m[1;39m([0m[39mkid[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:                kids = newKids;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:        [0m[35m/[0m[39m**[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:         * This takes a node, and, if it is a page adds it to the queue.[0m        [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:         * If it is a PageTreeNode, it returns the children for that node.[0m      [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:         *[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:         * @param node[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:         * @return[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:         *[0m[35m/[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:        private List<COSDictionary> [0m[1;35menqueueKids[0m[1;39m([0m[39mCOSDictionary node[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:            if [0m[1;39m([0m[1;35misPageTreeNode[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:                return [0m[1;35mgetKids[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:                if [0m[1;39m([0m[39mnode != null && [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mCOSName.PAGE.equals[0m[1;39m([0m[1;35mnode.getCOSName[0m[1;39m([0m[39mCOSName.TYPE[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                    [0m[1;35mqueue.add[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                else[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                    [0m[1;35mLOG.error[0m[1;39m([0m[32m"Page skipped due to an invalid or missing type [0m  [2m                [0m
[2;36m                    [0m         [32m{[0m[32m}[0m[32m"[0m[39m,[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:                            [0m[1;39m([0m[1;39m)[0m[39m -> [0m[1;39m([0m[39mnode == null ? [0m[32m"[0m[32m([0m[32mnull[0m[32m)[0m[32m"[0m[39m : [0m                   [2m                [0m
[2;36m                    [0m         [1;35mnode.getCOSName[0m[1;39m([0m[39mCOSName.TYPE[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:            return Collections.EMPTY_LIST;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:20[0m[39m-[0m[1;36m27[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import org.apache.fontbox.encoding.BuiltInEncoding;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import org.apache.fontbox.encoding.StandardEncoding;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:382[0m[39m-[0m[1;36m432[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:    private List<Token> [0m[1;35mreadValue[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                          [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:        List<Token> value = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:        Token token = [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:        if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:            return value;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:        [0m[1;35mvalue.add[0m[1;39m([0m[39mtoken[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:        if [0m[1;39m([0m[1;35mtoken.getKind[0m[1;39m([0m[1;39m)[0m[39m == Token.START_ARRAY[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:            int openArray = [0m[1;36m1[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:            while [0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m397[0m[39m:                if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:                    return value;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:                if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.START_ARRAY[0m[1;39m)[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:                    openArray++;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:                token = [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:                [0m[1;35mvalue.add[0m[1;39m([0m[39mtoken[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m409[0m[39m:                if [0m[1;39m([0m[1;35mtoken.getKind[0m[1;39m([0m[1;39m)[0m[39m == Token.END_ARRAY[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:                    openArray--;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:                    if [0m[1;39m([0m[39mopenArray == [0m[1;36m0[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m413[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m414[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:        else if [0m[1;39m([0m[1;35mtoken.getKind[0m[1;39m([0m[1;39m)[0m[39m == Token.START_PROC[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:            [0m[1;35mvalue.addAll[0m[1;39m([0m[1;35mreadProc[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:        else if [0m[1;39m([0m[1;35mtoken.getKind[0m[1;39m([0m[1;39m)[0m[39m == Token.START_DICT[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:            [0m[35m/[0m[35m/[0m[39m skip [0m[32m"/GlyphNames2HostCode << >> def"[0m                            [2m                [0m
[2;36m                    [0m         [1;36m426[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.END_DICT[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m427[0m[39m:            return value;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m428[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m429[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m430[0m[39m:        [0m[1;35mreadPostScriptWrapper[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m431[0m[39m:        return value;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m432[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:469[0m[39m-[0m[1;36m505[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m469[0m[39m:    private List<Token> [0m[1;35mreadProc[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                           [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:        List<Token> value = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m472[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m473[0m[39m:        int openProc = [0m[1;36m1[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m474[0m[39m:        while [0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m475[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m476[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m477[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m478[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Malformed procedure: missing token"[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m479[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m480[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m481[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.START_PROC[0m[1;39m)[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m482[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m483[0m[39m:                openProc++;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m484[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m485[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m486[0m[39m:            Token token = [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m487[0m[39m:            [0m[1;35mvalue.add[0m[1;39m([0m[39mtoken[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m488[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m489[0m[39m:            if [0m[1;39m([0m[1;35mtoken.getKind[0m[1;39m([0m[1;39m)[0m[39m == Token.END_PROC[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m490[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m491[0m[39m:                openProc--;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m492[0m[39m:                if [0m[1;39m([0m[39mopenProc == [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:        Token executeonly = [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"executeonly"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:        if [0m[1;39m([0m[39mexecuteonly != null[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:            [0m[1;35mvalue.add[0m[1;39m([0m[39mexecuteonly[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:        return value;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_0/README.m[0m[1;92md:1[0m[39m-[0m[1;36m14[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:# What functions and functionality is relevant?[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:Parsing of Extensible Metadata Platform [0m[1;39m([0m[39mXMP[0m[1;39m)[0m[39m within a PDF.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:# Why is this vulnerable?[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:The XML parser is not securely configured.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:# Is this a replay and/or is inspired by anything?[0m                                [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:This is a replay of CVE-[0m[1;36m2016[0m[39m-[0m[1;36m2175[0m[39m.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:# What makes it interesting?[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:This vulnerability is buried fairly deeply in the codebase. The[0m                  [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:vulnerability should be easy to fix, but finding it in the full codebase[0m         [2m                [0m
[2;36m                    [0m         [1;92m14:a[0m[39mnd generating a proof of vulnerability are both good challenges.[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_1/README.m[0m[1;92md:1[0m[39m-[0m[1;36m14[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:# What functions and functionality is relevant?[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:Parsing of XML Forms Architecture [0m[1;39m([0m[39mXFA[0m[1;39m)[0m[39m within a PDF.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:# Why is this vulnerable?[0m                                                         [2m                [0m
[2;36m                    [0m         [1;92m5:C[0m[39mode fails to configure the XML DOM build securely.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:# Is this a replay and/or is inspired by anything?[0m                                [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:This is a replay of a code refactoring that was part of the DRY fixes for [0m        [2m                [0m
[2;36m                    [0m         [39mCVE-[0m[1;36m2019[0m[39m-[0m[1;36m0228[0m[39m.[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;92m9:A[0m[39mt the time of that fix, the XFA code was already secured against xxe.[0m            [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:# What makes it interesting?[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:This vulnerability is buried fairly deeply in the codebase. The[0m                  [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:vulnerability should be easy to fix, but finding it in the full codebase [0m        [2m                [0m
[2;36m                    [0m         [1;92m14:a[0m[39mnd generating a proof of vulnerability are both good challenges.[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_3/README.m[0m[1;92md:1[0m[39m-[0m[1;36m19[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:# What functions and functionality is relevant?[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:Parsing a Type1 font embedded in a PDF.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:# Why is this vulnerable?[0m                                                         [2m                [0m
[2;36m                    [0m         [1;92m5:Fa[0m[39milure to check if next value is null.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:# Is this a replay and/or is inspired by anything?[0m                                [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:This reintroduces an infinite loop fixed on PDFBOX-[0m[1;36m5624[0m                           [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:# What makes it interesting?[0m                                                     [2m                [0m
[2;36m                    [0m         [1;92m11:A[0m[39ms with the other Type1 font vulnerabilities, the POV was[0m                        [2m                [0m
[2;36m                    [0m         [1;92m12:fa[0m[39mirly easily generated with a custom harness and a custom seed corpus.[0m          [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:However, neither of these resources were made available in the competition.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m15:F[0m[39murther, finding the vulnerability is non-trivial.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:# Additional details[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:* [0m[4;94mhttps://issues.apache.org/jira/browse/PDFBOX-5624[0m                              [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:* [0m                                                                               [2m                [0m
[2;36m                    [0m         [4;94mhttps://github.com/apache/pdfbox/commit/aa7dc6ccd1c3055b70c8084d7bf383f799047ad5[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_4/README.m[0m[1;92md:1[0m[39m-[0m[1;36m16[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:# What functions and functionality is relevant?[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:Parsing a Type1 font embedded in a PDF.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:# Why is this vulnerable?[0m                                                         [2m                [0m
[2;36m                    [0m         [1;92m5:Fa[0m[39milure to check for null when calling [0m[32m"nextToken"[0m[39m.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:# Is this a replay and/or is inspired by anything?[0m                                [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:This reintroduces an infinite loop fixed on PDFBOX-[0m[1;36m5624[0m                           [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:# What makes it interesting?[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:This is similar to vuln_3, but located in a slightly different[0m                   [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:location within the Type1Parser.[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:# Additional details[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:* [0m[4;94mhttps://issues.apache.org/jira/browse/PDFBOX-5624[0m                              [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:* [0m                                                                               [2m                [0m
[2;36m                    [0m         [4;94mhttps://github.com/apache/pdfbox/commit/aa7dc6ccd1c3055b70c8084d7bf383f799047ad5[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_5/README.m[0m[1;92md:1[0m[39m-[0m[1;36m16[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:# What functions and functionality is relevant?[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:Parsing a Type1 font in a PDF[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:# Why is this vulnerable?[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:The code reads a value from user input and then allocates[0m                         [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:that amount of memory without any checks.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:# Is this a replay and/or is inspired by anything?[0m                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:This is inspired by the [0m[32m"read length then allocate"[0m[39m without any checks[0m            [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:that is common in MSOffice OLE based file formats and several[0m                    [2m                [0m
[2;36m                    [0m         [1;92m11:c[0m[39mompression formats. However, this is an organic memory usage vulnerability.[0m     [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:# What makes it interesting?[0m                                                     [2m                [0m
[2;36m                    [0m         [1;92m14:A[0m[39ms with the other Type1 font vulnerabilities, the POV was[0m                        [2m                [0m
[2;36m                    [0m         [1;92m15:fa[0m[39mirly easily generated with a custom harness and a custom seed corpus.[0m          [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:However, neither of these resources were made available in the competition.[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_6/README.m[0m[1;92md:1[0m[39m-[0m[1;36m24[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:# What functions and functionality is relevant?[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:Parsing Printer Font Binary [0m[1;39m([0m[39mPFB[0m[1;39m)[0m[39m Type [0m[1;36m1[0m[39m fonts within a PDF.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:# Why is this vulnerable?[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:Integer overflow in a check that is intended to prevent an Out-of-memory [0m         [2m                [0m
[2;36m                    [0m         [39mallocation.[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:With a very small crafted file, the parser can allocate 2gb of memory.[0m            [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:# Is this a replay and/or is inspired by anything?[0m                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:This is an organic vulnerability. It is based on read-length-then-allocate[0m        [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:vulnerabilities that are common in other file formats. The twist to this[0m         [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:is that there was an incorrect fix to add a heuristic record limit, but[0m          [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:that fix, in turn, fails to account for integer overflow. There[0m                  [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:was no check in the actual PDFBox codebase.[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:# What makes it interesting?[0m                                                     [2m                [0m
[2;36m                    [0m         [1;92m16:A[0m[39ms with the other Type1 font vulnerabilities, the POV was [0m                       [2m                [0m
[2;36m                    [0m         [1;92m17:fa[0m[39mirly easily generated with a custom harness and a custom seed corpus.[0m          [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:However, neither of these resources were made available in the competition.[0m      [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:So, generating the POV is challenging. Finding the vulnerability [0m                [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:should be straight forward with static analysis, but it would be very[0m            [2m                [0m
[2;36m                    [0m         [1;92m21:d[0m[39mifficult to find via fuzzing with the harnesses supplied during the [0m            [2m                [0m
[2;36m                    [0m         [39mcompetition.[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:# Additional details[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:* [0m[4;94mhttps://issues.apache.org/jira/browse/PDFBOX-6044[0m                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_7/README.m[0m[1;92md:1[0m[39m-[0m[1;36m15[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:# What functions and functionality is relevant?[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:Parsing a PDF's page tree.[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:# Why is this vulnerable?[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:There's no check on which objects have been processed, and a crafted PDF[0m          [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:may contain a loop in the page tree.[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:# Is this a replay and/or is inspired by anything?[0m                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:Replay of PDFBOX-[0m[1;36m4623[0m[39m, but rewritten to trigger a timeout instead of a [0m           [2m                [0m
[2;36m                    [0m         [39mStackOverflow.[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:# What makes it interesting?[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:# Additional details[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:* [0m[4;94mhttps://issues.apache.org/jira/browse/PDFBOX-4623[0m                              [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:* The POV is [0m                                                                    [2m                [0m
[2;36m                    [0m         [4;94mhttps://issues.apache.org/jira/secure/attachment/12993517/loop_in_page_tree.pdf[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_8/README.m[0m[1;92md:1[0m[39m-[0m[1;36m23[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:# What functions and functionality is relevant?[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:Parsing an xref table in a PDF.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:# Why is this vulnerable?[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:There's no check for circular references in the xref table.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:# Is this a replay and/or is inspired by anything?[0m                                [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:This is a replay of a famous infinite loop/Denial of Service[0m                      [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:vulnerability that was fixed in PDFBOX-[0m[1;36m3919[0m[39m. Andreas Bogk[0m                         [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:presented this vulnerability at Chaos Communication Camp in [0m[1;36m2011[0m[39m.[0m                [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:It affected poppler, qpdf and PDFBox among, probably, many other[0m                 [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:PDF parsers.[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:# What makes it interesting?[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:This is a very famous vulnerability. It would be challenging[0m                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:to identify and patch without historical context.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:# Additional details[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:The POV is taken from: [0m                                                          [2m                [0m
[2;36m                    [0m         [4;94mhttps://bugs.launchpad.net/ubuntu/+source/poppler/+bug/825554[0m                       [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:See also: [0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:* [0m[4;94mhttps://www.ieee-security.org/TC/SPW2014/papers/5103a198.PDF[0m[39m [0m                  [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:* [0m                                                                               [2m                [0m
[2;36m                    [0m         [4;94mhttps://www.bleepingcomputer.com/news/software/six-year-old-loop-bug-re-discovered-[0m [2m                [0m
[2;36m                    [0m         [4;94mto-affect-almost-all-major-pdf-viewers/[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:* [0m                                                                               [2m                [0m
[2;36m                    [0m         [4;94mhttps://blog.fuzzing-project.org/59-Six-year-old-PDF-loop-bug-affects-most-major-im[0m [2m                [0m
[2;36m                    [0m         [4;94mplementations.html[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:22[0m[39m-[0m[1;36m26[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.BufferUnderflowException;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.ByteBuffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.logging.log4j.LogManager;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:499[0m[39m-[0m[1;36m516[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:     * Reads a binary CharString.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:    private Token [0m[1;35mreadCharString[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m throws IOException[0m                 [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:        try[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:            [0m[1;35mbuffer.get[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m space[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m507[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m data = new byte[0m[1;39m[[0m[39mlength[0m[1;39m][0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:            [0m[1;35mbuffer.get[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:            return new [0m[1;35mToken[0m[1;39m([0m[39mdata, Token.CHARSTRING[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:        catch [0m[1;39m([0m[39mBufferUnderflowException exception[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Premature end of buffer reached"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_5/patches/good_patch.di[0m[1;92mff:1[0m[39m-[0m[1;36m25[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1:d[0m[39miff --git a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java [0m      [2m                [0m
[2;36m                    [0m         [39mb/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java[0m                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:index 56aaf64ad..a995710c8 [0m[1;36m100644[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:--- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java[0m              [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:+++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java[0m              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:@@ [0m[1;36m-48[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m48[0m[39m,[0m[1;36m8[0m[39m @@ class Type1Lexer[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:      * Log instance.[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:      *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:     private static final Logger LOG = [0m[1;35mLogManager.getLogger[0m[1;39m([0m[39mType1Lexer.class[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:-    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:+    private static int MAX_CHAR_STRING_SIZE = 1_000_000;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:+[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:     private final ByteBuffer buffer;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:     private Token aheadToken;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:     private int openParens = [0m[1;36m0[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:@@ [0m[1;36m-501[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m502[0m[39m,[0m[1;36m10[0m[39m @@ class Type1Lexer[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:      *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:     private Token [0m[1;35mreadCharString[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m throws IOException[0m                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:     [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:+        if [0m[1;39m([0m[39mlength > MAX_CHAR_STRING_SIZE[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:+            throw new [0m[1;35mDamagedFontException[0m[1;39m([0m[32m"char string is too long. [0m[32mlength[0m[32m="[0m[39m +[0m [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:+                    length + [0m[32m" [0m[32mmax_length[0m[32m="[0m[39m + MAX_CHAR_STRING_SIZE[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:+        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:         try[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:         [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:             [0m[1;35mbuffer.get[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m space[0m                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:1[0m[39m-[0m[1;36m13[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_6/patches/good_patch.di[0m[1;92mff:1[0m[39m-[0m[1;36m13[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1:d[0m[39miff --git a/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java [0m         [2m                [0m
[2;36m                    [0m         [39mb/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java[0m                       [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:index cda8dc6f3..a07f63232 [0m[1;36m100644[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:--- a/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java[0m                 [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:+++ b/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java[0m                 [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:@@ [0m[1;36m-158[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m158[0m[39m,[0m[1;36m7[0m[39m @@ public class PfbParser[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:             size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m16[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:             size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m24[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:             [0m[1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, size[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:-            long newTotal = total + size;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:+            long newTotal = [0m[1;39m([0m[39mlong[0m[1;39m)[0m[39mtotal + [0m[1;39m([0m[39mlong[0m[1;39m)[0m[39msize;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:             if [0m[1;39m([0m[39mnewTotal > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:                 throw new [0m[1;35mIOException[0m[1;39m([0m[32m"record size would be too large: "[0m[39m + [0m     [2m                [0m
[2;36m                    [0m         [39mnewTotal[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:             [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:20[0m[39m-[0m[1;36m27[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import org.apache.fontbox.encoding.BuiltInEncoding;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import org.apache.fontbox.encoding.StandardEncoding;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:192[0m[39m-[0m[1;36m239[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:    private void [0m[1;35mreadEncoding[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                              [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:        if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:            String name = [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:            if [0m[1;39m([0m[1;35mname.equals[0m[1;39m([0m[32m"StandardEncoding"[0m[1;39m)[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:                font.encoding = StandardEncoding.INSTANCE;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Unknown encoding: "[0m[39m + name[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:            [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"readonly"[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"def"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:        else[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"array"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:            [0m[35m/[0m[35m/[0m[39m [0m[1;36m0[0m[39m [0m[1;36m1[0m[39m [0m[1;36m255[0m[39m [0m[1;39m{[0m[1;36m1[0m[39m index exch [0m[35m/[0m[95m.notdef[0m[39m put [0m[1;39m}[0m[39m for[0m                         [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:            [0m[35m/[0m[35m/[0m[39m we have to check [0m[32m"readonly"[0m[39m and [0m[32m"def"[0m[39m too[0m                        [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:            [0m[35m/[0m[35m/[0m[39m as some fonts don't provide any dup-values, see PDFBOX-[0m[1;36m2134[0m      [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:            while [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                    && [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"dup"[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:                            || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"readonly"[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                            || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"def"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:            Map<Integer, String> codeToName = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:            while [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m &&[0m                                [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                    [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"dup"[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dup"[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                int code = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                String name = [0m[1;35mread[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"put"[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                [0m[1;35mcodeToName.put[0m[1;39m([0m[39mcode, name[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:            font.encoding = new [0m[1;35mBuiltInEncoding[0m[1;39m([0m[39mcodeToName[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:            [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"readonly"[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"def"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:555[0m[39m-[0m[1;36m565[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m555[0m[39m:        [0m[35m/[0m[35m/[0m[39m find [0m[35m/[0m[95mPrivate[0m[39m dict[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m556[0m[39m:        Token peekToken = [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m557[0m[39m:        while [0m[1;39m([0m[39mpeekToken != null && ![0m[32m"Private"[0m[1;35m.equals[0m[1;39m([0m[1;35mpeekToken.getText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m558[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m559[0m[39m:            [0m[35m/[0m[35m/[0m[39m for a more thorough validation, the presence of [0m[32m"begin"[0m[39m before [0m  [2m                [0m
[2;36m                    [0m         [39mPrivate[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m560[0m[39m:            [0m[35m/[0m[35m/[0m[39m determines how code before and following charstrings should look[0m [2m                [0m
[2;36m                    [0m         [1;36m561[0m[39m:            [0m[35m/[0m[35m/[0m[39m it is not currently checked anyway[0m                               [2m                [0m
[2;36m                    [0m         [1;36m562[0m[39m:            [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m563[0m[39m:            peekToken = [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m564[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m565[0m[39m:        if [0m[1;39m([0m[39mpeekToken == null[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:636[0m[39m-[0m[1;36m650[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m636[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m637[0m[39m:        [0m[35m/[0m[35m/[0m[39m some fonts have [0m[32m"2 index"[0m[39m here, others have [0m[32m"end noaccess put"[0m       [2m                [0m
[2;36m                    [0m         [1;36m638[0m[39m:        [0m[35m/[0m[35m/[0m[39m sometimes followed by [0m[32m"put"[0m[39m. Either way, we just skip until[0m          [2m                [0m
[2;36m                    [0m         [1;36m639[0m[39m:        [0m[35m/[0m[35m/[0m[39m the [0m[35m/[0m[95mCharStrings[0m[39m dict is found[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m640[0m[39m:        while [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m641[0m[39m:                && [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"CharStrings"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [1;36m642[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m643[0m[39m:            [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m644[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m645[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m646[0m[39m:        [0m[35m/[0m[35m/[0m[39m CharStrings dict[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m647[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.LITERAL, [0m[32m"CharStrings"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m648[0m[39m:        [0m[1;35mreadCharStrings[0m[1;39m([0m[39mlenIV[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m649[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m650[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:19[0m[39m-[0m[1;36m50[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.ByteArrayInputStream;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.EOFException;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.logging.log4j.LogManager;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m: * Parser for a pfb-file.[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m: * @author Ben Litchfield[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m: * @author Michael Niedermair[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:public class PfbParser [0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    private static final Logger LOG = [0m[1;35mLogManager.getLogger[0m[1;39m([0m[39mPfbParser.class[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * the pfb header length.[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     * [0m[1;39m([0m[39mstart-marker [0m[1;39m([0m[1;36m1[0m[39m byte[0m[1;39m)[0m[39m, ascii-[0m[35m/[0m[95mbinary-marker[0m[39m [0m[1;39m([0m[1;36m1[0m[39m byte[0m[1;39m)[0m[39m, size [0m[1;39m([0m[1;36m4[0m[39m byte[0m[1;39m)[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * [0m[1;36m3[0m[39m*[0m[1;36m6[0m[39m == [0m[1;36m18[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    private static final int PFB_[0m[1;33mHEAD[0m[39mER_LENGTH = [0m[1;36m18[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * the start marker.[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:150[0m[39m-[0m[1;36m180[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:            if [0m[1;39m([0m[39mrecordType != ASCII_MARKER && recordType != BINARY_MARKER[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Incorrect record type: "[0m[39m + recordType[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            int size = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m8[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m16[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m24[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, size[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            long newTotal = total + size;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            if [0m[1;39m([0m[39mnewTotal > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"record size would be too large: "[0m[39m + [0m     [2m                [0m
[2;36m                    [0m         [39mnewTotal[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m ar = new byte[0m[1;39m[[0m[39msize[0m[1;39m][0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:            int got = [0m[1;35min.read[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:            if [0m[1;39m([0m[39mgot != size[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                throw new [0m[1;35mEOFException[0m[1;39m([0m[32m"EOF while reading PFB font"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            total += size;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            [0m[1;35mtypeList.add[0m[1;39m([0m[39mrecordType[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:            [0m[1;35mbarrList.add[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:        while [0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:        [0m[35m/[0m[35m/[0m[39m We now have ASCII and binary segments. Lets arrange these so that [0m   [2m                [0m
[2;36m                    [0m         [39mthe ASCII segments[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:        [0m[35m/[0m[35m/[0m[39m come first, then the binary segments, then the last ASCII segment if[0m [2m                [0m
[2;36m                    [0m         [39mit is[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:        [0m[35m/[0m[35m/[0m[39m [0m[1;36m0000[0m[33m...[0m[39m cleartomark[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_6/patches/good_patch.di[0m[1;92mff:1[0m[39m-[0m[1;36m13[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1:d[0m[39miff --git a/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java [0m         [2m                [0m
[2;36m                    [0m         [39mb/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java[0m                       [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:index cda8dc6f3..a07f63232 [0m[1;36m100644[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:--- a/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java[0m                 [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:+++ b/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java[0m                 [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:@@ [0m[1;36m-158[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m158[0m[39m,[0m[1;36m7[0m[39m @@ public class PfbParser[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:             size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m16[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:             size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m24[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:             [0m[1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, size[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:-            long newTotal = total + size;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:+            long newTotal = [0m[1;39m([0m[39mlong[0m[1;39m)[0m[39mtotal + [0m[1;39m([0m[39mlong[0m[1;39m)[0m[39msize;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:             if [0m[1;39m([0m[39mnewTotal > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:                 throw new [0m[1;35mIOException[0m[1;39m([0m[32m"record size would be too large: "[0m[39m + [0m     [2m                [0m
[2;36m                    [0m         [39mnewTotal[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:             [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:706[0m[39m-[0m[1;36m743[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m706[0m[39m:    private void [0m[1;35mreadSubrs[0m[1;39m([0m[39mint lenIV[0m[1;39m)[0m[39m throws IOException[0m                        [2m                [0m
[2;36m                    [0m         [1;36m707[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m708[0m[39m:        [0m[35m/[0m[35m/[0m[39m allocate size [0m[1;39m([0m[39marray indexes may not be in-order[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m709[0m[39m:        int length = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m710[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m711[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m712[0m[39m:            [0m[1;35mfont.subrs.add[0m[1;39m([0m[39mnull[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m713[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m714[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"array"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m715[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m716[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m717[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m718[0m[39m:            [0m[35m/[0m[35m/[0m[39m premature end[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m719[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m720[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m721[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m722[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m723[0m[39m:            if [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m &&[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m724[0m[39m:                  [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"dup"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m725[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m726[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m727[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m728[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m729[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dup"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m730[0m[39m:            Token index = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m731[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m732[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m733[0m[39m:            [0m[35m/[0m[35m/[0m[39m RD[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m734[0m[39m:            Token charstring = [0m[1;35mread[0m[1;39m([0m[39mToken.CHARSTRING[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m735[0m[39m:            int j = [0m[1;35mindex.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m736[0m[39m:            if [0m[1;39m([0m[39mj < [0m[1;35mfont.subrs.size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m737[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m738[0m[39m:                [0m[1;35mfont.subrs.set[0m[1;39m([0m[39mj, [0m[1;35mdecrypt[0m[1;39m([0m[1;35mcharstring.getData[0m[1;39m([0m[1;39m)[0m[39m, CHARSTRING_KEY,[0m [2m                [0m
[2;36m                    [0m         [39mlenIV[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m739[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m740[0m[39m:            [0m[1;35mreadPut[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m741[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m742[0m[39m:        [0m[1;35mreadDef[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m743[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:777[0m[39m-[0m[1;36m813[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m777[0m[39m:    private void [0m[1;35mreadCharStrings[0m[1;39m([0m[39mint lenIV[0m[1;39m)[0m[39m throws IOException[0m                  [2m                [0m
[2;36m                    [0m         [1;36m778[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m779[0m[39m:        int length = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m780[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dict"[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m781[0m[39m:        [0m[35m/[0m[35m/[0m[39m could actually be a sequence ending in [0m[32m"CharStrings begin"[0m[39m, too[0m      [2m                [0m
[2;36m                    [0m         [1;36m782[0m[39m:        [0m[35m/[0m[35m/[0m[39m instead of the [0m[32m"dup begin"[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m783[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dup"[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m784[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"begin"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m785[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m786[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m787[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m788[0m[39m:            [0m[35m/[0m[35m/[0m[39m premature end[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m789[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m790[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m791[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m792[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m793[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m &&[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:                [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"end"[0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:            [0m[35m/[0m[35m/[0m[39m key/value[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:            String name = [0m[1;35mread[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:            [0m[35m/[0m[35m/[0m[39m RD[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:            Token charstring = [0m[1;35mread[0m[1;39m([0m[39mToken.CHARSTRING[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:            [0m[1;35mfont.charstrings.put[0m[1;39m([0m[39mname, [0m[1;35mdecrypt[0m[1;39m([0m[1;35mcharstring.getData[0m[1;39m([0m[1;39m)[0m[39m, [0m           [2m                [0m
[2;36m                    [0m         [39mCHARSTRING_KEY, lenIV[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:            [0m[1;35mreadDef[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:        [0m[35m/[0m[35m/[0m[39m some fonts have one [0m[32m"end"[0m[39m, others two[0m                                [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"end"[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:        [0m[35m/[0m[35m/[0m[39m since checking ends here, this does not matter [0m[33m...[0m[39m.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:        [0m[35m/[0m[35m/[0m[39m more thorough checking would see whether there is [0m[32m"begin"[0m[39m before [0m    [2m                [0m
[2;36m                    [0m         [35m/[0m[95mPrivate[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:        [0m[35m/[0m[35m/[0m[39m and expect a [0m[32m"def"[0m[39m somewhere, otherwise a [0m[32m"put"[0m                      [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_3/patches/good_patch.di[0m[1;92mff:1[0m[39m-[0m[1;36m15[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1:d[0m[39miff --git a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java [0m     [2m                [0m
[2;36m                    [0m         [39mb/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java[0m                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:index c995d96e2..c4a973ade [0m[1;36m100644[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:--- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java[0m             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:+++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java[0m             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:@@ [0m[1;36m-219[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m219[0m[39m,[0m[1;36m9[0m[39m @@ final class Type1Parser[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:                             || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"readonly"[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:                             || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"def"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:             [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:-                [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:+                if [0m[1;39m([0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:+                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Should have found dup, readonly or [0m  [2m                [0m
[2;36m                    [0m         [32mdef?! EOF?"[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:+                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:             [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:             [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:             Map<Integer, String> codeToName = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_4/patches/good_patch.di[0m[1;92mff:1[0m[39m-[0m[1;36m16[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1:d[0m[39miff --git a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java [0m     [2m                [0m
[2;36m                    [0m         [39mb/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java[0m                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:index a979cfbdb..c8e7e1e1c [0m[1;36m100644[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:--- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java[0m             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:+++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java[0m             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:@@ [0m[1;36m-643[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m643[0m[39m,[0m[1;36m10[0m[39m @@ final class Type1Parser[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:         while [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:                 && [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"CharStrings"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:         [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:-            [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:+[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:+            if [0m[1;39m([0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:+                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"EOF? Should have found CharStrings"[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:+            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:         [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: [0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:         [0m[35m/[0m[35m/[0m[39m CharStrings dict[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_7/patches/good_patch.di[0m[1;92mff:1[0m[39m-[0m[1;36m25[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1:d[0m[39miff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java [0m      [2m                [0m
[2;36m                    [0m         [39mb/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java[0m                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:index 949b259c3..f4a3c6f66 [0m[1;36m100644[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java[0m              [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java[0m              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:@@ [0m[1;36m-180[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m180[0m[39m,[0m[1;36m7[0m[39m @@ public class PDPageTree implements COSObjectable, [0m            [2m                [0m
[2;36m                    [0m         [39mIterable<PDPage>[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:     private final class PageIterator implements Iterator<PDPage>[0m                 [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:     [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:         private final Queue<COSDictionary> queue = new ArrayDeque<>[0m[1;39m([0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:-[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:+        private Set<COSDictionary> seen = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:         private [0m[1;35mPageIterator[0m[1;39m([0m[39mCOSDictionary node[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:         [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:             List<COSDictionary> kids = [0m[1;35menqueueKids[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:@@ [0m[1;36m-205[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m205[0m[39m,[0m[1;36m11[0m[39m @@ public class PDPageTree implements COSObjectable, [0m          [2m                [0m
[2;36m                    [0m         [39mIterable<PDPage>[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:          *[0m[35m/[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:         private List<COSDictionary> [0m[1;35menqueueKids[0m[1;39m([0m[39mCOSDictionary node[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:         [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:+            if [0m[1;39m([0m[1;35mseen.contains[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:+                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Found an infinite loop in the page tree"[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:+                return Collections.EMPTY_LIST;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:+            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:+            [0m[1;35mseen.add[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:             if [0m[1;39m([0m[1;35misPageTreeNode[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:             [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:                 return [0m[1;35mgetKids[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_8/patches/good_patch.di[0m[1;92mff:1[0m[39m-[0m[1;36m54[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1:d[0m[39miff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java [0m    [2m                [0m
[2;36m                    [0m         [39mb/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java[0m                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:index e8b53efc4..97bc49a2a [0m[1;36m100644[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java[0m            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:@@ [0m[1;36m-23[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m23[0m[39m,[0m[1;36m7[0m[39m @@ import java.util.HashSet;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: import java.util.Optional;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: import java.util.Map.Entry;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:+import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: [0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: import org.apache.logging.log4j.LogManager;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: import org.apache.logging.log4j.Logger;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:@@ [0m[1;36m-98[0m[39m,[0m[1;36m17[0m[39m +[0m[1;36m99[0m[39m,[0m[1;36m19[0m[39m @@ public class XrefParser[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:         [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:         [0m[1;35mdocument.setStartXref[0m[1;39m([0m[39mstartXrefOffset[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:         long prev = startXrefOffset;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:-        [0m[35m/[0m[35m/[0m[95mlastPrev[0m[39m prevents potential infinite loops in crafted files[0m           [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:-        long lastPrev = [0m[1;36m-1[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:         [0m[35m/[0m[35m/[0m[39m ---- parse whole chain of xref tables/object streams using PREV [0m     [2m                [0m
[2;36m                    [0m         [39mreference[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:+        Set<Long> prevSet = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:         COSDictionary trailer = null;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:-        while [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[39m && prev != lastPrev[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:+        while [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:         [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:-            lastPrev = prev;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:+            [0m[35m/[0m[35m/[0m[39m save expected position for loop detection[0m                        [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:+            [0m[1;35mprevSet.add[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:             [0m[35m/[0m[35m/[0m[39m seek to xref table[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:             [0m[1;35msource.seek[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:             [0m[35m/[0m[35m/[0m[39m skip white spaces[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:             [0m[1;35mparser.skipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:+            [0m[35m/[0m[35m/[0m[39m save current position as well due to skipped spaces[0m              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:+            [0m[1;35mprevSet.add[0m[1;39m([0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:             [0m[35m/[0m[35m/[0m[39m -- parse xref[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:             if [0m[1;39m([0m[1;35msource.peek[0m[1;39m([0m[1;39m)[0m[39m == X[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:             [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:@@ [0m[1;36m-120[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m123[0m[39m,[0m[1;36m7[0m[39m @@ public class XrefParser[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:                             + [0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:                 [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:                 trailer = [0m[1;35mxrefTrailerResolver.getCurrentTrailer[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:-                [0m[35m/[0m[35m/[0m[39m check for a XRef stream, it may contain some object ids of [0m  [2m                [0m
[2;36m                    [0m         [39mcompressed objects [0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:+                [0m[35m/[0m[35m/[0m[39m check for a XRef stream, it may contain some object ids of [0m  [2m                [0m
[2;36m                    [0m         [39mcompressed objects[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:                 [0m[1;35mif[0m[1;39m([0m[1;35mtrailer.containsKey[0m[1;39m([0m[39mCOSName.XREF_STM[0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:                 [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:                     int streamOffset = [0m[1;35mtrailer.getInt[0m[1;39m([0m[39mCOSName.XREF_STM[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:@@ [0m[1;36m-170[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m173[0m[39m,[0m[1;36m7[0m[39m @@ public class XrefParser[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:                     [0m[1;35mtrailer.setLong[0m[1;39m([0m[39mCOSName.PREV, prev[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:                 [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:             [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:-            if [0m[1;39m([0m[39mprev == lastPrev[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:+            if [0m[1;39m([0m[1;35mprevSet.contains[0m[1;39m([0m[39mprev[0m[1;39m)[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:             [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:                 throw new [0m[1;35mIOException[0m[1;39m([0m[32m"/Prev loop at offset "[0m[39m + prev[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:             [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:19[0m[39m-[0m[1;36m50[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.ByteArrayInputStream;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.EOFException;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.logging.log4j.LogManager;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m: * Parser for a pfb-file.[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m: * @author Ben Litchfield[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m: * @author Michael Niedermair[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:public class PfbParser [0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    private static final Logger LOG = [0m[1;35mLogManager.getLogger[0m[1;39m([0m[39mPfbParser.class[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * the pfb header length.[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     * [0m[1;39m([0m[39mstart-marker [0m[1;39m([0m[1;36m1[0m[39m byte[0m[1;39m)[0m[39m, ascii-[0m[35m/[0m[95mbinary-marker[0m[39m [0m[1;39m([0m[1;36m1[0m[39m byte[0m[1;39m)[0m[39m, size [0m[1;39m([0m[1;36m4[0m[39m byte[0m[1;39m)[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * [0m[1;36m3[0m[39m*[0m[1;36m6[0m[39m == [0m[1;36m18[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    private static final int PFB_[0m[1;33mHEAD[0m[39mER_LENGTH = [0m[1;36m18[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * the start marker.[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:66[0m[39m-[0m[1;36m167[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    private static final int EOF_MARKER = [0m[1;36m0x03[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * Heuristically chosen max length to buffer a Type1 font[0m                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    private static final long MAX_LENGTH = 100_000_000;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * the parsed pfb-data.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    private byte[0m[1;39m[[0m[1;39m][0m[39m pfbdata;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     * the lengths of the records [0m[1;39m([0m[39mASCII, BINARY, ASCII[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private final int[0m[1;39m[[0m[1;39m][0m[39m lengths = new int[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[35m/[0m[35m/[0m[39m sample [0m[1;39m([0m[39mpfb-file[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;36m00000000[0m[39m [0m[1;36m80[0m[39m [0m[1;36m01[0m[39m 8b [0m[1;36m15[0m[39m  [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m25[0m[39m [0m[1;36m21[0m[39m  [0m[1;36m50[0m[39m [0m[1;36m53[0m[39m 2d [0m[1;36m41[0m[39m  [0m[1;36m64[0m[39m 6f [0m[1;36m62[0m[39m [0m[1;36m65[0m[39m  [0m             [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    [0m[35m/[0m[35m/[0m[39m          [0m[33m...[0m[33m...[0m[39m%!PS-Adobe[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     * Create a new object.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     * @param filename  the file name[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     * @throws IOException if an IO-error occurs.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    public [0m[1;35mPfbParser[0m[1;39m([0m[39mfinal String filename[0m[1;39m)[0m[39m throws IOException [0m                  [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[1;35mFiles.readAllBytes[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     * Create a new object.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:     * @param in   The input.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:     * @throws IOException if an IO-error occurs.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    public [0m[1;35mPfbParser[0m[1;39m([0m[39mfinal InputStream in[0m[1;39m)[0m[39m throws IOException [0m                  [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m pfb = [0m[1;35min.readAllBytes[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        [0m[1;35mparsePfb[0m[1;39m([0m[39mpfb[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:     * Create a new object.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:     * @param bytes   The input.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:     * @throws IOException if an IO-error occurs.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    public [0m[1;35mPfbParser[0m[1;39m([0m[39mfinal byte[0m[1;39m[[0m[1;39m][0m[39m bytes[0m[1;39m)[0m[39m throws IOException[0m                     [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        [0m[1;35mparsePfb[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:     * Parse the pfb-array.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:     * @param pfb   The pfb-Array[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:     * @throws IOException in an IO-error occurs.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    private void [0m[1;35mparsePfb[0m[1;39m([0m[39mfinal byte[0m[1;39m[[0m[1;39m][0m[39m pfb[0m[1;39m)[0m[39m throws IOException [0m                 [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        if [0m[1;39m([0m[39mpfb.length < PFB_[0m[1;33mHEAD[0m[39mER_LENGTH[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"PFB header missing"[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        [0m[35m/[0m[35m/[0m[39m read into segments and keep them[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        List<Integer> typeList = new ArrayList<>[0m[1;39m([0m[1;36m3[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        List<byte[0m[1;39m[[0m[1;39m][0m[39m> barrList = new ArrayList<>[0m[1;39m([0m[1;36m3[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        ByteArrayInputStream in = new [0m[1;35mByteArrayInputStream[0m[1;39m([0m[39mpfb[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        int total = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        do[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            int r = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            if [0m[1;39m([0m[39mr == [0m[1;36m-1[0m[39m && total > [0m[1;36m0[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:                break; [0m[35m/[0m[35m/[0m[39m EOF[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:            if [0m[1;39m([0m[39mr != START_MARKER[0m[1;39m)[0m[39m [0m                                             [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Start marker missing"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:            int recordType = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:            if [0m[1;39m([0m[39mrecordType == EOF_MARKER[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:            if [0m[1;39m([0m[39mrecordType != ASCII_MARKER && recordType != BINARY_MARKER[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Incorrect record type: "[0m[39m + recordType[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            int size = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m8[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m16[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m24[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, size[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            long newTotal = total + size;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            if [0m[1;39m([0m[39mnewTotal > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"record size would be too large: "[0m[39m + [0m     [2m                [0m
[2;36m                    [0m         [39mnewTotal[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m ar = new byte[0m[1;39m[[0m[39msize[0m[1;39m][0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:            int got = [0m[1;35min.read[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.jav[0m[1;92ma:60[0m[39m-[0m[1;36m70[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    private static final long OBJECT_NUMBER_THRESHOLD = 10000000000L;[0m            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    private static final long GENERATION_NUMBER_THRESHOLD = [0m[1;36m65535[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    private static final int MAX_LENGTH_LONG = [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mLong.toString[0m[1;39m([0m[39mLong.MAX_VALUE[0m[1;39m)[0m[1;35m.length[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    private static final Charset ALTERNATIVE_CHARSET;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    private final Map<Long, COSObjectKey> keyCache = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.jav[0m[1;92ma:1445[0m[39m-[0m[1;36m1455[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1445[0m[39m:        int lastByte;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1446[0m[39m:        StringBuilder buffer = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1447[0m[39m:        while [0m[1;39m([0m[1;35misDigit[0m[1;39m([0m[39mlastByte = [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1448[0m[39m:        [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1449[0m[39m:            [0m[1;35mbuffer.append[0m[1;39m([0m[39m [0m[1;39m([0m[39mchar[0m[1;39m)[0m[39mlastByte [0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1450[0m[39m:            if [0m[1;39m([0m[1;35mbuffer.length[0m[1;39m([0m[1;39m)[0m[39m > MAX_LENGTH_LONG[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1451[0m[39m:            [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1452[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Number '"[0m[39m + buffer + [0m                   [2m                [0m
[2;36m                    [0m         [1;36m1453[0m[39m:                        [0m[32m"' is getting too long, stop reading at offset "[0m[39m + [0m    [2m                [0m
[2;36m                    [0m         [1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1454[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1455[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:316[0m[39m-[0m[1;36m365[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:    private Map<String, List<Token>> [0m[1;35mreadSimpleDict[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m        [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:        Map<String, List<Token>> dict = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:        int length = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m321[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dict"[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m322[0m[39m:        [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"dup"[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m323[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m324[0m[39m:        if [0m[1;39m([0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"def"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m325[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m326[0m[39m:            [0m[35m/[0m[35m/[0m[39m PDFBOX-[0m[1;36m5942[0m[39m empty dict[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m327[0m[39m:            return dict;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m328[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m329[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m330[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"begin"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m331[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m332[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m333[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m334[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m335[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m336[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m337[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m338[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m &&[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m339[0m[39m:               ![0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"end"[0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m340[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m341[0m[39m:                [0m[1;35mread[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m342[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m343[0m[39m:            [0m[35m/[0m[35m/[0m[39m premature end[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m344[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m345[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m346[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m347[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m348[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m &&[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m349[0m[39m:                [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"end"[0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m351[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m352[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m353[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:            [0m[35m/[0m[35m/[0m[39m simple value[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:            String key = [0m[1;35mread[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:            List<Token> value = [0m[1;35mreadDictValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:            [0m[1;35mdict.put[0m[1;39m([0m[39mkey, value[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"end"[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:        [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"readonly"[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"def"[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:        return dict;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:706[0m[39m-[0m[1;36m743[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m706[0m[39m:    private void [0m[1;35mreadSubrs[0m[1;39m([0m[39mint lenIV[0m[1;39m)[0m[39m throws IOException[0m                        [2m                [0m
[2;36m                    [0m         [1;36m707[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m708[0m[39m:        [0m[35m/[0m[35m/[0m[39m allocate size [0m[1;39m([0m[39marray indexes may not be in-order[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m709[0m[39m:        int length = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m710[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m711[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m712[0m[39m:            [0m[1;35mfont.subrs.add[0m[1;39m([0m[39mnull[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m713[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m714[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"array"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m715[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m716[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m717[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m718[0m[39m:            [0m[35m/[0m[35m/[0m[39m premature end[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m719[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m720[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m721[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m722[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m723[0m[39m:            if [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m &&[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m724[0m[39m:                  [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"dup"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m725[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m726[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m727[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m728[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m729[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dup"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m730[0m[39m:            Token index = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m731[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m732[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m733[0m[39m:            [0m[35m/[0m[35m/[0m[39m RD[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m734[0m[39m:            Token charstring = [0m[1;35mread[0m[1;39m([0m[39mToken.CHARSTRING[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m735[0m[39m:            int j = [0m[1;35mindex.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m736[0m[39m:            if [0m[1;39m([0m[39mj < [0m[1;35mfont.subrs.size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m737[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m738[0m[39m:                [0m[1;35mfont.subrs.set[0m[1;39m([0m[39mj, [0m[1;35mdecrypt[0m[1;39m([0m[1;35mcharstring.getData[0m[1;39m([0m[1;39m)[0m[39m, CHARSTRING_KEY,[0m [2m                [0m
[2;36m                    [0m         [39mlenIV[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m739[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m740[0m[39m:            [0m[1;35mreadPut[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m741[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m742[0m[39m:        [0m[1;35mreadDef[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m743[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/challenge.yaml:[0m[1;36m1[0m[39m-[0m[1;36m46[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:metadata_spec_version: v1[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:name: [0m[32m'Lemon Aquarium'[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:# fuzz_tooling project info that pairs to this challenge[0m                          [2m                [0m
[2;36m                    [0m         [1;92m6:f[0m[39muzz_tooling_project_name: [0m[32m'pdfbox'[0m                                               [2m                [0m
[2;36m                    [0m         [1;92m7:f[0m[39muzz_tooling_url: [0m[4;94mhttps://github.com/aixcc-finals/oss-fuzz-aixcc.git[0m              [2m                [0m
[2;36m                    [0m         [1;92m8:f[0m[39muzz_tooling_ref: challenge-state/pdfbox-full-[0m[1;36m01[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;92m10:c[0m[39mhallenge_type: full     # full | delta[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m12:ba[0m[39mse_ref: challenges/pdfbox-full-[0m[1;36m01[0m                                              [2m                [0m
[2;36m                    [0m         [1;92m13:de[0m[39mlta_ref: null # this is null for full scans, a hash for delta scans[0m            [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:required_memory_gb: [0m[1;36m32[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:timeouts: [0m[32m'enabled'[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:# A list of the vulnerabilities included in this challenge[0m                       [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:# This should always match the dir names in .aixcc/vulns/*[0m                       [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:vulnerabilities:[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:    - vuln_0[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:    - vuln_1[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:    - vuln_3[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:    - vuln_4[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:    - vuln_5[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:    - vuln_6[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:    - vuln_7[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:    - vuln_8[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:sarif:[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    broadcast: false[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    target: null[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    correct: null[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:# harness fuzz targets available for this challenge[0m                              [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:harnesses:[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    - [0m[32m'DomXfaParserFuzzer'[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    - [0m[32m'DomXmpParserFuzzer'[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    - [0m[32m'PDFExtractTextFuzzer'[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    - [0m[32m'PDFStreamParserFuzzer'[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    - [0m[32m'PDFWriteReadFuzzer'[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    - [0m[32m'PDFOCRFuzzer'[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:patch_exclude_list:[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    - [0m[32m'.*/src/test/.*'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/README.m[0m[1;92md:1[0m[39m-[0m[1;36m11[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:# What design decisions were considered for this challenge?[0m                       [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:Unlike with commons-compress, where we focused on individual challenges,[0m          [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:we wanted to add a large number of vulnerabilities into on large full repository [0m [2m                [0m
[2;36m                    [0m         [39mscan.[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:# Why this set of vulnerabilities?[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:While there's a heavy focus on the Type1 font parser, there are vulnerabilities[0m   [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:that also focus on general structure of the PDF file.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:# Delta vs Full and why?[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:See above. We wanted at least one challenge to be a full repository challenge [0m   [2m                [0m
[2;36m                    [0m         [39mwith a [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:large number of vulnerabilities.[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:192[0m[39m-[0m[1;36m239[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:    private void [0m[1;35mreadEncoding[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                              [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:        if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:            String name = [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:            if [0m[1;39m([0m[1;35mname.equals[0m[1;39m([0m[32m"StandardEncoding"[0m[1;39m)[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:                font.encoding = StandardEncoding.INSTANCE;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Unknown encoding: "[0m[39m + name[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:            [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"readonly"[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"def"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:        else[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"array"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:            [0m[35m/[0m[35m/[0m[39m [0m[1;36m0[0m[39m [0m[1;36m1[0m[39m [0m[1;36m255[0m[39m [0m[1;39m{[0m[1;36m1[0m[39m index exch [0m[35m/[0m[95m.notdef[0m[39m put [0m[1;39m}[0m[39m for[0m                         [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:            [0m[35m/[0m[35m/[0m[39m we have to check [0m[32m"readonly"[0m[39m and [0m[32m"def"[0m[39m too[0m                        [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:            [0m[35m/[0m[35m/[0m[39m as some fonts don't provide any dup-values, see PDFBOX-[0m[1;36m2134[0m      [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:            while [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                    && [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"dup"[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:                            || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"readonly"[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                            || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"def"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:            Map<Integer, String> codeToName = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:            while [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m &&[0m                                [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                    [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"dup"[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dup"[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                int code = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                String name = [0m[1;35mread[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"put"[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                [0m[1;35mcodeToName.put[0m[1;39m([0m[39mcode, name[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:            font.encoding = new [0m[1;35mBuiltInEncoding[0m[1;39m([0m[39mcodeToName[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:            [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"readonly"[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"def"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:636[0m[39m-[0m[1;36m650[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m636[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m637[0m[39m:        [0m[35m/[0m[35m/[0m[39m some fonts have [0m[32m"2 index"[0m[39m here, others have [0m[32m"end noaccess put"[0m       [2m                [0m
[2;36m                    [0m         [1;36m638[0m[39m:        [0m[35m/[0m[35m/[0m[39m sometimes followed by [0m[32m"put"[0m[39m. Either way, we just skip until[0m          [2m                [0m
[2;36m                    [0m         [1;36m639[0m[39m:        [0m[35m/[0m[35m/[0m[39m the [0m[35m/[0m[95mCharStrings[0m[39m dict is found[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m640[0m[39m:        while [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m641[0m[39m:                && [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"CharStrings"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [1;36m642[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m643[0m[39m:            [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m644[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m645[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m646[0m[39m:        [0m[35m/[0m[35m/[0m[39m CharStrings dict[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m647[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.LITERAL, [0m[32m"CharStrings"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m648[0m[39m:        [0m[1;35mreadCharStrings[0m[1;39m([0m[39mlenIV[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m649[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m650[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:706[0m[39m-[0m[1;36m743[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m706[0m[39m:    private void [0m[1;35mreadSubrs[0m[1;39m([0m[39mint lenIV[0m[1;39m)[0m[39m throws IOException[0m                        [2m                [0m
[2;36m                    [0m         [1;36m707[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m708[0m[39m:        [0m[35m/[0m[35m/[0m[39m allocate size [0m[1;39m([0m[39marray indexes may not be in-order[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m709[0m[39m:        int length = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m710[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m711[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m712[0m[39m:            [0m[1;35mfont.subrs.add[0m[1;39m([0m[39mnull[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m713[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m714[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"array"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m715[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m716[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m717[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m718[0m[39m:            [0m[35m/[0m[35m/[0m[39m premature end[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m719[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m720[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m721[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m722[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m723[0m[39m:            if [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m &&[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m724[0m[39m:                  [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"dup"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m725[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m726[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m727[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m728[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m729[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dup"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m730[0m[39m:            Token index = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m731[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m732[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m733[0m[39m:            [0m[35m/[0m[35m/[0m[39m RD[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m734[0m[39m:            Token charstring = [0m[1;35mread[0m[1;39m([0m[39mToken.CHARSTRING[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m735[0m[39m:            int j = [0m[1;35mindex.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m736[0m[39m:            if [0m[1;39m([0m[39mj < [0m[1;35mfont.subrs.size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m737[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m738[0m[39m:                [0m[1;35mfont.subrs.set[0m[1;39m([0m[39mj, [0m[1;35mdecrypt[0m[1;39m([0m[1;35mcharstring.getData[0m[1;39m([0m[1;39m)[0m[39m, CHARSTRING_KEY,[0m [2m                [0m
[2;36m                    [0m         [39mlenIV[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m739[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m740[0m[39m:            [0m[1;35mreadPut[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m741[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m742[0m[39m:        [0m[1;35mreadDef[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m743[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:502[0m[39m-[0m[1;36m515[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:    private Token [0m[1;35mreadCharString[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m throws IOException[0m                 [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:        try[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:            [0m[1;35mbuffer.get[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m space[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m507[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m data = new byte[0m[1;39m[[0m[39mlength[0m[1;39m][0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:            [0m[1;35mbuffer.get[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:            return new [0m[1;35mToken[0m[1;39m([0m[39mdata, Token.CHARSTRING[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:        catch [0m[1;39m([0m[39mBufferUnderflowException exception[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Premature end of buffer reached"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:45[0m[39m-[0m[1;36m111[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m45:c[0m[39mlass Type1Lexer[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * Log instance.[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    private static final Logger LOG = [0m[1;35mLogManager.getLogger[0m[1;39m([0m[39mType1Lexer.class[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    private final ByteBuffer buffer;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    private Token aheadToken;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    private int openParens = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     * Constructs a new Type1Lexer given a header-less .pfb segment.[0m             [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     * @param bytes Header-less .pfb segment[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     * @throws IOException[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    [0m[1;35mType1Lexer[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m bytes[0m[1;39m)[0m[39m throws IOException[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        buffer = [0m[1;35mByteBuffer.wrap[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        aheadToken = [0m[1;35mreadToken[0m[1;39m([0m[39mnull[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * Returns the next token and consumes it.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * @return The next token.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    public Token [0m[1;35mnextToken[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        Token curToken = aheadToken;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        [0m[35m/[0m[35m/[0m[95mSystem.out.println[0m[1;39m([0m[39mcurToken[0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m for debugging[0m                         [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        aheadToken = [0m[1;35mreadToken[0m[1;39m([0m[39mcurToken[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        return curToken;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     * Returns the next token without consuming it.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     * @return The next token[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    public Token [0m[1;35mpeekToken[0m[1;39m([0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        return aheadToken;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     * Checks if the kind of the next token equals the given one without [0m        [2m                [0m
[2;36m                    [0m         [39mconsuming it.[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     * [0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     * @return true if the kind of the next token equals the given one[0m           [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    public boolean [0m[1;35mpeekKind[0m[1;39m([0m[39mToken.Kind kind[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        return aheadToken != null && [0m[1;35maheadToken.getKind[0m[1;39m([0m[1;39m)[0m[39m == kind;[0m               [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     * Reads an ASCII char from the buffer.[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    private char [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        try[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:            return [0m[1;39m([0m[39mchar[0m[1;39m)[0m[39m [0m[1;35mbuffer.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        catch [0m[1;39m([0m[39mBufferUnderflowException exception[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Premature end of buffer reached"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:555[0m[39m-[0m[1;36m565[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m555[0m[39m:        [0m[35m/[0m[35m/[0m[39m find [0m[35m/[0m[95mPrivate[0m[39m dict[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m556[0m[39m:        Token peekToken = [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m557[0m[39m:        while [0m[1;39m([0m[39mpeekToken != null && ![0m[32m"Private"[0m[1;35m.equals[0m[1;39m([0m[1;35mpeekToken.getText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m558[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m559[0m[39m:            [0m[35m/[0m[35m/[0m[39m for a more thorough validation, the presence of [0m[32m"begin"[0m[39m before [0m  [2m                [0m
[2;36m                    [0m         [39mPrivate[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m560[0m[39m:            [0m[35m/[0m[35m/[0m[39m determines how code before and following charstrings should look[0m [2m                [0m
[2;36m                    [0m         [1;36m561[0m[39m:            [0m[35m/[0m[35m/[0m[39m it is not currently checked anyway[0m                               [2m                [0m
[2;36m                    [0m         [1;36m562[0m[39m:            [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m563[0m[39m:            peekToken = [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m564[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m565[0m[39m:        if [0m[1;39m([0m[39mpeekToken == null[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.jav[0m[1;92ma:298[0m[39m-[0m[1;36m369[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:    private COSDictionary [0m[1;35mget[0m[1;39m([0m[39mint pageNum, COSDictionary node, int encountered[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:        if [0m[1;39m([0m[39mpageNum < [0m[1;36m1[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:            throw new [0m[1;35mIndexOutOfBoundsException[0m[1;39m([0m[32m"Index out of bounds: "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39mpageNum[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:        if [0m[1;39m([0m[1;35mpageSet.contains[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:            [0m[1;35mpageSet.clear[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:            throw new [0m[1;35mIllegalStateException[0m[1;39m([0m                                    [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:                    [0m[32m"Possible recursion found when searching for page "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39mpageNum[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:        else[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:            [0m[35m/[0m[35m/[0m[39m collect already processed pages to detect possible recursions[0m    [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:            [0m[35m/[0m[35m/[0m[39m to avoid a StackOverflowError[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:            [0m[1;35mpageSet.add[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:        if [0m[1;39m([0m[1;35misPageTreeNode[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:            int count = [0m[1;35mnode.getInt[0m[1;39m([0m[39mCOSName.COUNT, [0m[1;36m0[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:            if [0m[1;39m([0m[39mpageNum <= encountered + count[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m321[0m[39m:                [0m[35m/[0m[35m/[0m[39m it's a kid of this node[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m322[0m[39m:                for [0m[1;39m([0m[39mCOSDictionary kid : [0m[1;35mgetKids[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m323[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m324[0m[39m:                    [0m[35m/[0m[35m/[0m[39m which kid?[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m325[0m[39m:                    if [0m[1;39m([0m[1;35misPageTreeNode[0m[1;39m([0m[39mkid[0m[1;39m)[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m326[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m327[0m[39m:                        int kidCount = [0m[1;35mkid.getInt[0m[1;39m([0m[39mCOSName.COUNT, [0m[1;36m0[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m328[0m[39m:                        if [0m[1;39m([0m[39mpageNum <= encountered + kidCount[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m329[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m330[0m[39m:                            [0m[35m/[0m[35m/[0m[39m it's this kid[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m331[0m[39m:                            return [0m[1;35mget[0m[1;39m([0m[39mpageNum, kid, encountered[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m332[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m333[0m[39m:                        else[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m334[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m335[0m[39m:                            encountered += kidCount;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m336[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m337[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m338[0m[39m:                    else[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m339[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m340[0m[39m:                        [0m[35m/[0m[35m/[0m[39m single page[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m341[0m[39m:                        encountered++;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m342[0m[39m:                        if [0m[1;39m([0m[39mpageNum == encountered[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m343[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m344[0m[39m:                            [0m[35m/[0m[35m/[0m[39m it's this page[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m345[0m[39m:                            return [0m[1;35mget[0m[1;39m([0m[39mpageNum, kid, encountered[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m346[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m347[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m348[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m349[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:                throw new [0m[1;35mIllegalStateException[0m[1;39m([0m[32m"1-based index not found: "[0m[39m + [0m  [2m                [0m
[2;36m                    [0m         [39mpageNum[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m351[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m352[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m353[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:                throw new [0m[1;35mIndexOutOfBoundsException[0m[1;39m([0m[32m"1-based index out of [0m      [2m                [0m
[2;36m                    [0m         [32mbounds: "[0m[39m + pageNum[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:        else[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:            if [0m[1;39m([0m[39mencountered == pageNum[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:                [0m[1;35mpageSet.clear[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:                return node;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:                throw new [0m[1;35mIllegalStateException[0m[1;39m([0m[32m"1-based index not found: "[0m[39m + [0m  [2m                [0m
[2;36m                    [0m         [39mpageNum[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/test.sh:[0m[1;36m1[0m[39m-[0m[1;36m11[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:#![0m[35m/bin/[0m[95mbash[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m[33mMAVEN_ARGS[0m[39m="-Djacoco.[0m[33mskip[0m[39m=[0m[35mtrue[0m[39m -Drat.[0m[33mskip[0m[39m=[0m[35mtrue[0m[39m -Dcheckstyle.[0m[33mskip[0m[39m=[0m[35mtrue[0m[39m [0m            [2m                [0m
[2;36m                    [0m         [39m-Djavac.target.[0m[33mversion[0m[39m=[0m[1;36m11[0m[39m \[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:    -Dsurefire.[0m[33mfailIfNoSpecifiedTests[0m[39m=[0m[35mfalse[0m[39m \[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:      [0m[39m-[0m[33mDtest[0m[39m=!TestCreateSignature"[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:if [0m[1;39m[[0m[39m -z [0m[32m"$[0m[32m{[0m[32mMVN[0m[32m}[0m[32m"[0m[39m [0m[1;39m][0m[39m; then[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:      [0m[33mMVN[0m[39m=[0m[35mmvn[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m9:f[0m[39mi[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:$MVN test $MAVEN_ARGS[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/test/java/org/apache/pdfbox/pdfparser/TestPDFParser.jav[0m[1;92ma:38[0m[39m-[0m[1;36m55[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m38:c[0m[39mlass TestPDFParser[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    private static final File TAR[0m[1;33mGET[0m[39mPDFDIR = new [0m[1;35mFile[0m[1;39m([0m[32m"target/pdfs"[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    void [0m[1;35mtestPDFParserMissingCatalog[0m[1;39m([0m[1;39m)[0m[39m throws URISyntaxException[0m                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        [0m[35m/[0m[35m/[0m[39m PDFBOX-[0m[1;36m3060[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:        try[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:            [0m[1;35mLoader.loadPDF[0m[1;39m([0m[39mnew [0m                                                  [2m                [0m
[2;36m                    [0m         [1;35mFile[0m[1;39m([0m[1;35mTestPDFParser.class.getResource[0m[1;39m([0m[32m"MissingCatalog.pdf"[0m[1;39m)[0m[1;35m.toURI[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:                [0m[1;35m.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        catch [0m[1;39m([0m[39mException exception[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            [0m[1;35mfail[0m[1;39m([0m[32m"Unexpected Exception"[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/test/java/org/apache/fontbox/type1/Type1LexerTest.jav[0m[1;92ma:33[0m[39m-[0m[1;36m93[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m33:c[0m[39mlass Type1LexerTest[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[1;35mType1LexerTest[0m[1;39m([0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     * PDFBOX-[0m[1;36m5155[0m[39m: test real numbers.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    void [0m[1;35mtestRealNumbers[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:        String s = [0m[32m"/FontMatrix [0m[32m[[0m[32m1e-3 0e-3 0e-3 -1E-03 0 0 1.23 -1.23 [0m[32m][0m[32m readonly[0m [2m                [0m
[2;36m                    [0m         [32mdef"[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:        Type1Lexer t1l = new [0m[1;35mType1Lexer[0m[1;39m([0m[1;35ms.getBytes[0m[1;39m([0m[39mStandardCharsets.US_ASCII[0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        List<Token> tokens = [0m[1;35mreadTokens[0m[1;39m([0m[39mt1l[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mToken.LITERAL, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[1;35m.getKind[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"FontMatrix"[0m[39m, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mToken.START_ARRAY, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[1;35m.getKind[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mToken.REAL, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;35m.getKind[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mToken.REAL, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m3[0m[1;39m)[0m[1;35m.getKind[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mToken.REAL, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m4[0m[1;39m)[0m[1;35m.getKind[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mToken.REAL, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m5[0m[1;39m)[0m[1;35m.getKind[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mToken.INTEGER, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m6[0m[1;39m)[0m[1;35m.getKind[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mToken.INTEGER, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m7[0m[1;39m)[0m[1;35m.getKind[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mToken.REAL, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m8[0m[1;39m)[0m[1;35m.getKind[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mToken.REAL, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m9[0m[1;39m)[0m[1;35m.getKind[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"1e-3"[0m[39m, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"0e-3"[0m[39m, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m3[0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"0e-3"[0m[39m, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m4[0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"-1E-03"[0m[39m, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m5[0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39m-1E-3f, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m5[0m[1;39m)[0m[1;35m.floatValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"0"[0m[39m, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m6[0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"0"[0m[39m, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m7[0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"1.23"[0m[39m, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m8[0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"-1.23"[0m[39m, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m9[0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mToken.END_ARRAY, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m10[0m[1;39m)[0m[1;35m.getKind[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mToken.NAME, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m11[0m[1;39m)[0m[1;35m.getKind[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mToken.NAME, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m12[0m[1;39m)[0m[1;35m.getKind[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    void [0m[1;35mtestEmptyName[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        String s = [0m[32m"dup 127 / put"[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        Type1Lexer t1l = new [0m[1;35mType1Lexer[0m[1;39m([0m[1;35ms.getBytes[0m[1;39m([0m[39mStandardCharsets.US_ASCII[0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        Token nextToken;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        try[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            do[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                nextToken = [0m[1;35mt1l.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:            while [0m[1;39m([0m[39mnextToken != null[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            [0m[1;35mAssertions.fail[0m[1;39m([0m[32m"DamagedFontException expected"[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        catch [0m[1;39m([0m[39mDamagedFontException ex[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"Could not read token at position 9"[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;35mex.getMessage[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis of the Timeout Issue[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mBased on the evaluation report and code analysis, the libFuzzer timeout is caused [0m  [2m                [0m
[2;36m                    [0m         [39mby multiple infinite loop vulnerabilities in the codebase:[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Root Causes Identified[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **vuln_3**: Infinite loop in `[0m[1;35mType1Parser.readEncoding[0m[1;39m([0m[1;39m)[0m[39m` at lines [0m[1;36m217[0m[39m-[0m[1;36m223[0m       [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **vuln_4**: Infinite loop in `[0m[1;35mType1Parser.parseBinary[0m[1;39m([0m[1;39m)[0m[39m` at lines [0m[1;36m640[0m[39m-[0m[1;36m644[0m        [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **vuln_7**: Infinite loop in `PDPageTree.PageIterator` due to missing cycle [0m     [2m                [0m
[2;36m                    [0m         [39mdetection[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **vuln_8**: Infinite loop in `XrefParser` due to inadequate cycle detection in [0m  [2m                [0m
[2;36m                    [0m         [39mxref chain traversal[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **vuln_5**: Excessive memory allocation in `[0m[1;35mType1Parser.readSubrs[0m[1;39m([0m[1;39m)[0m[39m` can cause [0m  [2m                [0m
[2;36m                    [0m         [39mtimeout[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAll of these are classic DoS vulnerabilities where malformed input causes the [0m      [2m                [0m
[2;36m                    [0m         [39mparser to enter long-running or infinite execution paths.[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Comprehensive Fix Strategy[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Fix #[0m[1;36m1[0m[39m: [0m[1;35mType1Parser.readEncoding[0m[1;39m([0m[1;39m)[0m[39m - EOF Check [0m[1;39m([0m[39mvuln_3[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: `fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java` [0m    [2m                [0m
[2;36m                    [0m         [39mlines [0m[1;36m217[0m[39m-[0m[1;36m223[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Issue**: The while loop consumes tokens looking for [0m[32m"dup"[0m[39m, [0m[32m"readonly"[0m[39m, or [0m[32m"def"[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mbut doesn't check if `[0m[1;35mnextToken[0m[1;39m([0m[1;39m)[0m[39m` returns null at EOF, causing an infinite loop.[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Fix Strategy**:[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mwhile [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [39m        && [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"dup"[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [39m                || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"readonly"[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m                || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"def"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m        throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Unexpected EOF while looking for dup, readonly, or [0m  [2m                [0m
[2;36m                    [0m         [32mdef"[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Justification**: This follows the established pattern in the codebase [0m[1;39m([0m[39mseen in [0m   [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mreadProc[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m476[0m[39m-[0m[1;36m478[0m[1;39m)[0m[39m where EOF is explicitly checked before proceeding. [0m   [2m                [0m
[2;36m                    [0m         [39mThe fix prevents infinite looping when a malformed font file ends unexpectedly.[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Fix #[0m[1;36m2[0m[39m: [0m[1;35mType1Parser.parseBinary[0m[1;39m([0m[1;39m)[0m[39m - EOF Check [0m[1;39m([0m[39mvuln_4[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: `fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java` [0m    [2m                [0m
[2;36m                    [0m         [39mlines [0m[1;36m640[0m[39m-[0m[1;36m644[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Issue**: Similar pattern - loop searches for [0m[32m"CharStrings"[0m[39m literal without [0m       [2m                [0m
[2;36m                    [0m         [39mchecking for EOF.[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Fix Strategy**:[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mwhile [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [39m        && [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"CharStrings"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m        throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Unexpected EOF while looking for CharStrings"[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Justification**: Identical pattern to vuln_3. The fix is minimal, consistent with[0m [2m                [0m
[2;36m                    [0m         [39mexisting code patterns [0m[1;39m([0m[39msee line [0m[1;36m557[0m[39m for correct EOF handling[0m[1;39m)[0m[39m, and prevents the [0m   [2m                [0m
[2;36m                    [0m         [39minfinite loop.[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Fix #[0m[1;36m3[0m[39m: PDPageTree.PageIterator - Cycle Detection [0m[1;39m([0m[39mvuln_7[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: `pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java` [0m     [2m                [0m
[2;36m                    [0m         [39mlines [0m[1;36m180[0m[39m-[0m[1;36m225[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Issue**: The `PageIterator` constructor traverses the page tree without tracking [0m [2m                [0m
[2;36m                    [0m         [39mvisited nodes, allowing circular references to cause infinite loops.[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Fix Strategy**:[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mAdd a `Set<COSDictionary>` field to track visited nodes:[0m                            [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mprivate final class PageIterator implements Iterator<PDPage>[0m                        [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    private final Queue<COSDictionary> queue = new ArrayDeque<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [39m    private Set<COSDictionary> seen = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m ADD THIS[0m                 [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m [0m[33m...[0m[39m rest of code [0m[33m...[0m                                                         [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    private List<COSDictionary> [0m[1;35menqueueKids[0m[1;39m([0m[39mCOSDictionary node[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        if [0m[1;39m([0m[1;35mseen.contains[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m  [0m[35m/[0m[35m/[0m[39m ADD THIS CHECK[0m                               [2m                [0m
[2;36m                    [0m         [39m            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Found an infinite loop in the page tree"[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [39m            return Collections.EMPTY_LIST;[0m                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mseen.add[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m ADD THIS[0m                                                [2m                [0m
[2;36m                    [0m         [39m        [0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        if [0m[1;39m([0m[1;35misPageTreeNode[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [39m        [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m            return [0m[1;35mgetKids[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m        [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[35m/[0m[35m/[0m[39m [0m[33m...[0m[39m rest of existing code [0m[33m...[0m                                            [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Justification**: This mirrors the existing cycle detection pattern already [0m       [2m                [0m
[2;36m                    [0m         [39mpresent in the `[0m[1;35mget[0m[1;39m([0m[1;39m)[0m[39m` method at line [0m[1;36m304[0m[39m-[0m[1;36m314[0m[39m which uses `pageSet`. The fix is [0m     [2m                [0m
[2;36m                    [0m         [39mconsistent with the codebase's approach and prevents infinite loops from circular [0m  [2m                [0m
[2;36m                    [0m         [39mpage tree structures. Note that the iterator is already used in a similar context [0m  [2m                [0m
[2;36m                    [0m         [39mwhere cycle detection is critical.[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Fix #[0m[1;36m4[0m[39m: XrefParser - Enhanced Cycle Detection [0m[1;39m([0m[39mvuln_8[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: `pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java` [0m   [2m                [0m
[2;36m                    [0m         [39maround lines [0m[1;36m98[0m[39m-[0m[1;36m173[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Issue**: The xref table traversal uses a simple `lastPrev` check that only [0m       [2m                [0m
[2;36m                    [0m         [39mdetects immediate [0m[1;36m2[0m[39m-node cycles [0m[1;39m([0m[39mA→B→A[0m[1;39m)[0m[39m but misses longer cycles [0m[1;39m([0m[39mA→B→C→A[0m[1;39m)[0m[39m.[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Fix Strategy**:[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mReplace the `lastPrev` variable with a `Set<Long>` to track all visited offsets:[0m    [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mlong prev = startXrefOffset;[0m                                                        [2m                [0m
[2;36m                    [0m         [39mSet<Long> prevSet = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m REPLACE lastPrev[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mwhile [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[1;39m)[0m[39m  [0m[35m/[0m[35m/[0m[39m REMOVE: && prev != lastPrev[0m                                    [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mprevSet.add[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m REPLACE: lastPrev = prev[0m                                 [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35msource.seek[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mparser.skipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mprevSet.add[0m[1;39m([0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Also track position after skipping[0m       [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m [0m[33m...[0m[39m parse xref table/stream [0m[33m...[0m                                              [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Get next prev value from trailer[0m                                             [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mtrailer != null && [0m[1;35mtrailer.containsKey[0m[1;39m([0m[39mCOSName.PREV[0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        prev = [0m[1;35mtrailer.getLong[0m[1;39m([0m[39mCOSName.PREV[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    else[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        prev = [0m[1;36m-1[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[1;35mprevSet.contains[0m[1;39m([0m[39mprev[0m[1;39m)[0m[1;39m)[0m[39m  [0m[35m/[0m[35m/[0m[39m CHECK before next iteration[0m                     [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        throw new [0m[1;35mIOException[0m[1;39m([0m[32m"/Prev loop detected at offset "[0m[39m + prev[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Justification**: Using a Set provides comprehensive cycle detection for any [0m      [2m                [0m
[2;36m                    [0m         [39mlength cycle. The fix also tracks the position after skipping spaces, as the actual[0m [2m                [0m
[2;36m                    [0m         [39mparsing position may differ from the PREV value. This is the standard approach for [0m [2m                [0m
[2;36m                    [0m         [39mdetecting cycles in linked structures.[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Fix #[0m[1;36m5[0m[39m: [0m[1;35mType1Parser.readSubrs[0m[1;39m([0m[1;39m)[0m[39m - Bounds Validation [0m[1;39m([0m[39mvuln_5 related[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: `fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java` [0m    [2m                [0m
[2;36m                    [0m         [39mlines [0m[1;36m709[0m[39m-[0m[1;36m713[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Issue**: The method reads a length value from untrusted input and immediately [0m    [2m                [0m
[2;36m                    [0m         [39mallocates that many list elements without validation, potentially causing OOM or [0m   [2m                [0m
[2;36m                    [0m         [39mtimeout.[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Fix Strategy**:[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mprivate void [0m[1;35mreadSubrs[0m[1;39m([0m[39mint lenIV[0m[1;39m)[0m[39m throws IOException[0m                                [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    int length = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m ADD VALIDATION[0m                                                               [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mlength < [0m[1;36m0[0m[39m || length > [0m[1;36m65535[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [39m        throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Invalid Subrs array size: "[0m[39m + length + [0m              [2m                [0m
[2;36m                    [0m         [39m            [0m[32m". Must be between 0 and 65535"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mfont.subrs.add[0m[1;39m([0m[39mnull[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m [0m[33m...[0m[39m rest of method unchanged [0m[33m...[0m                                             [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Justification**: [0m[1;36m65[0m[39m,[0m[1;36m535[0m[39m is a reasonable upper bound for subroutines in a Type1 [0m   [2m                [0m
[2;36m                    [0m         [39mfont [0m[1;39m([0m[39mderived from the fact that Type1 fonts use [0m[1;36m16[0m[39m-bit indices[0m[1;39m)[0m[39m. This is [0m          [2m                [0m
[2;36m                    [0m         [39mconsistent with the existing `GENERATION_NUMBER_THRESHOLD = [0m[1;36m65535[0m[39m` in BaseParser. [0m  [2m                [0m
[2;36m                    [0m         [39mThe check prevents excessive allocation while allowing all legitimate fonts to [0m     [2m                [0m
[2;36m                    [0m         [39mparse correctly.[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Additional Note on vuln_5 [0m[1;39m([0m[39mType1Lexer.readCharString[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe primary fix for vuln_5 is already documented in the patch and involves adding a[0m [2m                [0m
[2;36m                    [0m         [39mcheck in `[0m[1;35mType1Lexer.readCharString[0m[1;39m([0m[1;39m)[0m[39m`:[0m                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mprivate static int MAX_CHAR_STRING_SIZE = 1_000_000;[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mprivate Token [0m[1;35mreadCharString[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m throws IOException[0m                         [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mlength > MAX_CHAR_STRING_SIZE[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [39m        throw new [0m[1;35mDamagedFontException[0m[1;39m([0m[32m"char string is too long. [0m[32mlength[0m[32m="[0m[39m +[0m         [2m                [0m
[2;36m                    [0m         [39m                length + [0m[32m" [0m[32mmax_length[0m[32m="[0m[39m + MAX_CHAR_STRING_SIZE[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m [0m[33m...[0m[39m rest of method [0m[33m...[0m                                                       [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis should also be applied as it prevents excessive allocation in character string[0m [2m                [0m
[2;36m                    [0m         [39mreading.[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Additional Note on vuln_6 [0m[1;39m([0m[39mInteger Overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: `fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java` line [0m   [2m                [0m
[2;36m                    [0m         [1;36m161[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Fix**: Cast operands to long before addition to prevent integer overflow:[0m         [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mlong newTotal = [0m[1;39m([0m[39mlong[0m[1;39m)[0m[39mtotal + [0m[1;39m([0m[39mlong[0m[1;39m)[0m[39msize;  [0m[35m/[0m[35m/[0m[39m Instead of: total + size[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis prevents the overflow that allows bypass of the MAX_LENGTH check.[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Implementation Guidelines[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Critical Principles[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **No Harness Modifications**: All fixes target source code only, never harness [0m  [2m                [0m
[2;36m                    [0m         [39mor test code[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Preserve Existing Logic**: All fixes are additive [0m[1;39m([0m[39madding checks[0m[1;39m)[0m[39m rather than [0m [2m                [0m
[2;36m                    [0m         [39mchanging core parsing logic[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Consistent Error Handling**: All new exceptions use IOException with [0m          [2m                [0m
[2;36m                    [0m         [39mdescriptive messages[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Pattern Consistency**: All fixes follow patterns already established elsewhere[0m [2m                [0m
[2;36m                    [0m         [39min the codebase[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Minimal Impact**: Fixes are surgical - only adding null checks, bounds checks,[0m [2m                [0m
[2;36m                    [0m         [39mor cycle detection where missing[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Testing Considerations[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- All existing tests must continue to pass[0m                                          [2m                [0m
[2;36m                    [0m         [39m- Legitimate PDF files and Type1 fonts must parse correctly[0m                         [2m                [0m
[2;36m                    [0m         [39m- The bounds values [0m[1;39m([0m[1;36m65535[0m[39m for subrs, [0m[1;36m1[0m[39m,[0m[1;36m000[0m[39m,[0m[1;36m000[0m[39m for char strings[0m[1;39m)[0m[39m are orders of [0m    [2m                [0m
[2;36m                    [0m         [39mmagnitude larger than typical usage[0m                                                 [2m                [0m
[2;36m                    [0m         [39m- Error messages provide clear indication of the issue for debugging[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This Approach Is Optimal[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Surgical Fixes**: Each fix targets a specific vulnerability without broad [0m     [2m                [0m
[2;36m                    [0m         [39mchanges[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Established Patterns**: All fixes use patterns already present in the codebase[0m [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mEOF checks at line [0m[1;36m719[0m[39m, cycle detection at line [0m[1;36m304[0m[39m, bounds checks throughout[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Defense in Depth**: Multiple layers of protection [0m[1;39m([0m[39mEOF checks, cycle [0m          [2m                [0m
[2;36m                    [0m         [39mdetection, bounds validation[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Backwards Compatible**: No changes to public APIs or expected behavior for [0m    [2m                [0m
[2;36m                    [0m         [39mvalid inputs[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Low Risk**: Small, localized changes reduce the chance of introducing new bugs[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Side Effects and Mitigations[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential Side Effect**: Some malformed but [0m[32m"working"[0m[39m files might now be [0m         [2m                [0m
[2;36m                    [0m         [39mrejected.[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m**Mitigation**: The error messages clearly indicate what's wrong, and the bounds [0m   [2m                [0m
[2;36m                    [0m         [39mare generous enough to handle any legitimate file.[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential Side Effect**: Slight performance overhead from Set operations and [0m     [2m                [0m
[2;36m                    [0m         [39madditional checks.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m**Mitigation**: The overhead is negligible compared to I/O and parsing operations, [0m [2m                [0m
[2;36m                    [0m         [39mand only affects files that would have timed out anyway.[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Conclusion[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis fix strategy comprehensively addresses all timeout-causing vulnerabilities by:[0m [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Adding EOF checks to prevent infinite loops [0m[1;39m([0m[39mvuln_3, vuln_4[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Implementing proper cycle detection [0m[1;39m([0m[39mvuln_7, vuln_8[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Validating size/count values from untrusted input [0m[1;39m([0m[39mvuln_5, vuln_6[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAll fixes follow established patterns in the codebase and maintain full backwards [0m  [2m                [0m
[2;36m                    [0m         [39mcompatibility with legitimate inputs while protecting against malicious crafted [0m    [2m                [0m
[2;36m                    [0m         [39mfiles.[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/05/26 21:44:40][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=877149;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=171172;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=560712;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=576315;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpwnqvjnrk[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/pdfbox_pdfbox-full-01_vuln_8/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1767649480.2302296[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc/pdfbox_pdfbox-full-01_vuln_8.toml       [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-pdfbox[0m           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/05/26 21:44:42][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mpdfbox[0m         ]8;id=144193;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=162514;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=501830;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=367644;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mpdfbox[0m                [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=766923;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=511164;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mpdfbox[0m                 [2m               [0m
