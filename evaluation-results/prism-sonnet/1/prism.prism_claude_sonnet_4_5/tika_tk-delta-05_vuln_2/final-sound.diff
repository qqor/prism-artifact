--- a/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java
+++ b/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java
@@ -1125,7 +1125,7 @@
             }
         }
 
-        private File getOutputFile(String name, Metadata metadata, MediaType contentType) {
+        private File getOutputFile(String name, Metadata metadata, MediaType contentType) throws IOException {
             String ext = getExtension(contentType);
             if (name.indexOf('.') == -1 && contentType != null) {
                 name += ext;
@@ -1158,12 +1158,26 @@
                 LOG.warn("couldn't url decode name {}", normalizedName);
             }
             File outputFile = new File(extractDir, normalizedName);
+            
+            // Validate that the resolved path is within the extraction directory to prevent path traversal
+            Path outputPath = outputFile.toPath().toAbsolutePath().normalize();
+            Path extractPath = extractDir.toPath().toAbsolutePath().normalize();
+            if (!outputPath.startsWith(extractPath)) {
+                throw new IOException("Path traversal detected in embedded resource: " + name);
+            }
+            
             //if file already exists, prepend uuid
             if (outputFile.exists()) {
                 String fileName = FilenameUtils.getName(normalizedName);
                 outputFile = new File(extractDir, UUID
                         .randomUUID()
                         .toString() + "-" + fileName);
+                
+                // Revalidate the path after prepending UUID
+                outputPath = outputFile.toPath().toAbsolutePath().normalize();
+                if (!outputPath.startsWith(extractPath)) {
+                    throw new IOException("Path traversal detected in embedded resource after UUID prepend: " + name);
+                }
             }
             return outputFile;
         }

--- a/tika-example/src/main/java/org/apache/tika/example/ExtractEmbeddedFiles.java
+++ b/tika-example/src/main/java/org/apache/tika/example/ExtractEmbeddedFiles.java
@@ -108,10 +108,24 @@
             }
 
             Path outputFile = outputDir.resolve(name);
+            
+            // Validate that the resolved path is within the output directory to prevent path traversal
+            Path normalizedOutput = outputFile.toAbsolutePath().normalize();
+            Path normalizedOutputDir = outputDir.toAbsolutePath().normalize();
+            if (!normalizedOutput.startsWith(normalizedOutputDir)) {
+                throw new IOException("Path traversal detected in embedded resource: " + name);
+            }
+            
             if (Files.exists(outputFile)) {
                 outputFile = outputDir.resolve(UUID
                         .randomUUID()
                         .toString() + "-" + name);
+                
+                // Revalidate the path after prepending UUID
+                normalizedOutput = outputFile.toAbsolutePath().normalize();
+                if (!normalizedOutput.startsWith(normalizedOutputDir)) {
+                    throw new IOException("Path traversal detected in embedded resource after UUID prepend: " + name);
+                }
             }
             Files.createDirectories(outputFile.getParent());
             Files.copy(stream, outputFile);
