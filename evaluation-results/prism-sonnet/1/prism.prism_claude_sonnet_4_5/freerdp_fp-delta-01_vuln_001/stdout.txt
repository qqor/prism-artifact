[2;36m[01/06/26 15:27:49][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=791281;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=897327;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpn7g4x4zr[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/freerdp_fp-delta-01_vuln_001/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1767713269.0308418[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/freerdp_fp-delta-01_vuln_001.toml                     [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-freerdp[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Building Cached for CLEAN environment[1m)[0m           ]8;id=584695;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=446410;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[01/06/26 15:28:20][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Building Cached for CLEAN environment[1m)[0m Took     ]8;id=276397;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=360986;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m31.83[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=668190;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=952233;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Running tests for Cached for CLEAN environment[1m)[0m ]8;id=92843;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=933885;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=547549;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=855621;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m31[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=757807;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=240447;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 15:28:21][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.83[0m seconds;               ]8;id=365886;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=683078;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/06/26 15:28:22][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=460692;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=805799;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=747821;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=85554;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=300999;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=928276;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=862302;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=427482;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 15:28:23][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m1.02[0m seconds;               ]8;id=300524;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=99742;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=315065;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=653626;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 15:28:24][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.82[0m seconds;               ]8;id=713054;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=742973;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/06/26 15:28:27][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=140642;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=252051;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mTestFuzzCryptoCertificateDataSetPEM[0m                                        [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer TestFuzzCryptoCertificateDataSetPEM -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m   [2m                [0m
[2;36m                    [0m         [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3551741767[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m9103[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m9103[0m[39m [0m[1;39m[[0m[1;36m0x55d0790e9af0[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55d0790ebe7f[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m9103[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m9103[0m[39m [0m[1;39m[[0m[1;36m0x55d0790ebe80[0m[39m,[0m[1;36m0x55d07910f770[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m        [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x502000010230[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55d078daaf4f[0m[39m bp [0m[1;36m0x7fffb2bb38e0[0m[39m sp [0m[1;36m0x7fffb2bb38d8[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x502000010230[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m41[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow-far-from-bounds[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d078daaf4e[0m[39m in freerdp_bio_read_pem_with_policy [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1570:14[0m                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d078daaf4e[0m[39m in freerdp_certificate_get_pem_ex [0m                            [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1634:9[0m                                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d078da2861[0m[39m in freerdp_certificate_data_load_cache [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m84:21[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d078da2861[0m[39m in freerdp_certificate_data_new_nocopy [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m126:7[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d078da2bb9[0m[39m in freerdp_certificate_data_new_from_pem [0m                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m155:29[0m                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d078da2277[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCryptoCertificateDataSetPEM.c[0m[39m:[0m[1;92m13:9[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d078c590f0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d078c44365[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d078c49dff[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d078c750a2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7f81372d9082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55d078c3c54d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM+0xcb54d[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39mfreerdp_bio_read_pem_with_policy--freerdp_certificate_get_pem_ex--freerdp_certifica[0m [2m                [0m
[2;36m                    [0m         [39mte_data_load_cache[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddress [0m[1;36m0x502000010230[0m[39m is a wild pointer inside of access range of size [0m            [2m                [0m
[2;36m                    [0m         [1;36m0x000000000001[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1570:14[0m[39m in [0m                            [2m                [0m
[2;36m                    [0m         [39mfreerdp_bio_read_pem_with_policy[0m                                                    [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x50200000ff80[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010000[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010080[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010100[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x502000010200[0m[39m: fa fa fa fa fa fa[0m[1;39m[[0m[39mfa[0m[1;39m][0m[39mfa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010400[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010480[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mfreerdp[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp_quc47_t[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mTestFuzzCryptoCertificateDataSetPEM -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mTestFuzzCryptoCertificateDataSetPEM[0m                                        [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer TestFuzzCryptoCertificateDataSetPEM -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3551741767[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m9103[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m9103[0m[39m [0m[1;39m[[0m[1;36m0x55d0790e9af0[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55d0790ebe7f[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m9103[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m9103[0m[39m [0m[1;39m[[0m[1;36m0x55d0790ebe80[0m[39m,[0m[1;36m0x55d07910f770[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m        [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x502000010230[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55d078daaf4f[0m[39m bp [0m[1;36m0x7fffb2bb38e0[0m[39m sp [0m[1;36m0x7fffb2bb38d8[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x502000010230[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m41[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow-far-from-bounds[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d078daaf4e[0m[39m in freerdp_bio_read_pem_with_policy [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1570:14[0m                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d078daaf4e[0m[39m in freerdp_certificate_get_pem_ex [0m                            [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1634:9[0m                                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d078da2861[0m[39m in freerdp_certificate_data_load_cache [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m84:21[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d078da2861[0m[39m in freerdp_certificate_data_new_nocopy [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m126:7[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d078da2bb9[0m[39m in freerdp_certificate_data_new_from_pem [0m                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m155:29[0m                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d078da2277[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCryptoCertificateDataSetPEM.c[0m[39m:[0m[1;92m13:9[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d078c590f0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d078c44365[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d078c49dff[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d078c750a2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7f81372d9082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55d078c3c54d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM+0xcb54d[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39mfreerdp_bio_read_pem_with_policy--freerdp_certificate_get_pem_ex--freerdp_certifica[0m [2m                [0m
[2;36m                    [0m         [39mte_data_load_cache[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddress [0m[1;36m0x502000010230[0m[39m is a wild pointer inside of access range of size [0m            [2m                [0m
[2;36m                    [0m         [1;36m0x000000000001[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1570:14[0m[39m in [0m                            [2m                [0m
[2;36m                    [0m         [39mfreerdp_bio_read_pem_with_policy[0m                                                    [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x50200000ff80[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010000[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010080[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010100[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x502000010200[0m: fa fa fa fa fa fa[1m[[0mfa[1m][0mfa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000010280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000010300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000010380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000010400[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000010480[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                [2m                [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                       [2m                [0m
[2;36m                    [0m           Heap left redzone:       fa                                                       [2m                [0m
[2;36m                    [0m           Freed heap region:       fd                                                       [2m                [0m
[2;36m                    [0m           Stack left redzone:      f1                                                       [2m                [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                       [2m                [0m
[2;36m                    [0m           Stack right redzone:     f3                                                       [2m                [0m
[2;36m                    [0m           Stack after return:      f5                                                       [2m                [0m
[2;36m                    [0m           Stack use after scope:   f8                                                       [2m                [0m
[2;36m                    [0m           Global redzone:          f9                                                       [2m                [0m
[2;36m                    [0m           Global init order:       f6                                                       [2m                [0m
[2;36m                    [0m           Poisoned by user:        f7                                                       [2m                [0m
[2;36m                    [0m           Container overflow:      fc                                                       [2m                [0m
[2;36m                    [0m           Array cookie:            ac                                                       [2m                [0m
[2;36m                    [0m           Intra object redzone:    bb                                                       [2m                [0m
[2;36m                    [0m           ASan internal:           fe                                                       [2m                [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                       [2m                [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                       [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                      [2m                [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                               [2m                [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64 [2m                [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                    [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mfreerdp[0m:[35m/[0m[95mout[0m -v       [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp_quc47_t[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce     [2m                [0m
[2;36m                    [0m         TestFuzzCryptoCertificateDataSetPEM -[33mruns[0m=[1;36m100[0m.                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/06/26 15:28:46][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=443003;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=912842;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/06/26 15:33:27][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=378537;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=34002;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/06/26 15:33:56][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=100607;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=537959;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=702296;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=122512;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 15:33:57][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.86[0m seconds;               ]8;id=835316;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=144750;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Patching[1m)[0m Started[33m...[0m                             ]8;id=394286;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=861845;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpltl57qzg[0m                                                 ]8;id=970938;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=926290;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/06/26 15:34:20][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Patching[1m)[0m Took [1;36m22.66[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=248199;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=903715;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Checking build[1m)[0m Started[33m...[0m                       ]8;id=19913;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=286123;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 15:34:32][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Checking build[1m)[0m Took [1;36m12.64[0m seconds;             ]8;id=808242;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=886839;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Running PoV[1m)[0m Started[33m...[0m                          ]8;id=354412;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=271294;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 15:34:34][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Running PoV[1m)[0m Took [1;36m2.11[0m seconds; [33mexception[0m=[3;91mFalse[0m ]8;id=744293;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=53143;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Testing[1m)[0m Started[33m...[0m                              ]8;id=570993;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=595687;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m     ]8;id=660776;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=392773;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=714078;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=673898;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 15:34:35][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.81[0m seconds;               ]8;id=115539;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=920270;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/06/26 15:34:36][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=65535;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=20668;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 15:34:37][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.90[0m seconds;               ]8;id=432541;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=726694;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=829846;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=911704;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 15:34:38][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.87[0m seconds;               ]8;id=611370;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=285837;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=698055;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=439382;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/libfreerdp/crypto/certificate.c                                               [2m                [0m
[2;36m                    [0m         +++ b/libfreerdp/crypto/certificate.c                                               [2m                [0m
[2;36m                    [0m         @@ [1;36m-1534[0m,[1;36m9[0m +[1;36m1534[0m,[1;36m9[0m @@                                                               [2m                [0m
[2;36m                    [0m                 [1;35mWINPR_ASSERT[0m[1m([0mbio[1m)[0m;                                                          [2m                [0m
[2;36m                    [0m                 [1;35mWINPR_ASSERT[0m[1m([0mppem[1m)[0m;                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         -       const uint16_t blocksize = [1;36m2048[0m;                                            [2m                [0m
[2;36m                    [0m         -       uint16_t offset = [1;36m0[0m;                                                        [2m                [0m
[2;36m                    [0m         -       uint16_t length = blocksize;                                                [2m                [0m
[2;36m                    [0m         +       const size_t blocksize = [1;36m2048[0m;                                              [2m                [0m
[2;36m                    [0m         +       size_t offset = [1;36m0[0m;                                                          [2m                [0m
[2;36m                    [0m         +       size_t length = blocksize;                                                  [2m                [0m
[2;36m                    [0m                 char* pem = NULL;                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                 *ppem = NULL;                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mTestFuzzCryptoCertificateDataSetPEM[0m                                        [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer TestFuzzCryptoCertificateDataSetPEM -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m   [2m                [0m
[2;36m                    [0m         [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3551741767[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m9103[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m9103[0m[39m [0m[1;39m[[0m[1;36m0x55d0790e9af0[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55d0790ebe7f[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m9103[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m9103[0m[39m [0m[1;39m[[0m[1;36m0x55d0790ebe80[0m[39m,[0m[1;36m0x55d07910f770[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m        [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x502000010230[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55d078daaf4f[0m[39m bp [0m[1;36m0x7fffb2bb38e0[0m[39m sp [0m[1;36m0x7fffb2bb38d8[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x502000010230[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m41[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow-far-from-bounds[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d078daaf4e[0m[39m in freerdp_bio_read_pem_with_policy [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1570:14[0m                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d078daaf4e[0m[39m in freerdp_certificate_get_pem_ex [0m                            [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1634:9[0m                                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d078da2861[0m[39m in freerdp_certificate_data_load_cache [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m84:21[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d078da2861[0m[39m in freerdp_certificate_data_new_nocopy [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m126:7[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d078da2bb9[0m[39m in freerdp_certificate_data_new_from_pem [0m                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m155:29[0m                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d078da2277[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCryptoCertificateDataSetPEM.c[0m[39m:[0m[1;92m13:9[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d078c590f0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d078c44365[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d078c49dff[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d078c750a2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7f81372d9082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55d078c3c54d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM+0xcb54d[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39mfreerdp_bio_read_pem_with_policy--freerdp_certificate_get_pem_ex--freerdp_certifica[0m [2m                [0m
[2;36m                    [0m         [39mte_data_load_cache[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddress [0m[1;36m0x502000010230[0m[39m is a wild pointer inside of access range of size [0m            [2m                [0m
[2;36m                    [0m         [1;36m0x000000000001[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1570:14[0m[39m in [0m                            [2m                [0m
[2;36m                    [0m         [39mfreerdp_bio_read_pem_with_policy[0m                                                    [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x50200000ff80[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010000[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010080[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010100[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x502000010200[0m[39m: fa fa fa fa fa fa[0m[1;39m[[0m[39mfa[0m[1;39m][0m[39mfa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010400[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010480[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mfreerdp[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp_quc47_t[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mTestFuzzCryptoCertificateDataSetPEM -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA heap-buffer-overflow vulnerability has been detected in the FreeRDP library [0m      [2m                [0m
[2;36m                    [0m         [39mduring fuzzing of the `TestFuzzCryptoCertificateDataSetPEM` component. The [0m         [2m                [0m
[2;36m                    [0m         [39mvulnerability involves a [0m[1;36m1[0m[39m-byte write operation beyond the bounds of an allocated [0m  [2m                [0m
[2;36m                    [0m         [39mheap buffer, occurring in the certificate processing code path. AddressSanitizer [0m   [2m                [0m
[2;36m                    [0m         [39mhas flagged this as a critical issue with a scariness score of [0m[1;36m41[0m[39m.[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Issue Overview[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mThe fuzzing process has identified a heap-buffer-overflow error when processing [0m    [2m                [0m
[2;36m                    [0m         [39mcertificate data. The error occurs when the fuzzer executes the [0m                    [2m                [0m
[2;36m                    [0m         [39m`TestFuzzCryptoCertificateDataSetPEM` fuzzer with a specific test case input. The [0m  [2m                [0m
[2;36m                    [0m         [39moverflow is characterized as a [0m[1;36m1[0m[39m-byte write operation at address `[0m[1;36m0x502000010230[0m[39m`, [0m [2m                [0m
[2;36m                    [0m         [39mwhich is reported as a [0m[32m"wild pointer inside of access range."[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Vulnerability Type[0m                                                              [2m                [0m
[2;36m                    [0m         [39mThis is a **heap-buffer-overflow** vulnerability, specifically a write operation [0m   [2m                [0m
[2;36m                    [0m         [39mthat exceeds the allocated buffer boundaries. The AddressSanitizer report indicates[0m [2m                [0m
[2;36m                    [0m         [39mthis is a [0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow that occurs [0m[32m"far-from-bounds,"[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39msuggesting the write operation significantly overshoots the intended buffer area.[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Stack Trace Analysis[0m                                                            [2m                [0m
[2;36m                    [0m         [39mThe vulnerability manifests through the following call chain:[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Entry Point**: `LLVMFuzzerTestOneInput` in [0m                                    [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCryptoCertificateDataSetPEM.c[0m[39m:[0m[1;36m13[0m[39m`[0m        [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Data Processing**: `freerdp_certificate_data_new_from_pem` at line [0m[1;36m155[0m         [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Intermediate Processing**: `freerdp_certificate_data_new_nocopy` at line [0m[1;36m126[0m   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Cache Loading**: `freerdp_certificate_data_load_cache` at line [0m[1;36m84[0m              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **PEM Extraction**: `freerdp_certificate_get_pem_ex` at line [0m[1;36m1634[0m                [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Critical Point**: `freerdp_bio_read_pem_with_policy` at [0m                       [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1570:14[0m[39m` - where the actual overflow [0m [2m                [0m
[2;36m                    [0m         [39moccurs[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Key Observations[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Location**: The overflow occurs at line [0m[1;36m1570[0m[39m in `certificate.c` within the [0m    [2m                [0m
[2;36m                    [0m         [39m`freerdp_bio_read_pem_with_policy` function[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Memory State**: The shadow bytes around the buggy address show the region is [0m  [2m                [0m
[2;36m                    [0m         [39mmarked as heap left redzone [0m[1;39m([0m[39m`fa`[0m[1;39m)[0m[39m, indicating the write operation is attempting to[0m [2m                [0m
[2;36m                    [0m         [39maccess memory outside the allocated buffer[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Deduplication Token**: [0m                                                        [2m                [0m
[2;36m                    [0m         [39m`freerdp_bio_read_pem_with_policy--freerdp_certificate_get_pem_ex--freerdp_certific[0m [2m                [0m
[2;36m                    [0m         [39mate_data_load_cache` suggests this is a known issue pattern in the certificate [0m     [2m                [0m
[2;36m                    [0m         [39mprocessing pipeline[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas for Investigation[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo understand the full scope of this vulnerability, the following components should[0m [2m                [0m
[2;36m                    [0m         [39mbe examined:[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Primary Investigation**:[0m                                                       [2m                [0m
[2;36m                    [0m         [39m   - `[0m[35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m` - specifically the [0m             [2m                [0m
[2;36m                    [0m         [39m`freerdp_bio_read_pem_with_policy` function around line [0m[1;36m1570[0m                        [2m                [0m
[2;36m                    [0m         [39m   - The exact write operation that causes the overflow at this location[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Certificate Data Processing Chain**:[0m                                           [2m                [0m
[2;36m                    [0m         [39m   - `[0m[35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m` - examine functions:[0m       [2m                [0m
[2;36m                    [0m         [39m     - `freerdp_certificate_data_load_cache` [0m[1;39m([0m[39mline [0m[1;36m84[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [39m     - `freerdp_certificate_data_new_nocopy` [0m[1;39m([0m[39mline [0m[1;36m126[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [39m     - `freerdp_certificate_data_new_from_pem` [0m[1;39m([0m[39mline [0m[1;36m155[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Related Functions**:[0m                                                           [2m                [0m
[2;36m                    [0m         [39m   - `freerdp_certificate_get_pem_ex` in certificate.c [0m[1;39m([0m[39mline [0m[1;36m1634[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [39m   - Buffer allocation and management in the PEM reading logic[0m                      [2m                [0m
[2;36m                    [0m         [39m   - Size calculations and boundary checks in the certificate processing functions[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Data Flow Analysis**:[0m                                                          [2m                [0m
[2;36m                    [0m         [39m   - How input data flows from the fuzzer harness through the certificate [0m          [2m                [0m
[2;36m                    [0m         [39mprocessing pipeline[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m   - Buffer size calculations and allocations throughout the call chain[0m             [2m                [0m
[2;36m                    [0m         [39m   - String/data manipulation operations that could lead to off-by-one errors or [0m   [2m                [0m
[2;36m                    [0m         [39mincorrect size calculations[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability appears to be triggered by specific input patterns during PEM [0m    [2m                [0m
[2;36m                    [0m         [39mcertificate parsing, suggesting that input validation or buffer size calculations [0m  [2m                [0m
[2;36m                    [0m         [39mmay be insufficient in handling certain certificate formats or malformed data.[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mTestFuzzCryptoCertificateDataSetPEM[0m                                        [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer TestFuzzCryptoCertificateDataSetPEM -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3551741767[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m9103[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m9103[0m[39m [0m[1;39m[[0m[1;36m0x55d0790e9af0[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55d0790ebe7f[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m9103[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m9103[0m[39m [0m[1;39m[[0m[1;36m0x55d0790ebe80[0m[39m,[0m[1;36m0x55d07910f770[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m        [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x502000010230[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55d078daaf4f[0m[39m bp [0m[1;36m0x7fffb2bb38e0[0m[39m sp [0m[1;36m0x7fffb2bb38d8[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x502000010230[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m41[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow-far-from-bounds[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d078daaf4e[0m[39m in freerdp_bio_read_pem_with_policy [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1570:14[0m                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d078daaf4e[0m[39m in freerdp_certificate_get_pem_ex [0m                            [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1634:9[0m                                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d078da2861[0m[39m in freerdp_certificate_data_load_cache [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m84:21[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d078da2861[0m[39m in freerdp_certificate_data_new_nocopy [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m126:7[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d078da2bb9[0m[39m in freerdp_certificate_data_new_from_pem [0m                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m155:29[0m                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d078da2277[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCryptoCertificateDataSetPEM.c[0m[39m:[0m[1;92m13:9[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d078c590f0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d078c44365[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d078c49dff[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d078c750a2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7f81372d9082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55d078c3c54d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM+0xcb54d[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39mfreerdp_bio_read_pem_with_policy--freerdp_certificate_get_pem_ex--freerdp_certifica[0m [2m                [0m
[2;36m                    [0m         [39mte_data_load_cache[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddress [0m[1;36m0x502000010230[0m[39m is a wild pointer inside of access range of size [0m            [2m                [0m
[2;36m                    [0m         [1;36m0x000000000001[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1570:14[0m[39m in [0m                            [2m                [0m
[2;36m                    [0m         [39mfreerdp_bio_read_pem_with_policy[0m                                                    [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x50200000ff80[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010000[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010080[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010100[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x502000010200[0m[39m: fa fa fa fa fa fa[0m[1;39m[[0m[39mfa[0m[1;39m][0m[39mfa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010400[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010480[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mfreerdp[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp_quc47_t[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mTestFuzzCryptoCertificateDataSetPEM -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1529[0m[39m-[0m[1;36m1580[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1529[0m[39m:static BOOL [0m[1;35mfreerdp_bio_read_pem_with_policy[0m[1;39m([0m[39mBIO* bio, char** ppem, size_t* [0m   [2m                [0m
[2;36m                    [0m         [39mplength[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1530[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1531[0m[39m:   [0m[39mBOOL rc = FALSE;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1532[0m[39m:   [0m[39mint status = [0m[1;36m-1[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1533[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1534[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mbio[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1535[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mppem[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1536[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1537[0m[39m:   [0m[39mconst uint16_t blocksize = [0m[1;36m2048[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1538[0m[39m:   [0m[39muint16_t offset = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1539[0m[39m:   [0m[39muint16_t length = blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1540[0m[39m:   [0m[39mchar* pem = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1541[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1542[0m[39m:   [0m[39m*ppem = NULL;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1543[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1544[0m[39m:   [0m[39m        [0m[39m*plength = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1545[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1546[0m[39m:   [0m[39mwhile [0m[1;39m([0m[39mstatus != [0m[1;36m0[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1547[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1548[0m[39m:   [0m[39m        [0m[39mchar* tmp = [0m[1;35mrealloc[0m[1;39m([0m[39mpem, length + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1549[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m!tmp[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1550[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1551[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1552[0m[39m:   [0m[39m        [0m[39mpem = tmp;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1553[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1554[0m[39m:   [0m[39m        [0m[1;35mERR_clear_error[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1555[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1556[0m[39m:   [0m[39m        [0m[39mstatus = [0m[1;35mBIO_read[0m[1;39m([0m[39mbio, &pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[1;39m([0m[39mlength - offset[0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1557[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1558[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1559[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"failed to read certificate"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1561[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1562[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1563[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1564[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1565[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1566[0m[39m:   [0m[39m        [0m[39moffset += [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mstatus;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:   [0m[39m        [0m[39mlength += blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1568[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1569[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1570[0m[39m:   [0m[39mpem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1571[0m[39m:   [0m[39m*ppem = pem;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1572[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1573[0m[39m:   [0m[39m        [0m[39m*plength = offset;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1574[0m[39m:   [0m[39mrc = TRUE;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;92m1575:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1576[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!rc[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1577[0m[39m:   [0m[39m        [0m[1;35mfree[0m[1;39m([0m[39mpem[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1578[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1579[0m[39m:   [0m[39mreturn rc;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1580[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1477[0m[39m-[0m[1;36m1527[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1477[0m[39m:static BOOL [0m[1;35mbio_read_pem[0m[1;39m([0m[39mBIO* bio, char** ppem, size_t* plength[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m1478[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1479[0m[39m:   [0m[39mBOOL rc = FALSE;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1480[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1481[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mbio[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1482[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mppem[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1483[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1484[0m[39m:   [0m[39mconst size_t blocksize = [0m[1;36m2048[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1485[0m[39m:   [0m[39msize_t offset = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1486[0m[39m:   [0m[39msize_t length = blocksize;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1487[0m[39m:   [0m[39mchar* pem = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1488[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1489[0m[39m:   [0m[39m*ppem = NULL;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1490[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1491[0m[39m:   [0m[39m        [0m[39m*plength = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1492[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1493[0m[39m:   [0m[39mwhile [0m[1;39m([0m[39moffset < length[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1494[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1495[0m[39m:   [0m[39m        [0m[39mchar* tmp = [0m[1;35mrealloc[0m[1;39m([0m[39mpem, length + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1496[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m!tmp[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1497[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1498[0m[39m:   [0m[39m        [0m[39mpem = tmp;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1499[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1500[0m[39m:   [0m[39m        [0m[1;35mERR_clear_error[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1501[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1502[0m[39m:   [0m[39m        [0m[39mconst int status = [0m[1;35mBIO_read[0m[1;39m([0m[39mbio, &pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[1;39m([0m[39mlength - [0m      [2m                [0m
[2;36m                    [0m         [39moffset[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1503[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1504[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1505[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"failed to read certificate"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1506[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1507[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1508[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1509[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1510[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1511[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1512[0m[39m:   [0m[39m        [0m[39moffset += [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mstatus;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1513[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mlength - offset > [0m[1;36m0[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1514[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1515[0m[39m:   [0m[39m        [0m[39mlength += blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1516[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1517[0m[39m:   [0m[39mpem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1518[0m[39m:   [0m[39m*ppem = pem;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1519[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1520[0m[39m:   [0m[39m        [0m[39m*plength = offset;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1521[0m[39m:   [0m[39mrc = TRUE;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;92m1522:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1523[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!rc[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1524[0m[39m:   [0m[39m        [0m[1;35mfree[0m[1;39m([0m[39mpem[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1525[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1526[0m[39m:   [0m[39mreturn rc;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1527[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate_data.[0m[1;92mc:68[0m[39m-[0m[1;36m104[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:static BOOL [0m[1;35mfreerdp_certificate_data_load_cache[0m[1;39m([0m[39mrdpCertificateData* data[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     [0m[39mBOOL rc = FALSE;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     [0m[1;35mfreerdp_certificate_data_hash_[0m[1;39m([0m[39mdata->hostname, data->port, [0m                 [2m                [0m
[2;36m                    [0m         [39mdata->cached_hash,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     [0m[39m                               [0m[1;35msizeof[0m[1;39m([0m[39mdata->cached_hash[0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     [0m[39mif [0m[1;39m([0m[1;35mstrnlen[0m[1;39m([0m[39mdata->cached_hash, [0m[1;35msizeof[0m[1;39m([0m[39mdata->cached_hash[0m[1;39m)[0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     [0m[39mdata->cached_subject = [0m[1;35mfreerdp_certificate_get_subject[0m[1;39m([0m[39mdata->cert[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data->cached_subject[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     [0m[39m        [0m[39mdata->cached_subject = [0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     [0m[39msize_t pemlen = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     [0m[39mdata->cached_pem = [0m[1;35mfreerdp_certificate_get_pem_ex[0m[1;39m([0m[39mdata->cert, &pemlen, [0m     [2m                [0m
[2;36m                    [0m         [39mFALSE[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data->cached_pem[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     [0m[39msize_t pemchainlen = [0m[1;36m0[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     [0m[39mdata->cached_pem_chain = [0m[1;35mfreerdp_certificate_get_pem_ex[0m[1;39m([0m[39mdata->cert, [0m        [2m                [0m
[2;36m                    [0m         [39m&pemchainlen, TRUE[0m[1;39m)[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data->cached_pem_chain[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:     [0m[39mdata->cached_fingerprint = [0m[1;35mfreerdp_certificate_get_fingerprint[0m[1;39m([0m[39mdata->cert[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data->cached_fingerprint[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:     [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:     [0m[39mdata->cached_issuer = [0m[1;35mfreerdp_certificate_get_issuer[0m[1;39m([0m[39mdata->cert[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data->cached_issuer[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     [0m[39m        [0m[39mdata->cached_issuer = [0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    [0m[39mrc = TRUE;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;92m102:fa[0m[39mil:[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    [0m[39mreturn rc;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate_data.[0m[1;92mc:106[0m[39m-[0m[1;36m160[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:static rdpCertificateData* [0m[1;35mfreerdp_certificate_data_new_nocopy[0m[1;39m([0m[39mconst char* [0m     [2m                [0m
[2;36m                    [0m         [39mhostname, UINT16 port,[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:                                                               rdpCertificate* [0m [2m                [0m
[2;36m                    [0m         [39mxcert[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    [0m[39mrdpCertificateData* certdata = NULL;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!hostname || !xcert[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    [0m[39mcertdata = [0m[1;39m([0m[39mrdpCertificateData*[0m[1;39m)[0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mrdpCertificateData[0m[1;39m)[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!certdata[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    [0m[39mcertdata->port = port;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[39mcertdata->hostname = [0m[1;35m_strdup[0m[1;39m([0m[39mhostname[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!certdata->hostname[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[1;35mensure_lowercase[0m[1;39m([0m[39mcertdata->hostname, [0m[1;35mstrlen[0m[1;39m([0m[39mcertdata->hostname[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[39mcertdata->cert = xcert;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mfreerdp_certificate_data_load_cache[0m[1;39m([0m[39mcertdata[0m[1;39m)[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:    [0m[39m        [0m[39mcertdata->cert = NULL;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:    [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    [0m[39mreturn certdata;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;92m133:fa[0m[39mil:[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    [0m[1;35mfreerdp_certificate_data_free[0m[1;39m([0m[39mcertdata[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:    [0m[39mreturn NULL;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:rdpCertificateData* [0m[1;35mfreerdp_certificate_data_new[0m[1;39m([0m[39mconst char* hostname, UINT16 [0m  [2m                [0m
[2;36m                    [0m         [39mport,[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:                                                 const rdpCertificate* xcert[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    [0m[39mrdpCertificate* copy = [0m[1;35mfreerdp_certificate_clone[0m[1;39m([0m[39mxcert[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:    [0m[39mrdpCertificateData* data = [0m[1;35mfreerdp_certificate_data_new_nocopy[0m[1;39m([0m[39mhostname, [0m   [2m                [0m
[2;36m                    [0m         [39mport, copy[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!data[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:    [0m[39m        [0m[1;35mfreerdp_certificate_free[0m[1;39m([0m[39mcopy[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    [0m[39mreturn data;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:rdpCertificateData* [0m[1;35mfreerdp_certificate_data_new_from_pem[0m[1;39m([0m[39mconst char* hostname,[0m [2m                [0m
[2;36m                    [0m         [39mUINT16 port,[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:                                                          const char* pem, [0m     [2m                [0m
[2;36m                    [0m         [39msize_t length[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!pem || [0m[1;39m([0m[39mlength == [0m[1;36m0[0m[1;39m)[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    [0m[39mrdpCertificate* cert = [0m[1;35mfreerdp_certificate_new_from_pem[0m[1;39m([0m[39mpem[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[39mrdpCertificateData* data = [0m[1;35mfreerdp_certificate_data_new_nocopy[0m[1;39m([0m[39mhostname, [0m   [2m                [0m
[2;36m                    [0m         [39mport, cert[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!data[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    [0m[39m        [0m[1;35mfreerdp_certificate_free[0m[1;39m([0m[39mcert[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    [0m[39mreturn data;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/test/TestFuzzCryptoCertificateDataSetPEM.[0m[1;92mc:1[0m[39m-[0m[1;36m22[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:#include <stddef.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:#include <stdint.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#include <freerdp/crypto/certificate_store.h>[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:int [0m[1;35mLLVMFuzzerTestOneInput[0m[1;39m([0m[39mconst uint8_t* Data, size_t Size[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m[1;39m{[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:      [0m[39mrdpCertificateData* data = NULL;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:      [0m[39mchar* pem = [0m[1;35mcalloc[0m[1;39m([0m[39mSize + [0m[1;36m1[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mchar[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:      [0m[39mif [0m[1;39m([0m[39mpem == NULL[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:     [0m[39m        [0m[39mgoto cleanup;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:     [0m[1;35mmemcpy[0m[1;39m([0m[39mpem, Data, Size[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:     [0m[39mdata = [0m[1;35mfreerdp_certificate_data_new_from_pem[0m[1;39m([0m[32m"somehost"[0m[39m, [0m[1;36m1234[0m[39m, pem, Size[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:     [0m[39m        [0m[39mgoto cleanup;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m17:c[0m[39mleanup:[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:     [0m[1;35mfreerdp_certificate_data_free[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:     [0m[1;35mfree[0m[1;39m([0m[39mpem[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:     [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1351[0m[39m-[0m[1;36m1380[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1351[0m[39m:int [0m[1;35mfreerdp_certificate_policies[0m[1;39m([0m[39mconst rdpCertificate* cert, const char* oid[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1352[0m[39m:    [0m[1;35mSTACK_OF[0m[1;39m([0m[39mPOLICYINFO[0m[1;39m)[0m[39m *policies;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1353[0m[39m:   [0m[39mint result = [0m[1;36m0[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1354[0m[39m:    int crit;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1355[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1356[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!cert->x509[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1357[0m[39m:   [0m[39m        [0m[39mreturn result;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1358[0m[39m:   [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1359[0m[39m:    [0m[35m/[0m[35m/[0m[39m Get certificate policies[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1360[0m[39m:    policies = [0m[1;35mX509_get_ext_d2i[0m[1;39m([0m[39mcert->x509, NID_certificate_policies, &crit, [0m  [2m                [0m
[2;36m                    [0m         [39mNULL[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1361[0m[39m:    if [0m[1;39m([0m[39m!policies[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1362[0m[39m:        return result;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1363[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1364[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1365[0m[39m:    for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < [0m[1;35msk_POLICYINFO_num[0m[1;39m([0m[39mpolicies[0m[1;39m)[0m[39m; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1366[0m[39m:        POLICYINFO *policy = [0m[1;35msk_POLICYINFO_value[0m[1;39m([0m[39mpolicies, i[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1367[0m[39m:        if [0m[1;39m([0m[39mpolicy->policyid[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1368[0m[39m:            char buf[0m[1;39m[[0m[1;36m128[0m[1;39m][0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1369[0m[39m:            [0m[1;35mOBJ_obj2txt[0m[1;39m([0m[39mbuf, [0m[1;35msizeof[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[39m, policy->policyid, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1370[0m[39m:            if [0m[1;39m([0m[39m [0m[1;35mstrncmp[0m[1;39m([0m[39mbuf, oid, [0m[1;35msizeof[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1371[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mresult = [0m[1;36m1[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1372[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1373[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1374[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1375[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1376[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1377[0m[39m:    [0m[1;35msk_POLICYINFO_pop_free[0m[1;39m([0m[39mpolicies, POLICYINFO_free[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1378[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1379[0m[39m:   [0m[39mreturn result;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1380[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1587[0m[39m-[0m[1;36m1642[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1587:c[0m[39mhar* [0m[1;35mfreerdp_certificate_get_pem_ex[0m[1;39m([0m[39mconst rdpCertificate* cert, size_t* [0m      [2m                [0m
[2;36m                    [0m         [39mpLength,[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1588[0m[39m:                                     BOOL withCertChain[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1589[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1590[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcert[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1591[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1592[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!cert->x509[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1593[0m[39m:   [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1594[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1595[0m[39m:   [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1596[0m[39m:   [0m[39m * Don't manage certificates internally, leave it up entirely to the [0m       [2m                [0m
[2;36m                    [0m         [39mexternal client[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1597[0m[39m:   [0m[39m * implementation[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1598[0m[39m:   [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1599[0m[39m:   [0m[39mBIO* bio = [0m[1;35mBIO_new[0m[1;39m([0m[1;35mBIO_s_mem[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1600[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1601[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!bio[0m[1;39m)[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1602[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1603[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"BIO_new[0m[32m([0m[32m)[0m[32m failure"[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1604[0m[39m:   [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1605[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1606[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1607[0m[39m:   [0m[39mchar* pem = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1608[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1609[0m[39m:   [0m[39mconst int status = [0m[1;35mPEM_write_bio_X509[0m[1;39m([0m[39mbio, cert->x509[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1610[0m[39m:   [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1611[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1612[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"PEM_write_bio_X509 failure: %d"[0m[39m, status[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m1613[0m[39m:   [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1614[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1615[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1616[0m[39m:   [0m[39mif [0m[1;39m([0m[39mcert->chain && withCertChain[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1617[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1618[0m[39m:   [0m[39m        [0m[39mconst int count = [0m[1;35msk_X509_num[0m[1;39m([0m[39mcert->chain[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1619[0m[39m:   [0m[39m        [0m[39mfor [0m[1;39m([0m[39mint x = [0m[1;36m0[0m[39m; x < count; x++[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1620[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1621[0m[39m:   [0m[39m        [0m[39m        [0m[39mX509* c = [0m[1;35msk_X509_value[0m[1;39m([0m[39mcert->chain, x[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1622[0m[39m:   [0m[39m        [0m[39m        [0m[39mconst int rc = [0m[1;35mPEM_write_bio_X509[0m[1;39m([0m[39mbio, c[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1623[0m[39m:   [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mrc < [0m[1;36m0[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1624[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1625[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"PEM_write_bio_X509 failure: %d"[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mrc[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m1626[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1627[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1628[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1629[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1630[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1631[0m[39m:   [0m[35m/[0m[35m/[0m[39m Updated rfc to handle specific policy issues[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1632[0m[39m:   [0m[35m/[0m[35m/[0m[39m [0m[4;94mhttps://datatracker.ietf.org/doc/html/rfc7299[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1633[0m[39m:   [0m[39mif [0m[1;39m([0m[39m [0m[1;35mfreerdp_certificate_policies[0m[1;39m([0m[39mcert, [0m[32m"2.23.140.1.2.1"[0m[1;39m)[0m[39m [0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m1634[0m[39m:   [0m[39m        [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35mfreerdp_bio_read_pem_with_policy[0m[1;39m([0m[39mbio, &pem, pLength[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1635[0m[39m:   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1636[0m[39m:   [0m[39m        [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35mbio_read_pem[0m[1;39m([0m[39mbio, &pem, pLength[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1637[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1638[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1639:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1640[0m[39m:   [0m[1;35mBIO_free_all[0m[1;39m([0m[39mbio[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1641[0m[39m:   [0m[39mreturn pem;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1642[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1537[0m[39m-[0m[1;36m1570[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1537[0m[39m:   [0m[39mconst uint16_t blocksize = [0m[1;36m2048[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1538[0m[39m:   [0m[39muint16_t offset = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1539[0m[39m:   [0m[39muint16_t length = blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1540[0m[39m:   [0m[39mchar* pem = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1541[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1542[0m[39m:   [0m[39m*ppem = NULL;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1543[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1544[0m[39m:   [0m[39m        [0m[39m*plength = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1545[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1546[0m[39m:   [0m[39mwhile [0m[1;39m([0m[39mstatus != [0m[1;36m0[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1547[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1548[0m[39m:   [0m[39m        [0m[39mchar* tmp = [0m[1;35mrealloc[0m[1;39m([0m[39mpem, length + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1549[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m!tmp[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1550[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1551[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1552[0m[39m:   [0m[39m        [0m[39mpem = tmp;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1553[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1554[0m[39m:   [0m[39m        [0m[1;35mERR_clear_error[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1555[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1556[0m[39m:   [0m[39m        [0m[39mstatus = [0m[1;35mBIO_read[0m[1;39m([0m[39mbio, &pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[1;39m([0m[39mlength - offset[0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1557[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1558[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1559[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"failed to read certificate"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1561[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1562[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1563[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1564[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1565[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1566[0m[39m:   [0m[39m        [0m[39moffset += [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mstatus;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:   [0m[39m        [0m[39mlength += blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1568[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1569[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1570[0m[39m:   [0m[39mpem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1484[0m[39m-[0m[1;36m1517[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1484[0m[39m:   [0m[39mconst size_t blocksize = [0m[1;36m2048[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1485[0m[39m:   [0m[39msize_t offset = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1486[0m[39m:   [0m[39msize_t length = blocksize;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1487[0m[39m:   [0m[39mchar* pem = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1488[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1489[0m[39m:   [0m[39m*ppem = NULL;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1490[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1491[0m[39m:   [0m[39m        [0m[39m*plength = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1492[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1493[0m[39m:   [0m[39mwhile [0m[1;39m([0m[39moffset < length[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1494[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1495[0m[39m:   [0m[39m        [0m[39mchar* tmp = [0m[1;35mrealloc[0m[1;39m([0m[39mpem, length + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1496[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m!tmp[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1497[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1498[0m[39m:   [0m[39m        [0m[39mpem = tmp;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1499[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1500[0m[39m:   [0m[39m        [0m[1;35mERR_clear_error[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1501[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1502[0m[39m:   [0m[39m        [0m[39mconst int status = [0m[1;35mBIO_read[0m[1;39m([0m[39mbio, &pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[1;39m([0m[39mlength - [0m      [2m                [0m
[2;36m                    [0m         [39moffset[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1503[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1504[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1505[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"failed to read certificate"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1506[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1507[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1508[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1509[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1510[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1511[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1512[0m[39m:   [0m[39m        [0m[39moffset += [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mstatus;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1513[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mlength - offset > [0m[1;36m0[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1514[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1515[0m[39m:   [0m[39m        [0m[39mlength += blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1516[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1517[0m[39m:   [0m[39mpem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39minclude/freerdp/crypto/certificate.h:[0m[1;36m1[0m[39m-[0m[1;36m149[0m                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m**[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * FreeRDP: A Remote Desktop Protocol Implementation[0m                              [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * Certificate Handling[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * Copyright [0m[1;36m2023[0m[39m Armin Novak <anovak@thincast.com>[0m                               [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * Copyright [0m[1;36m2023[0m[39m Thincast Technologies GmbH[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * Licensed under the Apache License, Version [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: * you may not use this file except in compliance with the License.[0m               [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: * You may obtain a copy of the License at[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:#ifndef FREERDP_CRYPTO_CERTIFICATE_H[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:#define FREERDP_CRYPTO_CERTIFICATE_H[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:#include <winpr/crypto.h>[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:#include <freerdp/api.h>[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:#ifdef __cplusplus[0m                                                               [2m                [0m
[2;36m                    [0m         [1;92m29:e[0m[39mxtern [0m[32m"C"[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:     [0m[39menum FREERDP_CERT_PARAM[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:     [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:     [0m[39m        [0m[39mFREERDP_CERT_RSA_E,[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:     [0m[39m        [0m[39mFREERDP_CERT_RSA_N[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     [0m[1;39m}[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     [0m[39mtypedef struct rdp_certificate rdpCertificate;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     [0m[39mFREERDP_API void [0m[1;35mfreerdp_certificate_free[0m[1;39m([0m[39mrdpCertificate* certificate[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     [0m[1;35mWINPR_ATTR_MALLOC[0m[1;39m([0m[39mfreerdp_certificate_free, [0m[1;36m1[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     [0m[39mFREERDP_API rdpCertificate* [0m[1;35mfreerdp_certificate_new[0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     [0m[1;35mWINPR_ATTR_MALLOC[0m[1;39m([0m[39mfreerdp_certificate_free, [0m[1;36m1[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     [0m[39mFREERDP_API rdpCertificate* [0m[1;35mfreerdp_certificate_new_from_file[0m[1;39m([0m[39mconst char* [0m  [2m                [0m
[2;36m                    [0m         [39mfile[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     [0m[1;35mWINPR_ATTR_MALLOC[0m[1;39m([0m[39mfreerdp_certificate_free, [0m[1;36m1[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     [0m[39mFREERDP_API rdpCertificate* [0m[1;35mfreerdp_certificate_new_from_pem[0m[1;39m([0m[39mconst char* [0m   [2m                [0m
[2;36m                    [0m         [39mpem[0m[1;39m)[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     [0m[1;35mWINPR_ATTR_MALLOC[0m[1;39m([0m[39mfreerdp_certificate_free, [0m[1;36m1[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     [0m[39mFREERDP_API rdpCertificate* [0m[1;35mfreerdp_certificate_new_from_der[0m[1;39m([0m[39mconst BYTE* [0m   [2m                [0m
[2;36m                    [0m         [39mdata, size_t length[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     [0m[39mFREERDP_API BOOL [0m[1;35mfreerdp_certificate_is_rsa[0m[1;39m([0m[39mconst rdpCertificate* [0m          [2m                [0m
[2;36m                    [0m         [39mcertificate[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     [0m[1;35mWINPR_ATTR_MALLOC[0m[1;39m([0m[39mfree, [0m[1;36m1[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     [0m[39mFREERDP_API char* [0m[1;35mfreerdp_certificate_get_hash[0m[1;39m([0m[39mconst rdpCertificate* [0m       [2m                [0m
[2;36m                    [0m         [39mcertificate,[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     [0m[39m                                               const char* hash, size_t* [0m   [2m                [0m
[2;36m                    [0m         [39mplength[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     [0m[1;35mWINPR_ATTR_MALLOC[0m[1;39m([0m[39mfree, [0m[1;36m1[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     [0m[39mFREERDP_API char* [0m[1;35mfreerdp_certificate_get_fingerprint_by_hash[0m[1;39m([0m[39mconst [0m        [2m                [0m
[2;36m                    [0m         [39mrdpCertificate* certificate,[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     [0m[39m                                                              const char* [0m  [2m                [0m
[2;36m                    [0m         [39mhash[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     [0m[1;35mWINPR_ATTR_MALLOC[0m[1;39m([0m[39mfree, [0m[1;36m1[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     [0m[39mFREERDP_API char*[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     [0m[1;35mfreerdp_certificate_get_fingerprint_by_hash_ex[0m[1;39m([0m[39mconst rdpCertificate* [0m       [2m                [0m
[2;36m                    [0m         [39mcertificate,[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     [0m[39m                                               const char* hash, BOOL [0m      [2m                [0m
[2;36m                    [0m         [39mseparator[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     [0m[1;35mWINPR_ATTR_MALLOC[0m[1;39m([0m[39mfree, [0m[1;36m1[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     [0m[39mFREERDP_API char* [0m[1;35mfreerdp_certificate_get_fingerprint[0m[1;39m([0m[39mconst rdpCertificate*[0m [2m                [0m
[2;36m                    [0m         [39mcertificate[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     [0m[1;35mWINPR_ATTR_MALLOC[0m[1;39m([0m[39mfree, [0m[1;36m1[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     [0m[39mFREERDP_API char* [0m[1;35mfreerdp_certificate_get_pem[0m[1;39m([0m[39mconst rdpCertificate* [0m        [2m                [0m
[2;36m                    [0m         [39mcertificate,[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     [0m[39m                                              size_t* pLength[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     [0m[39mFREERDP_API int [0m[1;35mfreerdp_certificate_policies[0m[1;39m([0m[39mconst rdpCertificate* [0m         [2m                [0m
[2;36m                    [0m         [39mcertificate,[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     [0m[39m                                              const char* oid[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     [0m[39m * @brief Get the certificate as PEM string[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     [0m[39m * @param certificate A certificate instance to query[0m                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     [0m[39m * @param pLength A pointer to the size in bytes of the PEM string[0m          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     [0m[39m * @param withCertChain \b TRUE to export a full chain PEM, \b FALSE for [0m   [2m                [0m
[2;36m                    [0m         [39monly the last[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     [0m[39m * certificate in the chain[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     [0m[39m * @return A newly allocated string containing the requested PEM [0m[1;39m([0m[39mfree to [0m  [2m                [0m
[2;36m                    [0m         [39mdeallocate[0m[1;39m)[0m[39m or NULL[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     [0m[39m * @since version [0m[1;36m3.8[0m[39m.[0m[1;36m0[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:     [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     [0m[1;35mWINPR_ATTR_MALLOC[0m[1;39m([0m[39mfree, [0m[1;36m1[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     [0m[39mFREERDP_API char* [0m[1;35mfreerdp_certificate_get_pem_ex[0m[1;39m([0m[39mconst rdpCertificate* [0m     [2m                [0m
[2;36m                    [0m         [39mcertificate,[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     [0m[39m                                                 size_t* pLength, BOOL [0m     [2m                [0m
[2;36m                    [0m         [39mwithCertChain[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     [0m[1;35mWINPR_ATTR_MALLOC[0m[1;39m([0m[39mfree, [0m[1;36m1[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:     [0m[39mFREERDP_API BYTE* [0m[1;35mfreerdp_certificate_get_der[0m[1;39m([0m[39mconst rdpCertificate* [0m        [2m                [0m
[2;36m                    [0m         [39mcertificate,[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:     [0m[39m                                              size_t* pLength[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:     [0m[1;35mWINPR_ATTR_MALLOC[0m[1;39m([0m[39mfree, [0m[1;36m1[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:     [0m[39mFREERDP_API char* [0m[1;35mfreerdp_certificate_get_subject[0m[1;39m([0m[39mconst rdpCertificate* [0m    [2m                [0m
[2;36m                    [0m         [39mcertificate[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     [0m[1;35mWINPR_ATTR_MALLOC[0m[1;39m([0m[39mfree, [0m[1;36m1[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    [0m[39mFREERDP_API char* [0m[1;35mfreerdp_certificate_get_issuer[0m[1;39m([0m[39mconst rdpCertificate* [0m     [2m                [0m
[2;36m                    [0m         [39mcertificate[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    [0m[1;35mWINPR_ATTR_MALLOC[0m[1;39m([0m[39mfree, [0m[1;36m1[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    [0m[39mFREERDP_API char* [0m[1;35mfreerdp_certificate_get_upn[0m[1;39m([0m[39mconst rdpCertificate* [0m        [2m                [0m
[2;36m                    [0m         [39mcertificate[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    [0m[1;35mWINPR_ATTR_MALLOC[0m[1;39m([0m[39mfree, [0m[1;36m1[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:    [0m[39mFREERDP_API char* [0m[1;35mfreerdp_certificate_get_email[0m[1;39m([0m[39mconst rdpCertificate* [0m      [2m                [0m
[2;36m                    [0m         [39mcertificate[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    [0m[39m * @brief return the date string of the certificate validity[0m                [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    [0m[39m * @param certificate The certificate instance to query[0m                     [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    [0m[39m * @param startDate \b TRUE return the start date, \b FALSE for the end [0m    [2m                [0m
[2;36m                    [0m         [39mdate[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    [0m[39m * @return A newly allocated string containing the date, use \b free to [0m    [2m                [0m
[2;36m                    [0m         [39mdeallocate[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    [0m[39m * @since version [0m[1;36m3.8[0m[39m.[0m[1;36m0[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    [0m[1;35mWINPR_ATTR_MALLOC[0m[1;39m([0m[39mfree, [0m[1;36m1[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:    [0m[39mFREERDP_API char* [0m[1;35mfreerdp_certificate_get_validity[0m[1;39m([0m[39mconst rdpCertificate* [0m   [2m                [0m
[2;36m                    [0m         [39mcertificate,[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    [0m[39m                                                   BOOL startDate[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    [0m[39mFREERDP_API WINPR_MD_TYPE [0m[1;35mfreerdp_certificate_get_signature_alg[0m[1;39m([0m[39mconst [0m      [2m                [0m
[2;36m                    [0m         [39mrdpCertificate* cert[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[1;35mWINPR_ATTR_MALLOC[0m[1;39m([0m[39mfree, [0m[1;36m1[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[39mFREERDP_API char* [0m[1;35mfreerdp_certificate_get_common_name[0m[1;39m([0m[39mconst rdpCertificate*[0m [2m                [0m
[2;36m                    [0m         [39mcert,[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[39m                                                      size_t* plength[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[1;35mWINPR_ATTR_MALLOC[0m[1;39m([0m[39mfree, [0m[1;36m1[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:    [0m[39mFREERDP_API char** [0m[1;35mfreerdp_certificate_get_dns_names[0m[1;39m([0m[39mconst rdpCertificate* [0m [2m                [0m
[2;36m                    [0m         [39mcert, size_t* pcount,[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:    [0m[39m                                                     size_t** pplengths[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:    [0m[39mFREERDP_API void [0m[1;35mfreerdp_certificate_free_dns_names[0m[1;39m([0m[39msize_t count, size_t* [0m  [2m                [0m
[2;36m                    [0m         [39mlengths,[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:    [0m[39m                                                    char** names[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:    [0m[39mFREERDP_API BOOL [0m[1;35mfreerdp_certificate_check_eku[0m[1;39m([0m[39mconst rdpCertificate* [0m       [2m                [0m
[2;36m                    [0m         [39mcertificate, int nid[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    [0m[39mFREERDP_API BOOL [0m[1;35mfreerdp_certificate_get_public_key[0m[1;39m([0m[39mconst rdpCertificate* [0m  [2m                [0m
[2;36m                    [0m         [39mcert,[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    [0m[39m                                                    BYTE** PublicKey, [0m      [2m                [0m
[2;36m                    [0m         [39mDWORD* PublicKeyLength[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    [0m[39mFREERDP_API BOOL [0m[1;35mfreerdp_certificate_verify[0m[1;39m([0m[39mconst rdpCertificate* cert,[0m     [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:    [0m[39m                                            const char* [0m                    [2m                [0m
[2;36m                    [0m         [39mcertificate_store_path[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:    [0m[39mFREERDP_API BOOL [0m[1;35mfreerdp_certificate_is_rdp_security_compatible[0m[1;39m([0m[39mconst [0m      [2m                [0m
[2;36m                    [0m         [39mrdpCertificate* cert[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    [0m[1;35mWINPR_ATTR_MALLOC[0m[1;39m([0m[39mfree, [0m[1;36m1[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:    [0m[39mFREERDP_API char* [0m[1;35mfreerdp_certificate_get_param[0m[1;39m([0m[39mconst rdpCertificate* cert,[0m [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    [0m[39m                                                enum FREERDP_CERT_PARAM [0m    [2m                [0m
[2;36m                    [0m         [39mwhat, size_t* psize[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:#ifdef __cplusplus[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:#endif [0m[35m/[0m[39m* FREERDP_CRYPTO_CERTIFICATE_H *[0m[35m/[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:84[0m[39m-[0m[1;36m96[0m                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     [0m[39mUINT32 count;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     [0m[39mrdpCertBlob* array;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:typedef struct rdp_X509CertChain rdpX509CertChain;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:struct rdp_certificate[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     [0m[39mX509* x509;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     [0m[1;35mSTACK_OF[0m[1;39m([0m[39mX509[0m[1;39m)[0m[39m * chain;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:     [0m[39mrdpCertInfo cert_info;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:     [0m[39mrdpX509CertChain x509_cert_chain;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1546[0m[39m-[0m[1;36m1570[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1546[0m[39m:   [0m[39mwhile [0m[1;39m([0m[39mstatus != [0m[1;36m0[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1547[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1548[0m[39m:   [0m[39m        [0m[39mchar* tmp = [0m[1;35mrealloc[0m[1;39m([0m[39mpem, length + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1549[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m!tmp[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1550[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1551[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1552[0m[39m:   [0m[39m        [0m[39mpem = tmp;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1553[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1554[0m[39m:   [0m[39m        [0m[1;35mERR_clear_error[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1555[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1556[0m[39m:   [0m[39m        [0m[39mstatus = [0m[1;35mBIO_read[0m[1;39m([0m[39mbio, &pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[1;39m([0m[39mlength - offset[0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1557[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1558[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1559[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"failed to read certificate"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1561[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1562[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1563[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1564[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1565[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1566[0m[39m:   [0m[39m        [0m[39moffset += [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mstatus;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:   [0m[39m        [0m[39mlength += blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1568[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1569[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1570[0m[39m:   [0m[39mpem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1493[0m[39m-[0m[1;36m1527[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1493[0m[39m:   [0m[39mwhile [0m[1;39m([0m[39moffset < length[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1494[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1495[0m[39m:   [0m[39m        [0m[39mchar* tmp = [0m[1;35mrealloc[0m[1;39m([0m[39mpem, length + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1496[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m!tmp[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1497[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1498[0m[39m:   [0m[39m        [0m[39mpem = tmp;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1499[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1500[0m[39m:   [0m[39m        [0m[1;35mERR_clear_error[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1501[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1502[0m[39m:   [0m[39m        [0m[39mconst int status = [0m[1;35mBIO_read[0m[1;39m([0m[39mbio, &pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[1;39m([0m[39mlength - [0m      [2m                [0m
[2;36m                    [0m         [39moffset[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1503[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1504[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1505[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"failed to read certificate"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1506[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1507[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1508[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1509[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1510[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1511[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1512[0m[39m:   [0m[39m        [0m[39moffset += [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mstatus;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1513[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mlength - offset > [0m[1;36m0[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1514[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1515[0m[39m:   [0m[39m        [0m[39mlength += blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1516[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1517[0m[39m:   [0m[39mpem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1518[0m[39m:   [0m[39m*ppem = pem;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1519[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1520[0m[39m:   [0m[39m        [0m[39m*plength = offset;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1521[0m[39m:   [0m[39mrc = TRUE;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;92m1522:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1523[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!rc[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1524[0m[39m:   [0m[39m        [0m[1;35mfree[0m[1;39m([0m[39mpem[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1525[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1526[0m[39m:   [0m[39mreturn rc;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1527[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1609[0m[39m-[0m[1;36m1637[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1609[0m[39m:   [0m[39mconst int status = [0m[1;35mPEM_write_bio_X509[0m[1;39m([0m[39mbio, cert->x509[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1610[0m[39m:   [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1611[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1612[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"PEM_write_bio_X509 failure: %d"[0m[39m, status[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m1613[0m[39m:   [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1614[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1615[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1616[0m[39m:   [0m[39mif [0m[1;39m([0m[39mcert->chain && withCertChain[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1617[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1618[0m[39m:   [0m[39m        [0m[39mconst int count = [0m[1;35msk_X509_num[0m[1;39m([0m[39mcert->chain[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1619[0m[39m:   [0m[39m        [0m[39mfor [0m[1;39m([0m[39mint x = [0m[1;36m0[0m[39m; x < count; x++[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1620[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1621[0m[39m:   [0m[39m        [0m[39m        [0m[39mX509* c = [0m[1;35msk_X509_value[0m[1;39m([0m[39mcert->chain, x[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1622[0m[39m:   [0m[39m        [0m[39m        [0m[39mconst int rc = [0m[1;35mPEM_write_bio_X509[0m[1;39m([0m[39mbio, c[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1623[0m[39m:   [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mrc < [0m[1;36m0[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1624[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1625[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"PEM_write_bio_X509 failure: %d"[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mrc[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m1626[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1627[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1628[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1629[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1630[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1631[0m[39m:   [0m[35m/[0m[35m/[0m[39m Updated rfc to handle specific policy issues[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1632[0m[39m:   [0m[35m/[0m[35m/[0m[39m [0m[4;94mhttps://datatracker.ietf.org/doc/html/rfc7299[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1633[0m[39m:   [0m[39mif [0m[1;39m([0m[39m [0m[1;35mfreerdp_certificate_policies[0m[1;39m([0m[39mcert, [0m[32m"2.23.140.1.2.1"[0m[1;39m)[0m[39m [0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m1634[0m[39m:   [0m[39m        [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35mfreerdp_bio_read_pem_with_policy[0m[1;39m([0m[39mbio, &pem, pLength[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1635[0m[39m:   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1636[0m[39m:   [0m[39m        [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35mbio_read_pem[0m[1;39m([0m[39mbio, &pem, pLength[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1637[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1397[0m[39m-[0m[1;36m1400[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1397[0m[39m:rdpCertificate* [0m[1;35mfreerdp_certificate_new_from_pem[0m[1;39m([0m[39mconst char* pem[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m1398[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1399[0m[39m:   [0m[39mreturn [0m[1;35mfreerdp_certificate_new_from[0m[1;39m([0m[39mpem, FALSE[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1400[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1382[0m[39m-[0m[1;36m1400[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1382[0m[39m:static rdpCertificate* [0m[1;35mfreerdp_certificate_new_from[0m[1;39m([0m[39mconst char* file, BOOL [0m    [2m                [0m
[2;36m                    [0m         [39misFile[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1383[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1384[0m[39m:   [0m[39mX509* x509 = [0m[1;35mx509_utils_from_pem[0m[1;39m([0m[39mfile, [0m[1;35mstrlen[0m[1;39m([0m[39mfile[0m[1;39m)[0m[39m, isFile[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m1385[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!x509[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1386[0m[39m:   [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1387[0m[39m:   [0m[39mrdpCertificate* cert = [0m[1;35mfreerdp_certificate_new_from_x509[0m[1;39m([0m[39mx509, NULL[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1388[0m[39m:   [0m[1;35mX509_free[0m[1;39m([0m[39mx509[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1389[0m[39m:   [0m[39mreturn cert;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1390[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1391[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1392[0m[39m:rdpCertificate* [0m[1;35mfreerdp_certificate_new_from_file[0m[1;39m([0m[39mconst char* file[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [1;36m1393[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1394[0m[39m:   [0m[39mreturn [0m[1;35mfreerdp_certificate_new_from[0m[1;39m([0m[39mfile, TRUE[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1395[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1396[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1397[0m[39m:rdpCertificate* [0m[1;35mfreerdp_certificate_new_from_pem[0m[1;39m([0m[39mconst char* pem[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m1398[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1399[0m[39m:   [0m[39mreturn [0m[1;35mfreerdp_certificate_new_from[0m[1;39m([0m[39mpem, FALSE[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1400[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1529[0m[39m-[0m[1;36m1580[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1529[0m[39m:static BOOL [0m[1;35mfreerdp_bio_read_pem_with_policy[0m[1;39m([0m[39mBIO* bio, char** ppem, size_t* [0m   [2m                [0m
[2;36m                    [0m         [39mplength[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1530[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1531[0m[39m:   [0m[39mBOOL rc = FALSE;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1532[0m[39m:   [0m[39mint status = [0m[1;36m-1[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1533[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1534[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mbio[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1535[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mppem[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1536[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1537[0m[39m:   [0m[39mconst uint16_t blocksize = [0m[1;36m2048[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1538[0m[39m:   [0m[39muint16_t offset = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1539[0m[39m:   [0m[39muint16_t length = blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1540[0m[39m:   [0m[39mchar* pem = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1541[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1542[0m[39m:   [0m[39m*ppem = NULL;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1543[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1544[0m[39m:   [0m[39m        [0m[39m*plength = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1545[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1546[0m[39m:   [0m[39mwhile [0m[1;39m([0m[39mstatus != [0m[1;36m0[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1547[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1548[0m[39m:   [0m[39m        [0m[39mchar* tmp = [0m[1;35mrealloc[0m[1;39m([0m[39mpem, length + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1549[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m!tmp[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1550[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1551[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1552[0m[39m:   [0m[39m        [0m[39mpem = tmp;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1553[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1554[0m[39m:   [0m[39m        [0m[1;35mERR_clear_error[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1555[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1556[0m[39m:   [0m[39m        [0m[39mstatus = [0m[1;35mBIO_read[0m[1;39m([0m[39mbio, &pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[1;39m([0m[39mlength - offset[0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1557[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1558[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1559[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"failed to read certificate"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1561[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1562[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1563[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1564[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1565[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1566[0m[39m:   [0m[39m        [0m[39moffset += [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mstatus;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:   [0m[39m        [0m[39mlength += blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1568[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1569[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1570[0m[39m:   [0m[39mpem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1571[0m[39m:   [0m[39m*ppem = pem;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1572[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1573[0m[39m:   [0m[39m        [0m[39m*plength = offset;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1574[0m[39m:   [0m[39mrc = TRUE;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;92m1575:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1576[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!rc[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1577[0m[39m:   [0m[39m        [0m[1;35mfree[0m[1;39m([0m[39mpem[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1578[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1579[0m[39m:   [0m[39mreturn rc;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1580[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1477[0m[39m-[0m[1;36m1527[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1477[0m[39m:static BOOL [0m[1;35mbio_read_pem[0m[1;39m([0m[39mBIO* bio, char** ppem, size_t* plength[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m1478[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1479[0m[39m:   [0m[39mBOOL rc = FALSE;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1480[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1481[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mbio[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1482[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mppem[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1483[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1484[0m[39m:   [0m[39mconst size_t blocksize = [0m[1;36m2048[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1485[0m[39m:   [0m[39msize_t offset = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1486[0m[39m:   [0m[39msize_t length = blocksize;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1487[0m[39m:   [0m[39mchar* pem = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1488[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1489[0m[39m:   [0m[39m*ppem = NULL;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1490[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1491[0m[39m:   [0m[39m        [0m[39m*plength = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1492[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1493[0m[39m:   [0m[39mwhile [0m[1;39m([0m[39moffset < length[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1494[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1495[0m[39m:   [0m[39m        [0m[39mchar* tmp = [0m[1;35mrealloc[0m[1;39m([0m[39mpem, length + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1496[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m!tmp[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1497[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1498[0m[39m:   [0m[39m        [0m[39mpem = tmp;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1499[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1500[0m[39m:   [0m[39m        [0m[1;35mERR_clear_error[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1501[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1502[0m[39m:   [0m[39m        [0m[39mconst int status = [0m[1;35mBIO_read[0m[1;39m([0m[39mbio, &pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[1;39m([0m[39mlength - [0m      [2m                [0m
[2;36m                    [0m         [39moffset[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1503[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1504[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1505[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"failed to read certificate"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1506[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1507[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1508[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1509[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1510[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1511[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1512[0m[39m:   [0m[39m        [0m[39moffset += [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mstatus;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1513[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mlength - offset > [0m[1;36m0[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1514[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1515[0m[39m:   [0m[39m        [0m[39mlength += blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1516[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1517[0m[39m:   [0m[39mpem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1518[0m[39m:   [0m[39m*ppem = pem;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1519[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1520[0m[39m:   [0m[39m        [0m[39m*plength = offset;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1521[0m[39m:   [0m[39mrc = TRUE;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;92m1522:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1523[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!rc[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1524[0m[39m:   [0m[39m        [0m[1;35mfree[0m[1;39m([0m[39mpem[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1525[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1526[0m[39m:   [0m[39mreturn rc;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1527[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/x509_utils.[0m[1;92mc:624[0m[39m-[0m[1;36m650[0m                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m624[0m[39m:X509* [0m[1;35mx509_utils_from_pem[0m[1;39m([0m[39mconst char* data, size_t len, BOOL fromFile[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [1;36m625[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m626[0m[39m:    [0m[39mX509* x509 = NULL;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m627[0m[39m:    [0m[39mBIO* bio = NULL;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m628[0m[39m:    [0m[39mif [0m[1;39m([0m[39mfromFile[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m629[0m[39m:    [0m[39m        [0m[39mbio = [0m[1;35mBIO_new_file[0m[1;39m([0m[39mdata, [0m[32m"rb"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m630[0m[39m:    [0m[39melse[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m631[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m632[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39mlen > INT_MAX[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m633[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn NULL;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m634[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m635[0m[39m:    [0m[39m        [0m[39mbio = [0m[1;35mBIO_new_mem_buf[0m[1;39m([0m[39mdata, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39mlen[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m636[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m637[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m638[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!bio[0m[1;39m)[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m639[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m640[0m[39m:    [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"BIO_new failed for certificate"[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m641[0m[39m:    [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m642[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m643[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m644[0m[39m:    [0m[39mx509 = [0m[1;35mPEM_read_bio_X509[0m[1;39m([0m[39mbio, NULL, NULL, [0m[1;36m0[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m645[0m[39m:    [0m[1;35mBIO_free_all[0m[1;39m([0m[39mbio[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m646[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!x509[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m647[0m[39m:    [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"PEM_read_bio_X509 returned NULL [0m[32m[[0m[32minput length %"[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mPRIuz [0m[32m"[0m[32m][0m[32m"[0m[39m, len[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m648[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m649[0m[39m:    [0m[39mreturn x509;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m650[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1537[0m[39m-[0m[1;36m1539[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1537[0m[39m:   [0m[39mconst uint16_t blocksize = [0m[1;36m2048[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1538[0m[39m:   [0m[39muint16_t offset = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1539[0m[39m:   [0m[39muint16_t length = blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1351[0m[39m-[0m[1;36m1380[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1351[0m[39m:int [0m[1;35mfreerdp_certificate_policies[0m[1;39m([0m[39mconst rdpCertificate* cert, const char* oid[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1352[0m[39m:    [0m[1;35mSTACK_OF[0m[1;39m([0m[39mPOLICYINFO[0m[1;39m)[0m[39m *policies;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1353[0m[39m:   [0m[39mint result = [0m[1;36m0[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1354[0m[39m:    int crit;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1355[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1356[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!cert->x509[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1357[0m[39m:   [0m[39m        [0m[39mreturn result;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1358[0m[39m:   [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1359[0m[39m:    [0m[35m/[0m[35m/[0m[39m Get certificate policies[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1360[0m[39m:    policies = [0m[1;35mX509_get_ext_d2i[0m[1;39m([0m[39mcert->x509, NID_certificate_policies, &crit, [0m  [2m                [0m
[2;36m                    [0m         [39mNULL[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1361[0m[39m:    if [0m[1;39m([0m[39m!policies[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1362[0m[39m:        return result;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1363[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1364[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1365[0m[39m:    for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < [0m[1;35msk_POLICYINFO_num[0m[1;39m([0m[39mpolicies[0m[1;39m)[0m[39m; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1366[0m[39m:        POLICYINFO *policy = [0m[1;35msk_POLICYINFO_value[0m[1;39m([0m[39mpolicies, i[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1367[0m[39m:        if [0m[1;39m([0m[39mpolicy->policyid[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1368[0m[39m:            char buf[0m[1;39m[[0m[1;36m128[0m[1;39m][0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1369[0m[39m:            [0m[1;35mOBJ_obj2txt[0m[1;39m([0m[39mbuf, [0m[1;35msizeof[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[39m, policy->policyid, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1370[0m[39m:            if [0m[1;39m([0m[39m [0m[1;35mstrncmp[0m[1;39m([0m[39mbuf, oid, [0m[1;35msizeof[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1371[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mresult = [0m[1;36m1[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1372[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1373[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1374[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1375[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1376[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1377[0m[39m:    [0m[1;35msk_POLICYINFO_pop_free[0m[1;39m([0m[39mpolicies, POLICYINFO_free[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1378[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1379[0m[39m:   [0m[39mreturn result;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1380[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1631[0m[39m-[0m[1;36m1637[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1631[0m[39m:   [0m[35m/[0m[35m/[0m[39m Updated rfc to handle specific policy issues[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1632[0m[39m:   [0m[35m/[0m[35m/[0m[39m [0m[4;94mhttps://datatracker.ietf.org/doc/html/rfc7299[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1633[0m[39m:   [0m[39mif [0m[1;39m([0m[39m [0m[1;35mfreerdp_certificate_policies[0m[1;39m([0m[39mcert, [0m[32m"2.23.140.1.2.1"[0m[1;39m)[0m[39m [0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m1634[0m[39m:   [0m[39m        [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35mfreerdp_bio_read_pem_with_policy[0m[1;39m([0m[39mbio, &pem, pLength[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1635[0m[39m:   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1636[0m[39m:   [0m[39m        [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35mbio_read_pem[0m[1;39m([0m[39mbio, &pem, pLength[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1637[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1326[0m[39m-[0m[1;36m1349[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1326[0m[39m:rdpCertificate* [0m[1;35mfreerdp_certificate_new_from_x509[0m[1;39m([0m[39mconst X509* xcert, const [0m    [2m                [0m
[2;36m                    [0m         [1;35mSTACK_OF[0m[1;39m([0m[39mX509[0m[1;39m)[0m[39m * chain[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1327[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1328[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mxcert[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1329[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1330[0m[39m:   [0m[39mrdpCertificate* cert = [0m[1;35mfreerdp_certificate_new[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1331[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!cert[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1332[0m[39m:   [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1333[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1334[0m[39m:   [0m[39mX509* wcert = [0m[1;35mWINPR_CAST_CONST_PTR_AWAY[0m[1;39m([0m[39mxcert, X509*[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1335[0m[39m:   [0m[39mcert->x509 = [0m[1;35mX509_dup[0m[1;39m([0m[39mwcert[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1336[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!cert->x509[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1337[0m[39m:   [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1338[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1339[0m[39m:   [0m[39mif [0m[1;39m([0m[39m![0m[1;35mfreerdp_rsa_from_x509[0m[1;39m([0m[39mcert[0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1340[0m[39m:   [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1341[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1342[0m[39m:   [0m[39mif [0m[1;39m([0m[39mchain[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1343[0m[39m:   [0m[39m        [0m[39mcert->chain = [0m[1;35msk_X509_deep_copy[0m[1;39m([0m[39mchain, X509_const_dup, X509_free[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m1344[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1345[0m[39m:   [0m[39mreturn cert;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;92m1346:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1347[0m[39m:   [0m[1;35mfreerdp_certificate_free[0m[1;39m([0m[39mcert[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1348[0m[39m:   [0m[39mreturn NULL;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1349[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/test/TestFuzzCryptoCertificateDataSetPEM.[0m[1;92mc:1[0m[39m-[0m[1;36m22[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:#include <stddef.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:#include <stdint.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#include <freerdp/crypto/certificate_store.h>[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:int [0m[1;35mLLVMFuzzerTestOneInput[0m[1;39m([0m[39mconst uint8_t* Data, size_t Size[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m[1;39m{[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:      [0m[39mrdpCertificateData* data = NULL;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:      [0m[39mchar* pem = [0m[1;35mcalloc[0m[1;39m([0m[39mSize + [0m[1;36m1[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mchar[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:      [0m[39mif [0m[1;39m([0m[39mpem == NULL[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:     [0m[39m        [0m[39mgoto cleanup;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:     [0m[1;35mmemcpy[0m[1;39m([0m[39mpem, Data, Size[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:     [0m[39mdata = [0m[1;35mfreerdp_certificate_data_new_from_pem[0m[1;39m([0m[32m"somehost"[0m[39m, [0m[1;36m1234[0m[39m, pem, Size[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:     [0m[39m        [0m[39mgoto cleanup;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m17:c[0m[39mleanup:[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:     [0m[1;35mfreerdp_certificate_data_free[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:     [0m[1;35mfree[0m[1;39m([0m[39mpem[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:     [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate_data.[0m[1;92mc:148[0m[39m-[0m[1;36m159[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:rdpCertificateData* [0m[1;35mfreerdp_certificate_data_new_from_pem[0m[1;39m([0m[39mconst char* hostname,[0m [2m                [0m
[2;36m                    [0m         [39mUINT16 port,[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:                                                          const char* pem, [0m     [2m                [0m
[2;36m                    [0m         [39msize_t length[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!pem || [0m[1;39m([0m[39mlength == [0m[1;36m0[0m[1;39m)[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    [0m[39mrdpCertificate* cert = [0m[1;35mfreerdp_certificate_new_from_pem[0m[1;39m([0m[39mpem[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[39mrdpCertificateData* data = [0m[1;35mfreerdp_certificate_data_new_nocopy[0m[1;39m([0m[39mhostname, [0m   [2m                [0m
[2;36m                    [0m         [39mport, cert[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!data[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    [0m[39m        [0m[1;35mfreerdp_certificate_free[0m[1;39m([0m[39mcert[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    [0m[39mreturn data;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate_data.[0m[1;92mc:106[0m[39m-[0m[1;36m136[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:static rdpCertificateData* [0m[1;35mfreerdp_certificate_data_new_nocopy[0m[1;39m([0m[39mconst char* [0m     [2m                [0m
[2;36m                    [0m         [39mhostname, UINT16 port,[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:                                                               rdpCertificate* [0m [2m                [0m
[2;36m                    [0m         [39mxcert[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    [0m[39mrdpCertificateData* certdata = NULL;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!hostname || !xcert[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    [0m[39mcertdata = [0m[1;39m([0m[39mrdpCertificateData*[0m[1;39m)[0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mrdpCertificateData[0m[1;39m)[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!certdata[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    [0m[39mcertdata->port = port;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[39mcertdata->hostname = [0m[1;35m_strdup[0m[1;39m([0m[39mhostname[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!certdata->hostname[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[1;35mensure_lowercase[0m[1;39m([0m[39mcertdata->hostname, [0m[1;35mstrlen[0m[1;39m([0m[39mcertdata->hostname[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[39mcertdata->cert = xcert;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mfreerdp_certificate_data_load_cache[0m[1;39m([0m[39mcertdata[0m[1;39m)[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:    [0m[39m        [0m[39mcertdata->cert = NULL;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:    [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    [0m[39mreturn certdata;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;92m133:fa[0m[39mil:[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    [0m[1;35mfreerdp_certificate_data_free[0m[1;39m([0m[39mcertdata[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:    [0m[39mreturn NULL;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate_data.[0m[1;92mc:68[0m[39m-[0m[1;36m104[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:static BOOL [0m[1;35mfreerdp_certificate_data_load_cache[0m[1;39m([0m[39mrdpCertificateData* data[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     [0m[39mBOOL rc = FALSE;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     [0m[1;35mfreerdp_certificate_data_hash_[0m[1;39m([0m[39mdata->hostname, data->port, [0m                 [2m                [0m
[2;36m                    [0m         [39mdata->cached_hash,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     [0m[39m                               [0m[1;35msizeof[0m[1;39m([0m[39mdata->cached_hash[0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     [0m[39mif [0m[1;39m([0m[1;35mstrnlen[0m[1;39m([0m[39mdata->cached_hash, [0m[1;35msizeof[0m[1;39m([0m[39mdata->cached_hash[0m[1;39m)[0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     [0m[39mdata->cached_subject = [0m[1;35mfreerdp_certificate_get_subject[0m[1;39m([0m[39mdata->cert[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data->cached_subject[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     [0m[39m        [0m[39mdata->cached_subject = [0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     [0m[39msize_t pemlen = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     [0m[39mdata->cached_pem = [0m[1;35mfreerdp_certificate_get_pem_ex[0m[1;39m([0m[39mdata->cert, &pemlen, [0m     [2m                [0m
[2;36m                    [0m         [39mFALSE[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data->cached_pem[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     [0m[39msize_t pemchainlen = [0m[1;36m0[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     [0m[39mdata->cached_pem_chain = [0m[1;35mfreerdp_certificate_get_pem_ex[0m[1;39m([0m[39mdata->cert, [0m        [2m                [0m
[2;36m                    [0m         [39m&pemchainlen, TRUE[0m[1;39m)[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data->cached_pem_chain[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:     [0m[39mdata->cached_fingerprint = [0m[1;35mfreerdp_certificate_get_fingerprint[0m[1;39m([0m[39mdata->cert[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data->cached_fingerprint[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:     [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:     [0m[39mdata->cached_issuer = [0m[1;35mfreerdp_certificate_get_issuer[0m[1;39m([0m[39mdata->cert[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data->cached_issuer[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     [0m[39m        [0m[39mdata->cached_issuer = [0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    [0m[39mrc = TRUE;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;92m102:fa[0m[39mil:[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    [0m[39mreturn rc;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate_data.[0m[1;92mc:37[0m[39m-[0m[1;36m49[0m                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:struct rdp_certificate_data[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     [0m[39mchar* hostname;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     [0m[39mUINT16 port;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     [0m[39mrdpCertificate* cert;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     [0m[39mchar cached_hash[0m[1;39m[[0m[39mMAX_PATH + [0m[1;36m10[0m[1;39m][0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     [0m[39mchar* cached_subject;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     [0m[39mchar* cached_issuer;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     [0m[39mchar* cached_fingerprint;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     [0m[39mchar* cached_pem;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     [0m[39mchar* cached_pem_chain;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate_data.[0m[1;92mc:68[0m[39m-[0m[1;36m104[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:static BOOL [0m[1;35mfreerdp_certificate_data_load_cache[0m[1;39m([0m[39mrdpCertificateData* data[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     [0m[39mBOOL rc = FALSE;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     [0m[1;35mfreerdp_certificate_data_hash_[0m[1;39m([0m[39mdata->hostname, data->port, [0m                 [2m                [0m
[2;36m                    [0m         [39mdata->cached_hash,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     [0m[39m                               [0m[1;35msizeof[0m[1;39m([0m[39mdata->cached_hash[0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     [0m[39mif [0m[1;39m([0m[1;35mstrnlen[0m[1;39m([0m[39mdata->cached_hash, [0m[1;35msizeof[0m[1;39m([0m[39mdata->cached_hash[0m[1;39m)[0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     [0m[39mdata->cached_subject = [0m[1;35mfreerdp_certificate_get_subject[0m[1;39m([0m[39mdata->cert[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data->cached_subject[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     [0m[39m        [0m[39mdata->cached_subject = [0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     [0m[39msize_t pemlen = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     [0m[39mdata->cached_pem = [0m[1;35mfreerdp_certificate_get_pem_ex[0m[1;39m([0m[39mdata->cert, &pemlen, [0m     [2m                [0m
[2;36m                    [0m         [39mFALSE[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data->cached_pem[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     [0m[39msize_t pemchainlen = [0m[1;36m0[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     [0m[39mdata->cached_pem_chain = [0m[1;35mfreerdp_certificate_get_pem_ex[0m[1;39m([0m[39mdata->cert, [0m        [2m                [0m
[2;36m                    [0m         [39m&pemchainlen, TRUE[0m[1;39m)[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data->cached_pem_chain[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:     [0m[39mdata->cached_fingerprint = [0m[1;35mfreerdp_certificate_get_fingerprint[0m[1;39m([0m[39mdata->cert[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data->cached_fingerprint[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:     [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:     [0m[39mdata->cached_issuer = [0m[1;35mfreerdp_certificate_get_issuer[0m[1;39m([0m[39mdata->cert[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data->cached_issuer[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     [0m[39m        [0m[39mdata->cached_issuer = [0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    [0m[39mrc = TRUE;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;92m102:fa[0m[39mil:[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    [0m[39mreturn rc;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1529[0m[39m-[0m[1;36m1580[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1529[0m[39m:static BOOL [0m[1;35mfreerdp_bio_read_pem_with_policy[0m[1;39m([0m[39mBIO* bio, char** ppem, size_t* [0m   [2m                [0m
[2;36m                    [0m         [39mplength[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1530[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1531[0m[39m:   [0m[39mBOOL rc = FALSE;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1532[0m[39m:   [0m[39mint status = [0m[1;36m-1[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1533[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1534[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mbio[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1535[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mppem[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1536[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1537[0m[39m:   [0m[39mconst uint16_t blocksize = [0m[1;36m2048[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1538[0m[39m:   [0m[39muint16_t offset = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1539[0m[39m:   [0m[39muint16_t length = blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1540[0m[39m:   [0m[39mchar* pem = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1541[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1542[0m[39m:   [0m[39m*ppem = NULL;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1543[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1544[0m[39m:   [0m[39m        [0m[39m*plength = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1545[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1546[0m[39m:   [0m[39mwhile [0m[1;39m([0m[39mstatus != [0m[1;36m0[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1547[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1548[0m[39m:   [0m[39m        [0m[39mchar* tmp = [0m[1;35mrealloc[0m[1;39m([0m[39mpem, length + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1549[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m!tmp[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1550[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1551[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1552[0m[39m:   [0m[39m        [0m[39mpem = tmp;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1553[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1554[0m[39m:   [0m[39m        [0m[1;35mERR_clear_error[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1555[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1556[0m[39m:   [0m[39m        [0m[39mstatus = [0m[1;35mBIO_read[0m[1;39m([0m[39mbio, &pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[1;39m([0m[39mlength - offset[0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1557[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1558[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1559[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"failed to read certificate"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1561[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1562[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1563[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1564[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1565[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1566[0m[39m:   [0m[39m        [0m[39moffset += [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mstatus;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:   [0m[39m        [0m[39mlength += blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1568[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1569[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1570[0m[39m:   [0m[39mpem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1571[0m[39m:   [0m[39m*ppem = pem;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1572[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1573[0m[39m:   [0m[39m        [0m[39m*plength = offset;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1574[0m[39m:   [0m[39mrc = TRUE;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;92m1575:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1576[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!rc[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1577[0m[39m:   [0m[39m        [0m[1;35mfree[0m[1;39m([0m[39mpem[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1578[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1579[0m[39m:   [0m[39mreturn rc;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1580[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1351[0m[39m-[0m[1;36m1380[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1351[0m[39m:int [0m[1;35mfreerdp_certificate_policies[0m[1;39m([0m[39mconst rdpCertificate* cert, const char* oid[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1352[0m[39m:    [0m[1;35mSTACK_OF[0m[1;39m([0m[39mPOLICYINFO[0m[1;39m)[0m[39m *policies;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1353[0m[39m:   [0m[39mint result = [0m[1;36m0[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1354[0m[39m:    int crit;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1355[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1356[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!cert->x509[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1357[0m[39m:   [0m[39m        [0m[39mreturn result;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1358[0m[39m:   [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1359[0m[39m:    [0m[35m/[0m[35m/[0m[39m Get certificate policies[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1360[0m[39m:    policies = [0m[1;35mX509_get_ext_d2i[0m[1;39m([0m[39mcert->x509, NID_certificate_policies, &crit, [0m  [2m                [0m
[2;36m                    [0m         [39mNULL[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1361[0m[39m:    if [0m[1;39m([0m[39m!policies[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1362[0m[39m:        return result;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1363[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1364[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1365[0m[39m:    for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < [0m[1;35msk_POLICYINFO_num[0m[1;39m([0m[39mpolicies[0m[1;39m)[0m[39m; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1366[0m[39m:        POLICYINFO *policy = [0m[1;35msk_POLICYINFO_value[0m[1;39m([0m[39mpolicies, i[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1367[0m[39m:        if [0m[1;39m([0m[39mpolicy->policyid[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1368[0m[39m:            char buf[0m[1;39m[[0m[1;36m128[0m[1;39m][0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1369[0m[39m:            [0m[1;35mOBJ_obj2txt[0m[1;39m([0m[39mbuf, [0m[1;35msizeof[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[39m, policy->policyid, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1370[0m[39m:            if [0m[1;39m([0m[39m [0m[1;35mstrncmp[0m[1;39m([0m[39mbuf, oid, [0m[1;35msizeof[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1371[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mresult = [0m[1;36m1[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1372[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1373[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1374[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1375[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1376[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1377[0m[39m:    [0m[1;35msk_POLICYINFO_pop_free[0m[1;39m([0m[39mpolicies, POLICYINFO_free[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1378[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1379[0m[39m:   [0m[39mreturn result;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1380[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1[0m[39m-[0m[1;36m30[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m**[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * FreeRDP: A Remote Desktop Protocol Implementation[0m                              [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * Certificate Handling[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * Copyright [0m[1;36m2011[0m[39m Jiten Pathy[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * Copyright [0m[1;36m2011[0m[39m Marc-Andre Moreau <marcandre.moreau@gmail.com>[0m                  [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * Copyright [0m[1;36m2015[0m[39m Thincast Technologies GmbH[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * Copyright [0m[1;36m2015[0m[39m DI [0m[1;39m([0m[39mFH[0m[1;39m)[0m[39m Martin Haimberger <martin.haimberger@thincast.com>[0m      [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: * Copyright [0m[1;36m2023[0m[39m Armin Novak <anovak@thincast.com>[0m                               [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: * Copyright [0m[1;36m2023[0m[39m Thincast Technologies GmbH[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * Licensed under the Apache License, Version [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * you may not use this file except in compliance with the License.[0m              [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * You may obtain a copy of the License at[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:#include <freerdp/config.h>[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:#include <errno.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:#include <stdio.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:#include <string.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1477[0m[39m-[0m[1;36m1527[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1477[0m[39m:static BOOL [0m[1;35mbio_read_pem[0m[1;39m([0m[39mBIO* bio, char** ppem, size_t* plength[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m1478[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1479[0m[39m:   [0m[39mBOOL rc = FALSE;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1480[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1481[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mbio[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1482[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mppem[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1483[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1484[0m[39m:   [0m[39mconst size_t blocksize = [0m[1;36m2048[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1485[0m[39m:   [0m[39msize_t offset = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1486[0m[39m:   [0m[39msize_t length = blocksize;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1487[0m[39m:   [0m[39mchar* pem = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1488[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1489[0m[39m:   [0m[39m*ppem = NULL;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1490[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1491[0m[39m:   [0m[39m        [0m[39m*plength = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1492[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1493[0m[39m:   [0m[39mwhile [0m[1;39m([0m[39moffset < length[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1494[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1495[0m[39m:   [0m[39m        [0m[39mchar* tmp = [0m[1;35mrealloc[0m[1;39m([0m[39mpem, length + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1496[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m!tmp[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1497[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1498[0m[39m:   [0m[39m        [0m[39mpem = tmp;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1499[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1500[0m[39m:   [0m[39m        [0m[1;35mERR_clear_error[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1501[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1502[0m[39m:   [0m[39m        [0m[39mconst int status = [0m[1;35mBIO_read[0m[1;39m([0m[39mbio, &pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[1;39m([0m[39mlength - [0m      [2m                [0m
[2;36m                    [0m         [39moffset[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1503[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1504[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1505[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"failed to read certificate"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1506[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1507[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1508[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1509[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1510[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1511[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1512[0m[39m:   [0m[39m        [0m[39moffset += [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mstatus;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1513[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mlength - offset > [0m[1;36m0[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1514[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1515[0m[39m:   [0m[39m        [0m[39mlength += blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1516[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1517[0m[39m:   [0m[39mpem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1518[0m[39m:   [0m[39m*ppem = pem;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1519[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1520[0m[39m:   [0m[39m        [0m[39m*plength = offset;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1521[0m[39m:   [0m[39mrc = TRUE;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;92m1522:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1523[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!rc[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1524[0m[39m:   [0m[39m        [0m[1;35mfree[0m[1;39m([0m[39mpem[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1525[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1526[0m[39m:   [0m[39mreturn rc;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1527[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1529[0m[39m-[0m[1;36m1580[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1529[0m[39m:static BOOL [0m[1;35mfreerdp_bio_read_pem_with_policy[0m[1;39m([0m[39mBIO* bio, char** ppem, size_t* [0m   [2m                [0m
[2;36m                    [0m         [39mplength[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1530[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1531[0m[39m:   [0m[39mBOOL rc = FALSE;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1532[0m[39m:   [0m[39mint status = [0m[1;36m-1[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1533[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1534[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mbio[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1535[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mppem[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1536[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1537[0m[39m:   [0m[39mconst uint16_t blocksize = [0m[1;36m2048[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1538[0m[39m:   [0m[39muint16_t offset = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1539[0m[39m:   [0m[39muint16_t length = blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1540[0m[39m:   [0m[39mchar* pem = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1541[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1542[0m[39m:   [0m[39m*ppem = NULL;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1543[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1544[0m[39m:   [0m[39m        [0m[39m*plength = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1545[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1546[0m[39m:   [0m[39mwhile [0m[1;39m([0m[39mstatus != [0m[1;36m0[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1547[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1548[0m[39m:   [0m[39m        [0m[39mchar* tmp = [0m[1;35mrealloc[0m[1;39m([0m[39mpem, length + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1549[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m!tmp[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1550[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1551[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1552[0m[39m:   [0m[39m        [0m[39mpem = tmp;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1553[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1554[0m[39m:   [0m[39m        [0m[1;35mERR_clear_error[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1555[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1556[0m[39m:   [0m[39m        [0m[39mstatus = [0m[1;35mBIO_read[0m[1;39m([0m[39mbio, &pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[1;39m([0m[39mlength - offset[0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1557[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1558[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1559[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"failed to read certificate"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1561[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1562[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1563[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1564[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1565[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1566[0m[39m:   [0m[39m        [0m[39moffset += [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mstatus;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:   [0m[39m        [0m[39mlength += blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1568[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1569[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1570[0m[39m:   [0m[39mpem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1571[0m[39m:   [0m[39m*ppem = pem;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1572[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1573[0m[39m:   [0m[39m        [0m[39m*plength = offset;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1574[0m[39m:   [0m[39mrc = TRUE;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;92m1575:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1576[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!rc[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1577[0m[39m:   [0m[39m        [0m[1;35mfree[0m[1;39m([0m[39mpem[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1578[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1579[0m[39m:   [0m[39mreturn rc;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1580[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis of the Evaluation Report and Code Snippets[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Root Cause Identification[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe heap-buffer-overflow occurs in `freerdp_bio_read_pem_with_policy` at line [0m[1;36m1570[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39mof `libfreerdp/crypto/certificate.c`. The root cause is an **integer overflow** due[0m [2m                [0m
[2;36m                    [0m         [39mto incorrect use of `uint16_t` instead of `size_t` for buffer size tracking [0m        [2m                [0m
[2;36m                    [0m         [39mvariables.[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Specific Issues:**[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Lines [0m[1;36m1537[0m[39m-[0m[1;36m1539[0m[39m**: Variables `blocksize`, `offset`, and `length` are declared [0m [2m                [0m
[2;36m                    [0m         [39mas `uint16_t`, limiting maximum buffer size to [0m[1;36m65[0m[39m,[0m[1;36m535[0m[39m bytes[0m                         [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Line [0m[1;36m1567[0m[39m**: `length += blocksize` causes wraparound when exceeding [0m[1;36m65[0m[39m,[0m[1;36m535[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mbytes[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Line [0m[1;36m1570[0m[39m**: `pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m` writes beyond allocated buffer when integer [0m [2m                [0m
[2;36m                    [0m         [39moverflow occurs[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Line [0m[1;36m1546[0m[39m**: Loop condition `while [0m[1;39m([0m[39mstatus != [0m[1;36m0[0m[1;39m)[0m[39m` doesn't provide overflow [0m    [2m                [0m
[2;36m                    [0m         [39mprotection[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This Vulnerability Exists[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe buggy function was introduced to handle certificates with the Extended [0m         [2m                [0m
[2;36m                    [0m         [39mValidation [0m[1;39m([0m[39mEV[0m[1;39m)[0m[39m SSL policy OID [0m[32m"2.23.140.1.2.1"[0m[39m [0m[1;39m([0m[39mRFC [0m[1;36m7299[0m[39m compliance[0m[1;39m)[0m[39m. However, EV [0m [2m                [0m
[2;36m                    [0m         [39mcertificates typically have **longer certificate chains**, making them MORE likely [0m [2m                [0m
[2;36m                    [0m         [39mto exceed 65KB and trigger the overflow. The developer who added this special [0m      [2m                [0m
[2;36m                    [0m         [39mhandling did not notice that the existing `bio_read_pem` function uses `size_t` [0m    [2m                [0m
[2;36m                    [0m         [39minstead of `uint16_t`.[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Evidence from Code Analysis[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA correct reference implementation already exists in the same file [0m[1;39m([0m[39m`bio_read_pem` [0m [2m                [0m
[2;36m                    [0m         [39mat lines [0m[1;36m1477[0m[39m-[0m[1;36m1527[0m[1;39m)[0m[39m that uses `size_t` for all size variables. This demonstrates [0m   [2m                [0m
[2;36m                    [0m         [39mthe correct pattern that should have been followed.[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Comprehensive Fix Strategy[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m1[0m[39m: Primary Fix - Change Variable Types[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** `libfreerdp/crypto/certificate.c`, lines [0m[1;36m1537[0m[39m-[0m[1;36m1539[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Action:** Replace the three `uint16_t` declarations with `size_t`:[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Current [0m[1;39m([0m[39mBUGGY[0m[1;39m)[0m[39m:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39mconst uint16_t blocksize = [0m[1;36m2048[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [39muint16_t offset = [0m[1;36m0[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [39muint16_t length = blocksize;[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Fixed:[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mconst size_t blocksize = [0m[1;36m2048[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39msize_t offset = [0m[1;36m0[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [39msize_t length = blocksize;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Rationale:**[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m- `size_t` is the standard type for memory sizes and array indices in C[0m             [2m                [0m
[2;36m                    [0m         [39m- On [0m[1;36m64[0m[39m-bit systems, `size_t` can handle up to [0m[1;36m8[0m[39m,[0m[1;36m589[0m[39m,[0m[1;36m934[0m[39m,[0m[1;36m592[0m[39m GB, eliminating [0m       [2m                [0m
[2;36m                    [0m         [39moverflow risk[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m- Matches the implementation pattern in `bio_read_pem` [0m[1;39m([0m[39mlines [0m[1;36m1484[0m[39m-[0m[1;36m1486[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [39m- Maintains API compatibility [0m[1;39m([0m[39mfunctions already use `size_t*` for length [0m          [2m                [0m
[2;36m                    [0m         [39mparameters[0m[1;39m)[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m- Follows existing codebase conventions for buffer size handling[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m2[0m[39m: Optional Safety Enhancements[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mWhile not strictly necessary to fix the crash, consider adding safety checks from [0m  [2m                [0m
[2;36m                    [0m         [39mthe correct implementation:[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** `libfreerdp/crypto/certificate.c`, line [0m[1;36m1546[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Option A - Enhanced Loop Condition:**[0m                                             [2m                [0m
[2;36m                    [0m         [39mChange the loop condition from `while [0m[1;39m([0m[39mstatus != [0m[1;36m0[0m[1;39m)[0m[39m` to `while [0m[1;39m([0m[39moffset < length[0m[1;39m)[0m[39m` [0m  [2m                [0m
[2;36m                    [0m         [39mto match the safe implementation. This provides additional overflow protection.[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Option B - Early Exit Check:**[0m                                                    [2m                [0m
[2;36m                    [0m         [39mAfter line [0m[1;36m1566[0m[39m [0m[1;39m([0m[39m`offset += [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mstatus;`[0m[1;39m)[0m[39m, add:[0m                                 [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mlength - offset > [0m[1;36m0[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [39m    break;[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39mThis exits the loop if space remains after a read, preventing unnecessary [0m          [2m                [0m
[2;36m                    [0m         [39mreallocations.[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Recommendation:** These enhancements are optional since changing to `size_t` [0m     [2m                [0m
[2;36m                    [0m         [39mresolves the overflow issue. However, implementing them would make the code more [0m   [2m                [0m
[2;36m                    [0m         [39mdefensive and align it with the proven-safe `bio_read_pem` implementation.[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m3[0m[39m: Preserve Critical Logic[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**DO NOT MODIFY:**[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The certificate policy checking mechanism [0m[1;39m([0m[39m`freerdp_certificate_policies` at [0m    [2m                [0m
[2;36m                    [0m         [39mlines [0m[1;36m1351[0m[39m-[0m[1;36m1380[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. The policy-based code path selection [0m[1;39m([0m[39mlines [0m[1;36m1633[0m[39m-[0m[1;36m1637[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. PEM writing to BIO operations [0m[1;39m([0m[39mlines [0m[1;36m1609[0m[39m-[0m[1;36m1629[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Error handling and cleanup logic [0m[1;39m([0m[39mlines [0m[1;36m1575[0m[39m-[0m[1;36m1579[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. BIO reading mechanism [0m[1;39m([0m[39mline [0m[1;36m1556[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. NULL termination [0m[1;39m([0m[39mline [0m[1;36m1570[0m[1;39m)[0m[39m - the operation itself is correct, just needs [0m      [2m                [0m
[2;36m                    [0m         [39mproper buffer allocation[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why Preserve These:**[0m                                                             [2m                [0m
[2;36m                    [0m         [39m- The policy checking implements RFC [0m[1;36m7299[0m[39m compliance requirements[0m                   [2m                [0m
[2;36m                    [0m         [39m- The error handling ensures proper resource cleanup[0m                                [2m                [0m
[2;36m                    [0m         [39m- The BIO operations are standard OpenSSL usage patterns[0m                            [2m                [0m
[2;36m                    [0m         [39m- These components are not the root cause and work correctly when given proper [0m     [2m                [0m
[2;36m                    [0m         [39mbuffer sizes[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m4[0m[39m: Secondary Code Quality Issue [0m[1;39m([0m[39mOptional[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** `libfreerdp/crypto/certificate.c`, line [0m[1;36m1370[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThere's a minor bug in the policy OID comparison:[0m                                   [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Current:[0m                                                                         [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39m [0m[1;35mstrncmp[0m[1;39m([0m[39mbuf, oid, [0m[1;35msizeof[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Should be:[0m                                                                       [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39m [0m[1;35mstrcmp[0m[1;39m([0m[39mbuf, oid[0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Rationale:**[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m- `[0m[1;35msizeof[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[39m` is [0m[1;36m128[0m[39m, not the string length[0m                                       [2m                [0m
[2;36m                    [0m         [39m- Using `strcmp` is more semantically correct for null-terminated string comparison[0m [2m                [0m
[2;36m                    [0m         [39m- **Note:** This is NOT the root cause of the heap-buffer-overflow and fixing it [0m   [2m                [0m
[2;36m                    [0m         [39mwon't resolve the ASAN issue[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Recommendation:** This can be addressed as a code quality improvement in a [0m       [2m                [0m
[2;36m                    [0m         [39mseparate patch, but it's not critical for fixing the reported vulnerability.[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Justification[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This Is the Optimal Approach[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Minimal Code Changes:** Only [0m[1;36m3[0m[39m lines need modification, reducing risk of [0m      [2m                [0m
[2;36m                    [0m         [39mintroducing new bugs[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Follows Existing Patterns:** Matches the proven-safe implementation in [0m        [2m                [0m
[2;36m                    [0m         [39m`bio_read_pem`[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Maintains Compatibility:** No API changes needed; functions already use [0m       [2m                [0m
[2;36m                    [0m         [39m`size_t*` parameters[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Comprehensive Solution:** Eliminates integer overflow at the source rather [0m    [2m                [0m
[2;36m                    [0m         [39mthan adding workarounds[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **No Functionality Loss:** Preserves RFC [0m[1;36m7299[0m[39m policy handling and all [0m           [2m                [0m
[2;36m                    [0m         [39mcertificate processing features[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Preserves Existing Logic[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Certificate Processing:** All certificate parsing, validation, and chain [0m       [2m                [0m
[2;36m                    [0m         [39mhandling remain unchanged[0m                                                           [2m                [0m
[2;36m                    [0m         [39m- **Policy-Based Routing:** The decision to use `freerdp_bio_read_pem_with_policy` [0m [2m                [0m
[2;36m                    [0m         [39mvs `bio_read_pem` is preserved[0m                                                      [2m                [0m
[2;36m                    [0m         [39m- **Error Handling:** All error paths, cleanup routines, and memory management [0m     [2m                [0m
[2;36m                    [0m         [39mremain intact[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m- **OpenSSL Integration:** BIO operations and X509 certificate handling are [0m        [2m                [0m
[2;36m                    [0m         [39munchanged[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m- **API Contracts:** Public functions maintain their signatures and behavior[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Addresses the Issues[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Eliminates Integer Overflow:** `size_t` prevents wraparound at [0m[1;36m65[0m[39m,[0m[1;36m535[0m[39m bytes[0m    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Fixes Heap-Buffer-Overflow:** Proper buffer allocation prevents out-of-bounds [0m [2m                [0m
[2;36m                    [0m         [39mwrites at line [0m[1;36m1570[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Supports Large Certificates:** Can handle certificate chains of any practical [0m [2m                [0m
[2;36m                    [0m         [39msize[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Maintains Security:** No reduction in certificate validation or policy [0m        [2m                [0m
[2;36m                    [0m         [39menforcement[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Potential Side Effects and Mitigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential Side Effect:** Increased memory usage for extremely large certificates [0m [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mmulti-MB[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Mitigation:** [0m                                                                    [2m                [0m
[2;36m                    [0m         [39m- This is acceptable as `bio_read_pem` already supports unlimited sizes[0m             [2m                [0m
[2;36m                    [0m         [39m- Modern systems can easily handle certificate data up to several MB[0m                [2m                [0m
[2;36m                    [0m         [39m- The blocksize of [0m[1;36m2048[0m[39m bytes ensures memory is allocated incrementally, not all at[0m [2m                [0m
[2;36m                    [0m         [39monce[0m                                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**No Breaking Changes:**[0m                                                            [2m                [0m
[2;36m                    [0m         [39m- Existing tests will continue to pass[0m                                              [2m                [0m
[2;36m                    [0m         [39m- Certificates without the policy OID use the unmodified `bio_read_pem` function[0m    [2m                [0m
[2;36m                    [0m         [39m- Certificates with the policy OID will now work correctly for all sizes[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Similar Solutions in Codebase[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix directly mirrors the implementation in `bio_read_pem` [0m[1;39m([0m[39mlines [0m[1;36m1477[0m[39m-[0m[1;36m1527[0m[1;39m)[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [39mwhich demonstrates this is the established pattern for buffer management in the [0m    [2m                [0m
[2;36m                    [0m         [39mFreeRDP codebase. This function has been working correctly and serves as the [0m       [2m                [0m
[2;36m                    [0m         [39mreference implementation.[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Implementation Steps[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Open `libfreerdp/crypto/certificate.c`[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Locate lines [0m[1;36m1537[0m[39m-[0m[1;36m1539[0m[39m in the `freerdp_bio_read_pem_with_policy` function[0m        [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Change `const uint16_t blocksize = [0m[1;36m2048[0m[39m;` to `const size_t blocksize = [0m[1;36m2048[0m[39m;`[0m    [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Change `uint16_t offset = [0m[1;36m0[0m[39m;` to `size_t offset = [0m[1;36m0[0m[39m;`[0m                            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Change `uint16_t length = blocksize;` to `size_t length = blocksize;`[0m            [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. [0m[1;39m([0m[39mOptional[0m[1;39m)[0m[39m Consider adding the safety enhancements from Step [0m[1;36m2[0m                   [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. [0m[1;39m([0m[39mOptional[0m[1;39m)[0m[39m Fix the `strncmp` comparison bug at line [0m[1;36m1370[0m[39m as a code quality [0m      [2m                [0m
[2;36m                    [0m         [39mimprovement[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Testing Recommendations[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Test with certificates containing policy OID [0m[32m"2.23.140.1.2.1"[0m                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Test with large certificate chains [0m[1;39m([0m[1;36m5[0m[39m+ certificates[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Test with the original fuzzer input that triggered the crash[0m                     [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Verify existing test suites pass[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Run AddressSanitizer builds to confirm the overflow is resolved[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/06/26 15:34:39][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=236622;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=658033;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=132065;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=715735;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpn7g4x4zr[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/freerdp_fp-delta-01_vuln_001/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1767713679.1249416[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/freerdp_fp-delta-01_vuln_001.toml                     [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-freerdp[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/06/26 15:34:41][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/qqor/crete/.cache/environments/[0m[95mfreerdp[0m        ]8;id=537502;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=482704;file:///home/qqor/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=206808;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=460760;file:///home/qqor/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mfreerdp[0m               [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=95221;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=920403;file:///home/qqor/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mfreerdp[0m                [2m               [0m
