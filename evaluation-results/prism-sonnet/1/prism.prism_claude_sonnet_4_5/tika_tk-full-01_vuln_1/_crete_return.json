{
  "project_name": "tika",
  "vulnerability_identifier": "tika_tk-full-01_vuln_1",
  "source_directory": "/home/user/crete/.cache/official-afc-tika",
  "llm_usage": {
    "total_cost": 3.4328100000000004,
    "prompt_tokens": 930050,
    "completion_tokens": 42844
  },
  "variant": "sound",
  "diff": "--- a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-microsoft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFEmbObjHandler.java\n+++ b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-microsoft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFEmbObjHandler.java\n@@ -18,7 +18,6 @@\n \n import java.io.IOException;\n import java.io.InputStream;\n-import java.io.ObjectInputStream;\n import java.nio.charset.StandardCharsets;\n import java.util.concurrent.atomic.AtomicInteger;\n \n@@ -99,11 +98,6 @@\n         metadata = new Metadata();\n     }\n \n-    protected void startJavaObjData() {\n-        state = EMB_STATE.JAVA_OBJDATA;\n-        metadata = new Metadata();\n-    }\n-\n     protected void startSN() {\n         sb.setLength(0);\n         sb.append(RTFMetadata.RTF_PICT_META_PREFIX);\n@@ -210,18 +204,6 @@\n             }\n             extractObj(bytes, handler, metadata);\n \n-        } else if (state == EMB_STATE.JAVA_OBJDATA) {\n-            try {\n-                Object obj = new ObjectInputStream(\n-                        UnsynchronizedByteArrayInputStream.builder().setByteArray(bytes)\n-                                .get()).readObject();\n-                metadata.set(RTFMetadata.EMB_CLASS, obj.getClass().getName());\n-                metadata.set(TikaCoreProperties.CONTENT_TYPE_PARSER_OVERRIDE,\n-                        MediaType.text(\"plain\").toString());\n-                extractObj(obj.toString().getBytes(StandardCharsets.UTF_8), handler, metadata);\n-            } catch (ClassNotFoundException e) {\n-                throw new TikaException(\"Not found\", e);\n-            }\n         } else if (state == EMB_STATE.NADA) {\n             //swallow...no start for pict or embed?!\n         }\n@@ -280,7 +262,6 @@\n     private enum EMB_STATE {\n         PICT, //recording pict data\n         OBJDATA, //recording objdata\n-        JAVA_OBJDATA, //recording java obj data\n         NADA\n     }\n }\n\n--- a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-microsoft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/GroupState.java\n+++ b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-microsoft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/GroupState.java\n@@ -35,8 +35,6 @@\n     public Charset fontCharset;\n     //in objdata\n     public boolean objdata;\n-    //in javaobjdata\n-    public boolean javaobjdata;\n     //depth in pict, 1 = at pict level\n     public int pictDepth;\n     //in picprop key/value pair\n@@ -64,7 +62,6 @@\n         fontCharset = other.fontCharset;\n         depth = 1 + other.depth;\n         pictDepth = other.pictDepth > 0 ? other.pictDepth + 1 : 0;\n-        javaobjdata = other.javaobjdata;\n         //do not inherit object, sn, sv, sp or annotation\n \n     }\n\n--- a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-microsoft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/TextExtractor.java\n+++ b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-microsoft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/TextExtractor.java\n@@ -484,8 +484,7 @@\n                     // parsed document closing brace\n                     break;\n                 }\n-            } else if (groupState.objdata == true || groupState.javaobjdata == true\n-                    || groupState.pictDepth == 1) {\n+            } else if (groupState.objdata == true || groupState.pictDepth == 1) {\n                 embObjHandler.writeHexChar(b);\n             } else if (b != '\\r' && b != '\\n' &&\n                     (!groupState.ignore || nextMetaData != null || groupState.sn == true ||\n@@ -1271,9 +1270,6 @@\n         } else if (equals(\"objdata\")) {\n             groupState.objdata = true;\n             embObjHandler.startObjData();\n-        } else if (equals(\"javaobjdata\")) {\n-            groupState.javaobjdata = true;\n-            embObjHandler.startJavaObjData();\n         } else if (equals(\"pict\")) {\n             pushText();\n             // TODO: create img tag?  but can that support\n@@ -1470,13 +1466,6 @@\n             }\n             groupState.objdata = false;\n \n-        } else if (groupState.javaobjdata == true) {\n-            try {\n-                embObjHandler.handleCompletedObject();\n-            } catch (TikaException | IOException e) {\n-                EmbeddedDocumentUtil.recordException(e, metadata);\n-            }\n-            groupState.javaobjdata = false;\n         } else if (groupState.pictDepth > 0) {\n             if (groupState.sn == true) {\n                 embObjHandler.endSN();\n",
  "stdout": "",
  "stderr": ""
}