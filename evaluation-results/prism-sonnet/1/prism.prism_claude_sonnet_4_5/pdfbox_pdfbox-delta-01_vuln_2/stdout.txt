[2;36m[01/06/26 18:07:17][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=701845;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=797839;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpm6zpt0b8[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/pdfbox_pdfbox-delta-01_vuln_2[0m [2m               [0m
[2;36m                    [0m         [35m/[0m[95magent-output-1767722837.821431[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/pdfbox_pdfbox-delta-01_vuln_2.toml                    [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-pdfbox[0m           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Building Cached for CLEAN environment[1m)[0m Started[33m...[0m ]8;id=571426;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=802544;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 18:08:46][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Building Cached for CLEAN environment[1m)[0m Took      ]8;id=838468;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=371227;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m88.30[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running tests for Cached for CLEAN environment[1m)[0m   ]8;id=836445;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=651773;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=110851;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=417082;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=603557;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=869784;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m88[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=904771;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=421862;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 18:08:47][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.88[0m seconds;                ]8;id=886620;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=449544;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/06/26 18:08:48][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=536267;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=597591;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=334148;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=361059;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=336326;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=601817;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=449351;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=369955;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 18:08:49][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m1.02[0m seconds;                ]8;id=901708;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=378153;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=849047;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=475807;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 18:08:50][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.92[0m seconds;                ]8;id=875621;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=910561;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/06/26 18:08:56][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=165756;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=136451;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS [2m                [0m
[2;36m                    [0m         Command Injection                                                                   [2m                [0m
[2;36m                    [0m         Executing OS commands with attacker-controlled data can lead to remote code         [2m                [0m
[2;36m                    [0m         execution.                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1m([0mOsC [2m                [0m
[2;36m                    [0m         ommandInjection.kt:[1;36m60[0m[1m)[0m                                                              [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1110[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1073[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.doOCR[0m[1m([0mOCRStreamEngine.jav[1;92ma:190[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.runTesseract[0m[1m([0mOCRStreamEngine.jav[1;92ma:165[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.processPage[0m[1m([0mOCRStreamEngine.jav[1;92ma:150[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.processPages[0m[1m([0mOCRStreamEngine.jav[1;92ma:140[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.writeText[0m[1m([0mOCRStreamEngine.jav[1;92ma:129[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.getText[0m[1m([0mOCRStreamEngine.jav[1;92ma:88[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.getText[0m[1m([0mOCRStreamEngine.jav[1;92ma:71[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke0[0m[1m([0mNative   [2m                [0m
[2;36m                    [0m         Method[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke[0m[1m([0mNativeMethodAccessor [2m                [0m
[2;36m                    [0m         Impl.jav[1;92ma:77[0m[1m)[0m                                                                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjdk.internal.reflect.DelegatingMethodAccessorImpl.invoke[0m[1m([0mDelegatingMethod [2m                [0m
[2;36m                    [0m         AccessorImpl.jav[1;92ma:43[0m[1m)[0m                                                               [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.reflect.Method.invoke[0m[1m([0mMethod.jav[1;92ma:568[0m[1m)[0m               [2m                [0m
[2;36m                    [0m                 at [1;35mcom.example.PDFOCRFuzzer.fuzzerTestOneInput[0m[1m([0mPDFOCRFuzzer.jav[1;92ma:75[0m[1m)[0m        [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: af83c7db521bbc07                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS [2m                [0m
[2;36m                    [0m         Command Injection                                                                   [2m                [0m
[2;36m                    [0m         Executing OS commands with attacker-controlled data can lead to remote code         [2m                [0m
[2;36m                    [0m         execution.                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1m([0mOsC [2m                [0m
[2;36m                    [0m         ommandInjection.kt:[1;36m60[0m[1m)[0m                                                              [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1110[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1073[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.doOCR[0m[1m([0mOCRStreamEngine.jav[1;92ma:190[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.runTesseract[0m[1m([0mOCRStreamEngine.jav[1;92ma:165[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.processPage[0m[1m([0mOCRStreamEngine.jav[1;92ma:150[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.processPages[0m[1m([0mOCRStreamEngine.jav[1;92ma:140[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.writeText[0m[1m([0mOCRStreamEngine.jav[1;92ma:129[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.getText[0m[1m([0mOCRStreamEngine.jav[1;92ma:88[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.getText[0m[1m([0mOCRStreamEngine.jav[1;92ma:71[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke0[0m[1m([0mNative   [2m                [0m
[2;36m                    [0m         Method[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke[0m[1m([0mNativeMethodAccessor [2m                [0m
[2;36m                    [0m         Impl.jav[1;92ma:77[0m[1m)[0m                                                                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjdk.internal.reflect.DelegatingMethodAccessorImpl.invoke[0m[1m([0mDelegatingMethod [2m                [0m
[2;36m                    [0m         AccessorImpl.jav[1;92ma:43[0m[1m)[0m                                                               [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.reflect.Method.invoke[0m[1m([0mMethod.jav[1;92ma:568[0m[1m)[0m               [2m                [0m
[2;36m                    [0m                 at [1;35mcom.example.PDFOCRFuzzer.fuzzerTestOneInput[0m[1m([0mPDFOCRFuzzer.jav[1;92ma:75[0m[1m)[0m        [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: af83c7db521bbc07                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/06/26 18:09:15][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=311490;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=418645;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/06/26 18:13:35][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=266222;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=275019;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/06/26 18:14:31][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=734947;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=619327;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=824238;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=725166;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 18:14:32][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.94[0m seconds;                ]8;id=485656;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=489788;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/06/26 18:14:33][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Patching[1m)[0m Started[33m...[0m                              ]8;id=49476;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=212651;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp6xnkh2ln[0m                                                 ]8;id=545974;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=811084;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/06/26 18:15:42][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Patching[1m)[0m Took [1;36m68.98[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=758083;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=504935;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Checking build[1m)[0m Started[33m...[0m                        ]8;id=85508;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=24275;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 18:15:57][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Checking build[1m)[0m Took [1;36m15.05[0m seconds;              ]8;id=284699;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=327487;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running PoV[1m)[0m Started[33m...[0m                           ]8;id=22445;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=985514;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 18:16:08][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running PoV[1m)[0m Took [1;36m10.92[0m seconds; [33mexception[0m=[3;91mFalse[0m ]8;id=997069;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=89226;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Testing[1m)[0m Started[33m...[0m                               ]8;id=28796;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=787331;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=178775;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=257027;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=877535;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=479189;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 18:16:09][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.86[0m seconds;                ]8;id=780663;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=8098;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=127091;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=660135;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 18:16:10][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.93[0m seconds;                ]8;id=34741;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=182477;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/06/26 18:16:11][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=39785;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=756307;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.88[0m seconds;                ]8;id=395363;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=758640;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/06/26 18:16:12][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=250026;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=264080;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/pdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.java               [2m                [0m
[2;36m                    [0m         +++ b/pdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.java               [2m                [0m
[2;36m                    [0m         @@ [1;36m-11[0m,[1;36m6[0m +[1;36m11[0m,[1;36m7[0m @@                                                                   [2m                [0m
[2;36m                    [0m          import java.io.Writer;                                                             [2m                [0m
[2;36m                    [0m          import java.nio.file.FileVisitResult;                                              [2m                [0m
[2;36m                    [0m          import java.nio.file.Files;                                                        [2m                [0m
[2;36m                    [0m         +import java.nio.file.InvalidPathException;                                         [2m                [0m
[2;36m                    [0m          import java.nio.file.Path;                                                         [2m                [0m
[2;36m                    [0m          import java.nio.file.Paths;                                                        [2m                [0m
[2;36m                    [0m          import java.nio.file.SimpleFileVisitor;                                            [2m                [0m
[2;36m                    [0m         @@ [1;36m-22[0m,[1;36m6[0m +[1;36m23[0m,[1;36m9[0m @@                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          import javax.imageio.ImageIO;                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         +import org.apache.logging.log4j.Logger;                                            [2m                [0m
[2;36m                    [0m         +import org.apache.logging.log4j.LogManager;                                        [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m          import org.apache.pdfbox.pdmodel.PDDocument;                                       [2m                [0m
[2;36m                    [0m          import org.apache.pdfbox.pdmodel.PDPageTree;                                       [2m                [0m
[2;36m                    [0m          import org.apache.pdfbox.rendering.PDFRenderer;                                    [2m                [0m
[2;36m                    [0m         @@ [1;36m-33[0m,[1;36m6[0m +[1;36m37[0m,[1;36m7[0m @@                                                                   [2m                [0m
[2;36m                    [0m           *[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m          public class OCRStreamEngine [1m{[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         +    private static final Logger LOG = [1;35mLogManager.getLogger[0m[1m([0mOCRStreamEngine.class[1m)[0m; [2m                [0m
[2;36m                    [0m              private static final String TESSERACT_PATH_KEY = [32m"tesseract-path"[0m;             [2m                [0m
[2;36m                    [0m              private PDFRenderer pdfRenderer = null;                                        [2m                [0m
[2;36m                    [0m              private String tesseractPath = [32m"tesseract"[0m;                                    [2m                [0m
[2;36m                    [0m         @@ [1;36m-112[0m,[1;36m7[0m +[1;36m117[0m,[1;36m30[0m @@                                                                [2m                [0m
[2;36m                    [0m                          [1m}[0m                                                                  [2m                [0m
[2;36m                    [0m                      [1m}[0m[1m)[0m;                                                                    [2m                [0m
[2;36m                    [0m                  [1m}[0m catch [1m([0mIOException e[1m)[0m [1m{[0m                                                  [2m                [0m
[2;36m                    [0m         -            [35m/[0m[35m/[0m[95mlog[0m                                                                  [2m                [0m
[2;36m                    [0m         +            [1;35mLOG.warn[0m[1m([0m[32m"Failed to delete temporary OCR directory: [0m[32m{[0m[32m}[0m[32m"[0m, tmpDir, e[1m)[0m;   [2m                [0m
[2;36m                    [0m         +        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +    [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +    [35m/[0m**                                                                            [2m                [0m
[2;36m                    [0m         +     * Validates that the given path points to an executable file.                 [2m                [0m
[2;36m                    [0m         +     * This prevents OS command injection through PDF metadata.                    [2m                [0m
[2;36m                    [0m         +     *                                                                             [2m                [0m
[2;36m                    [0m         +     * @param path the path to validate                                            [2m                [0m
[2;36m                    [0m         +     * @return true if the path is valid and executable, false otherwise           [2m                [0m
[2;36m                    [0m         +     *[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         +    private boolean [1;35misValidTesseractPath[0m[1m([0mString path[1m)[0m [1m{[0m                            [2m                [0m
[2;36m                    [0m         +        if [1m([0mpath == null || [1;35mpath.isEmpty[0m[1m([0m[1m)[0m[1m)[0m [1m{[0m                                      [2m                [0m
[2;36m                    [0m         +            return false;                                                          [2m                [0m
[2;36m                    [0m         +        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +        try [1m{[0m                                                                      [2m                [0m
[2;36m                    [0m         +            Path tessPath = [1;35mPaths.get[0m[1m([0mpath[1m)[0m;                                       [2m                [0m
[2;36m                    [0m         +            [35m/[0m[35m/[0m Must exist, be a regular file [1m([0mnot directory[1m)[0m, and be executable    [2m                [0m
[2;36m                    [0m         +            return [1;35mFiles.exists[0m[1m([0mtessPath[1m)[0m &&                                       [2m                [0m
[2;36m                    [0m         +                   [1;35mFiles.isRegularFile[0m[1m([0mtessPath[1m)[0m &&                                [2m                [0m
[2;36m                    [0m         +                   [1;35mFiles.isExecutable[0m[1m([0mtessPath[1m)[0m;                                   [2m                [0m
[2;36m                    [0m         +        [1m}[0m catch [1m([0mInvalidPathException e[1m)[0m [1m{[0m                                         [2m                [0m
[2;36m                    [0m         +            [1;35mLOG.warn[0m[1m([0m[32m"Invalid path syntax for tesseract: [0m[32m{[0m[32m}[0m[32m"[0m, path[1m)[0m;               [2m                [0m
[2;36m                    [0m         +            return false;                                                          [2m                [0m
[2;36m                    [0m                  [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m              [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-155[0m,[1;36m10[0m +[1;36m183[0m,[1;36m38[0m @@                                                               [2m                [0m
[2;36m                    [0m              [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m              private String [1;35mrunTesseract[0m[1m([0mPath image[1m)[0m throws IOException [1m{[0m                   [2m                [0m
[2;36m                    [0m         -        String actualTessPath = [1;35mpdDocument.getDocumentInformation[0m[1m([0m[1m)[0m                [2m                [0m
[2;36m                    [0m         -                [1;35m.getCustomMetadataValue[0m[1m([0mTESSERACT_PATH_KEY[1m)[0m;                       [2m                [0m
[2;36m                    [0m         -        if [1m([0mactualTessPath == null || [1;35mactualTessPath.isEmpty[0m[1m([0m[1m)[0m[1m)[0m [1m{[0m                  [2m                [0m
[2;36m                    [0m         -            actualTessPath = tesseractPath;                                        [2m                [0m
[2;36m                    [0m         +        [35m/[0m[35m/[0m Start with programmatic/default configuration [1m([0mapplication-controlled[1m)[0m  [2m                [0m
[2;36m                    [0m         +        String actualTessPath = tesseractPath;                                     [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +        [35m/[0m[35m/[0m Check if metadata override is explicitly enabled via system property    [2m                [0m
[2;36m                    [0m         +        [35m/[0m[35m/[0m This provides defense-in-depth while maintaining backward compatibility [2m                [0m
[2;36m                    [0m         +        if [1m([0m[1;35mBoolean.getBoolean[0m[1m([0m[32m"pdfbox.ocr.allow-metadata-override"[0m[1m)[0m[1m)[0m [1m{[0m            [2m                [0m
[2;36m                    [0m         +            String metadataPath = [1;35mpdDocument.getDocumentInformation[0m[1m([0m[1m)[0m              [2m                [0m
[2;36m                    [0m         +                    [1;35m.getCustomMetadataValue[0m[1m([0mTESSERACT_PATH_KEY[1m)[0m;                   [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +            if [1m([0mmetadataPath != null && ![1;35mmetadataPath.isEmpty[0m[1m([0m[1m)[0m[1m)[0m [1m{[0m                 [2m                [0m
[2;36m                    [0m         +                [35m/[0m[35m/[0m Validate metadata path before using it                          [2m                [0m
[2;36m                    [0m         +                if [1m([0m[1;35misValidTesseractPath[0m[1m([0mmetadataPath[1m)[0m[1m)[0m [1m{[0m                          [2m                [0m
[2;36m                    [0m         +                    [1;35mLOG.info[0m[1m([0m[32m"Using tesseract path from PDF metadata: [0m[32m{[0m[32m}[0m[32m"[0m,         [2m                [0m
[2;36m                    [0m         metadataPath[1m)[0m;                                                                      [2m                [0m
[2;36m                    [0m         +                    actualTessPath = metadataPath;                                 [2m                [0m
[2;36m                    [0m         +                [1m}[0m else [1m{[0m                                                           [2m                [0m
[2;36m                    [0m         +                    [1;35mLOG.warn[0m[1m([0m[32m"Invalid tesseract path from PDF metadata [0m[32m([0m[32mnot [0m       [2m                [0m
[2;36m                    [0m         [32mexecutable[0m[32m)[0m[32m: [0m[32m{[0m[32m}[0m[32m, using default"[0m,                                                    [2m                [0m
[2;36m                    [0m         +                            metadataPath[1m)[0m;                                         [2m                [0m
[2;36m                    [0m         +                [1m}[0m                                                                  [2m                [0m
[2;36m                    [0m         +            [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m         +        [1m}[0m else [1m{[0m                                                                   [2m                [0m
[2;36m                    [0m         +            [35m/[0m[35m/[0m Log if metadata is present but override is disabled                 [2m                [0m
[2;36m                    [0m         +            String metadataPath = [1;35mpdDocument.getDocumentInformation[0m[1m([0m[1m)[0m              [2m                [0m
[2;36m                    [0m         +                    [1;35m.getCustomMetadataValue[0m[1m([0mTESSERACT_PATH_KEY[1m)[0m;                   [2m                [0m
[2;36m                    [0m         +            if [1m([0mmetadataPath != null && ![1;35mmetadataPath.isEmpty[0m[1m([0m[1m)[0m[1m)[0m [1m{[0m                 [2m                [0m
[2;36m                    [0m         +                [1;35mLOG.debug[0m[1m([0m[32m"Ignoring tesseract path from PDF metadata [0m[32m([0m[32moverride [0m    [2m                [0m
[2;36m                    [0m         [32mdisabled[0m[32m)[0m[32m: [0m[32m{[0m[32m}[0m[32m"[0m, metadataPath[1m)[0m;                                                      [2m                [0m
[2;36m                    [0m         +            [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m         +        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +        [35m/[0m[35m/[0m Final validation of the path to be used [1m([0mwhether from metadata, config, [2m                [0m
[2;36m                    [0m         or default[1m)[0m                                                                         [2m                [0m
[2;36m                    [0m         +        if [1m([0m![1;35misValidTesseractPath[0m[1m([0mactualTessPath[1m)[0m[1m)[0m [1m{[0m                               [2m                [0m
[2;36m                    [0m         +            throw new [1;35mIOException[0m[1m([0m[32m"Tesseract executable not found or not [0m          [2m                [0m
[2;36m                    [0m         [32mexecutable: "[0m + actualTessPath +                                                    [2m                [0m
[2;36m                    [0m         +                                [32m". Please ensure Tesseract OCR is installed and [0m   [2m                [0m
[2;36m                    [0m         [32mthe path is correct."[0m[1m)[0m;                                                             [2m                [0m
[2;36m                    [0m                  [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                  Path txt = [1;35mPaths.get[0m[1m([0m[1;35mimage.toAbsolutePath[0m[1m([0m[1m)[0m[1;35m.toString[0m[1m([0m[1m)[0m[1m)[0m;                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS [2m                [0m
[2;36m                    [0m         Command Injection                                                                   [2m                [0m
[2;36m                    [0m         Executing OS commands with attacker-controlled data can lead to remote code         [2m                [0m
[2;36m                    [0m         execution.                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1m([0mOsC [2m                [0m
[2;36m                    [0m         ommandInjection.kt:[1;36m60[0m[1m)[0m                                                              [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1110[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1073[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.doOCR[0m[1m([0mOCRStreamEngine.jav[1;92ma:190[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.runTesseract[0m[1m([0mOCRStreamEngine.jav[1;92ma:165[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.processPage[0m[1m([0mOCRStreamEngine.jav[1;92ma:150[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.processPages[0m[1m([0mOCRStreamEngine.jav[1;92ma:140[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.writeText[0m[1m([0mOCRStreamEngine.jav[1;92ma:129[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.getText[0m[1m([0mOCRStreamEngine.jav[1;92ma:88[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.getText[0m[1m([0mOCRStreamEngine.jav[1;92ma:71[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke0[0m[1m([0mNative   [2m                [0m
[2;36m                    [0m         Method[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke[0m[1m([0mNativeMethodAccessor [2m                [0m
[2;36m                    [0m         Impl.jav[1;92ma:77[0m[1m)[0m                                                                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjdk.internal.reflect.DelegatingMethodAccessorImpl.invoke[0m[1m([0mDelegatingMethod [2m                [0m
[2;36m                    [0m         AccessorImpl.jav[1;92ma:43[0m[1m)[0m                                                               [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.reflect.Method.invoke[0m[1m([0mMethod.jav[1;92ma:568[0m[1m)[0m               [2m                [0m
[2;36m                    [0m                 at [1;35mcom.example.PDFOCRFuzzer.fuzzerTestOneInput[0m[1m([0mPDFOCRFuzzer.jav[1;92ma:75[0m[1m)[0m        [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: af83c7db521bbc07                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m         # Evaluation Report                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Summary                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         A critical security vulnerability [1m([0mOS Command Injection[1m)[0m has been detected in       [2m                [0m
[2;36m                    [0m         Apache PDFBox's OCR functionality. The issue occurs when the OCRStreamEngine        [2m                [0m
[2;36m                    [0m         executes OS commands during the Tesseract OCR processing, potentially allowing      [2m                [0m
[2;36m                    [0m         remote code execution through attacker-controlled data. The vulnerability is        [2m                [0m
[2;36m                    [0m         triggered through the [1;35mgetText[0m[1m([0m[1m)[0m method chain and manifests in the                   [2m                [0m
[2;36m                    [0m         [1;35mProcessBuilder.start[0m[1m([0m[1m)[0m call within the [1;35mdoOCR[0m[1m([0m[1m)[0m method.                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Description                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Vulnerability Type                                                              [2m                [0m
[2;36m                    [0m         This is an **OS Command Injection** vulnerability, classified as a critical         [2m                [0m
[2;36m                    [0m         security issue. OS command injection occurs when an application executes system     [2m                [0m
[2;36m                    [0m         commands using externally supplied or insufficiently validated input, potentially   [2m                [0m
[2;36m                    [0m         allowing attackers to execute arbitrary commands on the host operating system.      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Issue Details                                                                   [2m                [0m
[2;36m                    [0m         The vulnerability has been identified in the following execution path:              [2m                [0m
[2;36m                    [0m         [1;36m1[0m. The entry point is `[1;35mOCRStreamEngine.getText[0m[1m([0m[1m)[0m` method                            [2m                [0m
[2;36m                    [0m         [1;36m2[0m. The call chain proceeds through: `[1;35mgetText[0m[1m([0m[1m)[0m → [1;35mwriteText[0m[1m([0m[1m)[0m → [1;35mprocessPages[0m[1m([0m[1m)[0m →     [2m                [0m
[2;36m                    [0m         [1;35mprocessPage[0m[1m([0m[1m)[0m → [1;35mrunTesseract[0m[1m([0m[1m)[0m → [1;35mdoOCR[0m[1m([0m[1m)[0m`                                           [2m                [0m
[2;36m                    [0m         [1;36m3[0m. The vulnerability manifests at `[1;35mdoOCR[0m[1m([0m[1m)[0m` method [1m([0mline [1;36m190[0m in                     [2m                [0m
[2;36m                    [0m         OCRStreamEngine.java[1m)[0m where `[1;35mProcessBuilder.start[0m[1m([0m[1m)[0m` is invoked                     [2m                [0m
[2;36m                    [0m         [1;36m4[0m. The security detection was triggered by Jazzer's OsCommandInjection sanitizer at [2m                [0m
[2;36m                    [0m         the [1;35mProcessBuilder.start[0m[1m([0m[1m)[0m call                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Key Observations                                                                [2m                [0m
[2;36m                    [0m         - The vulnerability is located in the **org.apache.pdfbox.ocr.OCRStreamEngine**     [2m                [0m
[2;36m                    [0m         class                                                                               [2m                [0m
[2;36m                    [0m         - The specific method triggering the security issue is **[1;35mdoOCR[0m[1m([0m[1m)[0m** at line [1;36m190[0m      [2m                [0m
[2;36m                    [0m         - The command execution happens through Java's **[1;35mProcessBuilder.start[0m[1m([0m[1m)[0m** API       [2m                [0m
[2;36m                    [0m         - The issue occurs during Tesseract OCR execution, suggesting that parameters or    [2m                [0m
[2;36m                    [0m         data passed to the external Tesseract process may be derived from untrusted sources [2m                [0m
[2;36m                    [0m         - This is a fuzzing-discovered vulnerability [1m([0mdetected using libFuzzer with Jazzer  [2m                [0m
[2;36m                    [0m         sanitizers[1m)[0m                                                                         [2m                [0m
[2;36m                    [0m         - The deduplication token [1m([0maf83c7db521bbc07[1m)[0m indicates this is a unique             [2m                [0m
[2;36m                    [0m         vulnerability pattern                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Areas for Investigation                                                         [2m                [0m
[2;36m                    [0m         To gain a comprehensive understanding of this vulnerability, the following          [2m                [0m
[2;36m                    [0m         components should be examined:                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m. **[1;35mOCRStreamEngine.doOCR[0m[1m([0m[1m)[0m method**: Investigate how command parameters are       [2m                [0m
[2;36m                    [0m         constructed and whether input validation is performed before passing data to        [2m                [0m
[2;36m                    [0m         ProcessBuilder                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m. **[1;35mOCRStreamEngine.runTesseract[0m[1m([0m[1m)[0m method**: Examine what data is passed to the    [2m                [0m
[2;36m                    [0m         [1;35mdoOCR[0m[1m([0m[1m)[0m method and its origin                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m. **Data flow analysis**: Trace the path from PDF document content/metadata        [2m                [0m
[2;36m                    [0m         through [1;35mgetText[0m[1m([0m[1m)[0m → [1;35mwriteText[0m[1m([0m[1m)[0m → [1;35mprocessPages[0m[1m([0m[1m)[0m → [1;35mprocessPage[0m[1m([0m[1m)[0m → [1;35mrunTesseract[0m[1m([0m[1m)[0m → [2m                [0m
[2;36m                    [0m         [1;35mdoOCR[0m[1m([0m[1m)[0m to identify where attacker-controlled data enters the system                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m. **ProcessBuilder usage**: Review how the ProcessBuilder is configured in         [2m                [0m
[2;36m                    [0m         [1;35mdoOCR[0m[1m([0m[1m)[0m, including:                                                                 [2m                [0m
[2;36m                    [0m            - Command arguments construction                                                 [2m                [0m
[2;36m                    [0m            - Environment variables                                                          [2m                [0m
[2;36m                    [0m            - Working directory settings                                                     [2m                [0m
[2;36m                    [0m            - Input/output stream handling                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m. **Input sources**: Identify all potential sources of untrusted input that could  [2m                [0m
[2;36m                    [0m         influence the command execution, including:                                         [2m                [0m
[2;36m                    [0m            - PDF document content                                                           [2m                [0m
[2;36m                    [0m            - PDF metadata                                                                   [2m                [0m
[2;36m                    [0m            - OCR configuration parameters                                                   [2m                [0m
[2;36m                    [0m            - File paths and names                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m. **Tesseract integration points**: Examine all locations where the code           [2m                [0m
[2;36m                    [0m         interfaces with the external Tesseract OCR engine to understand what data is being  [2m                [0m
[2;36m                    [0m         passed and how it's formatted                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Initial Issue Log                                                                [2m                [0m
[2;36m                    [0m         Here is the initial issue log of the codebase:                                      [2m                [0m
[2;36m                    [0m         [1m<[0m[1;95missue[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS[0m [2m                [0m
[2;36m                    [0m         [39mCommand Injection[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mExecuting OS commands with attacker-controlled data can lead to remote code [0m        [2m                [0m
[2;36m                    [0m         [39mexecution.[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1;39m([0m[39mOsC[0m [2m                [0m
[2;36m                    [0m         [39mommandInjection.kt:[0m[1;36m60[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1110[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1073[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.ocr.OCRStreamEngine.doOCR[0m[1;39m([0m[39mOCRStreamEngine.jav[0m[1;92ma:190[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.runTesseract[0m[1;39m([0m[39mOCRStreamEngine.jav[0m[1;92ma:165[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.processPage[0m[1;39m([0m[39mOCRStreamEngine.jav[0m[1;92ma:150[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.processPages[0m[1;39m([0m[39mOCRStreamEngine.jav[0m[1;92ma:140[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.writeText[0m[1;39m([0m[39mOCRStreamEngine.jav[0m[1;92ma:129[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.ocr.OCRStreamEngine.getText[0m[1;39m([0m[39mOCRStreamEngine.jav[0m[1;92ma:88[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.ocr.OCRStreamEngine.getText[0m[1;39m([0m[39mOCRStreamEngine.jav[0m[1;92ma:71[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke0[0m[1;39m([0m[39mNative [0m  [2m                [0m
[2;36m                    [0m         [39mMethod[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke[0m[1;39m([0m[39mNativeMethodAccessor[0m [2m                [0m
[2;36m                    [0m         [39mImpl.jav[0m[1;92ma:77[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35mjdk.internal.reflect.DelegatingMethodAccessorImpl.invoke[0m[1;39m([0m[39mDelegatingMethod[0m [2m                [0m
[2;36m                    [0m         [39mAccessorImpl.jav[0m[1;92ma:43[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.reflect.Method.invoke[0m[1;39m([0m[39mMethod.jav[0m[1;92ma:568[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mcom.example.PDFOCRFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPDFOCRFuzzer.jav[0m[1;92ma:75[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: af83c7db521bbc07[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:1[0m[39m-[0m[1;36m23[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:package org.apache.pdfbox.ocr;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:import static java.nio.charset.StandardCharsets.UTF_8;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:import java.awt.image.BufferedImage;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:import java.io.IOException;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:import java.io.InputStream;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:import java.io.InputStreamReader;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:import java.io.Reader;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:import java.io.StringWriter;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:import java.io.Writer;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:import java.nio.file.FileVisitResult;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:import java.nio.file.SimpleFileVisitor;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:import java.nio.file.attribute.BasicFileAttributes;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.util.concurrent.TimeUnit;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.concurrent.TimeoutException;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import javax.imageio.ImageIO;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:34[0m[39m-[0m[1;36m60[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:public class OCRStreamEngine [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    private static final String TESSERACT_PATH_KEY = [0m[32m"tesseract-path"[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    private PDFRenderer pdfRenderer = null;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    private String tesseractPath = [0m[32m"tesseract"[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    private int pageIndex = [0m[1;36m0[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    private int startPage = [0m[1;36m-1[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    private int endPage = [0m[1;36m-1[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    private long timeoutMillisPerPage = [0m[1;36m30000[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    private final PDDocument pdDocument;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    private Path tmpDir;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    public [0m[1;35mOCRStreamEngine[0m[1;39m([0m[39mPDDocument pdDocument[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        this.pdDocument = pdDocument;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        pdfRenderer = new [0m[1;35mPDFRenderer[0m[1;39m([0m[39mpdDocument[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    public void [0m[1;35msetTimeoutMillisPerPage[0m[1;39m([0m[39mlong millisPerPage[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        this.timeoutMillisPerPage = millisPerPage;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    public void [0m[1;35msetTesseractPath[0m[1;39m([0m[39mString tesseractPath[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        this.tesseractPath = tesseractPath;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:157[0m[39m-[0m[1;36m167[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    private String [0m[1;35mrunTesseract[0m[1;39m([0m[39mPath image[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:        String actualTessPath = [0m[1;35mpdDocument.getDocumentInformation[0m[1;39m([0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:                [0m[1;35m.getCustomMetadataValue[0m[1;39m([0m[39mTESSERACT_PATH_KEY[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        if [0m[1;39m([0m[39mactualTessPath == null || [0m[1;35mactualTessPath.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            actualTessPath = tesseractPath;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:        Path txt = [0m[1;35mPaths.get[0m[1;39m([0m[1;35mimage.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:        [0m[1;35mdoOCR[0m[1;39m([0m[39mactualTessPath, image, txt[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:        return [0m[1;35mextractContent[0m[1;39m([0m[39mtxt[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:178[0m[39m-[0m[1;36m197[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    private void [0m[1;35mdoOCR[0m[1;39m([0m[39mString actualTesseractPath, Path input, Path output[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:            throws IOException [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:        ArrayList<String> cmd = new ArrayList<>[0m[1;39m([0m                                [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:                [0m[1;35mArrays.asList[0m[1;39m([0m[39mactualTesseractPath, [0m                             [2m                [0m
[2;36m                    [0m         [1;35minput.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[39m,[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:                        [0m[1;35moutput.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:        ProcessBuilder pb = new [0m[1;35mProcessBuilder[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:            process = [0m[1;35mpb.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:            [0m[1;35mrunOCRProcess[0m[1;39m([0m[39mprocess, timeoutMillisPerPage[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:            if [0m[1;39m([0m[39mprocess != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:                [0m[1;35mprocess.destroyForcibly[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:145[0m[39m-[0m[1;36m155[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    public void [0m[1;35mprocessPage[0m[1;39m([0m[39mWriter writer[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:            BufferedImage image = [0m[1;35mpdfRenderer.renderImage[0m[1;39m([0m[39mpageIndex[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            Path target = [0m[1;35mFiles.createTempFile[0m[1;39m([0m[39mtmpDir, [0m[32m"render-"[0m[39m + pageIndex + [0m [2m                [0m
[2;36m                    [0m         [32m"-"[0m[39m, [0m[32m".png"[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            [0m[1;35mImageIO.write[0m[1;39m([0m[39mimage, [0m[32m"PNG"[0m[39m, [0m[1;35mtarget.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            String txt = [0m[1;35mrunTesseract[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:            [0m[1;35mwriter.append[0m[1;39m([0m[39mtxt[0m[1;39m)[0m[1;35m.append[0m[1;39m([0m[32m"\n"[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:            pageIndex++;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:82[0m[39m-[0m[1;36m95[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    public String [0m[1;35mgetText[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        StringWriter outputStream = new [0m[1;35mStringWriter[0m[1;39m([0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        pageIndex = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            tmpDir = [0m[1;35mFiles.createTempDirectory[0m[1;39m([0m[32m"pdfbox-ocr"[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:            [0m[1;35mwriteText[0m[1;39m([0m[39mpdDocument, outputStream[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:            return [0m[1;35moutputStream.toString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            if [0m[1;39m([0m[39mtmpDir != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:                [0m[1;35mquietlyDeleteDir[0m[1;39m([0m[39mtmpDir[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:127[0m[39m-[0m[1;36m143[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:    private void [0m[1;35mwriteText[0m[1;39m([0m[39mPDDocument doc, Writer outputStream[0m[1;39m)[0m[39m throws [0m         [2m                [0m
[2;36m                    [0m         [39mIOException[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        [0m[1;35mprocessPages[0m[1;39m([0m[1;35mdoc.getPages[0m[1;39m([0m[1;39m)[0m[39m, outputStream[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    public void [0m[1;35mprocessPages[0m[1;39m([0m[39mPDPageTree pages, Writer outputStream[0m[1;39m)[0m[39m throws [0m     [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        if [0m[1;39m([0m[39mstartPage < [0m[1;36m0[0m[39m || endPage < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:            for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < [0m[1;35mpages.getCount[0m[1;39m([0m[1;39m)[0m[39m; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:                [0m[1;35mprocessPage[0m[1;39m([0m[39moutputStream[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            startPage = pageIndex;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            for [0m[1;39m([0m[39mint i = startPage; i <= endPage && i < [0m[1;35mpages.getCount[0m[1;39m([0m[1;39m)[0m[39m; i++[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:                [0m[1;35mprocessPage[0m[1;39m([0m[39moutputStream[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDDocumentInformation.jav[0m[1;92ma:272[0m[39m-[0m[1;36m294[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:     *  This will get the value of a custom metadata information field for the [0m [2m                [0m
[2;36m                    [0m         [39mdocument.[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:     *  This will return null if one is not found.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:     * @param fieldName Name of custom metadata field from pdf document.[0m        [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:     * @return String Value of metadata field[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:    public String [0m[1;35mgetCustomMetadataValue[0m[1;39m([0m[39mString fieldName[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:        return [0m[1;35minfo.getString[0m[1;39m([0m[39m fieldName [0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:     * Set the custom metadata value.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:     * @param fieldName The name of the custom metadata field.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:     * @param fieldValue The value to the custom metadata field.[0m                [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:    public void [0m[1;35msetCustomMetadataValue[0m[1;39m([0m[39m String fieldName, String fieldValue [0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:        [0m[1;35minfo.setString[0m[1;39m([0m[39m fieldName, fieldValue [0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDDocumentInformation.jav[0m[1;92ma:19[0m[39m-[0m[1;36m27[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.util.Calendar;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.TreeSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.pdfbox.cos.COSDictionary;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.pdfbox.cos.COSName;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.pdfbox.pdmodel.common.COSObjectable;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDDocumentInformation.jav[0m[1;92ma:37[0m[39m-[0m[1;36m68[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:public class PDDocumentInformation implements COSObjectable[0m                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    private final COSDictionary info;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * Default Constructor.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    public [0m[1;35mPDDocumentInformation[0m[1;39m([0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:        info = new [0m[1;35mCOSDictionary[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     * Constructor that is used for a preexisting dictionary.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     * @param dic The underlying dictionary.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    public [0m[1;35mPDDocumentInformation[0m[1;39m([0m[39m COSDictionary dic [0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        info = dic;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     * This will get the underlying dictionary that this object wraps.[0m           [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * @return The underlying info dictionary.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    public COSDictionary [0m[1;35mgetCOSObject[0m[1;39m([0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        return info;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[1;39m}[0m[39m    [0m                                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mio/src/main/java/org/apache/pdfbox/io/IOUtils.jav[0m[1;92ma:1[0m[39m-[0m[1;36m48[0m                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m[35m/[0m[39m* $Id$ *[0m[35m/[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:package org.apache.pdfbox.io;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import static java.lang.invoke.MethodHandles.constant;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import static java.lang.invoke.MethodHandles.dropArguments;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import static java.lang.invoke.MethodHandles.filterReturnValue;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import static java.lang.invoke.MethodHandles.guardWithTest;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import static java.lang.invoke.MethodHandles.lookup;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import static java.lang.invoke.MethodType.methodType;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import static java.util.Objects.nonNull;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.io.Closeable;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.lang.invoke.MethodHandle;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.lang.invoke.MethodHandles.Lookup;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.lang.reflect.Field;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import java.lang.reflect.Method;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import java.nio.ByteBuffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import java.security.AccessController;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import java.security.PrivilegedAction;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import java.util.Objects;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import java.util.Optional;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import java.util.function.Consumer;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.logging.log4j.LogManager;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.pdfbox.io.RandomAccessStreamCache.StreamCacheCreateFunction;[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/test/java/org/apache/pdfbox/ocr/TestOCR.jav[0m[1;92ma:16[0m[39m-[0m[1;36m60[0m                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:    static String TESSERACT_PATH;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:    @BeforeAll[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:    static void [0m[1;35msetUp[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:        [0m[35m/[0m[35m/[0m[95mthese[0m[39m are some common locations for tesseract on linux[0m                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:        if [0m[1;39m([0m[1;35mFiles.isExecutable[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[32m"/usr/bin/tesseract"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:            TESSERACT_PATH = [0m[32m"/usr/bin/tesseract"[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:        else if [0m[1;39m([0m[1;35mFiles.isExecutable[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[32m"/usr/my-bin/tesseract"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:            TESSERACT_PATH = [0m[32m"/usr/my-bin/tesseract"[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:        else[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:            TESSERACT_PATH = null;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    public void [0m[1;35mtestBasic[0m[1;39m([0m[1;39m)[0m[39m throws Exception[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:        if [0m[1;39m([0m[39mTESSERACT_PATH == null[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:            return;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        Path p = [0m[1;35mPaths.get[0m[1;39m([0m[1;35mTestOCR.class.getResource[0m[1;39m([0m[32m"testOCR.pdf"[0m[1;39m)[0m[1;35m.toURI[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:        PDDocument pdDocument = [0m[1;35mLoader.loadPDF[0m[1;39m([0m[1;35mp.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        OCRStreamEngine ocrStreamEngine = new [0m[1;35mOCRStreamEngine[0m[1;39m([0m[39mpdDocument[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:        [0m[1;35mocrStreamEngine.setTesseractPath[0m[1;39m([0m[39mTESSERACT_PATH[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:        String txt = [0m[1;35mocrStreamEngine.getText[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        [0m[1;35mSystem.out.println[0m[1;39m([0m[32m"txt: "[0m[39m + txt[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        [0m[1;35massertTrue[0m[1;39m([0m[1;35mtxt.contains[0m[1;39m([0m[32m"Happy New Year"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public void [0m[1;35mtestOverride[0m[1;39m([0m[1;39m)[0m[39m throws Exception[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35mFiles.isExecutable[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[32m"/usr/my-bin/tesseract"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:            return;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        Path p = [0m                                                                [2m                [0m
[2;36m                    [0m         [1;35mPaths.get[0m[1;39m([0m[1;35mTestOCR.class.getResource[0m[1;39m([0m[32m"testOCRCustomPath.pdf"[0m[1;39m)[0m[1;35m.toURI[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        PDDocument pdDocument = [0m[1;35mLoader.loadPDF[0m[1;39m([0m[1;35mp.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/test/java/org/apache/pdfbox/ocr/TestOCR.jav[0m[1;92ma:1[0m[39m-[0m[1;36m66[0m                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:package org.apache.pdfbox.ocr;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:import static org.junit.jupiter.api.Assertions.assertTrue;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:import java.nio.file.Files;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:import java.nio.file.Path;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:import java.nio.file.Paths;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:import org.apache.pdfbox.Loader;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:import org.apache.pdfbox.pdmodel.PDDocument;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:import org.junit.jupiter.api.BeforeAll;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:import org.junit.jupiter.api.Test;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:public class TestOCR [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:    static String TESSERACT_PATH;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:    @BeforeAll[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:    static void [0m[1;35msetUp[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:        [0m[35m/[0m[35m/[0m[95mthese[0m[39m are some common locations for tesseract on linux[0m                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:        if [0m[1;39m([0m[1;35mFiles.isExecutable[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[32m"/usr/bin/tesseract"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:            TESSERACT_PATH = [0m[32m"/usr/bin/tesseract"[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:        else if [0m[1;39m([0m[1;35mFiles.isExecutable[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[32m"/usr/my-bin/tesseract"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:            TESSERACT_PATH = [0m[32m"/usr/my-bin/tesseract"[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:        else[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:            TESSERACT_PATH = null;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    public void [0m[1;35mtestBasic[0m[1;39m([0m[1;39m)[0m[39m throws Exception[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:        if [0m[1;39m([0m[39mTESSERACT_PATH == null[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:            return;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        Path p = [0m[1;35mPaths.get[0m[1;39m([0m[1;35mTestOCR.class.getResource[0m[1;39m([0m[32m"testOCR.pdf"[0m[1;39m)[0m[1;35m.toURI[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:        PDDocument pdDocument = [0m[1;35mLoader.loadPDF[0m[1;39m([0m[1;35mp.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        OCRStreamEngine ocrStreamEngine = new [0m[1;35mOCRStreamEngine[0m[1;39m([0m[39mpdDocument[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:        [0m[1;35mocrStreamEngine.setTesseractPath[0m[1;39m([0m[39mTESSERACT_PATH[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:        String txt = [0m[1;35mocrStreamEngine.getText[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        [0m[1;35mSystem.out.println[0m[1;39m([0m[32m"txt: "[0m[39m + txt[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        [0m[1;35massertTrue[0m[1;39m([0m[1;35mtxt.contains[0m[1;39m([0m[32m"Happy New Year"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public void [0m[1;35mtestOverride[0m[1;39m([0m[1;39m)[0m[39m throws Exception[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35mFiles.isExecutable[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[32m"/usr/my-bin/tesseract"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:            return;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        Path p = [0m                                                                [2m                [0m
[2;36m                    [0m         [1;35mPaths.get[0m[1;39m([0m[1;35mTestOCR.class.getResource[0m[1;39m([0m[32m"testOCRCustomPath.pdf"[0m[1;39m)[0m[1;35m.toURI[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        PDDocument pdDocument = [0m[1;35mLoader.loadPDF[0m[1;39m([0m[1;35mp.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        OCRStreamEngine ocrStreamEngine = new [0m[1;35mOCRStreamEngine[0m[1;39m([0m[39mpdDocument[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        [0m[1;35mocrStreamEngine.setTesseractPath[0m[1;39m([0m[32m"some-other-path"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        String txt = [0m[1;35mocrStreamEngine.getText[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[1;35massertTrue[0m[1;39m([0m[1;35mtxt.contains[0m[1;39m([0m[32m"Happy New Year"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/FileSystemFontProvider.jav[0m[1;92ma:388[0m [2m                [0m
[2;36m                    [0m         [39m-[0m[1;36m405[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    private File [0m[1;35mgetDiskCacheFile[0m[1;39m([0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:        String path = [0m[1;35mSystem.getProperty[0m[1;39m([0m[32m"pdfbox.fontcache"[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:        if [0m[1;39m([0m[1;35misBadPath[0m[1;39m([0m[39mpath[0m[1;39m)[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:            path = [0m[1;35mSystem.getProperty[0m[1;39m([0m[32m"user.home"[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:            if [0m[1;39m([0m[1;35misBadPath[0m[1;39m([0m[39mpath[0m[1;39m)[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:                path = [0m[1;35mSystem.getProperty[0m[1;39m([0m[32m"java.io.tmpdir"[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m397[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:        return new [0m[1;35mFile[0m[1;39m([0m[39mpath, [0m[32m".pdfbox.cache"[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:    private static boolean [0m[1;35misBadPath[0m[1;39m([0m[39mString path[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:        return path == null || !new [0m[1;35mFile[0m[1;39m([0m[39mpath[0m[1;39m)[0m[1;35m.isDirectory[0m[1;39m([0m[1;39m)[0m[39m || !new [0m           [2m                [0m
[2;36m                    [0m         [1;35mFile[0m[1;39m([0m[39mpath[0m[1;39m)[0m[1;35m.canWrite[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:169[0m[39m-[0m[1;36m176[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:    private String [0m[1;35mextractContent[0m[1;39m([0m[39mPath base[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:        Path txt = [0m[1;35mPaths.get[0m[1;39m([0m[1;35mbase.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m".txt"[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:        if [0m[1;39m([0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mtxt[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            return [0m[1;35mFiles.readString[0m[1;39m([0m[39mtxt, UTF_8[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:        [0m[35m/[0m[35m/[0m[95mlog[0m[39m missing txt file[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:        return [0m[32m""[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/FileSystemFontProvider.jav[0m[1;92ma:19[0m[39m-[0m [2m                [0m
[2;36m                    [0m         [1;36m49[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.BufferedReader;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.BufferedWriter;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.FileInputStream;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.FileReader;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.FileWriter;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.net.URI;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.security.AccessControlException;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.HashSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.util.zip.CRC32;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.logging.log4j.LogManager;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.fontbox.FontBoxFont;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.fontbox.ttf.FontHeaders;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.fontbox.ttf.OS2WindowsMetricsTable;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.fontbox.ttf.OTFParser;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.fontbox.ttf.OpenTypeFont;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.fontbox.ttf.TTFParser;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.fontbox.ttf.TrueTypeCollection;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.fontbox.ttf.TrueTypeFont;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.fontbox.type1.Type1Font;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.fontbox.util.autodetect.FontFileFinder;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.pdfbox.io.RandomAccessReadBufferedFile;[0m                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/FileSystemFontProvider.jav[0m[1;92ma:388[0m [2m                [0m
[2;36m                    [0m         [39m-[0m[1;36m405[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    private File [0m[1;35mgetDiskCacheFile[0m[1;39m([0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:        String path = [0m[1;35mSystem.getProperty[0m[1;39m([0m[32m"pdfbox.fontcache"[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:        if [0m[1;39m([0m[1;35misBadPath[0m[1;39m([0m[39mpath[0m[1;39m)[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:            path = [0m[1;35mSystem.getProperty[0m[1;39m([0m[32m"user.home"[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:            if [0m[1;39m([0m[1;35misBadPath[0m[1;39m([0m[39mpath[0m[1;39m)[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:                path = [0m[1;35mSystem.getProperty[0m[1;39m([0m[32m"java.io.tmpdir"[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m397[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:        return new [0m[1;35mFile[0m[1;39m([0m[39mpath, [0m[32m".pdfbox.cache"[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:    private static boolean [0m[1;35misBadPath[0m[1;39m([0m[39mString path[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:        return path == null || !new [0m[1;35mFile[0m[1;39m([0m[39mpath[0m[1;39m)[0m[1;35m.isDirectory[0m[1;39m([0m[1;39m)[0m[39m || !new [0m           [2m                [0m
[2;36m                    [0m         [1;35mFile[0m[1;39m([0m[39mpath[0m[1;39m)[0m[1;35m.canWrite[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:199[0m[39m-[0m[1;36m232[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:    private void [0m[1;35mrunOCRProcess[0m[1;39m([0m[39mProcess process, long timeoutMillis[0m[1;39m)[0m[39m throws [0m     [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:        [0m[1;35mprocess.getOutputStream[0m[1;39m([0m[1;39m)[0m[1;35m.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:        InputStream out = [0m[1;35mprocess.getInputStream[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:        InputStream err = [0m[1;35mprocess.getErrorStream[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:        StringBuilder outBuilder = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:        StringBuilder errBuilder = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:        Thread outThread = [0m[1;35mlogStream[0m[1;39m([0m[39mout, outBuilder[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:        Thread errThread = [0m[1;35mlogStream[0m[1;39m([0m[39merr, errBuilder[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:        [0m[1;35moutThread.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:        [0m[1;35merrThread.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:        int exitValue = Integer.MIN_VALUE;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            boolean finished = [0m[1;35mprocess.waitFor[0m[1;39m([0m[39mtimeoutMillis, [0m                  [2m                [0m
[2;36m                    [0m         [39mTimeUnit.MILLISECONDS[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:            if [0m[1;39m([0m[39m!finished[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[39mnew [0m[1;35mTimeoutException[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:            exitValue = [0m[1;35mprocess.exitValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInterruptedException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:            [0m[1;35mThread.currentThread[0m[1;39m([0m[1;39m)[0m[1;35m.interrupt[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:        if [0m[1;39m([0m[39mexitValue > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:                [0m[35m/[0m[35m/[0m[95mmake[0m[39m sure this thread is actually done[0m                        [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:                [0m[1;35merrThread.join[0m[1;39m([0m[1;36m1000[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInterruptedException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:                [0m[35m/[0m[35m/[0m[95mswallow[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m                                              [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                    [0m[32m"TesseractOCRParser bad exit value "[0m[39m + exitValue + [0m[32m" err [0m   [2m                [0m
[2;36m                    [0m         [32mmsg: "[0m[39m +[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                            [0m[1;35merrBuilder.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:3[0m[39m-[0m[1;36m23[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:import static java.nio.charset.StandardCharsets.UTF_8;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:import java.awt.image.BufferedImage;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:import java.io.IOException;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:import java.io.InputStream;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:import java.io.InputStreamReader;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:import java.io.Reader;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:import java.io.StringWriter;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:import java.io.Writer;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:import java.nio.file.FileVisitResult;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:import java.nio.file.SimpleFileVisitor;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:import java.nio.file.attribute.BasicFileAttributes;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.util.concurrent.TimeUnit;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.concurrent.TimeoutException;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import javax.imageio.ImageIO;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:97[0m[39m-[0m[1;36m117[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    private void [0m[1;35mquietlyDeleteDir[0m[1;39m([0m[39mPath tmpDir[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:            [0m[1;35mFiles.walkFileTree[0m[1;39m([0m[39mtmpDir, new SimpleFileVisitor<Path>[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:                @Override[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:                public FileVisitResult [0m[1;35mvisitFile[0m[1;39m([0m[39mPath file, BasicFileAttributes[0m [2m                [0m
[2;36m                    [0m         [39mattrs[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                        throws IOException [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                    [0m[1;35mFiles.delete[0m[1;39m([0m[39mfile[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                    return FileVisitResult.CONTINUE;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:                @Override[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:                public FileVisitResult [0m[1;35mpostVisitDirectory[0m[1;39m([0m[39mPath dir, IOException[0m [2m                [0m
[2;36m                    [0m         [39mexc[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:                        throws IOException [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:                    [0m[1;35mFiles.delete[0m[1;39m([0m[39mdir[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:                    return FileVisitResult.CONTINUE;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:            [0m[1;39m}[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:            [0m[35m/[0m[35m/[0m[95mlog[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:34[0m[39m-[0m[1;36m60[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:public class OCRStreamEngine [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    private static final String TESSERACT_PATH_KEY = [0m[32m"tesseract-path"[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    private PDFRenderer pdfRenderer = null;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    private String tesseractPath = [0m[32m"tesseract"[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    private int pageIndex = [0m[1;36m0[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    private int startPage = [0m[1;36m-1[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    private int endPage = [0m[1;36m-1[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    private long timeoutMillisPerPage = [0m[1;36m30000[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    private final PDDocument pdDocument;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    private Path tmpDir;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    public [0m[1;35mOCRStreamEngine[0m[1;39m([0m[39mPDDocument pdDocument[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        this.pdDocument = pdDocument;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        pdfRenderer = new [0m[1;35mPDFRenderer[0m[1;39m([0m[39mpdDocument[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    public void [0m[1;35msetTimeoutMillisPerPage[0m[1;39m([0m[39mlong millisPerPage[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        this.timeoutMillisPerPage = millisPerPage;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    public void [0m[1;35msetTesseractPath[0m[1;39m([0m[39mString tesseractPath[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        this.tesseractPath = tesseractPath;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:36[0m[39m-[0m[1;36m36[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    private static final String TESSERACT_PATH_KEY = [0m[32m"tesseract-path"[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:157[0m[39m-[0m[1;36m167[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    private String [0m[1;35mrunTesseract[0m[1;39m([0m[39mPath image[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:        String actualTessPath = [0m[1;35mpdDocument.getDocumentInformation[0m[1;39m([0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:                [0m[1;35m.getCustomMetadataValue[0m[1;39m([0m[39mTESSERACT_PATH_KEY[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        if [0m[1;39m([0m[39mactualTessPath == null || [0m[1;35mactualTessPath.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            actualTessPath = tesseractPath;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:        Path txt = [0m[1;35mPaths.get[0m[1;39m([0m[1;35mimage.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:        [0m[1;35mdoOCR[0m[1;39m([0m[39mactualTessPath, image, txt[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:        return [0m[1;35mextractContent[0m[1;39m([0m[39mtxt[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:178[0m[39m-[0m[1;36m197[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    private void [0m[1;35mdoOCR[0m[1;39m([0m[39mString actualTesseractPath, Path input, Path output[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:            throws IOException [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:        ArrayList<String> cmd = new ArrayList<>[0m[1;39m([0m                                [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:                [0m[1;35mArrays.asList[0m[1;39m([0m[39mactualTesseractPath, [0m                             [2m                [0m
[2;36m                    [0m         [1;35minput.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[39m,[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:                        [0m[1;35moutput.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:        ProcessBuilder pb = new [0m[1;35mProcessBuilder[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:            process = [0m[1;35mpb.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:            [0m[1;35mrunOCRProcess[0m[1;39m([0m[39mprocess, timeoutMillisPerPage[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:            if [0m[1;39m([0m[39mprocess != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:                [0m[1;35mprocess.destroyForcibly[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/test/java/org/apache/pdfbox/ocr/TestOCR.jav[0m[1;92ma:18[0m[39m-[0m[1;36m33[0m                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:    @BeforeAll[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:    static void [0m[1;35msetUp[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:        [0m[35m/[0m[35m/[0m[95mthese[0m[39m are some common locations for tesseract on linux[0m                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:        if [0m[1;39m([0m[1;35mFiles.isExecutable[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[32m"/usr/bin/tesseract"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:            TESSERACT_PATH = [0m[32m"/usr/bin/tesseract"[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:        else if [0m[1;39m([0m[1;35mFiles.isExecutable[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[32m"/usr/my-bin/tesseract"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:            TESSERACT_PATH = [0m[32m"/usr/my-bin/tesseract"[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:        else[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:            TESSERACT_PATH = null;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/test/java/org/apache/pdfbox/ocr/TestOCR.jav[0m[1;92ma:52[0m[39m-[0m[1;36m65[0m                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public void [0m[1;35mtestOverride[0m[1;39m([0m[1;39m)[0m[39m throws Exception[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35mFiles.isExecutable[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[32m"/usr/my-bin/tesseract"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:            return;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        Path p = [0m                                                                [2m                [0m
[2;36m                    [0m         [1;35mPaths.get[0m[1;39m([0m[1;35mTestOCR.class.getResource[0m[1;39m([0m[32m"testOCRCustomPath.pdf"[0m[1;39m)[0m[1;35m.toURI[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        PDDocument pdDocument = [0m[1;35mLoader.loadPDF[0m[1;39m([0m[1;35mp.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        OCRStreamEngine ocrStreamEngine = new [0m[1;35mOCRStreamEngine[0m[1;39m([0m[39mpdDocument[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        [0m[1;35mocrStreamEngine.setTesseractPath[0m[1;39m([0m[32m"some-other-path"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        String txt = [0m[1;35mocrStreamEngine.getText[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[1;35massertTrue[0m[1;39m([0m[1;35mtxt.contains[0m[1;39m([0m[32m"Happy New Year"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/FileSystemFontProvider.jav[0m[1;92ma:402[0m [2m                [0m
[2;36m                    [0m         [39m-[0m[1;36m405[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:    private static boolean [0m[1;35misBadPath[0m[1;39m([0m[39mString path[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:        return path == null || !new [0m[1;35mFile[0m[1;39m([0m[39mpath[0m[1;39m)[0m[1;35m.isDirectory[0m[1;39m([0m[1;39m)[0m[39m || !new [0m           [2m                [0m
[2;36m                    [0m         [1;35mFile[0m[1;39m([0m[39mpath[0m[1;39m)[0m[1;35m.canWrite[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:1[0m[39m-[0m[1;36m27[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:package org.apache.pdfbox.ocr;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:import static java.nio.charset.StandardCharsets.UTF_8;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:import java.awt.image.BufferedImage;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:import java.io.IOException;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:import java.io.InputStream;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:import java.io.InputStreamReader;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:import java.io.Reader;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:import java.io.StringWriter;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:import java.io.Writer;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:import java.nio.file.FileVisitResult;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:import java.nio.file.SimpleFileVisitor;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:import java.nio.file.attribute.BasicFileAttributes;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.util.concurrent.TimeUnit;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.concurrent.TimeoutException;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import javax.imageio.ImageIO;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.pdfbox.pdmodel.PDDocument;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.pdfbox.pdmodel.PDPageTree;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.pdfbox.rendering.PDFRenderer;[0m                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:58[0m[39m-[0m[1;36m60[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    public void [0m[1;35msetTesseractPath[0m[1;39m([0m[39mString tesseractPath[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        this.tesseractPath = tesseractPath;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:157[0m[39m-[0m[1;36m167[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    private String [0m[1;35mrunTesseract[0m[1;39m([0m[39mPath image[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:        String actualTessPath = [0m[1;35mpdDocument.getDocumentInformation[0m[1;39m([0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:                [0m[1;35m.getCustomMetadataValue[0m[1;39m([0m[39mTESSERACT_PATH_KEY[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        if [0m[1;39m([0m[39mactualTessPath == null || [0m[1;35mactualTessPath.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            actualTessPath = tesseractPath;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:        Path txt = [0m[1;35mPaths.get[0m[1;39m([0m[1;35mimage.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:        [0m[1;35mdoOCR[0m[1;39m([0m[39mactualTessPath, image, txt[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:        return [0m[1;35mextractContent[0m[1;39m([0m[39mtxt[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy for OS Command Injection Vulnerability in OCRStreamEngine[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m1[0m[39m. Root Cause Analysis[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability stems from three fundamental security flaws in [0m                   [2m                [0m
[2;36m                    [0m         [39m`OCRStreamEngine.java`:[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Unvalidated External Input**: The `[0m[1;35mrunTesseract[0m[1;39m([0m[1;39m)[0m[39m` method [0m[1;39m([0m[39mlines [0m[1;36m157[0m[39m-[0m[1;36m167[0m[1;39m)[0m[39m [0m     [2m                [0m
[2;36m                    [0m         [39mreads the tesseract executable path from PDF document metadata without any [0m         [2m                [0m
[2;36m                    [0m         [39mvalidation[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Incorrect Priority Order**: PDF metadata [0m[1;39m([0m[39mattacker-controlled[0m[1;39m)[0m[39m takes [0m          [2m                [0m
[2;36m                    [0m         [39mprecedence over programmatic configuration [0m[1;39m([0m[39mapplication-controlled[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Direct Command Execution**: The unvalidated path is passed directly to [0m        [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mProcessBuilder.start[0m[1;39m([0m[1;39m)[0m[39m` in `[0m[1;35mdoOCR[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m[1;36m190[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe attack vector is straightforward: an attacker embeds malicious metadata like [0m   [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/[0m[95mInfo[0m[39m << [0m[35m/[0m[95mtesseract-path[0m[39m [0m[1;39m([0m[35m/bin/[0m[95msh[0m[1;39m)[0m[39m >>` in a PDF document, and when OCR processing [0m [2m                [0m
[2;36m                    [0m         [39moccurs, arbitrary commands execute with the application's privileges.[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m2[0m[39m. Comprehensive Fix Strategy[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Phase [0m[1;36m1[0m[39m: Add Path Validation [0m[1;39m([0m[39mPrimary Security Control[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: `pdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.java`[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m1.1[0m[39m**: Add required imports after line [0m[1;36m21[0m[39m:[0m                                   [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mimport java.nio.file.InvalidPathException;[0m                                          [2m                [0m
[2;36m                    [0m         [39mimport org.apache.logging.log4j.Logger;[0m                                             [2m                [0m
[2;36m                    [0m         [39mimport org.apache.logging.log4j.LogManager;[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m1.2[0m[39m**: Add logger field after line [0m[1;36m34[0m[39m [0m[1;39m([0m[39mafter class declaration[0m[1;39m)[0m[39m:[0m             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mprivate static final Logger LOG = [0m[1;35mLogManager.getLogger[0m[1;39m([0m[39mOCRStreamEngine.class[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m1.3[0m[39m**: Add validation method [0m[1;39m([0m[39minsert before `[0m[1;35mrunTesseract[0m[1;39m([0m[1;39m)[0m[39m` method, around [0m [2m                [0m
[2;36m                    [0m         [39mline [0m[1;36m156[0m[1;39m)[0m[39m:[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[39m**[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m * Validates that the given path points to an executable file.[0m                      [2m                [0m
[2;36m                    [0m         [39m * This prevents OS command injection through PDF metadata.[0m                         [2m                [0m
[2;36m                    [0m         [39m *[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m * @param path the path to validate[0m                                                 [2m                [0m
[2;36m                    [0m         [39m * @return true if the path is valid and executable, false otherwise[0m                [2m                [0m
[2;36m                    [0m         [39m *[0m[35m/[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39mprivate boolean [0m[1;35misValidTesseractPath[0m[1;39m([0m[39mString path[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mpath == null || [0m[1;35mpath.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [39m        return false;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    try [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        Path tessPath = [0m[1;35mPaths.get[0m[1;39m([0m[39mpath[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[35m/[0m[35m/[0m[39m Must exist, be a regular file [0m[1;39m([0m[39mnot directory[0m[1;39m)[0m[39m, and be executable[0m         [2m                [0m
[2;36m                    [0m         [39m        return [0m[1;35mFiles.exists[0m[1;39m([0m[39mtessPath[0m[1;39m)[0m[39m && [0m                                           [2m                [0m
[2;36m                    [0m         [39m               [0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mtessPath[0m[1;39m)[0m[39m && [0m                                    [2m                [0m
[2;36m                    [0m         [39m               [0m[1;35mFiles.isExecutable[0m[1;39m([0m[39mtessPath[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInvalidPathException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Invalid path syntax for tesseract: [0m[32m{[0m[32m}[0m[32m"[0m[39m, path[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [39m        return false;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis validation follows the existing pattern from [0m                                  [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mFileSystemFontProvider.isBadPath[0m[1;39m([0m[1;39m)[0m[39m` and the test code's use of [0m                    [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mFiles.isExecutable[0m[1;39m([0m[1;39m)[0m[39m`.[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Phase [0m[1;36m2[0m[39m: Secure the [0m[1;35mrunTesseract[0m[1;39m([0m[1;39m)[0m[39m Method [0m[1;39m([0m[39mFix Priority Order & Add [0m           [2m                [0m
[2;36m                    [0m         [39mValidation[0m[1;39m)[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: Lines [0m[1;36m157[0m[39m-[0m[1;36m167[0m[39m in `OCRStreamEngine.java`[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m2.1[0m[39m**: Replace the entire `[0m[1;35mrunTesseract[0m[1;39m([0m[1;39m)[0m[39m` method with secured version:[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mprivate String [0m[1;35mrunTesseract[0m[1;39m([0m[39mPath image[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Start with programmatic/default configuration [0m[1;39m([0m[39mapplication-controlled[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m    String actualTessPath = tesseractPath;[0m                                          [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Check if metadata override is explicitly enabled via system property[0m         [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m This provides defense-in-depth while maintaining backward compatibility[0m      [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[1;35mBoolean.getBoolean[0m[1;39m([0m[32m"pdfbox.ocr.allow-metadata-override"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [39m        String metadataPath = [0m[1;35mpdDocument.getDocumentInformation[0m[1;39m([0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m                [0m[1;35m.getCustomMetadataValue[0m[1;39m([0m[39mTESSERACT_PATH_KEY[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m        [0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        if [0m[1;39m([0m[39mmetadataPath != null && ![0m[1;35mmetadataPath.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [39m            [0m[35m/[0m[35m/[0m[39m Validate metadata path before using it[0m                               [2m                [0m
[2;36m                    [0m         [39m            if [0m[1;39m([0m[1;35misValidTesseractPath[0m[1;39m([0m[39mmetadataPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [39m                [0m[1;35mLOG.info[0m[1;39m([0m[32m"Using tesseract path from PDF metadata: [0m[32m{[0m[32m}[0m[32m"[0m[39m, [0m             [2m                [0m
[2;36m                    [0m         [39mmetadataPath[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m                actualTessPath = metadataPath;[0m                                      [2m                [0m
[2;36m                    [0m         [39m            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [39m                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Invalid tesseract path from PDF metadata [0m[32m([0m[32mnot [0m            [2m                [0m
[2;36m                    [0m         [32mexecutable[0m[32m)[0m[32m: [0m[32m{[0m[32m}[0m[32m, using default"[0m[39m, [0m                                                   [2m                [0m
[2;36m                    [0m         [39m                        metadataPath[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m            [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[35m/[0m[35m/[0m[39m Log if metadata is present but override is disabled[0m                      [2m                [0m
[2;36m                    [0m         [39m        String metadataPath = [0m[1;35mpdDocument.getDocumentInformation[0m[1;39m([0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m                [0m[1;35m.getCustomMetadataValue[0m[1;39m([0m[39mTESSERACT_PATH_KEY[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m        if [0m[1;39m([0m[39mmetadataPath != null && ![0m[1;35mmetadataPath.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [39m            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"Ignoring tesseract path from PDF metadata [0m[32m([0m[32moverride [0m         [2m                [0m
[2;36m                    [0m         [32mdisabled[0m[32m)[0m[32m: [0m[32m{[0m[32m}[0m[32m"[0m[39m, metadataPath[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Final validation of the path to be used [0m[1;39m([0m[39mwhether from metadata, config, or [0m  [2m                [0m
[2;36m                    [0m         [39mdefault[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39m![0m[1;35misValidTesseractPath[0m[1;39m([0m[39mactualTessPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [39m        throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Tesseract executable not found or not executable: "[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39m+ actualTessPath + [0m                                                                 [2m                [0m
[2;36m                    [0m         [39m                            [0m[32m". Please ensure Tesseract OCR is installed and the [0m    [2m                [0m
[2;36m                    [0m         [32mpath is correct."[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m    Path txt = [0m[1;35mPaths.get[0m[1;39m([0m[1;35mimage.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mdoOCR[0m[1;39m([0m[39mactualTessPath, image, txt[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m    return [0m[1;35mextractContent[0m[1;39m([0m[39mtxt[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Key Security Improvements**:[0m                                                      [2m                [0m
[2;36m                    [0m         [39m- **Changed Priority**: Programmatic configuration now takes precedence over PDF [0m   [2m                [0m
[2;36m                    [0m         [39mmetadata[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- **Opt-in Metadata Override**: Requires [0m                                           [2m                [0m
[2;36m                    [0m         [39m`-Dpdfbox.ocr.allow-metadata-[0m[33moverride[0m[39m=[0m[35mtrue[0m[39m` to enable metadata paths[0m                [2m                [0m
[2;36m                    [0m         [39m- **Mandatory Validation**: All paths [0m[1;39m([0m[39mmetadata, programmatic, and default[0m[1;39m)[0m[39m are [0m    [2m                [0m
[2;36m                    [0m         [39mvalidated before use[0m                                                                [2m                [0m
[2;36m                    [0m         [39m- **Security Logging**: Logs all validation failures and metadata override attempts[0m [2m                [0m
[2;36m                    [0m         [39mfor auditing[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m- **Clear Error Messages**: Helps legitimate users diagnose configuration issues[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Phase [0m[1;36m3[0m[39m: Add Validation to [0m[1;35msetTesseractPath[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m([0m[39mDefense in Depth[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: Lines [0m[1;36m58[0m[39m-[0m[1;36m60[0m[39m in `OCRStreamEngine.java`[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m3.1[0m[39m**: Add validation to the setter method:[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[39m**[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m * Sets the path to the Tesseract executable.[0m                                       [2m                [0m
[2;36m                    [0m         [39m * The path will be validated when OCR processing begins.[0m                           [2m                [0m
[2;36m                    [0m         [39m *[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m * @param tesseractPath the path to the Tesseract executable[0m                        [2m                [0m
[2;36m                    [0m         [39m *[0m[35m/[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39mpublic void [0m[1;35msetTesseractPath[0m[1;39m([0m[39mString tesseractPath[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Store the path; validation occurs at execution time in [0m[1;35mrunTesseract[0m[1;39m([0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m This allows setting the path before Tesseract is installed[0m                   [2m                [0m
[2;36m                    [0m         [39m    this.tesseractPath = tesseractPath;[0m                                             [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mNote: Validation is intentionally deferred to `[0m[1;35mrunTesseract[0m[1;39m([0m[1;39m)[0m[39m` to allow [0m            [2m                [0m
[2;36m                    [0m         [39mconfiguration before the executable is available, matching the existing test [0m       [2m                [0m
[2;36m                    [0m         [39mpatterns.[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Phase [0m[1;36m4[0m[39m: Improve Error Logging [0m[1;39m([0m[39mReplace Missing Log Statement[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: Line [0m[1;36m115[0m[39m in `OCRStreamEngine.java`[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m4.1[0m[39m**: Replace the `[0m[35m/[0m[35m/[0m[95mlog[0m[39m` comment with actual logging:[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Failed to delete temporary OCR directory: [0m[32m{[0m[32m}[0m[32m"[0m[39m, tmpDir, e[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m3[0m[39m. Justification and Impact Analysis[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Why This Approach is Optimal[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Addresses Root Cause**: Validates executable paths before command execution, [0m  [2m                [0m
[2;36m                    [0m         [39mpreventing injection[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Maintains Compatibility**: The opt-in system property allows existing [0m         [2m                [0m
[2;36m                    [0m         [39mfunctionality while defaulting to secure behavior[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Defense in Depth**: Multiple validation layers [0m[1;39m([0m[39mpath syntax, file existence, [0m  [2m                [0m
[2;36m                    [0m         [39mfile type, executable bit[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Follows Existing Patterns**: Uses `[0m[1;35mFiles.isExecutable[0m[1;39m([0m[1;39m)[0m[39m` as demonstrated in [0m   [2m                [0m
[2;36m                    [0m         [39mtest code and `[0m[1;35misBadPath[0m[1;39m([0m[1;39m)[0m[39m` pattern from `FileSystemFontProvider`[0m                   [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Security Auditing**: Comprehensive logging enables detection of exploitation [0m  [2m                [0m
[2;36m                    [0m         [39mattempts[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Clear Error Messages**: Helps legitimate users diagnose configuration issues [0m  [2m                [0m
[2;36m                    [0m         [39mquickly[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### How It Preserves Existing Logic[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Default Behavior Unchanged**: When no metadata is present and default [0m         [2m                [0m
[2;36m                    [0m         [32m"tesseract"[0m[39m is used, behavior is identical[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Programmatic Configuration Works**: `[0m[1;35msetTesseractPath[0m[1;39m([0m[1;39m)[0m[39m` continues to function[0m [2m                [0m
[2;36m                    [0m         [39mas expected[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Test Compatibility**: Existing tests will pass because they use valid, [0m        [2m                [0m
[2;36m                    [0m         [39mexecutable tesseract paths[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **No Breaking Changes**: Applications not using metadata override see no [0m        [2m                [0m
[2;36m                    [0m         [39mfunctional changes[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Protection Against Attack Vectors[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Before Fix**: [0m                                                                    [2m                [0m
[2;36m                    [0m         [39m- Attacker creates PDF with metadata: `[0m[35m/[0m[95mInfo[0m[39m << [0m[35m/[0m[95mtesseract-path[0m[39m [0m[1;39m([0m[35m/bin/[0m[95msh[0m[39m -c [0m        [2m                [0m
[2;36m                    [0m         [32m"malicious command"[0m[1;39m)[0m[39m >>`[0m                                                            [2m                [0m
[2;36m                    [0m         [39m- OCR processing executes arbitrary commands[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**After Fix**:[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m- Metadata path `[0m[35m/bin/[0m[95msh[0m[39m` is validated[0m                                              [2m                [0m
[2;36m                    [0m         [39m- `[0m[1;35mFiles.isRegularFile[0m[1;39m([0m[1;39m)[0m[39m` returns true for `[0m[35m/bin/[0m[95msh[0m[39m`[0m                                [2m                [0m
[2;36m                    [0m         [39m- `[0m[1;35mFiles.isExecutable[0m[1;39m([0m[1;39m)[0m[39m` returns true for `[0m[35m/bin/[0m[95msh[0m[39m`[0m                                 [2m                [0m
[2;36m                    [0m         [39m- **BUT** system property `pdfbox.ocr.allow-metadata-override` defaults to `false`[0m  [2m                [0m
[2;36m                    [0m         [39m- Metadata path is ignored, default [0m[32m"tesseract"[0m[39m is used[0m                             [2m                [0m
[2;36m                    [0m         [39m- Even if override is enabled, logs show: `[0m[32m"Using tesseract path from PDF metadata:[0m [2m                [0m
[2;36m                    [0m         [32m/bin/sh"[0m[39m`[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m- Security teams can monitor logs for suspicious paths[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Additional Protection**: Even with override enabled, paths like `sh -c malicious`[0m [2m                [0m
[2;36m                    [0m         [39mfail validation due to `InvalidPathException` [0m[1;39m([0m[39mspaces in path without proper [0m       [2m                [0m
[2;36m                    [0m         [39mescaping[0m[1;39m)[0m[39m.[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Mitigation of Side Effects[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Legitimate Metadata Override Use Cases**: Users who need this feature can [0m     [2m                [0m
[2;36m                    [0m         [39menable it via system property[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Performance Impact**: Minimal - validation happens once per page, uses fast [0m   [2m                [0m
[2;36m                    [0m         [39mNIO operations[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Backward Compatibility**: Default behavior is secure; opt-in required for [0m     [2m                [0m
[2;36m                    [0m         [39mprevious insecure behavior[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Error Handling**: Clear exception messages guide users to correct [0m             [2m                [0m
[2;36m                    [0m         [39mconfiguration[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m4[0m[39m. Alternative Approaches Considered and Rejected[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Complete Removal of Metadata Override**: Too breaking for existing deployments[0m [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Whitelist of Allowed Paths**: Too restrictive across different platforms and [0m  [2m                [0m
[2;36m                    [0m         [39minstallations[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Command Argument Escaping**: Insufficient - the executable itself is the [0m      [2m                [0m
[2;36m                    [0m         [39mattack vector[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Validation Only in [0m[1;35mdoOCR[0m[1;39m([0m[1;39m)[0m[39m**: Too late - validation should happen at [0m          [2m                [0m
[2;36m                    [0m         [39mconfiguration time[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Catching Broader Exceptions**: Would hide legitimate configuration errors[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m5[0m[39m. Testing Recommendations[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter applying this fix:[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Existing Tests**: Should pass unchanged [0m[1;39m([0m[39mtest code uses valid executable [0m      [2m                [0m
[2;36m                    [0m         [39mpaths[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Security Test**: Create PDF with malicious metadata and verify it's rejected[0m   [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Configuration Test**: Verify system property enables/disables metadata [0m        [2m                [0m
[2;36m                    [0m         [39moverride[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Path Validation Test**: Test invalid paths [0m[1;39m([0m[39mnon-existent, non-executable, [0m     [2m                [0m
[2;36m                    [0m         [39mdirectories[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Logging Test**: Verify security events are logged correctly[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m6[0m[39m. Documentation Updates Required[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mUpdate OCRStreamEngine class JavaDoc to document:[0m                                   [2m                [0m
[2;36m                    [0m         [39m- Security implications of PDF metadata[0m                                             [2m                [0m
[2;36m                    [0m         [39m- System property `pdfbox.ocr.allow-metadata-override`[0m                              [2m                [0m
[2;36m                    [0m         [39m- Requirement for Tesseract executable to exist and be executable[0m                   [2m                [0m
[2;36m                    [0m         [39m- Recommendation to monitor logs for security events[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=262468;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=282384;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=641419;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=715308;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpm6zpt0b8[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/pdfbox_pdfbox-delta-01_vuln_2[0m [2m               [0m
[2;36m                    [0m         [35m/[0m[95magent-output-1767723372.559399[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/pdfbox_pdfbox-delta-01_vuln_2.toml                    [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-pdfbox[0m           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/06/26 18:18:23][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/qqor/crete/.cache/environments/[0m[95mpdfbox[0m         ]8;id=578681;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=608652;file:///home/qqor/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=975816;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=932645;file:///home/qqor/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mpdfbox[0m                [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=65161;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=443559;file:///home/qqor/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mpdfbox[0m                 [2m               [0m
